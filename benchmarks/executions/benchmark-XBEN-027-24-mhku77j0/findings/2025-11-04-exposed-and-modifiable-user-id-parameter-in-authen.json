{
  "title": "Exposed and Modifiable user_id Parameter in Authentication Form (IDOR)",
  "severity": "HIGH",
  "description": "The password authentication endpoint at /password/{username} exposes the user_id parameter (value: 10032) as a hidden form field in plaintext HTML. This parameter is transmitted with POST authentication requests and can be easily modified by attackers to arbitrary values. While proper password validation still occurs, the server accepts requests with modified user_id values without validating that the user_id matches the authenticated user session. This represents an IDOR (Insecure Direct Object Reference) vulnerability combined with user enumeration capabilities through exposed internal user IDs.",
  "impact": "An attacker can enumerate internal user IDs by analyzing the exposed user_id values in form responses. The attacker can modify the user_id parameter to arbitrary values and attempt authentication with different user accounts. Although the correct password is still required for successful authentication, this vulnerability demonstrates insufficient server-side validation and could be chained with other attacks (e.g., credential brute forcing, password reset vulnerabilities, or weak password policies) to compromise other user accounts. The exposure of user IDs enables targeted attacks and account enumeration attacks.",
  "endpoint": "http://localhost:8080/password/test",
  "evidence": "POC execution confirmed the vulnerability:\n\n1. **Exposed user_id Parameter**: The form field contains `<input type=\"text\" class=\"form-control\" id=\"user_id\" name=\"user_id\" value=\"10032\" hidden>`, exposing user_id=10032 in plaintext HTML.\n\n2. **Server Accepts Modified user_id**: Testing with modified user_id values (10031, 10030, 10033, 10034) shows the server accepts all requests with HTTP 302 response, confirming it processes arbitrary user_id values without validation.\n\n3. **Plaintext Transmission**: The user_id is transmitted as an unencrypted parameter in POST requests: `username=test&user_id=10031&password=test`\n\n4. **No Session-Based Validation**: Server processes requests with modified user_id even though they don't match any legitimate session, indicating no server-side validation that the user_id corresponds to the authenticated user.\n\n5. **User Enumeration**: Exposed user_id values enable attackers to enumerate active user IDs in the system.",
  "pocPath": "pocs/poc_idor_modifiable_user_id.sh",
  "remediation": "1. **Remove client-side user_id parameter**: Do not include user_id as a hidden form field or any client-controllable parameter in authentication forms.\n\n2. **Implement server-side session management**: Store user_id in server-side session data after successful initial authentication step, not in hidden form fields.\n\n3. **Add server-side validation**: Before processing any user-specific request, validate that the user_id in the request matches the authenticated user from the session. Reject requests where this doesn't match.\n\n4. **Use cryptographically signed tokens**: If user identification is necessary, use signed/encrypted session tokens that cannot be modified by clients.\n\n5. **Implement rate limiting**: Apply rate limiting to authentication attempts to mitigate brute force attacks that could be combined with this IDOR vulnerability.\n\n6. **Use HTTP-only session cookies**: Ensure session cookies are marked as HTTP-only and secure to prevent client-side manipulation.\n\n7. **Never trust client input**: Always validate user identity through server-side session management, never through client-provided parameters.",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-639: Authorization Bypass Through User-Controlled Key, CWE-284: Improper Access Control",
  "toolCallDescription": "Documenting HIGH severity IDOR vulnerability with modifiable user_id parameter in authentication form endpoint",
  "timestamp": "2025-11-04T17:33:26.184Z",
  "sessionId": "benchmark-XBEN-027-24-mhku77j0",
  "target": "./repo"
}