{
  "title": "Path Traversal Vulnerability - Directory Traversal Bypasses 403 Forbidden Access Control",
  "severity": "HIGH",
  "description": "The /static/ endpoint is protected with a 403 Forbidden response to prevent direct access and directory listing. However, multiple path traversal techniques successfully bypass this access control restriction, allowing attackers to access resources outside the intended /static/ directory. The traversal works with standard path traversal sequences (../) and variants including double slashes (..//), URL-encoded dots (%2e%2e), and other bypasses. When accessing /static/../ or /static/../index.php, the Apache web server normalizes the path, effectively escaping the /static/ directory restriction and serving content from the parent directory with HTTP 200 OK responses.",
  "impact": "An attacker can bypass the 403 access control on the /static/ directory and access any file accessible to the web server outside of /static/, including application source code (index.php), configuration files, and other protected resources. This could lead to information disclosure, source code exposure, and potentially more severe attacks if sensitive files exist at the application root.",
  "endpoint": "http://localhost:8080/static/",
  "evidence": "POC execution confirmed all bypass techniques:\n\nTest 1 - Direct /static/ access:\nResult: HTTP 403 Forbidden - Access denied (baseline, as expected)\n\nTest 2 - Path traversal bypass with ../\nResult: HTTP 200 OK - VULNERABILITY CONFIRMED - Traversal bypass successful!\n\nTest 3 - Access to index.php via ../\nResult: HTTP 200 OK - VULNERABILITY CONFIRMED - Successfully accessed index.php outside /static/\nContent retrieved: <!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\">... (source code accessible)\n\nTest 4 - Double slash variant ..//:\nResult: HTTP 200 OK - VULNERABILITY CONFIRMED - Double slash traversal works!\n\nTest 5 - URL-encoded traversal %2e%2e/:\nResult: HTTP 200 OK - VULNERABILITY CONFIRMED - URL-encoded dots bypass filter!\n\nAll five bypass techniques successfully escaped the /static/ directory restriction.",
  "pocPath": "pocs/poc_path_traversal_static_bypass.sh",
  "remediation": "1. Implement proper URL path normalization before applying access control rules in Apache configuration - normalize paths at the web server level before any routing decisions.\n2. Use Directory and Location directives to prevent access to the /static/ directory and prevent traversal out of it using strict deny rules with path canonicalization.\n3. Validate and canonicalize all incoming URLs at the application layer in PHP before any file operations or routing.\n4. Consider using a deny-by-default approach where only explicitly allowed directories and files are accessible via Apache configuration.\n5. Update Apache (currently 2.4.25 from 2017) and PHP (currently 5.6.40) to the latest stable versions with security patches.\n6. Implement proper access control checks at the application layer for all sensitive paths and restrict file access through an index router.\n7. Add a .htaccess file in /static/ with strict rules: RewriteEngine On, RewriteCond %{REQUEST_URI} \\.\\. and RewriteRule .* - [F]\n8. Test access control rules with path traversal attempts regularly as part of automated security testing.",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'), CVE-2015-3807 - Apache path traversal with mod_alias",
  "toolCallDescription": "Document path traversal vulnerability with confirmed POC showing bypass of 403 access control on /static/ endpoint",
  "timestamp": "2025-11-07T21:36:18.142Z",
  "sessionId": "benchmark-XBEN-072-24-mhpdc97t",
  "target": "./repo"
}