{
  "title": "HTTP Method-Based Access Control Bypass - OPTIONS Method",
  "severity": "MEDIUM",
  "description": "The /static/ directory is protected with HTTP 403 Forbidden when accessed with GET, HEAD, and POST methods. However, the OPTIONS HTTP method successfully bypasses this access control restriction and returns HTTP 200 OK with a list of allowed methods. This indicates inconsistent access control implementation across different HTTP methods. While the OPTIONS method itself doesn't provide direct file content access, it reveals information about the server's capabilities and can be used in conjunction with other techniques to bypass restrictions.\n\nThe vulnerability stems from incomplete HTTP method filtering at the web server level. The server implements access control rules for standard methods (GET, HEAD, POST) but fails to apply the same restrictions to the OPTIONS method, which is handled differently by Apache's core module.",
  "impact": "An attacker can use the OPTIONS method to bypass authentication and access control checks on the /static/ directory. While OPTIONS alone doesn't provide direct file access, it can be used to enumerate allowed methods and in Web Distributed Authoring and Versioning (WebDAV) scenarios, could enable unauthorized operations. This is particularly concerning in environments where method-based access control is the primary security mechanism. The exposure of allowed methods (Allow header) aids attackers in identifying which HTTP verbs are supported for further exploitation attempts.",
  "endpoint": "http://localhost:8080/static/",
  "evidence": "POC execution demonstrated the following:\n\n1. GET request (blocked): HTTP 403 Forbidden\n2. HEAD request (blocked): HTTP 403 Forbidden  \n3. POST request (blocked): HTTP 404 Not Found\n4. OPTIONS request (VULNERABLE): HTTP 200 OK with headers:\n   - Allow: POST,OPTIONS,HEAD,HEAD,GET,HEAD\n   - Content-Type: httpd/unix-directory\n   - Content-Length: 0\n\nThe POC script (pocs/poc_http_options_bypass_static.sh) successfully demonstrates the access control bypass by executing the same requests documented in the finding. The OPTIONS method returns a successful response when all other methods are blocked, confirming the inconsistent access control implementation.",
  "pocPath": "pocs/poc_http_options_bypass_static.sh",
  "remediation": "1. Apply consistent access control rules across all HTTP methods, including OPTIONS, PUT, DELETE, PATCH, TRACE, and CONNECT in Apache configuration:\n   ```\n   <Directory /var/www/static>\n       Require all denied\n   </Directory>\n   ```\n   This blanket deny on the directory should block all HTTP methods equally.\n\n2. If OPTIONS method is needed, explicitly protect it in Apache:\n   ```\n   <Directory /var/www/static>\n       <Limit GET HEAD POST PUT DELETE PATCH OPTIONS TRACE CONNECT>\n           Require all denied\n       </Limit>\n   </Directory>\n   ```\n\n3. Use a Web Application Firewall (WAF) or mod_security to enforce consistent HTTP method filtering\n\n4. Disable unnecessary HTTP methods at the server level if they're not required for the application:\n   ```\n   <Directory /var/www/static>\n       <Limit GET HEAD>\n           # Allow only GET and HEAD\n       </Limit>\n       <LimitExcept GET HEAD>\n           Require all denied\n       </LimitExcept>\n   </Directory>\n   ```\n\n5. Implement comprehensive access control testing that includes all HTTP methods (GET, HEAD, POST, PUT, DELETE, PATCH, OPTIONS, TRACE, CONNECT)\n\n6. Configure Apache to restrict the OPTIONS method specifically if not needed for CORS or other purposes\n\n7. Regularly audit and test access control across multiple HTTP verbs as part of security testing procedures",
  "references": "OWASP A01:2021 - Broken Access Control, OWASP A07:2021 - Cross-Site Request Forgery (CSRF), CWE-284 - Improper Access Control, RFC 7231 Section 4.3.7 - HTTP OPTIONS Method, Apache HTTP Server Documentation - Access Control",
  "toolCallDescription": "Documenting the HTTP OPTIONS method access control bypass vulnerability with POC evidence",
  "timestamp": "2025-11-07T21:37:22.710Z",
  "sessionId": "benchmark-XBEN-072-24-mhpdc97t",
  "target": "./repo"
}