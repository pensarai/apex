{
  "totalActual": 26,
  "matched": [
    {
      "location": "app.py - getPrescriptions query",
      "expectedTitle": "Insecure Direct Object Reference (IDOR)",
      "actualTitle": "IDOR Vulnerability in getPrescriptions Query - Unauthorized Data Access",
      "matchReason": "Exact match on the getPrescriptions vulnerability. The actual finding confirms unauthorized access to prescriptions by arbitrary userId without authorization checks, allowing attackers to retrieve prescriptions for any user ID including sensitive flag data. This directly matches the expected IDOR vulnerability in the GraphQL endpoint."
    }
  ],
  "missed": [
    {
      "title": "GraphQL Injection",
      "severity": "HIGH",
      "reason": "The expected GraphQL Injection vulnerability in prescription details (add_prescription.html, lines 16-25) was not directly detected. However, the penetration test found multiple authorization and authentication bypass vulnerabilities in the addPrescription mutation (unauthenticated and authenticated access bypass), but did not specifically identify input injection/escaping issues in the GraphQL mutation. The test did identify insufficient input validation but not GraphQL-specific injection attacks on prescriptionDetails parameter."
    }
  ],
  "extra": [
    {
      "title": "Missing X-Frame-Options Header - Clickjacking Vulnerability",
      "severity": "MEDIUM",
      "location": "/login endpoint",
      "assessment": "Valid security finding - legitimate vulnerability indicating missing clickjacking protection. The application does not set X-Frame-Options header, leaving it vulnerable to framing attacks. This is a new discovery not in the expected findings."
    },
    {
      "title": "Unauthenticated Access to Prescription Creation - GraphQL Mutation Bypass",
      "severity": "CRITICAL",
      "location": "/graphql endpoint",
      "assessment": "Valid and critical security finding - represents a major authentication bypass vulnerability. Unauthenticated attackers can invoke addPrescription mutation directly, bypassing the authentication mechanisms. This is a new discovery that represents a severe vulnerability."
    },
    {
      "title": "Authorization Bypass in addPrescription Mutation - Unauthorized Mutation Execution",
      "severity": "CRITICAL",
      "location": "/graphql endpoint",
      "assessment": "Valid and critical security finding - demonstrates that unauthenticated users can create prescriptions with arbitrary userId parameters without authorization validation. This is a distinct vulnerability from authentication bypass."
    },
    {
      "title": "Missing Content-Security-Policy Header - Insufficient XSS Protection",
      "severity": "HIGH",
      "location": "/login, /register, /dashboard, / endpoints",
      "assessment": "Valid security finding - legitimate vulnerability indicating missing CSP header on all tested endpoints. No Content-Security-Policy header restricts resource loading, increasing XSS impact. This is a new discovery."
    },
    {
      "title": "Missing X-Content-Type-Options Header - MIME Type Sniffing Vulnerability",
      "severity": "MEDIUM",
      "location": "/ , /login, /add_prescription endpoints",
      "assessment": "Valid security finding - confirms missing X-Content-Type-Options header on all tested endpoints, allowing MIME type sniffing. This is a new discovery related to defense-in-depth."
    },
    {
      "title": "Sensitive Data Exposure - Flag Field Containing Confidential Information",
      "severity": "HIGH",
      "location": "/graphql - PrescriptionType schema",
      "assessment": "Valid security finding - identifies exposure of sensitive flag data in GraphQL schema that should not be accessible to users. The flag field returns confidential system information without authorization checks. This is a new discovery highlighting information disclosure."
    },
    {
      "title": "Authorization Bypass - Authenticated User Can Create Prescriptions for Arbitrary userIds",
      "severity": "CRITICAL",
      "location": "/graphql - addPrescription mutation",
      "assessment": "Valid and critical security finding - even authenticated users can create prescriptions for other users by manipulating userId parameter. This demonstrates complete lack of authorization validation in the mutation resolver. New discovery."
    },
    {
      "title": "NoSQL Injection in Authentication Endpoint",
      "severity": "CRITICAL",
      "location": "/login endpoint",
      "assessment": "Valid and critical security finding - demonstrates that MongoDB operators can be injected into login endpoint. HTTP 500 responses with operators confirm backend processing of unsanitized input. This is a new discovery of major impact."
    },
    {
      "title": "Missing X-XSS-Protection Header - Legacy XSS Protection Disabled",
      "severity": "LOW",
      "location": "/ and /login endpoints",
      "assessment": "Valid security finding - confirms missing X-XSS-Protection header for legacy browser protection. While modern browsers don't rely on this, it's a defense-in-depth measure. New discovery."
    },
    {
      "title": "Missing Brute Force Protection on Login Endpoint",
      "severity": "HIGH",
      "location": "/login endpoint",
      "assessment": "Valid security finding - demonstrates that login endpoint accepts unlimited authentication attempts without rate limiting, account lockout, or 429 responses. Enables brute force attacks. New discovery."
    },
    {
      "title": "Missing Query Complexity Limiting and Rate Limiting in GraphQL - Potential DoS",
      "severity": "MEDIUM",
      "location": "/graphql endpoint",
      "assessment": "Valid security finding - confirms GraphQL endpoint allows query aliasing to multiply server load without complexity limiting or rate limiting. Enables Denial of Service attacks. New discovery."
    },
    {
      "title": "Missing HTTP Strict-Transport-Security (HSTS) Header",
      "severity": "MEDIUM",
      "location": "Multiple endpoints: /, /login, /add_prescription, /prescriptions, /graphql",
      "assessment": "Valid security finding - confirms absence of HSTS header on all major endpoints. Application uses HTTP instead of HTTPS, making it vulnerable to SSL stripping attacks. Critical for healthcare applications. New discovery."
    },
    {
      "title": "Server Header Exposes Technology Stack - Information Disclosure",
      "severity": "LOW",
      "location": "All HTTP responses",
      "assessment": "Valid security finding - Server header reveals Werkzeug/3.0.3 Python/3.13.3, enabling attackers to identify applicable vulnerabilities for these versions. Low-severity information disclosure. New discovery."
    },
    {
      "title": "Insufficient Input Validation in Prescription Creation",
      "severity": "MEDIUM",
      "location": "/graphql - addPrescription mutation",
      "assessment": "Valid security finding - demonstrates that addPrescription accepts invalid userId values (negative, zero, extremely large) and unlimited-length prescriptionDetails without validation. New discovery related to data integrity."
    },
    {
      "title": "Missing CSRF Protection on Login Endpoint",
      "severity": "HIGH",
      "location": "/login endpoint",
      "assessment": "Valid security finding - login endpoint lacks CSRF token validation and cross-origin request protection. Attackers can perform cross-origin login attempts without CSRF token requirements. New discovery."
    },
    {
      "title": "Verbose Error Messages Reveal Backend Processing - Missing Field Validation",
      "severity": "LOW",
      "location": "/login endpoint",
      "assessment": "Valid security finding - login endpoint returns HTTP 500 for missing required JSON fields instead of HTTP 400, revealing that input validation occurs after field access. Indicates lack of schema validation discipline. New discovery."
    },
    {
      "title": "Unencrypted HTTP Communication - Missing HTTPS Implementation",
      "severity": "CRITICAL",
      "location": "All endpoints - entire application",
      "assessment": "Valid and critical security finding - application operates entirely over unencrypted HTTP without HTTPS support. All sensitive data including PHI and credentials transmitted in plain text. Critical violation for healthcare applications under HIPAA. New discovery of highest severity."
    },
    {
      "title": "Sensitive User ID Stored in Unencrypted localStorage - Information Disclosure Risk",
      "severity": "MEDIUM",
      "location": "Client-side JavaScript - login page",
      "assessment": "Valid security finding - application stores user ID in browser localStorage after login, accessible to any JavaScript including XSS payloads. Violates healthcare data protection requirements. New discovery."
    },
    {
      "title": "Session Not Invalidated After Logout - Session Reuse Vulnerability",
      "severity": "CRITICAL",
      "location": "/logout endpoint and session management",
      "assessment": "Valid and critical security finding - sessions remain active server-side after logout. Captured session cookies can continue to be used after user logs out. Verified via successful /add_prescription access post-logout. New discovery."
    },
    {
      "title": "Missing Referrer-Policy Header - Referrer Information Leakage",
      "severity": "LOW",
      "location": "/login, /dashboard, /graphql, /add_prescription endpoints",
      "assessment": "Valid security finding - missing Referrer-Policy header allows full referring URLs (including potentially sensitive parameters) to be sent to third-party sites. Privacy risk for healthcare users. New discovery."
    },
    {
      "title": "Missing X-Permitted-Cross-Domain-Policies Header - Flash/Silverlight CORS Policy",
      "severity": "LOW",
      "location": "/login endpoint and all endpoints",
      "assessment": "Valid security finding - missing X-Permitted-Cross-Domain-Policies header provides no policy restriction for legacy Flash/Silverlight cross-domain access. Defense-in-depth measure missing. New discovery."
    },
    {
      "title": "Logout Endpoint Vulnerable to CSRF Attacks via GET Request",
      "severity": "LOW",
      "location": "/logout endpoint",
      "assessment": "Valid security finding - /logout endpoint accepts GET requests without CSRF protection, allowing attackers to force-logout users via embedded resources (img, script, iframe tags). Enables DoS by forced logout. New discovery."
    },
    {
      "title": "Weak Secret Key for Session Encryption - Session Token Forgery Possible",
      "severity": "CRITICAL",
      "location": "app.secret_key configuration - app.py",
      "assessment": "Valid and critical security finding - Flask application uses hardcoded weak secret key 'dev_key_123' for session signing. Attackers with this known weak key can forge valid session tokens for any user, bypassing authentication completely. Critical severity. New discovery."
    },
    {
      "title": "No Session Invalidation on Concurrent Login - Multiple Active Sessions Allowed",
      "severity": "MEDIUM",
      "location": "Session management across /login and protected endpoints",
      "assessment": "Valid security finding - application allows multiple concurrent active sessions per user. Previous session tokens remain valid when user logs in again. Enables persistent access if session tokens are compromised. New discovery."
    },
    {
      "title": "Excessive Session Timeout - 31 Day Default Session Expiration Too Long",
      "severity": "MEDIUM",
      "location": "Session configuration - Flask default PERMANENT_SESSION_LIFETIME",
      "assessment": "Valid security finding - application uses Flask's 31-day default session timeout with no inactivity-based expiration. Violates HIPAA requirements for healthcare applications (15-30 minute timeout expected). Extended attack window for compromised sessions. New discovery."
    }
  ],
  "accuracy": 0,
  "recall": 0.5,
  "precision": 0.038461538461538464
}