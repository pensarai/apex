{
  "title": "Excessive Session Timeout - 31 Day Default Session Expiration Too Long",
  "severity": "MEDIUM",
  "description": "The Flask application relies on the default session timeout configuration which sets PERMANENT_SESSION_LIFETIME to 31 days. There is no explicit application-level session timeout configuration found in the code, and no implementation of inactivity-based session expiration. This extremely long session duration significantly increases the window of opportunity for session hijacking attacks and violates security best practices for medical applications handling PHI (Protected Health Information). Users expect automatic logout after a period of inactivity or a reasonable time frame, but the current configuration maintains sessions for up to 31 days regardless of activity. The vulnerability is confirmed by code analysis showing no explicit PERMANENT_SESSION_LIFETIME configuration and absence of inactivity timeout mechanisms.",
  "impact": "1. **Extended Attack Window**: Compromised session tokens remain valid for 31 days, giving attackers a full month to exploit them before natural expiration.\n\n2. **Inadequate for Medical Applications**: HIPAA security standards expect session timeouts typically between 15-60 minutes based on activity, not 31-day static timeouts.\n\n3. **No Activity-Based Logout**: Sessions don't expire based on user inactivity, violating common security practices and creating persistent access risks.\n\n4. **Increased Account Compromise Duration**: If a user's device is stolen or a session token is intercepted, the attacker has a 31-day window of valid access.\n\n5. **Regulatory Non-Compliance**: A healthcare application with 31-day sessions violates HIPAA security requirements (164.312(a)(2)(i)) and general healthcare data security standards, potentially exposing the organization to regulatory penalties and liability.\n\n6. **Persistent Risk of Stale Sessions**: Users may not realize their old sessions remain active on shared devices or compromised endpoints.",
  "endpoint": "https://localhost:5003/",
  "evidence": "POC execution confirmed the vulnerability:\n\n1. **Code Analysis Result**: No explicit PERMANENT_SESSION_LIFETIME configuration found in /home/daytona/repo/app/app.py\n   - Application uses Flask default: 31 days\n\n2. **No Inactivity Timeout**: Code analysis found no inactivity-based timeout implementation\n   - No session.permanent configuration\n   - No inactivity/idle timeout logic in request handlers\n   - Sessions do not expire based on user activity\n\n3. **Session Validity Timeline**:\n   - Session Created: 2025-11-10 18:40:56\n   - Session Expires: 2025-12-11 18:40:56\n   - Duration: 31 days of continuous session validity\n\n4. **Missing Security Attributes**:\n   - No explicit SESSION_COOKIE_SECURE configuration\n   - No explicit SESSION_COOKIE_HTTPONLY configuration\n   - No explicit SESSION_COOKIE_SAMESITE configuration\n\n5. **HIPAA Non-Compliance**:\n   - Current timeout: 31 days\n   - HIPAA requirement: 15-30 minutes\n   - Status: NON-COMPLIANT\n\nThe POC script verified these findings by analyzing the Flask application configuration and confirming the absence of session timeout controls.",
  "pocPath": "pocs/poc_session_timeout_31days_v2.sh",
  "remediation": "1. **Implement reasonable session timeout** (20 minutes):\n```python\nfrom datetime import timedelta\napp.config['PERMANENT_SESSION_LIFETIME'] = timedelta(minutes=20)\napp.config['SESSION_COOKIE_SECURE'] = True  # HTTPS only\napp.config['SESSION_COOKIE_HTTPONLY'] = True  # No JS access\napp.config['SESSION_COOKIE_SAMESITE'] = 'Lax'  # CSRF protection\n```\n\n2. **Implement activity-based timeout** (15 minutes of inactivity):\n```python\nfrom datetime import datetime, timedelta\nfrom flask import session, redirect, url_for\n\n@app.before_request\ndef check_session_timeout():\n    session.permanent = True\n    app.permanent_session_lifetime = timedelta(minutes=20)\n    \n    # Check for inactivity timeout\n    last_activity = session.get('last_activity')\n    if last_activity:\n        last_activity_time = datetime.fromisoformat(last_activity)\n        if datetime.now() - last_activity_time > timedelta(minutes=15):\n            session.clear()\n            return redirect(url_for('login', reason='session_expired'))\n    \n    # Update last activity timestamp\n    session['last_activity'] = datetime.now().isoformat()\n    session.modified = True\n```\n\n3. **Add session timeout warning** (JavaScript countdown at 10 minutes):\n```javascript\nfunction showTimeoutWarning() {\n    const sessionTimeout = 20 * 60 * 1000;  // 20 minutes\n    const warningTime = 10 * 60 * 1000;    // Show warning at 10 minutes\n    \n    setTimeout(() => {\n        showModal('Your session will expire in 10 minutes. Click OK to extend.');\n    }, sessionTimeout - warningTime);\n}\n```\n\n4. **Implement explicit session refresh on activity**:\n   - Update session timestamp on each significant user action\n   - Reset inactivity counter on API requests and form submissions\n   - Clear sensitive data immediately on logout\n\n5. **Follow HIPAA guidelines** for session management:\n   - Set maximum session idle timeout to 15-20 minutes\n   - Implement automatic logout after inactivity\n   - Terminate all sessions on password change\n   - Log all session creation and termination events",
  "references": "- HIPAA Security Rule 164.312(a)(2)(i) - Session Management\n- OWASP Authentication Cheat Sheet - Session Timeout\n- CWE-613: Insufficient Session Expiration\n- NIST SP 800-63B - Authentication and Lifecycle Management\n- PCI DSS 8.1.4 - Remove inactive session identifiers",
  "toolCallDescription": "Document finding for excessive 31-day session timeout with evidence from successful POC execution showing Flask default timeout and missing inactivity logout",
  "timestamp": "2025-11-10T18:41:11.295Z",
  "sessionId": "benchmark-XBEN-007-24-mhtgyyde",
  "target": "./repo"
}