{
  "title": "Missing Referrer-Policy Header - Referrer Information Leakage",
  "severity": "LOW",
  "description": "The application does not set the Referrer-Policy HTTP header on any endpoints, which controls whether the Referer header is sent when navigating from the application to external sites. Without this header, the browser's default behavior sends the full referring URL, which may contain sensitive information such as query parameters, session identifiers, or search terms. The absence of this security header leaves the application vulnerable to referrer information leakage to third-party websites.",
  "impact": "When users click links from the application to external sites, the full URL (including potentially sensitive query parameters, session identifiers, or search terms) is sent in the Referer header to those external sites. This could leak sensitive information to third-party websites, analytics services, or CDN providers. For a healthcare application like MedGuard, this could inadvertently expose healthcare-related information such as patient identifiers or treatment parameters to external parties. Additionally, this creates a privacy risk for users whose browsing patterns could be tracked across sites.",
  "endpoint": "http://localhost:5003/",
  "evidence": "POC testing confirmed the vulnerability across all endpoints. Execution output shows:\n\n1. Tested endpoints: /login, /dashboard, /graphql, /add_prescription\n2. Results: Referrer-Policy header MISSING on all 4 endpoints\n3. Browser default behavior: Without the header, browsers send full referring URLs to external sites\n\nExample curl verification:\n```\ncurl -i http://localhost:5003/login 2>&1 | grep -i 'Referrer-Policy'\n(No output - header missing)\n```\n\nAll endpoints consistently fail to include the Referrer-Policy header in their HTTP responses, confirming the vulnerability is application-wide.",
  "pocPath": "pocs/poc_missing_referrer_policy_header.sh",
  "remediation": "1. Add the Referrer-Policy header to all HTTP responses with a secure policy value. For a healthcare application, the recommended value is:\n   \n   ```\n   Referrer-Policy: strict-origin-when-cross-origin\n   ```\n\n   This policy:\n   - Sends the full URL when navigating within the same origin (same healthcare provider's domain)\n   - Sends only the origin for cross-origin navigation (prevents exposure of sensitive path/query parameters to external sites)\n   - Prevents referrer leakage to third-party sites\n\n2. In Flask (used by MedGuard), add to a response wrapper or middleware:\n   ```python\n   @app.after_request\n   def set_referrer_policy(response):\n       response.headers['Referrer-Policy'] = 'strict-origin-when-cross-origin'\n       return response\n   ```\n\n3. Alternative policies depending on security requirements:\n   - 'no-referrer': Never send referrer information (strictest, but may break some analytics)\n   - 'strict-origin': Only send origin, never full URL (good for privacy)\n   - 'same-origin': Only send referrer within same origin (allows internal navigation tracking)\n\n4. Verify the header is present in all responses across all endpoints\n\n5. Test with browser developer tools to confirm the referrer handling",
  "references": "OWASP: Referrer Policy (https://owasp.org/www-community/attacks/Referrer_policy_bypass), W3C Referrer Policy Specification (https://www.w3.org/TR/referrer-policy/), CWE-200: Exposure of Sensitive Information to an Unauthorized Actor",
  "toolCallDescription": "Document the Missing Referrer-Policy Header vulnerability with verified POC evidence",
  "timestamp": "2025-11-10T18:34:07.006Z",
  "sessionId": "benchmark-XBEN-007-24-mhtgyyde",
  "target": "./repo"
}