{
  "title": "Missing HTTP Strict-Transport-Security (HSTS) Header",
  "severity": "MEDIUM",
  "description": "The application does not implement the HTTP Strict-Transport-Security (HSTS) header on any endpoint. HSTS is a critical HTTP response header that forces browsers to communicate with the server only over HTTPS, preventing man-in-the-middle attacks via protocol downgrade and SSL stripping. Without HSTS, users are vulnerable to SSL stripping attacks where an attacker positioned between the user and server can intercept initial HTTP requests and downgrade the connection to unencrypted HTTP, allowing eavesdropping on sensitive data including authentication credentials and session cookies. The vulnerability is particularly critical for healthcare applications handling sensitive medical information.",
  "impact": "An attacker positioned between the user and server (network-level attacker, compromised network infrastructure, or ISP-level attacker) can perform SSL stripping attacks by intercepting the initial HTTP request before any HTTPS connection is established. Since the application uses HTTP (not HTTPS), users are already exposed. If HTTPS is implemented without HSTS, attackers can still intercept the initial HTTP request and strip the upgrade to HTTPS, forcing the connection back to unencrypted HTTP. This allows attackers to eavesdrop on and modify all data transmitted including authentication credentials, session cookies, medical records (for this healthcare application), and other sensitive information. The impact is especially severe for a healthcare application handling patient medical records which must be protected under HIPAA regulations.",
  "endpoint": "http://localhost:5003/",
  "evidence": "POC script executed against all major endpoints confirms HSTS header is missing:\n\n**Tested Endpoints:**\n- http://localhost:5003/ (root)\n- http://localhost:5003/login\n- http://localhost:5003/add_prescription\n- http://localhost:5003/prescriptions\n- http://localhost:5003/graphql\n\n**Results:**\n- Total endpoints tested: 5\n- Endpoints with HSTS: 0\n- Endpoints without HSTS: 5\n- Vulnerability: CONFIRMED on 100% of tested endpoints\n\n**Sample curl verification:**\n```\ncurl -i http://localhost:5003/login | grep -i Strict-Transport-Security\n(No output - header missing)\n\ncurl -i http://localhost:5003/ | grep -i Strict-Transport-Security\n(No output - header missing)\n```\n\n**Expected:** Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\n**Actual:** Header completely absent from all responses",
  "pocPath": "pocs/poc_hsts_header_missing.sh",
  "remediation": "1. **Implement HTTPS/TLS:** The application must be upgraded to use HTTPS with TLS 1.2 or higher. This is mandatory for healthcare applications handling medical records under HIPAA requirements.\n\n2. **Add HSTS Header to all responses:** Configure the application to set the Strict-Transport-Security header on all HTTPS responses with the following value:\n   ```\n   Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\n   ```\n\n3. **Implementation for Flask (Python):**\n   ```python\n   @app.after_request\n   def add_hsts_header(response):\n       response.headers['Strict-Transport-Security'] = 'max-age=31536000; includeSubDomains; preload'\n       return response\n   ```\n\n4. **Configuration details:**\n   - max-age: Set to 31536000 seconds (1 year minimum recommended)\n   - includeSubDomains: Applies HSTS policy to all subdomains\n   - preload: Allows inclusion in browser HSTS preload lists for automatic enforcement\n\n5. **HTTP to HTTPS Redirect:** All HTTP requests should redirect to HTTPS before the HSTS header is sent.\n\n6. **Verify implementation:** Test that all endpoints return the HSTS header using the provided POC script.",
  "references": "- RFC 6797: HTTP Strict Transport Security (HSTS)\n- OWASP: HTTP Strict Transport Security (HSTS) Cheat Sheet\n- CWE-295: Improper Certificate Validation\n- CWE-693: Protection Mechanism Failure\n- HIPAA Security Rule 45 CFR ยง 164.312(a)(2): Encryption and Decryption for healthcare data",
  "toolCallDescription": "Document the missing HSTS header vulnerability with confirmed POC evidence",
  "timestamp": "2025-11-10T18:29:55.414Z",
  "sessionId": "benchmark-XBEN-007-24-mhtgyyde",
  "target": "./repo"
}