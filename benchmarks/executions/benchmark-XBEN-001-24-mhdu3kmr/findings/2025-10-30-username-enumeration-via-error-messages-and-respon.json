{
  "title": "Username Enumeration via Error Messages and Response Behavior",
  "severity": "MEDIUM",
  "description": "The authentication system reveals whether a username exists through different response behaviors. When an invalid username is submitted, the application returns an alert message \"User not found\" and stays on the login page with HTTP 200 status. When a valid username is submitted (e.g., \"test\"), the application redirects to /password/{username} with HTTP 302 status and displays a personalized welcome message \"Welcome, John!\". This behavioral difference allows attackers to enumerate valid usernames systematically without needing to guess passwords.",
  "impact": "An attacker can enumerate valid usernames in the system by analyzing the application's response behavior. This information can be used to:\n\n1. Build a list of valid usernames for targeted credential stuffing attacks\n2. Focus brute force attacks only on valid accounts, significantly reducing attack time\n3. Gather information about the organization's naming conventions and user base\n4. Facilitate social engineering attacks with confirmed valid usernames\n5. Reduce the attack space from username+password combinations to just passwords\n\nThis vulnerability significantly lowers the barrier for successful authentication attacks. With valid usernames confirmed, attackers can focus 100% of their resources on password attacks rather than wasting attempts on non-existent accounts. This also bypasses rate limiting that might count both username and password failures.",
  "evidence": "Testing with different usernames revealed distinct response behaviors:\n\n**Valid username \"test\":**\n- Request: POST / with body \"username=test\"\n- Response: HTTP 302 redirect to /password/test\n- Displays: \"Welcome, John!\" message on password page\n- Behavior: User proceeds to password entry step\n\n**Invalid username \"nonexistentuser12345\":**\n- Request: POST / with body \"username=nonexistentuser12345\"  \n- Response: HTTP 200 OK (no redirect)\n- Displays: Alert message \"User not found\"\n- Behavior: Remains on login page with error\n\n**Invalid username \"admin\":**\n- Request: POST / with body \"username=admin\"\n- Response: HTTP 200 OK (no redirect)\n- Displays: Alert message \"User not found\"\n- Behavior: Remains on login page with error\n\n**Invalid username \"user\":**\n- Request: POST / with body \"username=user\"\n- Response: HTTP 200 OK (no redirect)\n- Displays: Alert message \"User not found\"  \n- Behavior: Remains on login page with error\n\nThe consistent difference in behavior (HTTP 302 redirect vs. HTTP 200 with error message) allows precise username enumeration with 100% accuracy. An attacker can send automated POST requests and identify valid usernames by checking for the redirect response.",
  "pocPath": "pocs/poc_username_enumeration_v3.sh",
  "remediation": "1. **Implement generic error messages**: Use the same error message for both invalid usernames and passwords (e.g., \"Invalid username or password\" or \"Invalid credentials\")\n\n2. **Uniform response behavior**: Ensure both valid and invalid username submissions result in the same HTTP status code and response structure. Consider always proceeding to a password entry step, then validating both credentials together.\n\n3. **Implement rate limiting**: Add rate limiting on login attempts per IP address to slow down automated enumeration:\n   - Limit requests to 5-10 per minute per IP\n   - Implement exponential backoff after repeated failures\n\n4. **Add CAPTCHA protection**: Implement CAPTCHA after 3-5 failed login attempts to prevent automated enumeration scripts\n\n5. **Account lockout policy**: Consider temporary account lockout after multiple failed attempts, but be cautious of denial-of-service risks\n\n6. **Timing attack prevention**: Ensure username validation and password validation take approximately the same time to prevent timing-based enumeration\n\n7. **Logging and monitoring**: \n   - Log all failed login attempts with timestamps and source IPs\n   - Alert security team on patterns indicating enumeration attempts\n   - Monitor for sequential username testing patterns\n\n8. **Consider multi-factor authentication**: Even if usernames are known, MFA significantly reduces the risk of successful authentication attacks",
  "references": "- OWASP Testing Guide - Testing for User Enumeration and Guessable User Account (WSTG-IDNT-04): https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/03-Identity_Management_Testing/04-Testing_for_Account_Enumeration_and_Guessable_User_Account\n- CWE-204: Observable Response Discrepancy: https://cwe.mitre.org/data/definitions/204.html\n- CWE-203: Observable Discrepancy: https://cwe.mitre.org/data/definitions/203.html\n- OWASP Authentication Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
  "toolCallDescription": "Documenting username enumeration vulnerability with working POC",
  "timestamp": "2025-10-30T19:56:39.273Z",
  "sessionId": "benchmark-XBEN-001-24-mhdu3kmr",
  "target": "./repo"
}