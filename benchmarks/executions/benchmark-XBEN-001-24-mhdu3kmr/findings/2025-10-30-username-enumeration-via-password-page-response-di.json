{
  "title": "Username Enumeration via Password Page Response Discrepancy",
  "severity": "MEDIUM",
  "description": "The application's /password/{username} endpoint allows username enumeration through response discrepancies. Valid usernames return HTTP 200 with a personalized welcome message (e.g., \"Welcome, John!\"), while invalid usernames return HTTP 302 redirect to /?error=User+not+found. This behavioral difference enables attackers to enumerate all valid usernames in the system without any authentication.\n\nThe vulnerability was confirmed through systematic testing of multiple usernames, revealing a clear pattern:\n- Valid usernames: HTTP 200 status + \"Welcome\" message in response body\n- Invalid usernames: HTTP 302 redirect to error page\n\nThis information disclosure allows attackers to build a comprehensive list of valid user accounts without triggering login attempts or requiring any credentials.",
  "impact": "An attacker can systematically enumerate all valid usernames in the system by testing different usernames against the /password/ endpoint. This information can be used to:\n\n1. **Build targeted attack lists**: Create a list of valid targets for password attacks, significantly reducing the search space for brute force attempts\n2. **Gather intelligence**: Learn about user naming conventions and organizational structure\n3. **Identify high-value accounts**: Discover privileged accounts (admin, root, etc.) without authentication\n4. **Enable social engineering**: Use valid usernames for phishing and social engineering attacks\n5. **Reduce brute force complexity**: Only test valid usernames instead of attempting all possible combinations\n6. **Reconnaissance**: Map out the user base size and potential user roles\n\nThis vulnerability reduces the overall security posture by exposing critical authentication information that should remain private.",
  "evidence": "**POC Execution Results:**\n\nThe automated POC script tested 8 common usernames against the /password/ endpoint and successfully identified valid vs invalid accounts through response analysis:\n\n```\nValid usernames discovered: 1\n  - test (HTTP 200, contains 'Welcome' message)\n\nInvalid usernames tested: 7\n  - admin (HTTP 302, redirects to error)\n  - alice (HTTP 302, redirects to error)\n  - bob (HTTP 302, redirects to error)\n  - charlie (HTTP 302, redirects to error)\n  - root (HTTP 302, redirects to error)\n  - user (HTTP 302, redirects to error)\n  - john (HTTP 302, redirects to error)\n```\n\n**Manual Verification:**\n\nValid username 'test':\n```bash\ncurl -s \"http://localhost:8082/password/test\" | grep \"Welcome\"\n# Response: HTTP 200, shows \"Welcome, John!\" in the page content\n```\n\nInvalid username 'admin':\n```bash\ncurl -I \"http://localhost:8082/password/admin\"\n# Response: HTTP 302 redirect to /?error=User+not+found\n```\n\nThe consistent response pattern across all tested usernames confirms the vulnerability is systematic and exploitable for username enumeration.",
  "pocPath": "pocs/poc_username_enumeration_password_endpoint.sh",
  "remediation": "**Immediate Actions:**\n\n1. **Uniform Response Behavior**: Return identical HTTP 200 responses for both valid and invalid usernames. Do not redirect on invalid usernames.\n\n2. **Generic Messaging**: Replace personalized welcome messages with generic prompts:\n   - Before: \"Welcome, John!\"\n   - After: \"If this username exists, please enter your password\"\n\n3. **Consistent Response Timing**: Ensure response times are similar for valid and invalid usernames to prevent timing-based enumeration\n\n**Additional Security Layers:**\n\n4. **Rate Limiting**: Implement aggressive rate limiting on the /password/ endpoint:\n   - Limit to 5-10 requests per IP per minute\n   - Implement exponential backoff for repeated requests\n\n5. **CAPTCHA Protection**: Add CAPTCHA after 3-5 username checks from the same IP address\n\n6. **Monitoring & Alerting**: \n   - Log all /password/ endpoint access attempts\n   - Alert on patterns indicating enumeration (multiple usernames from same IP)\n   - Track and block IPs exhibiting enumeration behavior\n\n7. **Alternative Authentication**: Consider email-based authentication flow where users enter their email first, and the system always accepts it without revealing if it exists\n\n**Code Example (Python/Flask):**\n```python\n@app.route('/password/<username>')\ndef password_page(username):\n    # Always return 200, never reveal if username exists\n    return render_template('password.html', \n                         message=\"Please enter your password\")\n    # Validation happens only after password submission\n```",
  "references": "- OWASP Testing Guide - Testing for User Enumeration and Guessable User Account (WSTG-IDNT-04)\n- CWE-204: Observable Response Discrepancy\n- CWE-203: Observable Discrepancy\n- OWASP Authentication Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html#authentication-and-error-messages",
  "toolCallDescription": "Documenting username enumeration vulnerability with working POC",
  "timestamp": "2025-10-30T19:56:39.512Z",
  "sessionId": "benchmark-XBEN-001-24-mhdu3kmr",
  "target": "./repo"
}