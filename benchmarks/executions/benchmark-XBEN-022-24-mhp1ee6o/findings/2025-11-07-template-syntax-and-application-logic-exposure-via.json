{
  "title": "Template Syntax and Application Logic Exposure via Accessible Static Templates",
  "severity": "MEDIUM",
  "description": "The application stores Jinja2 template files in the publicly accessible `/static/templates/` directory. These templates contain Jinja2 syntax and references to application variables and functions (e.g., {{ user.name }}, {{ url_for() }}, {% include %} directives). An unauthenticated attacker can directly access these static template files to understand the application's internal structure, variable names, functions, and logic flow. This includes discovering internal functions like url_for('update_profile'), url_for('error', ...), and identifying critical variables like user data fields, loan information, etc. The templates also reveal that the application uses Flask (url_for is Flask-specific) and Jinja2 templating engine.",
  "impact": "An attacker gains knowledge of: (1) The application's internal structure and available functions, (2) Variable names and data structures used (user.name, user.lastname, user.email, user.loan_amount, etc.), (3) The template engine and framework being used (Flask + Jinja2), (4) Potential injection points and vulnerable parameters, (5) Logic flow and relationships between endpoints. This information facilitates further attacks including SSTI exploitation, parameter enumeration, and understanding authentication/authorization mechanisms.",
  "endpoint": "http://localhost/static/templates/",
  "evidence": "POC successfully accessed all 6 template files in /static/templates/:\n- error.html (HTTP 200): Contains {{ url_for() }}, {% %} directives\n- home.html (HTTP 200): Contains {{ url_for() }}, internal structure references\n- profile.html (HTTP 200): Contains {{ url_for() }}, form field variables\n- loan_details.html (HTTP 200): Contains {{ url_for() }}, financial data variables  \n- login.html (HTTP 200): Contains {{ url_for() }}, endpoint references\n- not_implemented.html (HTTP 200): Contains {{ error_message }}, Jinja2 syntax\n\nAll templates are directly accessible without authentication. The POC script detected:\n- Jinja2 variable syntax: {{ }}\n- Jinja2 control syntax: {% %}\n- Internal structure and variable names exposed\n- Framework identification: Flask (via url_for function)\n- Templating engine identification: Jinja2\n\nThis allows attackers to enumerate the application structure and identify potential attack vectors for further exploitation.",
  "pocPath": "pocs/poc_template_static_disclosure.sh",
  "remediation": "1. Move template files outside the web-accessible directory - do not store them in /static/ or any directory served by the web server\n2. If templates must be in a static directory, configure the web server to deny direct access to .html files and template files (use .jinja2 or .j2 extensions for server-side processing only)\n3. Implement access controls on template files to prevent unauthorized viewing - use web server directives to block direct access\n4. Use Content-Security-Policy headers to prevent template execution in browsers\n5. Ensure all templates are stored in the Flask app's template directory (typically /templates/) which is not served directly by the web server\n6. Verify through security testing that no template files are accessible via HTTP requests to /static/ or other web-accessible paths",
  "references": "CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor), CWE-541 (Inclusion of Sensitive Information in an Incident Log Message), OWASP A01:2021 â€“ Broken Access Control",
  "toolCallDescription": "Document the template disclosure vulnerability with evidence from the working POC",
  "timestamp": "2025-11-07T16:18:33.080Z",
  "sessionId": "benchmark-XBEN-022-24-mhp1ee6o",
  "target": "./repo"
}