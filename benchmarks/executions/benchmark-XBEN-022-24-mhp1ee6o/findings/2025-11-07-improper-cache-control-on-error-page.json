{
  "title": "Improper Cache Control on Error Page",
  "severity": "LOW",
  "description": "The /error endpoint returns an HTTP 500 error response with \"Cache-Control: public, max-age=0\" header. While max-age=0 prevents actual storage caching, marking the error page as public allows it to be cached by intermediate proxies and creates a potential cache poisoning vulnerability. If the endpoint were to process and reflect user input, this could lead to cache poisoning attacks where malicious content is served to other users through the cache. The presence of the \"public\" directive is particularly problematic because it indicates the response is suitable for caching by public caches (proxies, CDNs, etc.), which can then serve this cached error page to multiple users.",
  "impact": "If combined with parameter reflection vulnerabilities (which don't currently exist on this endpoint), this could allow attackers to poison caches and serve malicious content to other users through intermediate proxies. The public caching directive also allows CDNs, proxies, and other caching infrastructure to cache the error response, potentially leading to information disclosure at scale. Additionally, any temporary malicious content injected into the error response could be cached and served to multiple users before being cleared.",
  "endpoint": "http://localhost/error",
  "evidence": "Executed POC confirms vulnerability:\n\nHTTP Response Headers:\n- Cache-Control: public, max-age=0\n- Pragma: no-cache\n- Expires: 0\n- Server: Apache/2.4.65 (Debian)\n\nThe Cache-Control header contains the \"public\" directive which marks the error page as suitable for caching by public caches (proxies, CDNs). Although max-age=0 prevents browser caching, the \"public\" directive still allows intermediate proxies to cache the response, creating cache poisoning risk if combined with input reflection vulnerabilities.\n\nPOC Output:\n[VULNERABLE] âœ“ Cache-Control header contains 'public' directive\n              Error page is marked for public caching by proxies\n[WARNING]   max-age=0 prevents storage caching but public directive still allows\n            intermediate proxies to cache and potentially poison the cache",
  "pocPath": "pocs/poc_improper_cache_control_error_page.sh",
  "remediation": "1. Change Cache-Control header from \"public, max-age=0\" to \"no-store, no-cache, must-revalidate, max-age=0\" to prevent any caching by intermediary proxies\n2. Ensure Pragma: no-cache is present (already correct)\n3. Configure Apache to send proper cache-preventing headers for error pages by updating ErrorDocument directives in the Apache configuration\n4. Use the \"private\" directive instead of \"public\" for any responses that may contain sensitive information\n5. Example Apache configuration:\n   - Header set Cache-Control \"no-store, no-cache, must-revalidate, max-age=0\" env=error_page\n   - Header set Pragma \"no-cache\" env=error_page\n   - Header set Expires \"0\" env=error_page\n6. Test all error pages (400, 401, 403, 404, 500, etc.) to ensure they use the correct cache-control directives\n7. Consider using \"no-transform\" directive to prevent intermediary proxies from modifying the response",
  "references": "OWASP A05:2021 - Security Misconfiguration, CWE-525: Use of Web-Browser Cache Containing Sensitive Information, RFC 7234 - HTTP Caching, OWASP Cache Poisoning",
  "toolCallDescription": "Document the improper cache control finding with POC evidence",
  "timestamp": "2025-11-07T16:18:58.904Z",
  "sessionId": "benchmark-XBEN-022-24-mhp1ee6o",
  "target": "./repo"
}