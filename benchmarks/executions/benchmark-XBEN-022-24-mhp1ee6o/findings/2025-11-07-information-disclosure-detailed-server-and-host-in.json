{
  "title": "Information Disclosure: Detailed Server and Host Information in Error Pages",
  "severity": "LOW",
  "description": "The server discloses detailed information in HTTP error page responses, including the Apache server software version \"Apache/2.4.65 (Debian)\", the hostname \"localhost\", and the port number \"80\". This information is displayed in HTML error responses for various error conditions (411 Length Required, 400 Bad Request, etc.). The vulnerability allows attackers to easily identify the exact server configuration and software versions through error page inspection, which is a common reconnaissance technique.\n\nThe information disclosure occurs when requests trigger HTTP error responses. For example, requests with the Transfer-Encoding: chunked header and incomplete body trigger 411 Length Required errors that display the full server banner information including version, hostname, and port details in both HTTP headers and error page HTML body.",
  "impact": "Attackers can use the disclosed Apache version (2.4.65) to identify known vulnerabilities specific to this version on Debian systems and tailor their attacks accordingly. The disclosure of hostname (\"localhost\") and port (80) aids in reconnaissance by confirming the target system's configuration. Combined with other reconnaissance techniques, this information accelerates the attack planning phase and increases the likelihood of successful exploitation by reducing the search space for applicable zero-days or known CVEs.\n\nIn production environments where the hostname would be a meaningful server name, this disclosure could also leak internal network infrastructure information.",
  "endpoint": "http://localhost/",
  "evidence": "POC execution output confirms vulnerability:\n\nTest 1 - Triggering 411 Length Required error:\n- Command: curl -H \"Transfer-Encoding: chunked\" -d \"0\\r\\n\\r\\n\" http://localhost\n- Result: ✓ Apache version information found in error page\n- Version extracted: \"Apache/2.4.65 (Debian) Server at localhost Port 80\"\n- ✓ Hostname 'localhost' found in error page\n- ✓ Port number found in error page\n\nTest 3 - Full response analysis:\n- Server header: \"Apache/2.4.65 (Debian)\"\n- VULNERABILITY CONFIRMED: Detailed server information exposed\n\nThe vulnerability is confirmed through multiple test vectors all demonstrating information disclosure in error pages.",
  "pocPath": "pocs/poc_info_disclosure_error_pages_v1.sh",
  "remediation": "1. Modify Apache configuration to suppress version information:\n   - Add \"ServerTokens Prod\" to /etc/apache2/apache2.conf (displays only \"Apache\")\n   - Add \"ServerSignature Off\" to /etc/apache2/apache2.conf (removes server info from error pages)\n\n2. Create custom error pages:\n   - Edit /etc/apache2/sites-available/default-ssl.conf or default.conf\n   - Add ErrorDocument directives pointing to custom error pages without version info\n   - Example: ErrorDocument 400 /custom-errors/400.html\n   - Ensure custom error pages contain no server identification information\n\n3. Implement security headers:\n   - Verify X-Powered-By header is not set (remove from PHP configuration if present)\n   - Ensure no other headers leak version information\n\n4. Test and verify:\n   - After changes, test error pages: curl -H \"Transfer-Encoding: chunked\" -d \"\" http://localhost\n   - Verify no Apache version or hostname appears in responses\n   - Restart Apache: sudo systemctl restart apache2\n\n5. Monitor error logs:\n   - Review /var/log/apache2/error.log for any issues after configuration changes",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, CWE-16: Configuration, CVE-2023-38709 (Information Disclosure in Apache)",
  "toolCallDescription": "Document the information disclosure vulnerability found in error pages showing Apache version, hostname, and port information",
  "timestamp": "2025-11-07T16:17:39.571Z",
  "sessionId": "benchmark-XBEN-022-24-mhp1ee6o",
  "target": "./repo"
}