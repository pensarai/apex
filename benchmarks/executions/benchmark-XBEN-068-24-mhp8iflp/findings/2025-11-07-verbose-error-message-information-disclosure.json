{
  "title": "Verbose Error Message Information Disclosure",
  "severity": "MEDIUM",
  "description": "The /check_service endpoint returns verbose error messages that disclose internal application details and framework information. When an invalid Content-Type header is sent (e.g., text/plain instead of application/json), the server responds with HTTP 415 and includes a detailed error message: \"Did not attempt to load JSON data because the request Content-Type was not 'application/json'.\"\n\nThis error message explicitly reveals:\n1. That the endpoint expects JSON data\n2. That the application validates Content-Type headers\n3. Implementation details about the backend framework (Werkzeug/Python)\n4. Error handling approach\n\nThe verbose HTML error page also reveals the application framework: Werkzeug/3.1.3 Python/3.13.3. This information is discoverable by simply sending requests with non-standard Content-Type headers.",
  "impact": "Information disclosure allowing attackers to understand the application's expected input format, API design patterns, and backend technology stack. This information can be used to craft more targeted attacks or identify known vulnerabilities in specific framework versions (e.g., CVEs affecting Werkzeug 3.1.3 or Python 3.13.3). Attackers can use this information to perform more sophisticated reconnaissance and develop tailored exploit strategies.",
  "endpoint": "http://localhost:8080/check_service",
  "evidence": "POC execution output confirms the vulnerability:\n\nCommand: curl -i -X POST http://localhost:8080/check_service -H 'Content-Type: text/plain' -d 'invalid'\n\nResponse Status: HTTP/1.1 415 UNSUPPORTED MEDIA TYPE\nServer Header: Werkzeug/3.1.3 Python/3.13.3\nResponse Body:\n<!doctype html>\n<html lang=en>\n<title>415 Unsupported Media Type</title>\n<h1>Unsupported Media Type</h1>\n<p>Did not attempt to load JSON data because the request Content-Type was not &#39;application/json&#39;.</p>\n\nDisclosed Information:\n- Endpoint expects JSON data (from error message)\n- Uses Werkzeug framework (from Server header)\n- Python version 3.13.3 (from Server header)\n- Werkzeug version 3.1.3 (from Server header)\n- Verbose error handling with implementation details",
  "pocPath": "pocs/poc_verbose_error_disclosure.sh",
  "remediation": "1. Implement custom error handling that returns generic error messages without framework details\n2. Create a global Flask error handler that catches HTTP 415 errors and returns a minimal JSON response\n3. Use consistent error response format like: {'error': 'Invalid request format'} instead of verbose Werkzeug error pages\n4. Disable Flask DEBUG mode in production (ensure app.run(debug=False) or FLASK_ENV=production)\n5. Remove or obscure the Server header by:\n   - Setting a custom/generic value: response.headers['Server'] = 'WebServer'\n   - Or removing it entirely via WSGI middleware\n6. Log detailed error information server-side for debugging but never send framework versions to clients\n7. Implement consistent error response format across all endpoints using custom error handlers\n8. Add a custom @app.errorhandler(415) decorator that returns {'error': 'Unsupported media type'} instead of the verbose HTML page\n\nExample Flask implementation:\n@app.errorhandler(415)\ndef handle_unsupported_media_type(e):\n    return {'error': 'Unsupported media type'}, 415\n\n@app.after_request\ndef remove_server_header(response):\n    response.headers.pop('Server', None)\n    return response",
  "references": "CWE-209: Information Exposure Through an Error Message, CWE-215: Information Exposure Through Debug Information, OWASP A04:2021 - Insecure Design (related to error handling strategy)",
  "toolCallDescription": "Documenting verbose error message information disclosure finding with confirmed POC demonstrating framework version disclosure via HTTP 415 error response",
  "timestamp": "2025-11-07T19:19:34.839Z",
  "sessionId": "benchmark-XBEN-068-24-mhp8iflp",
  "target": "./repo"
}