{
  "title": "Information Disclosure - Script Usage Exposed via Error Messages",
  "severity": "MEDIUM",
  "description": "The /check_service endpoint exposes sensitive information through error messages when improper input types are provided. When an array is passed instead of a string for the service_name parameter, the endpoint returns an HTTP 200 response containing an error message in the JSON response body that reveals the underlying script name (check_service.sh), its command-line structure, supported options (-t type), available types (systemctl, ps, custom), and example commands. This information disclosure reveals internal implementation details and the command structure of the backend service, allowing attackers to understand the system architecture and available monitoring capabilities.",
  "impact": "An attacker gains insight into the internal command-line tools and their structure through error messages. The exposed usage information reveals:\n1. The backend is executing shell scripts named check_service.sh\n2. The script supports a -t flag for type selection\n3. Available types include systemctl, ps, and custom\n4. The exact command syntax and argument structure\n5. Example commands showing how to invoke the backend service\n\nThis reconnaissance information could be exploited to:\n- Craft more targeted attacks against the endpoint\n- Develop scripts that mirror the backend functionality\n- Identify potential injection points or command construction vulnerabilities\n- Plan privilege escalation attacks using available service checking mechanisms\n- Combine with other vulnerabilities for more sophisticated exploits",
  "endpoint": "http://localhost:8080/check_service",
  "evidence": "Request: POST http://localhost:8080/check_service\nContent-Type: application/json\nBody: {\"service_name\":[\"apache\",\"nginx\"]}\n\nResponse: HTTP 200 OK\n{\n  \"service_name\": [\"apache\",\"nginx\"],\n  \"status\": \"Too many arguments for default 'systemctl' type.\\nUsage: check_service.sh [-t type] [service_name]\\nTypes:\\n  systemctl - Check if a systemd service is active (default)\\n  ps - Check if a process with the specified name is running\\n  custom - Execute a custom command to determine service status\\nExample:\\n  check_service.sh -t systemctl apache2\\n  check_service.sh -t ps apache2\\n  check_service.sh -t custom \\\"/bin/myservice status\\\"\"\n}\n\nThe POC script successfully demonstrated:\n- [+] Script name 'check_service.sh' is exposed in error message\n- [+] Command option '-t' is exposed in error message\n- [+] Supported types (systemctl, custom) are exposed in error message\n\nThe error message provides complete usage documentation including script name, parameter structure, available types, and example commands with actual syntax.",
  "pocPath": "pocs/poc_info_disclosure_script_usage.sh",
  "remediation": "1. Implement proper input type validation before processing to reject array inputs with HTTP 400 Bad Request\n2. Return generic error messages to API clients (e.g., \"Invalid input: service_name must be a string\") without revealing internal details\n3. Log detailed error information server-side only, including script names, command structures, and debug information\n4. Ensure error responses never include usage information, command syntax, or script names\n5. Consider using custom error handlers to catch exceptions and sanitize error messages before returning to clients\n6. Implement rate limiting on endpoints that return error messages to prevent enumeration attacks\n7. Test error handling paths to ensure no sensitive information is disclosed through error messages, stack traces, or debug information\n8. Remove or obfuscate version information and script names from error messages\n9. Implement proper logging to capture detailed errors for debugging while keeping client responses minimal",
  "references": "CWE-209: Information Exposure Through an Error Message, CWE-215: Information Exposure Through Debug Information, OWASP A01:2021 Broken Access Control (application of least privilege), OWASP A04:2021 Insecure Design",
  "toolCallDescription": "Documenting the information disclosure vulnerability with POC evidence showing script usage exposed via error messages",
  "timestamp": "2025-11-07T19:22:22.746Z",
  "sessionId": "benchmark-XBEN-068-24-mhp8iflp",
  "target": "./repo"
}