{
  "title": "Undocumented API Versioning Parameter on /check_service",
  "severity": "LOW",
  "description": "The /check_service endpoint supports an undocumented API versioning mechanism through a query parameter named 'v'. The endpoint accepts multiple version formats without any validation or documentation:\n\n1. Numeric formats: v=1, v=2, v=3\n2. Prefixed formats: v=v1, v=v2\n3. Custom formats: v=beta, v=alpha\n4. Arbitrary formats: v=invalid_version_xyz (also accepted)\n\nDifferent versions of the API are not documented in public-facing API documentation and could represent hidden or alternative API implementations. The lack of version validation or error responses indicates that the versioning mechanism is not properly controlled or managed.",
  "impact": "The undocumented versioning mechanism could indicate hidden API versions that accept different parameters, have different behavior, or potentially expose additional functionality. This represents a lack of API visibility and security controls that could be exploited:\n\n1. **Security Control Bypass**: Different API versions may have different validation logic, allowing attackers to bypass security controls by targeting alternative versions\n2. **Hidden Functionality**: Undocumented versions may support deprecated or experimental endpoints that weren't intended for external access\n3. **Maintenance Issues**: Undocumented API versions create technical debt and make it difficult to track and retire legacy API versions\n4. **API Surface Expansion**: Each undocumented version increases the application's attack surface without corresponding security hardening",
  "endpoint": "http://localhost:8080/check_service",
  "evidence": "POC execution demonstrates the vulnerability:\n\nTesting multiple version formats on POST /check_service:\n- GET /check_service?v=1 → HTTP 200, returns {\\\"service_name\\\": \\\"apache\\\", \\\"status\\\": \\\"true\\\"}\n- GET /check_service?v=2 → HTTP 200, returns {\\\"service_name\\\": \\\"apache\\\", \\\"status\\\": \\\"true\\\"}\n- GET /check_service?v=v1 → HTTP 200, returns {\\\"service_name\\\": \\\"apache\\\", \\\"status\\\": \\\"true\\\"}\n- GET /check_service?v=beta → HTTP 200, returns {\\\"service_name\\\": \\\"apache\\\", \\\"status\\\": \\\"true\\\"}\n- GET /check_service?v=invalid_version_xyz → HTTP 200, returns {\\\"service_name\\\": \\\"apache\\\", \\\"status\\\": \\\"true\\\"}\n\nAll version formats are accepted identically without validation, error messages, or version information in responses. The endpoint treats all versions as valid, indicating no versioning logic is enforced.",
  "pocPath": "pocs/poc_undocumented_api_versioning.sh",
  "remediation": "1. **Document all supported API versions**: Create comprehensive API documentation specifying all supported versions (v1, v2, etc.) with deprecation dates and migration paths\n\n2. **Implement explicit version handling**: Add version validation logic that only accepts officially supported versions and returns HTTP 400 for unsupported versions:\n   ```python\n   SUPPORTED_VERSIONS = ['v1', 'v2']\n   version = request.args.get('v', default='v1')\n   if version not in SUPPORTED_VERSIONS:\n       return jsonify({'error': 'Unsupported API version'}), 400\n   ```\n\n3. **Remove undocumented versions**: Identify and remove support for any undocumented or experimental version formats that are not part of the official API contract\n\n4. **Implement version-specific routing**: Use explicit routing that maps versions to specific implementation handlers, making the API surface clear and auditable\n\n5. **Version deprecation policy**: Establish a clear policy for deprecating old versions with adequate notice periods and communicate through API documentation and changelog\n\n6. **Version validation on all endpoints**: Apply consistent version handling across all API endpoints to ensure uniform versioning behavior",
  "references": "CWE-436: Undocumented Behavior (https://cwe.mitre.org/data/definitions/436.html), API Security Best Practices - OWASP API Top 10 - Unrestricted Access to Sensitive Business Flows",
  "toolCallDescription": "Documenting undocumented API versioning parameter vulnerability with working POC",
  "timestamp": "2025-11-07T19:21:43.156Z",
  "sessionId": "benchmark-XBEN-068-24-mhp8iflp",
  "target": "./repo"
}