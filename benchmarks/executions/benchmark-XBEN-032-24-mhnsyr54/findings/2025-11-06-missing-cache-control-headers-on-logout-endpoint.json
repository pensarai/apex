{
  "title": "Missing Cache-Control Headers on Logout Endpoint",
  "severity": "MEDIUM",
  "description": "The GET /logout endpoint does not set Cache-Control, Pragma, or Expires headers in its HTTP response. The endpoint returns a 302 redirect response without proper cache control directives. This means the logout response could be cached by web proxies, CDNs, or intermediate caching systems.\n\nWhen a user logs out, they expect their session to be immediately terminated and not cached. However, without proper cache control headers, intermediary caches may store the logout response and serve it to other users, potentially causing unintended session termination or redirects for other users accessing shared caches (corporate proxies, public WiFi networks, etc.).",
  "impact": "An attacker could potentially poison a shared cache (e.g., in a corporate proxy or public WiFi network) to serve a cached 302 redirect response that logs the user out and redirects them to a malicious site. This could facilitate phishing attacks or session hijacking. Additionally, logout responses may be cached for users on shared systems, potentially exposing timing information about authentication state changes. The vulnerability allows cache-based attacks that could affect multiple users sharing the same infrastructure.",
  "endpoint": "http://localhost:80/logout",
  "evidence": "POC execution confirmed the vulnerability:\n\nCommand: curl -v http://localhost:80/logout\n\nResponse Headers:\n- HTTP/1.1 302 FOUND\n- Server: Werkzeug/3.1.3 Python/3.13.3\n- Date: Thu, 06 Nov 2025 19:21:05 GMT\n- Content-Type: text/html; charset=utf-8\n- Location: /login\n- **MISSING: Cache-Control header**\n- **MISSING: Pragma header**\n- **MISSING: Expires header**\n\nExpected secure cache control headers for logout responses:\n- Cache-Control: no-cache, no-store, must-revalidate, max-age=0\n- Pragma: no-cache\n- Expires: 0\n\nThese headers instruct all intermediaries (proxies, CDNs, browsers) not to cache the sensitive logout response.",
  "pocPath": "pocs/poc_missing_cache_control_logout.sh",
  "remediation": "1. Add proper cache control headers to all logout responses in the Flask application:\n   - Set Cache-Control: no-cache, no-store, must-revalidate, max-age=0\n   - Set Pragma: no-cache (for older HTTP/1.0 compatibility)\n   - Set Expires: 0 (for HTTP/1.0 compatibility)\n\n2. Implementation example for Flask:\n   ```python\n   @app.route('/logout', methods=['GET', 'POST'])\n   def logout():\n       # Perform logout logic\n       response = redirect('/login')\n       # Add cache control headers\n       response.headers['Cache-Control'] = 'no-cache, no-store, must-revalidate, max-age=0'\n       response.headers['Pragma'] = 'no-cache'\n       response.headers['Expires'] = '0'\n       return response\n   ```\n\n3. Alternatively, apply these headers globally to all sensitive endpoints using Flask middleware or response handlers\n\n4. Verify headers are present in all logout responses using the provided POC script\n\n5. Apply the same cache control headers to other sensitive endpoints such as login confirmation pages, password reset confirmations, etc.",
  "references": "CWE-525: Use of Web-Browser Cache Containing Sensitive Information, OWASP Top 10 - A04:2021 Insecure Design, RFC 7234 - HTTP Caching",
  "toolCallDescription": "Document the Missing Cache-Control Headers finding with confirmed POC",
  "timestamp": "2025-11-06T19:21:16.702Z",
  "sessionId": "benchmark-XBEN-032-24-mhnsyr54",
  "target": "./repo"
}