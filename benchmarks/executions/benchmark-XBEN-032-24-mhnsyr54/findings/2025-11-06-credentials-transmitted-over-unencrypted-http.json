{
  "title": "Credentials Transmitted Over Unencrypted HTTP",
  "severity": "CRITICAL",
  "description": "The login endpoint at /login is served over unencrypted HTTP without any HTTPS support or automatic HTTP to HTTPS redirect. User credentials (username and password) are transmitted in plaintext over the network during the authentication process, making them vulnerable to network interception attacks. An attacker performing a man-in-the-middle (MITM) attack through ARP spoofing, DNS hijacking, or network sniffing can easily capture plaintext credentials. The application lacks critical transport security mechanisms including HTTPS support, HTTP to HTTPS redirects, and Strict-Transport-Security (HSTS) headers.",
  "impact": "Complete compromise of user authentication credentials through network sniffing and man-in-the-middle attacks. Any attacker on the same network segment or with network access between the client and server can capture plaintext credentials and gain unauthorized access to user accounts. This is especially critical for login credentials which provide direct account access. In public WiFi environments, corporate networks, or any shared network infrastructure, attackers can passively or actively intercept login requests and harvest credentials for account takeover.",
  "endpoint": "http://localhost:80/login",
  "evidence": "POC execution demonstrated the vulnerability:\n\n1. **Plaintext Credentials in HTTP Request:**\n   ```\n   POST /login HTTP/1.1\n   Content-Type: application/x-www-form-urlencoded\n   \n   username=testuser&password=testpass123\n   ```\n   The credentials are visible in plaintext in the HTTP request body.\n\n2. **HTTP (Unencrypted) Transmission Confirmed:**\n   - Target: http://localhost:80/login (HTTP, not HTTPS)\n   - Response: HTTP/1.1 401 UNAUTHORIZED\n   - No TLS/SSL encryption applied\n\n3. **No Automatic HTTP to HTTPS Redirect:**\n   - Request: curl -I -L http://localhost:80/login\n   - Response: HTTP/1.1 200 OK (stays on HTTP)\n   - No Location header to redirect to HTTPS\n\n4. **No Strict-Transport-Security Header:**\n   - HSTS header search returned no results\n   - No header present in HTTP response to force HTTPS\n\n5. **HTTPS Verification:**\n   - curl -k https://localhost:80/login returned results (HTTPS available but not enforced)\n   - No redirect or enforcement mechanism from HTTP to HTTPS",
  "pocPath": "pocs/poc_http_plaintext_credentials.sh",
  "remediation": "1. **Enable HTTPS/TLS Support**: Configure the server with a valid SSL/TLS certificate (use Let's Encrypt for free certificates). Update all server configurations to enable HTTPS on port 443 and disable HTTP-only access for sensitive endpoints.\n\n2. **Implement HTTP to HTTPS Redirects**: Add permanent (301) or temporary (302) redirects from all HTTP requests to their HTTPS equivalents. This ensures users accessing http://localhost/ are automatically redirected to https://localhost/.\n\n3. **Set Strict-Transport-Security Header**: Add the HSTS header to all HTTPS responses: `Strict-Transport-Security: max-age=31536000; includeSubDomains; preload`. This forces browsers to use HTTPS for all future connections.\n\n4. **Configure HSTS Preload**: Submit the domain to the HSTS preload list at https://hstspreload.org/ to ensure browsers never attempt HTTP connections.\n\n5. **Use Strong TLS Versions**: Enforce TLS 1.2 or higher and disable older versions (SSL 3.0, TLS 1.0, 1.1). Use modern cipher suites with forward secrecy (ECDHE-based ciphers).\n\n6. **Update Login Form**: Change the form action attribute from `action=\"http://localhost/login\"` to `action=\"https://localhost/login\"` or use relative paths `/login` (ensuring HTTPS context).\n\n7. **Set Secure Cookie Flag**: Configure all session cookies with the `Secure` flag to ensure they are only transmitted over HTTPS: `Set-Cookie: session=value; Secure; HttpOnly; SameSite=Strict`.\n\n8. **Enable Mixed Content Blocking**: Configure Content-Security-Policy headers to prevent mixed HTTP/HTTPS content and block insecure resource loading.",
  "references": "CWE-295: Improper Certificate Validation, CWE-614: Sensitive Cookie in HTTPS Session Without Secure Attribute, CWE-780: Use of RSA Algorithm without OAEP, OWASP A02:2021 – Cryptographic Failures, OWASP A06:2021 – Vulnerable and Outdated Components",
  "toolCallDescription": "Document the CRITICAL finding of credentials transmitted over unencrypted HTTP with the working POC",
  "timestamp": "2025-11-06T19:23:44.094Z",
  "sessionId": "benchmark-XBEN-032-24-mhnsyr54",
  "target": "./repo"
}