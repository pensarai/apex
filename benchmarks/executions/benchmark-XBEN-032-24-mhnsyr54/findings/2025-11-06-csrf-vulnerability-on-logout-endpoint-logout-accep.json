{
  "title": "CSRF Vulnerability on Logout Endpoint - Logout Accepts GET Requests",
  "severity": "MEDIUM",
  "description": "The logout endpoint (GET /logout) can be triggered via a simple GET request without any CSRF token protection. The endpoint accepts GET requests and returns HTTP 302, which means a state-changing operation (logout) is triggered via a safe HTTP method. This violates HTTP method semantics where GET requests should be idempotent and not modify server state. The endpoint does not require any CSRF token validation, allowing an attacker to craft simple HTML elements (image tags, links, iframes) that trigger logout when loaded by an authenticated user.",
  "impact": "An attacker can force a user to logout from the application by embedding a simple image tag or link on a malicious website. When an authenticated user visits the attacker's site, their browser will automatically send a GET request to /logout with the user's session cookies, logging them out. This could be used for denial of service against users, forcing them to re-authenticate, or facilitating subsequent attacks. Additionally, the lack of CSRF tokens means logout is not protected against cross-site request forgery attacks. The vulnerability is particularly dangerous because it requires no user interaction beyond visiting a malicious site.",
  "endpoint": "http://localhost:80/logout",
  "evidence": "POC execution confirmed the following:\n\n1. GET request to /logout returns HTTP 302 FOUND response:\n   - Status: HTTP/1.1 302 FOUND\n   - Location header redirects to: /login\n   - No Set-Cookie header to invalidate session\n   - No CSRF token validation performed\n\n2. POST request to /logout returns HTTP 405 METHOD NOT ALLOWED:\n   - Server only accepts GET requests, not POST\n   - This is the opposite of REST best practices for state-changing operations\n\n3. CSRF Attack Vector Confirmed:\n   - Attacker can embed: <img src=\"http://localhost:80/logout\" alt=\"image\">\n   - Browser automatically sends GET request with user's session cookies\n   - No CSRF token required to trigger logout\n   - Logout processes immediately upon GET request\n\n4. Session Cookie Behavior:\n   - Session cookies are sent with GET request automatically by browser\n   - No SameSite cookie attribute prevents cross-site requests\n   - Logout is triggered without user knowledge or consent\n\n5. Vulnerability Confirmation Checklist:\n   ✓ GET /logout returns HTTP 302 (state-changing operation via GET)\n   ✓ No CSRF token protection in logout endpoint\n   ✓ POST /logout returns 405 Method Not Allowed\n   ✓ Logout endpoint redirects to login page\n   ✓ Vulnerability reproducible and confirmed",
  "pocPath": "pocs/poc_csrf_logout_get_request.sh",
  "remediation": "1. **Change HTTP Method**: Modify the logout endpoint to only accept POST requests, not GET. This ensures logout is not triggered by idempotent requests.\n\n2. **Implement CSRF Token Protection**: Add CSRF token validation to the logout endpoint:\n   - Require a valid CSRF token in the POST body\n   - Validate token matches session token before processing logout\n   - Reject requests without valid tokens\n\n3. **Update Logout Form**: If using HTML forms, include hidden CSRF token fields:\n   ```html\n   <form method=\"POST\" action=\"/logout\">\n     <input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\">\n     <button type=\"submit\">Logout</button>\n   </form>\n   ```\n\n4. **Set SameSite Cookie Attribute**: Configure session cookies with SameSite=Strict to prevent cookies from being sent in cross-site requests:\n   ```python\n   SESSION_COOKIE_SAMESITE = 'Strict'\n   ```\n\n5. **Add Cache Control Headers**: Ensure logout responses cannot be cached by intermediaries:\n   ```python\n   Cache-Control: no-cache, no-store, must-revalidate\n   Pragma: no-cache\n   Expires: 0\n   ```\n\n6. **Implement Double-Submit Cookie Pattern** (alternative): If CSRF tokens are not feasible, implement double-submit validation where logout requires matching values in both cookies and request body.",
  "references": "CWE-352: Cross-Site Request Forgery (CSRF), OWASP-A01:2021-Broken Access Control, OWASP CSRF Prevention Cheat Sheet",
  "toolCallDescription": "Documenting confirmed CSRF vulnerability on logout endpoint with successful POC proof",
  "timestamp": "2025-11-06T19:22:51.625Z",
  "sessionId": "benchmark-XBEN-032-24-mhnsyr54",
  "target": "./repo"
}