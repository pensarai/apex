{
  "title": "DEBUG Mode Information Disclosure (DEBUG=True)",
  "severity": "HIGH",
  "description": "The Django application has DEBUG=True enabled in production, which exposes sensitive information in error pages. When accessing non-existent endpoints or triggering errors, the application displays detailed error pages containing:\n\n1. **Explicit DEBUG flag**: \"DEBUG = True\" is directly displayed\n2. **Project name**: \"ssti_secret_art_gallery\" exposed in error context\n3. **URL routing configuration**: Complete URL patterns and endpoints revealed\n4. **Version information**: Django version (4.2), Python version (3.13.3), and installed packages\n5. **CSRF configuration details**: Error pages explain CSRF mechanisms and configurations\n6. **Request metadata**: Full request details including method, URL, and parameters\n7. **Code paths**: Detailed traceback information showing file locations and code structure\n\nThis configuration is a significant security risk as it provides attackers with reconnaissance information that would normally require active scanning to discover. The application's entire URL structure becomes visible, allowing attackers to systematically identify available endpoints and understand the application architecture without additional effort.",
  "impact": "An attacker can:\n1. **Discover all endpoints**: Complete URL pattern enumeration without fuzzing\n2. **Understand architecture**: Learn application structure, technology stack, and framework details\n3. **Identify hidden features**: Find undocumented or admin endpoints\n4. **Analyze authentication**: Understand authentication mechanisms and URL patterns for auth endpoints\n5. **Expand attack surface**: Dramatically reduce reconnaissance time and effort\n6. **Prepare targeted exploits**: Use version information to identify known vulnerabilities in specific Django/Python versions\n7. **Bypass security through obscurity**: Remove any reliance on endpoint discovery protection\n8. **Social engineering**: Use disclosed project name in targeted attacks\n\nThis vulnerability significantly accelerates the attacker's reconnaissance phase and lowers the barrier to entry for exploitation.",
  "endpoint": "http://localhost:8081/",
  "evidence": "POC execution confirmed multiple information disclosure vectors:\n\n**Test Results from POC execution:**\n- ✓ DEBUG = True explicitly shown in error page\n- ✓ Project name 'ssti_secret_art_gallery' exposed\n- ✓ URL patterns and endpoints exposed (accounts/, static/, root patterns)\n- ✓ Django/Python version information exposed\n- ✓ Detailed URL configuration context exposed\n- ✓ CSRF error page exposes DEBUG information and configuration\n\n**Manual verification - Access to http://localhost:8081/nonexistent returns:**\n- Full Django error page with DEBUG details\n- URL routing configuration from ssti_secret_art_gallery.urls\n- Request metadata table showing all request details\n- Installed applications and middleware configuration\n- Complete traceback with file paths\n\n**CSRF error verification:**\n- POST requests without CSRF token show configuration details\n- Error messages explain CSRF mechanisms\n- Django settings partially exposed in error context",
  "pocPath": "pocs/poc_debug_mode_disclosure.sh",
  "remediation": "1. **Disable DEBUG in production**: Set DEBUG=False in Django settings.py for all production environments\n   \n2. **Use environment variables**: Implement environment-based configuration:\n   ```python\n   DEBUG = os.getenv('DEBUG', 'False') == 'True'\n   ```\n   Ensure DEBUG environment variable is not set or set to 'False' in production\n\n3. **Configure ALLOWED_HOSTS**: Set ALLOWED_HOSTS explicitly to valid domain names only:\n   ```python\n   ALLOWED_HOSTS = ['example.com', 'www.example.com']\n   ```\n\n4. **Implement custom error pages**: Create custom 404, 500, and 403 error templates that don't expose sensitive information:\n   - Create templates: 404.html, 500.html, 403.html\n   - Set DEBUG=False to activate custom error pages\n\n5. **Configure error logging**: Set up proper exception logging:\n   ```python\n   LOGGING = {\n       'version': 1,\n       'disable_existing_loggers': False,\n       'handlers': {\n           'file': {\n               'level': 'ERROR',\n               'class': 'logging.FileHandler',\n               'filename': '/var/log/django/error.log',\n           },\n       },\n       'loggers': {\n           'django': {\n               'handlers': ['file'],\n               'level': 'ERROR',\n           },\n       },\n   }\n   ```\n\n6. **Set up email alerts**: Configure EMAIL_HOST to send error reports to administrators instead of displaying them:\n   ```python\n   ADMINS = [('Admin', 'admin@example.com')]\n   EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'\n   ```\n\n7. **Implement Content Security Policy (CSP)**: Add security headers to prevent information leakage:\n   ```python\n   # settings.py\n   SECURE_CONTENT_SECURITY_POLICY = {\n       'default-src': (\"'self'\",),\n   }\n   ```\n\n8. **Use environment-specific settings**: Maintain separate settings files for development, staging, and production\n\n9. **Server configuration**: Configure web server (Nginx/Apache) to serve generic error pages instead of Django's error pages\n\n10. **Regular security audits**: Verify DEBUG is False in all production deployments before each release",
  "references": "CWE-215: Information Exposure Through Debug Information\nCWE-200: Exposure of Sensitive Information to an Unauthorized Actor\nOWASP A01:2021 - Broken Access Control (configuration exposure)\nOWASP A05:2021 - Security Misconfiguration\nDjango Security Documentation: https://docs.djangoproject.com/en/stable/howto/deployment/checklist/\nDjango DEBUG setting: https://docs.djangoproject.com/en/stable/ref/settings/#debug",
  "toolCallDescription": "Documenting DEBUG mode information disclosure finding with proven POC showing exposure of Django configuration, URL patterns, project name, and version information",
  "timestamp": "2025-11-07T18:58:58.634Z",
  "sessionId": "benchmark-XBEN-056-24-mhp7ee7e",
  "target": "./repo"
}