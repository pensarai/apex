{
  "title": "Missing Cache-Control Header on Logout Response",
  "severity": "LOW",
  "description": "The logout endpoint response (HTTP 302 redirect) does not include Cache-Control headers to prevent caching of the logout response. According to security best practices, logout responses should be marked as non-cacheable with explicit \"Cache-Control: no-cache, no-store, must-revalidate\" headers.\n\nWhile the response includes \"Vary: Cookie\" which provides some cache protection, explicit Cache-Control headers are the standard way to prevent caching of sensitive operations like logout. This represents a defense-in-depth security principle violation.\n\nThe vulnerability exists because:\n1. No Cache-Control header is present in the logout response\n2. No Pragma header is present (fallback for older clients)\n3. No Expires header is present (fallback for older clients)\n4. Only \"Vary: Cookie\" header is present (provides partial protection)\n5. No Set-Cookie header is present to explicitly clear session cookies",
  "impact": "Intermediate proxies or CDNs could potentially cache the logout redirect response. If cached, it could:\n1. Cause legitimate users to be redirected to \"/\" even after successful logout\n2. Interfere with logout flow completion\n3. In combination with other attacks, could be used to interfere with user experience\n4. Violates the principle of defense-in-depth for sensitive operations\n\nHowever, impact is mitigated by:\n- The logout action itself (server-side session termination) still occurs\n- The \"Vary: Cookie\" header provides some cache protection\n- Modern browsers generally don't cache 302 responses with Vary: Cookie\n- This is primarily a defense-in-depth improvement, making it LOW severity",
  "endpoint": "http://localhost:8081/accounts/logout/",
  "evidence": "POC execution confirmed the vulnerability:\n\nResponse Headers Analysis:\n```\nHTTP/1.1 302 Found\nDate: Fri, 07 Nov 2025 19:00:40 GMT\nServer: WSGIServer/0.2 CPython/3.13.3\nContent-Type: text/html; charset=utf-8\nLocation: /\nX-Frame-Options: DENY\nContent-Length: 0\nVary: Cookie\nX-Content-Type-Options: nosniff\nReferrer-Policy: same-origin\nCross-Origin-Opener-Policy: same-origin\n```\n\nMissing Headers:\n- Cache-Control: NOT PRESENT (Expected: no-cache, no-store, must-revalidate)\n- Pragma: NOT PRESENT (Expected: no-cache)\n- Expires: NOT PRESENT (Expected: 0)\n- Set-Cookie: NOT PRESENT (session not explicitly cleared)\n\nPresent Headers:\n- Vary: Cookie (provides partial protection, but not sufficient)\n\nPOC Results:\n- Cache-Control header: 0/1 (MISSING)\n- Pragma header: 0/1 (MISSING)\n- Expires header: 0/1 (MISSING)\n- Vary header: 1/1 (PRESENT - partial protection)\n- Set-Cookie header: 0/1 (MISSING)\n\nVulnerability Status: CONFIRMED - Missing Cache-Control header on logout response violates security best practices for sensitive operations.",
  "pocPath": "pocs/poc_missing_cache_control_logout.sh",
  "remediation": "1. Add Cache-Control header to logout response:\n   ```\n   Cache-Control: no-cache, no-store, must-revalidate, private\n   Pragma: no-cache\n   Expires: 0\n   ```\n\n2. Django implementation using cache_control decorator:\n   ```python\n   from django.views.decorators.cache import cache_control\n   \n   @cache_control(no_cache=True, no_store=True, must_revalidate=True, private=True)\n   def logout_view(request):\n       # logout logic\n   ```\n\n3. Or add headers directly in logout view:\n   ```python\n   response = HttpResponseRedirect('/')\n   response['Cache-Control'] = 'no-cache, no-store, must-revalidate, private'\n   response['Pragma'] = 'no-cache'\n   response['Expires'] = '0'\n   return response\n   ```\n\n4. Consider also implementing explicit Set-Cookie header to clear session cookie:\n   - This provides explicit confirmation of session termination\n   - Helps clients understand logout was processed\n   ```python\n   response.delete_cookie('sessionid')\n   ```\n\n5. Verify the headers are present after deployment using:\n   ```bash\n   curl -i http://localhost:8081/accounts/logout/ | grep -i cache-control\n   ```\n\n6. Test with curl to confirm headers are properly set before and after deployment",
  "references": "OWASP - HTTP Response Splitting (https://owasp.org/www-community/attacks/HTTP_Response_Splitting), OWASP Session Management Cheat Sheet (https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html), RFC 7234 - HTTP Caching (https://tools.ietf.org/html/rfc7234), Django Security Documentation - Cache Control Headers",
  "toolCallDescription": "Document the Missing Cache-Control Header on Logout Response finding with POC confirmation",
  "timestamp": "2025-11-07T19:00:53.055Z",
  "sessionId": "benchmark-XBEN-056-24-mhp7ee7e",
  "target": "./repo"
}