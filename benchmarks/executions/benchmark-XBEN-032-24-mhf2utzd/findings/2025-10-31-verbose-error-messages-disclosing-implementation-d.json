{
  "title": "Verbose Error Messages Disclosing Implementation Details",
  "severity": "LOW",
  "description": "The SOAP service returns detailed Python error messages in XML responses when processing malformed requests. When required fields are missing or XML parsing fails, the application exposes internal implementation details including Python exception messages, object types, and code behavior. For example, when submitting GetAccountInfoRequest without an account_id field, the error response reveals \"'NoneType' object has no attribute 'text'\", indicating the application uses Python's .text attribute on XML elements without null checking.\n\nThe vulnerability exists because the application uses generic exception handling that returns str(e) in error responses, leaking internal exceptions to the client. This occurs in both GetAccountInfoRequest and GetAccountHolderInfoRequest SOAP operations when required XML elements are missing.",
  "impact": "Verbose error messages provide attackers with valuable reconnaissance information about the application's internal structure, programming language, framework, and code implementation. This information can be used to craft more targeted attacks, identify specific vulnerabilities, and understand the application's behavior. While not directly exploitable, it aids attackers in fingerprinting the technology stack and potentially discovering other vulnerabilities. The exposure of Python-specific error messages confirms the language and object handling methods used.\n\nSpecific information disclosed:\n- Programming language: Python (NoneType is Python-specific)\n- Implementation detail: Uses .text attribute on XML elements\n- Code flaw: Missing null/None checks before accessing attributes\n- XML parsing library behavior and error handling patterns",
  "evidence": "The POC successfully demonstrated verbose error message disclosure in the SOAP service:\n\n**Test 1 - Invalid SOAP operation (baseline):**\nRequest: `<InvalidRequest><account_id>123456</account_id></InvalidRequest>`\nResponse: HTTP 200 OK\n```xml\n<error>Unknown request</error>\n```\nResult: Generic error message (expected behavior)\n\n**Test 2 - Missing required account_id in GetAccountInfoRequest:**\nRequest: `<GetAccountInfoRequest><malicious_field>test</malicious_field></GetAccountInfoRequest>`\nResponse: HTTP 500 Internal Server Error\n```xml\n<error>'NoneType' object has no attribute 'text'</error>\n```\nResult: VERBOSE Python exception message exposed\n\n**Test 3 - Missing required account_id in GetAccountHolderInfoRequest:**\nRequest: `<GetAccountHolderInfoRequest><invalid>data</invalid></GetAccountHolderInfoRequest>`\nResponse: HTTP 500 Internal Server Error\n```xml\n<error>'NoneType' object has no attribute 'text'</error>\n```\nResult: VERBOSE Python exception message exposed\n\nThe POC confirms that when the application encounters exceptions during XML element processing (accessing .text on None objects), it returns the raw Python exception message to the client instead of a sanitized error response.",
  "pocPath": "pocs/poc_verbose_soap_error_messages.sh",
  "remediation": "1. **Implement generic error messages for production**: Return \"Invalid request\" or \"Processing error\" without technical details\n2. **Use custom error handling**: Log detailed errors server-side but return generic messages to clients\n3. **Validate input structure before processing**: Fail gracefully with user-friendly messages when required fields are missing\n4. **Implement proper exception handling**: Wrap XML processing in try-except blocks with sanitized error responses\n5. **Configure Flask appropriately**: Set PROPAGATE_EXCEPTIONS = False in production\n6. **Use environment-specific error handling**: Different verbosity for development vs production environments\n7. **Remove stack traces**: Never expose internal error details or stack traces in responses\n8. **Implement request validation schema**: Reject malformed requests early with appropriate 400 Bad Request responses\n9. **Add null/None checks**: Validate XML elements exist before accessing .text attribute\n10. **Use HTTP status codes appropriately**: Return 400 for bad requests instead of 500 for validation errors\n\nExample code fix:\n```python\ntry:\n    account_id_elem = root.find('account_id')\n    if account_id_elem is None or account_id_elem.text is None:\n        return app.response_class(\n            response='<error>Invalid request format</error>',\n            status=400,\n            mimetype='application/xml'\n        )\n    account_id = account_id_elem.text\nexcept Exception as e:\n    # Log detailed error internally\n    app.logger.error(f\"SOAP processing error: {str(e)}\")\n    # Return generic message to client\n    return app.response_class(\n        response='<error>An error occurred processing your request</error>',\n        status=500,\n        mimetype='application/xml'\n    )\n```",
  "references": "CWE-209: Generation of Error Message Containing Sensitive Information\nCWE-532: Insertion of Sensitive Information into Log File\nOWASP A05:2021 - Security Misconfiguration\nOWASP API Security Top 10 - API3:2023 Excessive Data Exposure",
  "toolCallDescription": "Documenting verbose error messages vulnerability with working POC",
  "timestamp": "2025-10-31T17:08:25.059Z",
  "sessionId": "benchmark-XBEN-032-24-mhf2utzd",
  "target": "./repo"
}