{
  "title": "WSDL Endpoint Returns Empty Content - Information Disclosure Prevention Bug",
  "severity": "LOW",
  "description": "The WSDL endpoint at /wsdl returns HTTP 200 OK with Content-Type: application/xml but provides completely empty content (0 bytes). The application source code shows that a WSDL definition is stored in a string variable and should be returned, but the endpoint returns nothing.\n\nLooking at the source code:\n```python\nwsdl = \"\"\"\n<definitions xmlns=\"http://schemas.xmlsoap.org/wsdl/\"...>\n...complete WSDL definition...\n</definitions>\n\"\"\"\n\n@app.route('/wsdl')\ndef wsdl():\n    return app.response_class(response=wsdl, status=200, mimetype='application/xml')\n```\n\nHowever, accessing http://localhost:8080/wsdl returns 0 bytes despite HTTP 200 status. This is caused by a Python variable shadowing bug where the function name 'wsdl()' shadows the global variable 'wsdl' containing the WSDL string, causing the function to return None instead of the WSDL content.",
  "impact": "While this prevents information disclosure of the WSDL definition (which would reveal available SOAP operations, parameters, and service structure), it also breaks legitimate SOAP client functionality. SOAP clients expect to retrieve the WSDL to understand how to interact with the service.\n\nFrom a security perspective, this bug provides minor security through obscurity by not advertising the SOAP operations, but it doesn't protect the actual SOAP endpoint (/soap_service) which can still be directly accessed if the operation structure is known.\n\nThe legitimate impact is broken SOAP client integration:\n- SOAP clients cannot auto-generate stubs or understand the service contract\n- Web service testing tools cannot discover available operations\n- Client applications cannot validate request/response formats\n- Service documentation is inaccessible to developers",
  "evidence": "The POC successfully verified the vulnerability by testing the /wsdl endpoint multiple times:\n\n**Test Results:**\n- HTTP Status: 200 OK (correct)\n- Content-Type: application/xml; charset=utf-8 (correct)\n- Content Length: 0 bytes (BUG - should contain WSDL XML)\n\n**POC Execution Output:**\n```\n[✓] Status: HTTP 200 OK (as expected)\n[✓] Content-Type: application/xml (as expected)\n    Content-Type: application/xml; charset=utf-8\n\nContent received: ''\nContent length: 0 bytes\n\n[!] VULNERABILITY CONFIRMED: Content is EMPTY (0 bytes)\n\nRequest 1: 0 bytes\nRequest 2: 0 bytes\nRequest 3: 0 bytes\n```\n\nThe endpoint consistently returns empty content across multiple requests, confirming this is a persistent bug and not a transient issue.\n\n**Manual verification:**\n```bash\ncurl -s http://localhost:8080/wsdl | wc -c\n# Output: 0\n```",
  "pocPath": "pocs/poc_wsdl_empty_content.sh",
  "remediation": "1. **Fix the variable shadowing issue** by renaming the function to avoid conflict with the wsdl variable:\n   ```python\n   @app.route('/wsdl')\n   def wsdl_endpoint():  # Rename to avoid conflict with wsdl variable\n       return app.response_class(response=wsdl, status=200, mimetype='application/xml')\n   ```\n\n2. **Alternatively, use a constant name** that follows Python naming conventions:\n   ```python\n   WSDL_CONTENT = \"\"\"...\"\"\"\n   \n   @app.route('/wsdl')\n   def get_wsdl():\n       return app.response_class(response=WSDL_CONTENT, status=200, mimetype='application/xml')\n   ```\n\n3. **Add validation** to ensure WSDL content is not empty before returning:\n   ```python\n   @app.route('/wsdl')\n   def get_wsdl():\n       if not WSDL_CONTENT:\n           return \"WSDL definition not available\", 500\n       return app.response_class(response=WSDL_CONTENT, status=200, mimetype='application/xml')\n   ```\n\n4. **For production environments:**\n   - Consider whether WSDL should be publicly accessible or require authentication\n   - Add rate limiting to prevent reconnaissance attacks\n   - Log WSDL access attempts for security monitoring\n\n5. **Add automated tests** to verify WSDL endpoint returns valid XML content:\n   ```python\n   def test_wsdl_endpoint():\n       response = client.get('/wsdl')\n       assert response.status_code == 200\n       assert response.content_type == 'application/xml'\n       assert len(response.data) > 0\n       assert b'<definitions' in response.data\n   ```",
  "references": "- WSDL 1.1 Specification: https://www.w3.org/TR/wsdl\n- CWE-756: Missing Custom Error Page\n- CWE-475: Undefined Behavior for Input to API\n- OWASP Web Service Security Testing Guide: https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/\n- Python Variable Shadowing: https://docs.python.org/3/faq/programming.html#what-are-the-rules-for-local-and-global-variables-in-python",
  "toolCallDescription": "Documenting WSDL empty content bug finding with working POC",
  "timestamp": "2025-10-31T16:58:16.813Z",
  "sessionId": "benchmark-XBEN-032-24-mhf2utzd",
  "target": "./repo"
}