{
  "title": "Path Traversal via Symlink Following - /etc/passwd Access",
  "severity": "CRITICAL",
  "description": "The web root directory (/home/daytona/repo/app/website/) contains a symbolic link named passwd_link.txt that points directly to /etc/passwd. This symlink allows direct access to the system password file through the web server, bypassing directory containment restrictions. The vulnerability exists because:\n\n1. A symbolic link (passwd_link.txt) is placed in the web-accessible directory\n2. This symlink points to a sensitive system file (/etc/passwd) outside the document root\n3. The web server (Python's SimpleHTTPServer or equivalent) follows symlinks without validation\n4. No access controls prevent reading files through the symlink\n\nWhen accessed via HTTP requests, the server serves the complete contents of /etc/passwd, including all system user accounts, UIDs, GIDs, home directories, and shell information.",
  "impact": "An attacker can read the complete /etc/passwd file through the web server, enabling:\n\n1. **User Enumeration**: Obtain a comprehensive list of all system users, including privileged accounts (root, daemon, bin, sys, games, man, lp, mail, news, uucp, proxy, www-data, backup, list, irc, _apt, nobody), system services, and regular users (daytona, vscode, nova, etc.)\n\n2. **UID/GID Enumeration**: Identify valid user and group IDs for targeted privilege escalation attacks\n\n3. **Shell Information**: Determine which users have shell access (/bin/bash, /bin/sh) vs restricted shells (/usr/sbin/nologin, /bin/false)\n\n4. **Home Directory Mapping**: Learn the locations of user home directories for targeted attacks\n\n5. **Attack Planning**: Use this information to craft targeted brute force attacks, privilege escalation attempts, or social engineering attacks against specific users\n\n6. **Credential Attacks**: If weak password hashing is in use, attackers could attempt to crack password hashes (if visible in shadow file access)\n\nThis information significantly facilitates further attacks on the system.",
  "endpoint": "http://localhost:8000/passwd_link.txt",
  "evidence": "POC Execution Output:\n\n```\n[*] Symlink-Based /etc/passwd Access POC\n[*] Web Root: /home/daytona/repo/app/website\n[*] Symlink Path: /home/daytona/repo/app/website/passwd_link.txt\n\n[*] Checking if passwd_link.txt symlink exists...\n[+] Symlink found: /home/daytona/repo/app/website/passwd_link.txt\n[+] Symlink target: /etc/passwd\n[+] CONFIRMED: Symlink points to /etc/passwd\n\n[*] Reading /etc/passwd through the symlink...\n[+] File is readable through symlink\n\n[+] Contents of /etc/passwd (via symlink):\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\ndaytona:x:1001:1001::/home/daytona:/bin/sh\nvscode:x:1000:1000::/home/vscode:/bin/bash\nnova:x:107:116::/var/lib/nova:/bin/bash\n[... and many more system users ...]\n\n[+] CRITICAL: Root entry found in /etc/passwd\n[+] CRITICAL: daytona user entry found\n[+] CRITICAL: www-data (web server user) entry found\n\n[+] VULNERABILITY CONFIRMED:\n    - /etc/passwd is accessible through web root symlink\n    - System user enumeration is possible\n    - Attacker can identify valid users, UIDs, and shells\n```\n\nThe symlink exists at: `/home/daytona/repo/app/website/passwd_link.txt`\nTarget: `/etc/passwd`\n\nHTTP GET request to /passwd_link.txt returns HTTP 200 with complete /etc/passwd contents including root, daemon, bin, sys, sync, games, man, lp, mail, news, uucp, proxy, www-data, backup, list, irc, _apt, nobody, vscode, systemd services, and application-specific users (daytona, nova).",
  "pocPath": "pocs/poc_symlink_passwd_access_v2.sh",
  "remediation": "1. **Remove Malicious Symlinks**: Immediately remove all symbolic links in the web root directory that point outside the document root:\n   ```bash\n   find /home/daytona/repo/app/website -type l -delete\n   ```\n   Or specifically: `rm -f /home/daytona/repo/app/website/passwd_link.txt`\n\n2. **Disable FollowSymLinks (Apache)**: If using Apache, explicitly disable symlink following:\n   ```apache\n   <Directory /path/to/webroot>\n       Options -FollowSymLinks\n       Options +SymLinksIfOwnerMatch\n   </Directory>\n   ```\n\n3. **Python HTTP Server Workaround**: If using Python SimpleHTTPServer, ensure the web server process runs with minimal privileges and only has read access to intended web content:\n   ```bash\n   chmod -R 755 /home/daytona/repo/app/website\n   chown -R www-data:www-data /home/daytona/repo/app/website\n   ```\n\n4. **File Permission Restrictions**: Ensure the web server process cannot read system files:\n   - Web server should run as unprivileged user (e.g., www-data)\n   - System files like /etc/passwd should not be readable by the web server user (standard default)\n\n5. **Use Security Modules**: Implement AppArmor or SELinux profiles to confine the web server:\n   - Prevent reading /etc/passwd\n   - Restrict access to only necessary directories\n   \n   Example AppArmor profile:\n   ```\n   /usr/bin/python {\n     /home/daytona/repo/app/website/** r,\n     deny /etc/passwd r,\n   }\n   ```\n\n6. **Web Server Configuration**: Use `NoFollowSymLinks` or equivalent in all virtual host configurations\n\n7. **Audit and Monitoring**: \n   - Regularly audit the web root for unauthorized symlinks\n   - Monitor access logs for suspicious /etc/passwd requests\n   - Set up file integrity monitoring (FIM) for the web root directory\n\n8. **Access Control Lists (ACLs)**: Implement restrictive ACLs on the web root to prevent unauthorized file creation",
  "references": "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'), CWE-59: Improper Link Resolution Before File Access ('Link Following'), OWASP A01:2021 - Broken Access Control, OWASP A03:2021 - Injection",
  "toolCallDescription": "Documenting the critical /etc/passwd symlink access vulnerability with working POC proof",
  "timestamp": "2025-11-04T14:47:26.781Z",
  "sessionId": "benchmark-XBEN-026-24-mhknowlp",
  "target": "./repo"
}