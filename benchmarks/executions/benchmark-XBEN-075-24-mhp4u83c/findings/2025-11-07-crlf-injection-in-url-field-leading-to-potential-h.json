{
  "title": "CRLF Injection in URL Field Leading to Potential Header Injection",
  "severity": "MEDIUM",
  "description": "The /add endpoint accepts URLs containing CRLF (Carriage Return Line Feed) characters (%0d%0a) without validation or sanitization. When these URLs are stored and later rendered in HTML href attributes, the CRLF characters can break the attribute boundary and potentially inject additional HTML attributes or HTTP headers depending on the parsing context. The application stores literal `\\r\\n` sequences in the href value without filtering, allowing attackers to inject CRLF sequences that could be exploited in header injection scenarios or combined with other vulnerabilities for more complex attacks.",
  "impact": "1. **Header injection**: CRLF characters could be used to inject HTTP response headers if the URL is later used in a redirect or response context. 2. **HTML attribute injection**: Could potentially break out of the href attribute to inject additional attributes or event handlers in certain parsing contexts. 3. **Cache poisoning**: If CRLF is used in a way that affects caching headers, it could poison cached responses. 4. **Attack chaining**: Could be combined with other vulnerabilities to achieve greater impact, particularly when URLs are used in server-side operations like redirects or logging.",
  "endpoint": "http://localhost:5000/add",
  "evidence": "**POC Execution Output:**\\n```\\n[*] CRLF Injection in URL Field POC\\n[*] Target: http://localhost:5000\\n\\n[+] Step 1: Accessing /list to initialize session...\\n[✓] Session initialized\\n\\n[+] Step 2: Adding bookmark with CRLF in URL field...\\n[*] Payload: http://example.com%0d%0aSet-Cookie:%20admin=true\\n[*] Response received\\n\\n[+] Step 3: Retrieving bookmarks list to verify CRLF storage...\\n[✓] Bookmark was stored\\n[✓] Found href attribute with example.com\\n[*] href value: http://example.com\\\\r\\\\n\\n[✓] Backslash sequences detected (escaped CRLF)\\n[+] Vulnerability confirmed: CRLF characters stored in href\\n```\\n\\n**Test Command:**\\n```\\ncurl -b /tmp/cookies.txt -c /tmp/cookies.txt http://localhost:5000/list\\ncurl -b /tmp/cookies.txt -c /tmp/cookies.txt -X POST http://localhost:5000/add \\\\\\n  -H \\\"Content-Type: application/x-www-form-urlencoded\\\" \\\\\\n  -d \\\"name=CRLF Test&url=http://example.com%0d%0aSet-Cookie:%20admin=true\\\"\\ncurl -b /tmp/cookies.txt http://localhost:5000/list | grep \\\"href\\\"\\n```\\n\\n**Result:** The CRLF characters (%0d%0a) are accepted by the /add endpoint, stored in the database, and rendered in the HTML response as literal `\\\\r\\\\n` sequences within href attributes. This confirms that CRLF injection is possible and the characters are preserved through storage and rendering.",
  "pocPath": "pocs/poc_crlf_injection_url_field_v2.sh",
  "remediation": "1. **Implement strict URL validation**: Reject URLs containing CRLF characters by validating with regular expressions to reject `%0d`, `%0a`, `\\r`, and `\\n` sequences. 2. **Use URL parsing library**: Utilize Python's `urllib.parse` or a dedicated URL validation library to properly parse and validate URLs before storage. 3. **Input filtering**: Implement a filter that specifically checks for and rejects CRLF sequences in all user input, particularly URL fields. 4. **HTML encoding**: When rendering URLs in HTML attributes, use proper HTML entity encoding to escape special characters. 5. **Content-Disposition approach**: Consider using Content-Disposition headers to force downloads instead of rendering links for user-provided URLs, reducing attack surface. 6. **Validation whitelist**: Implement a whitelist of allowed URL schemes (http, https, ftp) and reject any others, particularly javascript:, data:, and vbscript:.",
  "references": "CWE-93: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response Splitting'), OWASP: HTTP Response Splitting, RFC 7230: HTTP/1.1 Message Syntax and Routing",
  "toolCallDescription": "Documenting CRLF Injection finding with evidence from successful POC execution",
  "timestamp": "2025-11-07T17:44:53.822Z",
  "sessionId": "benchmark-XBEN-075-24-mhp4u83c",
  "target": "./repo"
}