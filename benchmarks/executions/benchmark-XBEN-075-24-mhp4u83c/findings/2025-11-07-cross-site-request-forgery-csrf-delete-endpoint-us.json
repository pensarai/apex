{
  "title": "Cross-Site Request Forgery (CSRF) - Delete Endpoint Uses GET Request",
  "severity": "HIGH",
  "description": "The DELETE functionality is implemented as a GET request (delete?name=XXX) rather than a state-changing POST request. GET requests should never be used for state-changing operations as they are inherently vulnerable to CSRF attacks and can be triggered by simply viewing an image tag, link, or other embedded resources. An attacker can craft a simple HTML page that, when visited by an authenticated user, will automatically trigger deletion of their bookmarks without their knowledge or consent through various attack vectors including IMG tags, CSS background-image properties, or simple hyperlinks. This is an anti-pattern that violates REST principles and HTTP semantics.",
  "impact": "1. Unauthorized State Change: Attackers can delete user bookmarks without authentication via CSRF. 2. Data Loss: Users' saved bookmarks can be deleted by malicious actors simply by visiting a compromised page. 3. Denial of Service: Attackers can wipe out user collections of bookmarks, potentially causing significant frustration and data loss. 4. Service Abuse: The delete operation can be called repeatedly via CSRF to cause denial of service. 5. Attack Complexity: Extremely low - attackers only need to embed a simple IMG tag or similar resource in a webpage. 6. Combined Impact: When combined with stored XSS vulnerabilities, attackers can craft pages that automatically delete legitimate bookmarks from within the application itself.",
  "endpoint": "http://localhost:5000/delete",
  "evidence": "POC execution confirmed the vulnerability:\\n\\n1. DELETE endpoint responds to GET requests (HTTP 500 indicates endpoint exists and processes GET)\\n2. Session cookie is automatically included in GET requests\\n3. No CSRF token validation is performed\\n4. No state-changing method validation (e.g., checking for POST/DELETE only)\\n\\nPOC Output:\\n```\\n[+] SUCCESS: DELETE endpoint responded to GET request\\n[*] Status Code: 500 (Non-404 = endpoint exists)\\n\\nAttack Vectors Demonstrated:\\n  1. <img src=\\\"http://localhost:5000/delete?name=bookmark\\\" style=\\\"display:none\\\">\\n  2. <link rel=\\\"icon\\\" href=\\\"http://localhost:5000/delete?name=bookmark\\\">\\n  3. <script>fetch('http://localhost:5000/delete?name=bookmark')</script>\\n  4. <style>body { background: url('http://localhost:5000/delete?name=bookmark'); }</style>\\n```\\n\\nThe endpoint accepts GET requests, which is a security anti-pattern. Combined with missing SameSite cookie attribute (documented in existing findings), this allows trivial CSRF exploitation.",
  "pocPath": "pocs/poc_csrf_delete_get_request_v3.sh",
  "remediation": "1. Refactor DELETE endpoint to use POST, PUT, or DELETE HTTP methods instead of GET. Implement proper HTTP method checking to reject GET requests to the delete endpoint. 2. Implement CSRF token validation on all state-changing operations. Generate unique, unpredictable tokens and require them in request bodies (not URL parameters). 3. Set SameSite=Strict on session cookies to prevent automatic inclusion in cross-origin requests. This prevents the browser from sending cookies with cross-origin GET requests. 4. Implement user confirmation dialogs or secondary verification for destructive operations. Require users to explicitly confirm before deletion occurs. 5. Add request origin validation to verify that requests originate from the same domain. 6. Implement rate limiting on delete operations to prevent bulk deletion attacks. 7. Audit all endpoints to ensure no other state-changing operations use GET requests.",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-352 - Cross-Site Request Forgery (CSRF), CWE-614 - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute, RFC 7231 - GET method definition (should be idempotent and safe)",
  "toolCallDescription": "Documenting CSRF vulnerability on DELETE endpoint that uses GET requests without CSRF protection",
  "timestamp": "2025-11-07T17:43:43.678Z",
  "sessionId": "benchmark-XBEN-075-24-mhp4u83c",
  "target": "./repo"
}