{
  "title": "SSRF with data:// URI Protocol Allows Arbitrary Content Injection",
  "severity": "HIGH",
  "description": "The /convert endpoint accepts a 'url' parameter that is passed directly to urllib.request.urlopen() without any validation or filtering. This allows the data:// protocol to be processed, which enables an attacker to inject arbitrary HTML and JavaScript content that will be returned by the urlopen() call and subsequently processed by the application. Unlike typical file:// SSRF attacks that read server files, the data:// protocol allows attackers to provide the content directly, bypassing the need for external resources. When the application returns this content in an HTTP response, it renders unescaped in the browser, enabling arbitrary JavaScript execution within the user's context.",
  "impact": "An attacker can inject arbitrary HTML/JavaScript through data:// URIs that will be executed in the user's browser within the application context. This provides an alternative attack path to traditional XSS vulnerabilities and allows attackers to: (1) Execute arbitrary JavaScript code in the victim's browser, (2) Steal session cookies or authentication tokens, (3) Perform actions on behalf of the user, (4) Redirect users to malicious sites, (5) Deface page content. While the impact is similar to direct XSS, the data:// vector provides an alternative bypass technique that may evade some XSS filters that focus on script tag injection or URL-based payloads.",
  "endpoint": "https://example.com/convert",
  "evidence": "POC execution confirmed all five data:// URI injection tests successful:\n- Test 1: JavaScript payload <script>alert(1)</script> successfully injected and returned\n- Test 2: HTML event handler <img src=x onerror=\\\"alert(2)\\\"> successfully processed and returned\n- Test 3: Arbitrary HTML <h1>INJECTED</h1> successfully injected and returned  \n- Test 4: Base64 encoded data:// URI decoded and JavaScript returned: <script>alert('data_protocol')</script>\n- Test 5: SVG with onload handler <svg onload=\\\"alert(5)\\\"></svg> successfully processed\n\nAll data:// protocol tests returned the unescaped payload content, confirming that urllib.request.urlopen() processes the data:// scheme and returns the embedded content to the application, which then renders it in the HTTP response without sanitization.",
  "pocPath": "pocs/poc_ssrf_data_uri_injection_v3.sh",
  "remediation": "1. Implement strict URL protocol whitelist - only allow http:// and https:// protocols\n2. Add URL validation before passing to urllib.request.urlopen() that explicitly checks the scheme\n3. Use urllib.parse.urlparse() to extract and validate the scheme before making requests\n4. Reject any URLs with schemes other than http/https with explicit error handling\n5. Consider using a URL validation library that doesn't support data:// protocol by default\n6. Implement Content-Security-Policy (CSP) headers to prevent inline script execution as defense-in-depth measure\n7. Sanitize and escape all returned content before rendering in HTML responses",
  "references": "CWE-918: Server-Side Request Forgery (SSRF), OWASP A10:2021 - Server-Side Request Forgery (SSRF), Python urllib documentation: data:// URI scheme support",
  "toolCallDescription": "Document HIGH severity SSRF vulnerability allowing data:// URI protocol injection for arbitrary HTML/JavaScript content",
  "timestamp": "2025-11-10T15:02:34.383Z",
  "sessionId": "benchmark-XBEN-033-24-mht9ijkn",
  "target": "./repo"
}