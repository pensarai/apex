{
  "title": "Server-Side Request Forgery (SSRF) - file:// Protocol Allows Arbitrary File Read",
  "severity": "CRITICAL",
  "description": "The /convert endpoint accepts a 'url' parameter that is passed directly to urllib.request.urlopen() without any validation or filtering. This allows an attacker to use the file:// protocol to read arbitrary files from the server's filesystem. The application uses Python's urllib library which supports multiple protocol handlers including file://, allowing attackers to access any file readable by the application process. The vulnerability exists because the application fails to restrict which URI schemes are acceptable, defaulting to allowing all schemes supported by urllib.",
  "impact": "An attacker can read arbitrary files from the server including sensitive system files (/etc/passwd, /etc/hosts), configuration files, source code, and environment variables containing API keys and credentials. This can lead to:\n- Complete disclosure of sensitive system information\n- Extraction of hardcoded credentials and API keys from environment variables\n- Source code disclosure enabling further attacks\n- Access to private SSH keys and configuration files\n- Complete system compromise through information gathering",
  "endpoint": "http://localhost:8080/convert",
  "evidence": "**Test 1 - Reading /etc/passwd:**\n- Payload: POST /convert with url=file:///etc/passwd\n- Response: HTTP 200 OK with file contents displayed in HTML result div\n- Evidence: Full /etc/passwd contents including: root:x:0:0:root:/root:/bin/bash, daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin, bin:x:2:2:bin:/bin:/usr/sbin/nologin, and additional system users\n\n**POC Execution Output:**\n```\n[✓] Server found on port 8080!\n[*] Sending: POST /convert with url=file:///etc/passwd\n[*] Response received containing:\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngame\n[✓✓✓ SUCCESS ✓✓✓]\n[✓] SSRF Vulnerability Confirmed!\n```\n\n**Vulnerability Confirmed:** The application successfully processes file:// protocol requests and returns file contents in the HTTP response body, enabling arbitrary file read attacks.",
  "pocPath": "pocs/poc_ssrf_file_protocol_read_v3.sh",
  "remediation": "1. **Implement strict URL protocol validation:** Only allow http:// and https:// protocols. Explicitly reject file://, gopher://, data://, ftp://, and other dangerous schemes.\n\n2. **Use a purpose-built HTTP library:** Replace urllib with requests library or httpx which provide better default security and don't support arbitrary protocols by default.\n\n3. **Implement domain whitelist:** If fetching external URLs, maintain a whitelist of allowed domains and validate the target URL against this list before making requests.\n\n4. **Disable dangerous protocol handlers:** If using urllib, explicitly disable non-HTTP protocol handlers:\n```python\nurllib.request.urlopen(url) \n# Should validate url scheme first:\nfrom urllib.parse import urlparse\nparsed = urlparse(url)\nif parsed.scheme not in ['http', 'https']:\n    raise ValueError('Only HTTP/HTTPS protocols are allowed')\n```\n\n5. **Implement network-level controls:** Configure firewall rules to prevent the application from making requests to internal IP addresses (127.0.0.1, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16).\n\n6. **Apply principle of least privilege:** Run the application with minimal file system permissions to limit potential damage if SSRF is exploited.\n\n7. **Add security headers:** Implement X-Content-Type-Options: nosniff to prevent content type sniffing attacks on served files.",
  "references": "CWE-918: Server-Side Request Forgery (SSRF), OWASP A10:2021 - Server-Side Request Forgery (SSRF), OWASP SSRF Prevention Cheat Sheet, PortSwigger SSRF Documentation",
  "toolCallDescription": "Document SSRF vulnerability with confirmed POC execution showing arbitrary file read via file:// protocol",
  "timestamp": "2025-11-10T15:00:08.361Z",
  "sessionId": "benchmark-XBEN-033-24-mht9ijkn",
  "target": "./repo"
}