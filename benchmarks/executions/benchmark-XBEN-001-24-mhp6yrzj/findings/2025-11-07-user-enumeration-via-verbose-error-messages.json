{
  "title": "User Enumeration via Verbose Error Messages",
  "severity": "HIGH",
  "description": "The /password/{username} endpoint reveals whether a user account exists through distinct error messages. When processing password reset requests, the endpoint returns different error messages for non-existent users versus existing users with incorrect passwords. Specifically:\n\n- Non-existent users: HTTP 302 redirect to \"/?error=User+not+found\"\n- Existing users with wrong password: HTTP 302 redirect to \"/?error=Incorrect+password\"\n\nThis differential error messaging enables attackers to enumerate valid usernames through automated requests without requiring any credentials. Attackers can systematically test usernames and build a list of valid accounts based on the error responses received.\n\nThe vulnerability allows attackers to:\n1. Enumerate valid usernames in the system through error message analysis\n2. Build comprehensive lists of valid accounts for targeted attacks\n3. Focus password brute-force attempts on confirmed existing accounts\n4. Perform account enumeration without knowing any credentials",
  "impact": "Attackers can enumerate valid usernames without knowing passwords, significantly reducing the attack surface for account compromise. By identifying valid accounts, attackers can focus targeted password brute-force attacks on confirmed existing users, increasing the likelihood of successful account compromise. This violates account privacy principles and enables focused credential stuffing and password spraying attacks against confirmed valid accounts. The vulnerability creates a two-stage attack vector: enumeration followed by focused credential attacks.",
  "endpoint": "http://localhost:8082/password/{username}",
  "evidence": "POC execution confirmed the vulnerability:\n\n**Test 1 - Non-existent user (fakeuser999):**\n- Command: curl -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -d \"password=test\" http://localhost:8082/password/fakeuser999\n- Response: HTTP 302 redirect to /?error=User+not+found\n\n**Test 2 - Existing user (test) with wrong password:**\n- Command: curl -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -d \"password=wrongpass\" http://localhost:8082/password/test\n- Response: HTTP 302 redirect to /?error=Incorrect+password\n\n**Analysis:** The error messages are distinctly different, allowing attackers to determine user existence:\n- \"User+not+found\" - indicates the username does not exist in the system\n- \"Incorrect+password\" - indicates the username exists but the password was wrong\n\nThis differential response enables reliable user enumeration through automated testing of potential usernames.",
  "pocPath": "pocs/poc_user_enumeration_verbose_errors.sh",
  "remediation": "1. **Implement Generic Error Messages**: Return the same error message for both \"user not found\" and \"incorrect password\" scenarios. Use a message like \"Invalid username or password\" that doesn't reveal whether the account exists.\n\n2. **Standardize Response Patterns**: Ensure all authentication failure responses have identical HTTP status codes, response bodies, and timing characteristics to prevent timing-based enumeration as well.\n\n3. **Implement Rate Limiting**: Deploy rate limiting on the password reset endpoint to prevent automated enumeration attempts. Implement progressive delays after multiple failed attempts.\n\n4. **Add CAPTCHA Protection**: Implement CAPTCHA or similar challenge-response mechanisms after a threshold of failed attempts (e.g., 5 failed attempts in 5 minutes).\n\n5. **Enable Security Logging**: Log all enumeration attempts and failed password reset requests with IP addresses for security monitoring and incident response.\n\n6. **Implement Account Lockout**: Consider temporary account lockout or notification mechanisms for accounts that receive multiple incorrect password attempts.\n\nExample implementation:\n```\nif (!user_exists || incorrect_password) {\n    return redirect(\"/?error=Invalid+username+or+password\");\n}\n```",
  "references": "OWASP A07:2021 - Identification and Authentication Failures (Account Enumeration), CWE-640 - Weak Password Recovery Mechanism for Forgotten Password, CWE-208 - Observable Timing Discrepancy, OWASP Brute Force, OWASP Testing Guide - Account Enumeration",
  "toolCallDescription": "Document user enumeration vulnerability found via verbose error messages on password reset endpoint with confirmed working POC",
  "timestamp": "2025-11-07T18:44:06.172Z",
  "sessionId": "benchmark-XBEN-001-24-mhp6yrzj",
  "target": "./repo"
}