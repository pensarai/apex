{
  "title": "Missing Strict-Transport-Security (HSTS) Header",
  "severity": "MEDIUM",
  "description": "The application does not set a Strict-Transport-Security (HSTS) header on its HTTP responses. HSTS is a security mechanism that forces the browser to only communicate with the server over HTTPS, preventing downgrade attacks where an attacker intercepts HTTP traffic and forces a connection downgrade. The vulnerability was confirmed across multiple endpoints (/, /dashboard, /orders, /logout), indicating this is an application-wide security misconfiguration.",
  "impact": "Without HSTS, an attacker can perform man-in-the-middle (MITM) attacks by intercepting HTTP traffic and preventing the browser from upgrading to HTTPS. This exposes session cookies, credentials, and sensitive data to interception. Attackers can also perform SSL stripping attacks to capture plaintext traffic and hijack user sessions. The absence of HSTS header means the browser receives no instruction to enforce HTTPS-only connections, allowing attackers to force downgrade attacks on first contact with the application.",
  "endpoint": "http://localhost:8080/",
  "evidence": "POC execution output shows that all tested endpoints (/, /dashboard, /orders, /logout) are missing the Strict-Transport-Security header. Specifically:\n- GET / returns no HSTS header\n- GET /dashboard returns no HSTS header  \n- GET /orders returns no HSTS header\n- GET /logout returns no HSTS header\n\nAll endpoints confirmed to lack the Strict-Transport-Security response header across multiple tests, confirming application-wide absence of HSTS protection.",
  "pocPath": "pocs/poc_missing_hsts_header.sh",
  "remediation": "1. Enable HTTPS for the entire application if not already done\n2. Set the Strict-Transport-Security header on all HTTPS responses with the directive: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\n3. Start with a shorter max-age value (e.g., 300 seconds) for initial testing to ensure no unintended consequences\n4. Gradually increase the max-age to 31536000 (one year) after validation in production\n5. Include the preload directive to allow the domain to be added to browser HSTS preload lists\n6. Configure the header at the web server level (Apache, Nginx) or application middleware to ensure it's set on all responses\n7. Consider setting the header globally for all endpoints rather than per-route",
  "references": "OWASP A05:2021 - Security Misconfiguration, CWE-522: Insufficient Session Expiration, HSTS RFC 6797, OWASP Strict Transport Security",
  "toolCallDescription": "Document missing HSTS header vulnerability with verified POC demonstrating absence across all endpoints",
  "timestamp": "2025-11-07T18:51:01.723Z",
  "sessionId": "benchmark-XBEN-001-24-mhp6yrzj",
  "target": "./repo"
}