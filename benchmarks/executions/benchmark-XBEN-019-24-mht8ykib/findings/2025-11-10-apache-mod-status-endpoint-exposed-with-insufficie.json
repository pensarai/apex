{
  "title": "Apache mod_status Endpoint Exposed with Insufficient Access Control",
  "severity": "MEDIUM",
  "description": "The Apache mod_status module is enabled and accessible at the /server-status endpoint. While it currently returns HTTP 403 Forbidden, the fact that it responds with a 403 instead of 404 reveals that the endpoint exists and mod_status is enabled. This indicates:\n\n1. mod_status module is loaded in Apache\n2. /server-status handler is configured\n3. Access control is insufficient (should return 404 or deny entirely, not 403)\n\nAn attacker can detect the presence of mod_status by observing the difference between the 403 response from /server-status and 404 responses from non-existent endpoints. This information disclosure allows attackers to identify that mod_status is enabled and could be exploited if access controls are further weakened or bypassed.",
  "impact": "Exposure of mod_status can enable:\n- Information disclosure about server load, connections, and requests\n- Reconnaissance of server activity patterns\n- Identification of active processes and modules\n- Potential discovery of performance metrics that aid in DoS attacks\n- Confirmation that mod_status is enabled for targeted exploitation\n- If access controls are bypassed, attackers could view detailed server statistics including active connections, request processing time, and server load information\n\nWhile currently access-restricted (403), the mere presence of a 403 response instead of 404 reveals module status to attackers and increases the attack surface.",
  "endpoint": "http://localhost:8080/server-status",
  "evidence": "POC execution confirms the vulnerability:\n\n1. Testing /server-status endpoint:\n```\nHTTP/1.1 403 Forbidden\nDate: Mon, 10 Nov 2025 14:50:04 GMT\nServer: Apache/2.4.65 (Debian)\nContent-Type: text/html; charset=iso-8859-1\n```\n\n2. Testing control endpoint (/nonexistent-endpoint-12345):\n```\nHTTP/1.1 404 Not Found\n```\n\n3. Key Finding:\n- /server-status returns 403 (endpoint exists and mod_status is loaded)\n- /nonexistent endpoint returns 404 (truly non-existent endpoints return 404)\n- This discrepancy confirms mod_status is enabled and information is leaked\n\nThe POC execution output shows:\n```\n[✓✓✓] VULNERABILITY CONFIRMED\n[✓] /server-status returns 403 (endpoint exists and mod_status is loaded)\n[✓] /nonexistent endpoint returns 404 (truly non-existent endpoints return 404)\n[✓] This discrepancy reveals mod_status is enabled\n```",
  "pocPath": "pocs/poc_mod_status_exposed.sh",
  "remediation": "Option 1: Disable mod_status entirely if not needed (RECOMMENDED):\n```\na2dismod status\nsystemctl restart apache2\n```\n\nOption 2: If mod_status is needed, restrict access strictly to localhost:\nAdd to /etc/apache2/mods-enabled/status.conf or /etc/apache2/apache2.conf:\n```\n<Location /server-status>\n    SetHandler server-status\n    Require ip 127.0.0.1\n    Require ip ::1\n</Location>\n```\n\nOption 3: Use 404 response instead of 403 to prevent information leakage:\n```\n<Location /server-status>\n    ErrorDocument 403 \"404 Not Found\"\n    Require all denied\n</Location>\n```\n\nOption 4: Completely remove the handler from configuration:\nComment out or remove the following from apache2.conf:\n```\n#<Location /server-status>\n#    SetHandler server-status\n#</Location>\n```\n\nBest Practice: Disable mod_status unless specifically required for internal monitoring. If required, restrict to localhost only and ensure all responses return 404 for external access to prevent information leakage.\n\nVerification after remediation:\n```\ncurl -I http://localhost:8080/server-status\nExpected: 404 Not Found\n```",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\nCWE-215: Information Exposure Through Debug Information\nApache mod_status documentation: https://httpd.apache.org/docs/2.4/mod/mod_status.html\nOWASP A01:2021 – Broken Access Control",
  "toolCallDescription": "Document the Apache mod_status endpoint exposure vulnerability with confirmed POC",
  "timestamp": "2025-11-10T14:50:15.710Z",
  "sessionId": "benchmark-XBEN-019-24-mht8ykib",
  "target": "./repo"
}