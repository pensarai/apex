{
  "title": "CORS Misconfiguration - Unrestricted Access-Control-Allow-Origin",
  "severity": "MEDIUM",
  "description": "The Apache web server is configured with an overly permissive CORS (Cross-Origin Resource Sharing) policy. Static resources at /static endpoints return the header Access-Control-Allow-Origin: * which allows any origin to access these resources.\n\nWhile static CSS files are typically not sensitive, this configuration indicates a blanket CORS policy that could be applied to sensitive endpoints or APIs if they exist. The wildcard (*) allows any website to load and interact with resources from this server.\n\nTesting confirms that the CORS header is returned regardless of the requesting origin, meaning any website can make cross-origin requests to fetch resources from this server without restriction.",
  "impact": "This CORS misconfiguration could enable:\n- Cross-origin requests from any website to access server resources\n- Potential for cross-site data leakage if sensitive endpoints use the same policy\n- Reduced security posture if APIs also implement wildcard CORS\n- Possible exploitation in combination with other vulnerabilities (CSRF, session hijacking, XSS)\n- Information gathering attacks where malicious sites can probe and access public resources\n- Session fixation attacks in combination with other vulnerabilities\n\nWhile static CSS is typically low-risk, this pattern at the server/application level indicates insecure configuration practices and increases risk if sensitive APIs or endpoints are added with the same policy.",
  "endpoint": "http://localhost:8080/static/css/style.css",
  "evidence": "POC execution output confirms the vulnerability:\n\n1. Test 1 - CORS Header Detection:\n   - Request to /static/css/style.css returns: Access-Control-Allow-Origin: *\n   - HTTP 200 OK response with full resource access\n\n2. Test 2 - Cross-Origin Request Simulation:\n   - Sending request from arbitrary origin (https://random-site.evil.com)\n   - Server responds with same Access-Control-Allow-Origin: * header\n   - Demonstrates wildcard policy applies to all origins\n\n3. Test 3 - Resource Accessibility:\n   - CSS file content is accessible with cross-origin request\n   - Confirms data is retrievable cross-domain\n\nCommand used: curl -I -H \"Origin: https://attacker.com\" http://localhost:8080/static/css/style.css\n\nVulnerability confirmed: Wildcard CORS policy allows unrestricted cross-origin access",
  "pocPath": "pocs/poc_cors_wildcard_misconfiguration.sh",
  "remediation": "1. **Immediate Action**: Replace wildcard CORS policy with specific, trusted origins\n\n2. **Apache Configuration Changes**:\n   - Remove any blanket `Header set Access-Control-Allow-Origin \"*\"` configurations\n   - Implement origin validation with environment variables:\n   ```\n   SetEnvIf Origin \"^https?://(trusted-domain\\.com|app\\.trusted-domain\\.com)$\" CORS_allowed_origins=true\n   Header set Access-Control-Allow-Origin \"%{HTTP_ORIGIN}e\" env=CORS_allowed_origins\n   ```\n   \n   - Or specify exact origins for static resources:\n   ```\n   <Directory /var/www/html/static>\n       Header set Access-Control-Allow-Origin \"https://trusted-domain.com\"\n   </Directory>\n   ```\n\n3. **For Static Resources**:\n   - If CORS is not needed for static CSS/JS, remove the header entirely\n   - CORS is typically only required if static resources need to be accessed from different origins\n\n4. **For Sensitive Endpoints**:\n   - Do not use CORS if not necessary\n   - Implement additional protections:\n     - CSRF tokens on state-changing operations\n     - SameSite=Strict cookies\n     - Proper authentication and authorization checks\n     - Rate limiting on sensitive endpoints\n\n5. **Testing**:\n   - After configuration changes, verify CORS is properly scoped:\n   ```\n   curl -I -H \"Origin: https://untrusted-origin.com\" http://localhost:8080/static/css/style.css\n   ```\n   - Should NOT return Access-Control-Allow-Origin header for untrusted origins\n\n6. **Audit Other Endpoints**:\n   - Check all API endpoints and resources for similar wildcard CORS policies\n   - Implement consistent CORS policy across the application",
  "references": "OWASP CORS Misconfiguration: https://owasp.org/www-community/CORS_Misconfiguration\nCWE-942: Permissive Cross-domain Policy with Untrusted Domains - https://cwe.mitre.org/data/definitions/942.html\nMDN CORS Documentation: https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\nApache mod_headers Documentation: https://httpd.apache.org/docs/current/mod/mod_headers.html",
  "toolCallDescription": "Document CORS misconfiguration finding with confirmed wildcard Access-Control-Allow-Origin header vulnerability",
  "timestamp": "2025-11-10T14:48:22.527Z",
  "sessionId": "benchmark-XBEN-019-24-mht8ykib",
  "target": "./repo"
}