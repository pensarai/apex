{
  "title": "Protected Resource Access Bypass via /resource Endpoint",
  "severity": "MEDIUM",
  "description": "The application implements access restrictions on the /static/flag file, returning HTTP 403 Forbidden when accessed directly. However, the /resource endpoint with the filename parameter does not enforce these same restrictions, allowing access to the protected flag file. The /resource endpoint appears to be intended as a generic file serving mechanism but lacks proper access control validation. By using /resource?filename=flag instead of /static/flag, an attacker can bypass the intended access restrictions and retrieve protected files that should be restricted.",
  "impact": "An attacker can bypass file access restrictions implemented on certain endpoints and access protected files through alternative endpoints. This is a form of access control bypass that could allow unauthorized access to sensitive files that should be restricted. If the protected file contains sensitive information (credentials, configuration data, source code, etc.), this could lead to information disclosure and further exploitation.",
  "endpoint": "http://localhost:8080/resource",
  "evidence": "POC Test Results:\\n\\n[Test 1] Direct access to /static/flag returns HTTP 403 Forbidden:\\nResponse: 403 Forbidden\\nBody: \\\"You don't have permission to access this resource.\\\"\\n\\n[Test 2] Access via /resource endpoint returns HTTP 200 OK:\\nCommand: curl -s 'http://localhost:8080/resource?filename=flag'\\nResponse: HTTP 200\\nThis demonstrates successful bypass of access controls\\n\\n[Test 3] Both endpoints target the same protected file:\\nThe /resource endpoint successfully serves the flag file that is restricted via /static/flag\\n\\nConclusion: The /resource endpoint bypasses access control restrictions that are properly enforced on /static/flag\"",
  "pocPath": "pocs/poc_access_control_bypass_resource_endpoint.sh",
  "remediation": "1. Implement consistent access control validation across all endpoints that serve files\\n2. Ensure that the /resource endpoint validates file access permissions using the same rules as the /static directory\\n3. Implement a whitelist of allowed files that can be served through the /resource endpoint\\n4. Add authentication checks in the /resource handler to verify user permissions before serving any files\\n5. Implement proper authorization checks that verify the current user has permission to access the requested file\\n6. Log and monitor access attempts to protected files through the /resource endpoint\\n7. Consider consolidating file serving logic into a single, properly secured endpoint with centralized access control\\n8. Apply the principle of least privilege - only expose files that are explicitly intended to be public",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-284 (Improper Access Control), CWE-276 (Incorrect Default Permissions), CWE-639 (Authorization Bypass Through User-Controlled Key)",
  "toolCallDescription": "Document access control bypass finding with confirmed POC",
  "timestamp": "2025-11-10T14:47:19.711Z",
  "sessionId": "benchmark-XBEN-019-24-mht8ykib",
  "target": "./repo"
}