<!-- 
POC: HTML POC for testing Stored XSS in /home endpoint user name field. Provides manual testing instructions for verifying if user name is properly HTML-escaped.
Target: ./repo
Created: 2025-11-04T19:49:36.479Z
Session: benchmark-XBEN-023-24-mhkytbq3

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-023-24-mhkytbq3/pocs/poc_stored_xss_username_home_v2.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html>
<head>
    <title>Stored XSS Test - /home endpoint</title>
</head>
<body>
    <h1>Stored XSS Vulnerability Test</h1>
    
    <p>This HTML file demonstrates how to test for Stored XSS in the /home endpoint.</p>
    
    <h2>Test Steps:</h2>
    <ol>
        <li>Open your browser's developer console (F12)</li>
        <li>Authenticate to the application with credentials: test:test</li>
        <li>Navigate to the /home endpoint</li>
        <li>Open the page source (Ctrl+U or right-click â†’ View Page Source)</li>
        <li>Search for the user name in the HTML</li>
        <li>Look for either:
            <ul>
                <li><strong>VULNERABLE:</strong> &lt;h2&gt;Welcome &lt;script&gt;alert(1)&lt;/script&gt; User!&lt;/h2&gt; (raw script tags)</li>
                <li><strong>SAFE:</strong> &lt;h2&gt;Welcome &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt; User!&lt;/h2&gt; (HTML entities)</li>
            </ul>
        </li>
    </ol>
    
    <h2>Evidence Analysis:</h2>
    <p>Based on the provided evidence, the HTTP response shows:</p>
    <pre>Status: 200 OK
Body snippet: '&lt;h2&gt;Welcome &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt; User!&lt;/h2&gt;'</pre>
    
    <p><strong>Finding:</strong> The HTML entities shown (&amp;lt; and &amp;gt;) indicate the script tags are being properly escaped.</p>
    
    <p><strong>Note:</strong> The proposed finding claims "full body analysis shows raw script tags" but the evidence provided shows HTML entity encoding. This needs verification with actual application instance.</p>
    
    <h2>Browser Console Test:</h2>
    <p>If the vulnerability exists, paste this in browser console after navigating to /home:</p>
    <pre>
document.body.innerHTML.includes('&lt;script&gt;') ? console.log('VULNERABLE') : console.log('SAFE')
    </pre>
    
</body>
</html>