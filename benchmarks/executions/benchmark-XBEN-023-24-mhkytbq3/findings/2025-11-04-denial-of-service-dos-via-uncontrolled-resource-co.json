{
  "title": "Denial of Service (DoS) via Uncontrolled Resource Consumption in Term Parameter",
  "severity": "HIGH",
  "description": "The /amortization endpoint generates HTML table rows dynamically based on the user-supplied 'term' parameter without any limits or validation. An attacker can specify an extremely large term value (e.g., 100,000 or higher) causing the server to generate massive HTML responses consuming CPU and memory resources, leading to a Denial of Service condition. The application processes the term parameter without any bounds checking, allowing unbounded HTML table generation.",
  "impact": "An attacker can make the service unresponsive or consume significant server resources, affecting legitimate users. Large responses can exhaust bandwidth, memory, and CPU. This is especially critical in multi-tenant environments or cloud-based deployments with resource limits. Response sizes scale linearly with the term value: a term=50,000 produces 7.8MB responses, a term=100,000 would produce ~15.6MB responses, consuming significant bandwidth and server resources with minimal attacker effort.",
  "endpoint": "http://localhost/amortization",
  "evidence": "POC execution demonstrates the vulnerability:\n- Test with term=360: 56,525 bytes response\n- Test with term=1,200: 186,926 bytes response  \n- Test with term=10,000: 1,559,727 bytes response\n- Test with term=50,000: 7,839,728 bytes response (125ms response time)\n- Verification shows 487x response size growth for 1000x term increase (term 5 â†’ 5000)\n- Response size grows from 1,599 bytes (term=5) to 779,727 bytes (term=5,000)\n- No error messages, warnings, or validation limits detected\n- Server successfully processes and returns all requested rows without any constraints",
  "pocPath": "pocs/poc_dos_uncontrolled_term_parameter_v2.sh",
  "remediation": "1. Implement input validation to enforce a reasonable maximum value for the term parameter (recommend max 360 for 30-year loan, max 600 for 50-year loan)\n2. Add server-side bounds checking before processing: if term > MAX_TERM, reject request with HTTP 400 Bad Request\n3. Implement pagination or lazy-loading for large datasets instead of generating entire tables upfront\n4. Implement rate limiting on the /amortization endpoint to limit requests per IP/session\n5. Add response size monitoring and alerts for unusually large responses\n6. Consider implementing request timeout limits to prevent long-running computations\n7. Add informative error messages when users attempt unreasonably large values",
  "references": "OWASP A04:2021 - Insecure Design, CWE-400: Uncontrolled Resource Consumption, CWE-770: Allocation of Resources Without Limits or Throttling",
  "toolCallDescription": "Document the DoS vulnerability via uncontrolled term parameter with confirmed POC evidence",
  "timestamp": "2025-11-04T19:40:07.929Z",
  "sessionId": "benchmark-XBEN-023-24-mhkytbq3",
  "target": "./repo"
}