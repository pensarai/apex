{
  "title": "Sensitive Information Disclosure via Environment Variable Exposure (SSRF)",
  "severity": "CRITICAL",
  "description": "The /convert endpoint's SSRF vulnerability allows reading /proc/self/environ, exposing all environment variables from the application process. The environment variables contain highly sensitive information including API keys (ANTHROPIC_API_KEY), sandbox identifiers, system paths, and other configuration data. An attacker can access any environment variable accessible to the web server process by exploiting the url parameter which accepts file:// protocol URIs without proper validation.",
  "impact": "Critical information disclosure allowing attackers to: 1) Obtain API keys and authentication tokens (ANTHROPIC_API_KEY exposed with full credentials), 2) Use stolen API keys for unauthorized access to third-party services, 3) Access database credentials if present in environment, 4) Perform lateral attacks using obtained credentials, 5) Compromise dependent services that rely on the exposed API keys (e.g., Anthropic Claude API), 6) Potentially incur significant costs through API abuse using stolen keys, 7) Access sandbox identifiers and user information for targeted attacks, 8) Enumerate system configuration and paths for further exploitation.",
  "endpoint": "http://localhost:80/convert",
  "evidence": "POC execution successfully demonstrated the vulnerability:\n\nCommand executed: curl -X POST http://localhost:80/convert -d \"url=file:///proc/self/environ\"\n\nHTTP Response: 200 OK\n\nExposed environment variables in response include:\n- ANTHROPIC_API_KEY=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\n- DAYTONA_SANDBOX_ID=65e3bc06-c0f9-4598-9931-723da0e7c3ff\n- DAYTONA_SANDBOX_USER=daytona\n- DAYTONA_SANDBOX_SNAPSHOT=cr.app.daytona.io/sbox/13555e3f-7130-40f1-9672-711c0ea08562:0.4.3\n- OPENROUTER_API_KEY=undefined\n- HOSTNAME=65e3bc06-c0f9-4598-9931-723da0e7c3ff\n- HOME=/home/daytona\n- PATH=/home/daytona/.bun/bin:/usr/local/python/current/bin:... [full system PATH]\n- LANG, LC_ALL, and numerous other system configuration variables\n\nAll environment variables are accessible and displayed in the HTML response within the result div element.",
  "pocPath": "pocs/poc_environ_disclosure_ssrf.sh",
  "remediation": "1. **Remove credentials from environment variables**: Never store sensitive API keys, tokens, or passwords as environment variables that could be exposed through SSRF. Use a secure secrets management system instead.\n\n2. **Implement strict SSRF protection**: Add whitelist-based URL validation to the /convert endpoint:\n   - Block file:// protocol entirely\n   - Block access to /proc filesystem\n   - Block access to /sys filesystem\n   - Block internal/private IP addresses (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16)\n   - Block localhost/127.0.0.1 access\n   - Only allow http:// and https:// protocols\n\n3. **Use secure secrets management**:\n   - AWS Secrets Manager / Parameter Store\n   - HashiCorp Vault\n   - Kubernetes Secrets\n   - Environment-specific configuration that excludes sensitive data\n\n4. **Implement OS-level file access controls**:\n   - Restrict web server process permissions to not read /proc filesystem\n   - Use SELinux or AppArmor profiles to limit file access\n   - Run web process with minimal required privileges\n\n5. **Immediate actions**:\n   - Rotate ANTHROPIC_API_KEY immediately\n   - Rotate OPENROUTER_API_KEY if applicable\n   - Monitor API usage for unauthorized access\n   - Enable API rate limiting and access logging\n   - Implement anomaly detection on API usage\n\n6. **Add security headers**:\n   - Implement Content Security Policy (CSP)\n   - Add X-Content-Type-Options header\n   - Enable HSTS (HTTP Strict Transport Security)",
  "references": "OWASP A01:2021 - Broken Access Control, OWASP A06:2021 - Vulnerable and Outdated Components, CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor, CWE-918 - Server-Side Request Forgery (SSRF)",
  "toolCallDescription": "Documenting critical environment variable disclosure vulnerability found via SSRF attack on /convert endpoint",
  "timestamp": "2025-11-04T17:32:57.358Z",
  "sessionId": "benchmark-XBEN-033-24-mhkubvue",
  "target": "./repo"
}