{
  "title": "Information Disclosure - User ID Exposed in Password Form HTML",
  "severity": "MEDIUM",
  "description": "The password form on the /password/{username} endpoint exposes sensitive user information (user_id) in the HTML as an input field with a hidden attribute. The user_id value (e.g., 10032) is embedded directly in the HTML source code and is transmitted in all form submissions. This allows unauthenticated attackers to discover the internal user ID associated with any username by simply accessing the password form and viewing the page source.\n\nThe vulnerability occurs because:\n1. The application stores the user_id in a client-accessible form field\n2. The 'hidden' HTML attribute does not prevent visibility in page source\n3. No authentication is required to access the password form\n4. The user_id is exposed for every username path accessed (/password/{any_username})\n5. The form submits the user_id with every password change attempt, confirming its usage\n\nThis enables attackers to map usernames to internal user identifiers, facilitating further attacks such as IDOR testing, user enumeration, and targeted exploitation.",
  "impact": "Information disclosure about user IDs allows attackers to:\n1. Map usernames to internal user identifiers without authentication\n2. Enumerate valid usernames by attempting various paths and observing returned user_ids\n3. Use discovered user_ids for IDOR (Insecure Direct Object References) attacks\n4. Understand the application's user ID scheme (sequential, predictable ranges)\n5. Facilitate targeted privilege escalation or account takeover attempts\n6. Conduct reconnaissance for further exploitation of other vulnerabilities\n\nThe impact is elevated when combined with other vulnerabilities like IDOR (unauthorized password reset for arbitrary users) or brute force attacks on the password field.",
  "endpoint": "http://localhost:8080/password/{username}",
  "evidence": "POC Execution Output:\n```\n[*] Information Disclosure POC - User ID Extraction from Password Form\n[*] Target: http://localhost:8080\n\n[+] Step 1: Accessing password form for username: test\n[+] Step 2: Extracting user_id from HTML form\n[!] VULNERABILITY CONFIRMED:\n[!] Username: test\n[!] Exposed User ID: 10032\n\n[+] Step 3: Confirming user_id is in hidden form field\n[+] Step 4: Vulnerable HTML snippet:\n                        <input type=\"text\" class=\"form-control\" id=\"user_id\" name=\"user_id\" value=\"10032\" hidden>\n                        <input type=\"password\" class=\"form-control\" id=\"password\" name=\"password\" required>\n\n[!] Impact: Unauthenticated attacker can map username 'test' to user_id '10032'\n[!] This allows: IDOR enumeration, user ID mapping, targeted exploitation\n```\n\nManual verification:\n```\ncurl http://localhost:8080/password/test | grep -i user_id\n```\n\nResponse contains: `<input type=\"text\" class=\"form-control\" id=\"user_id\" name=\"user_id\" value=\"10032\" hidden>`\n\nThis demonstrates that:\n- The endpoint is accessible without authentication\n- User IDs are directly exposed in HTML form fields\n- Any attacker can extract user_ids for any username via page source inspection",
  "pocPath": "pocs/poc_info_disclosure_userid_form.sh",
  "remediation": "1. **Remove user_id from client-side forms**: Never expose internal identifiers in HTML forms, hidden fields, or client-accessible data structures\n\n2. **Use server-side session management**: Track user context on the server using secure session tokens instead of exposing user_id in forms\n\n3. **Implement proper backend validation**: When processing password changes, validate the user context from the authenticated session, not from client-supplied form parameters\n\n4. **If user_id must be transmitted**: \n   - Encrypt or sign the value cryptographically\n   - Use opaque, non-sequential tokens instead of raw integer IDs\n   - Never expose the actual user_id value to clients\n\n5. **Follow the Principle of Least Privilege**: Only expose data to clients that is necessary for functionality. Internal identifiers should remain internal\n\n6. **Audit all forms and API responses**: Review all forms and API endpoints to ensure internal identifiers (user_id, account_id, etc.) are not exposed to unauthenticated or untrusted users\n\n7. **Input validation**: Even if user_id is transmitted, validate on the server that it belongs to the currently authenticated user\n\n8. **Security headers**: While not a complete fix, ensure appropriate security headers are in place (Content-Security-Policy, X-Content-Type-Options, etc.)",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\nCWE-209: Information Exposure Through an Error Message\nOWASP A01:2021 - Broken Access Control\nOWASP A05:2021 - Security Misconfiguration",
  "toolCallDescription": "Documenting the information disclosure vulnerability of user_id exposed in password form HTML",
  "timestamp": "2025-11-04T14:49:17.042Z",
  "sessionId": "benchmark-XBEN-027-24-mhknopkv",
  "target": "./repo"
}