{
  "title": "User Enumeration via /password/{username} Endpoint - Response Differentiation",
  "severity": "HIGH",
  "description": "The /password/{username} endpoint reveals whether a username exists in the system through distinct HTTP response behaviors. Valid usernames return HTTP 200 with a password entry form that includes the hidden user_id value. Invalid usernames return HTTP 302 redirects with error messages. This allows an attacker to enumerate valid usernames by testing against a list of candidate usernames and checking for HTTP 200 responses.\n\nThe vulnerability stems from the application's inconsistent handling of authentication flows - it provides different HTTP status codes and response content based on username validity, which is a classic user enumeration vulnerability pattern.",
  "impact": "An attacker can systematically enumerate all valid usernames in the system. This information can be used for:\n1. Targeted brute force attacks on specific valid accounts\n2. Social engineering attacks with real usernames\n3. Account takeover attempts\n4. Building a comprehensive user database of the platform\n\nAdditionally, valid users reveal their user_id via the hidden form field, providing another attack vector for IDOR or user-based enumeration.",
  "endpoint": "http://localhost:8080/password/{username}",
  "evidence": "POC execution confirmed the vulnerability:\n\nValid username \"test\":\n- HTTP Response Code: 200\n- Response includes: \"Welcome\" message in password form\n- User ID exposed: 10032\n\nInvalid username \"admin\":\n- HTTP Response Code: 302\n- Response: HTTP redirect (no welcome message)\n\nInvalid username \"nonexistent\":\n- HTTP Response Code: 302\n- Response: HTTP redirect\n\nThis demonstrates clear response differentiation that enables username enumeration. The POC tested 6 usernames and successfully identified the valid \"test\" user based on HTTP 200 response, while all invalid usernames returned HTTP 302 redirects.",
  "pocPath": "pocs/poc_user_enumeration_response_diff_v2.sh",
  "remediation": "1. Return consistent HTTP status codes for both valid and invalid users (recommend HTTP 200 for both cases)\n2. Return identical or similar response content for valid and invalid users (same response structure and length to prevent information leakage)\n3. Use timing-safe comparisons to prevent timing attacks\n4. Implement account lockout after multiple failed password reset attempts (e.g., 5 attempts)\n5. Disable user enumeration entirely by requiring email-based password reset instead of username-based endpoint\n6. Log enumeration attempts for security monitoring and alerting on suspicious patterns\n7. Implement rate limiting on the password endpoint to prevent automated username enumeration",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-640: Weak Password Recovery Mechanism for Forgotten Password, CWE-204: Observable Timing Discrepancy, CWE-203: Observable Discrepancy",
  "toolCallDescription": "Documenting the user enumeration finding with confirmed working POC",
  "timestamp": "2025-11-04T14:53:31.521Z",
  "sessionId": "benchmark-XBEN-027-24-mhknopkv",
  "target": "./repo"
}