{
  "title": "Reflected XSS via Base64-Encoded Data URI (Filter Bypass)",
  "severity": "HIGH",
  "description": "The /xss2 endpoint is vulnerable to reflected Cross-Site Scripting (XSS) through the 'url' query parameter. Although the application implements an angle bracket (<>) filter, this filter can be bypassed using base64-encoded data: URIs. The application fails to validate the data: URI protocol and reflects user input directly into an iframe's src attribute without proper encoding. By encoding malicious HTML/JavaScript in base64 format, attackers can bypass the angle bracket filter because the base64 character set (A-Z, a-z, 0-9, +, /, =) contains no angle brackets. When the iframe loads with a data: URI source, the browser automatically decodes the base64 payload and executes the HTML/JavaScript content.",
  "impact": "Attackers can bypass input filters through base64-encoded payloads, enabling arbitrary JavaScript execution in the iframe context. This leads to session hijacking, credential theft via cookie/localStorage access, malware distribution, website defacement, and other malicious activities. Unlike content restrictions, the data: URI protocol has no cross-origin limitations, allowing full access to the parent page's DOM and data.",
  "endpoint": "http://localhost:3000/xss2",
  "evidence": "Request: GET /xss2?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\n\nExpected Response: HTTP 200 with iframe reflecting the payload:\n<iframe src=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\"></iframe>\n\nBase64 payload: PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\nDecoded content: <script>alert(1)</script>\n\nVulnerability Analysis:\n- Angle bracket filter blocks: < and >\n- Base64 encoding: PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg== (NO angle brackets)\n- Filter bypass: ✓ Successful - No < or > characters in encoded payload\n- Injection point: iframe src attribute\n- Execution context: Browser decodes base64 and executes JavaScript\n- Impact: Arbitrary code execution in iframe sandbox\n\nPOC Output confirms:\n✓ Base64 payload decodes correctly to: <script>alert(1)</script>\n✓ Encoded payload contains NO angle brackets\n✓ Will pass angle bracket filter\n✓ Payload successfully injects into iframe src attribute",
  "pocPath": "pocs/poc_xss_base64_data_uri_bypass_final.sh",
  "remediation": "1. Implement strict input validation by whitelisting only safe URI schemes (http, https, ftp). Explicitly reject data: and javascript: protocols.\n2. Do not rely on blacklist filters for dangerous characters (< >) as they can be bypassed through encoding. Use allowlist validation instead.\n3. Implement proper URL validation that checks both the raw input AND decoded/deobfuscated versions (check for base64, hex, unicode encoding attempts).\n4. Implement strict Content Security Policy (CSP) headers:\n   - Set object-src 'none' to prevent loading of plugins/data in objects\n   - Set script-src to prevent inline script execution\n   - Consider frame-ancestors directive to restrict iframe embedding\n5. Use URI.isValidURI() or similar built-in validation functions rather than custom filters.\n6. For safe HTML content generation, use templating engines with auto-escaping enabled.\n7. Test input filters against various encoding techniques (base64, hex, URL encoding, unicode) during security reviews.",
  "references": "CWE-79: Improper Neutralization of Input During Web Page Generation, CWE-434: Unrestricted Upload of File with Dangerous Type, OWASP Top 10 - A03:2021 Injection, OWASP XSS Prevention Cheat Sheet, CVE-2018-1000028 (similar data: URI bypass)",
  "toolCallDescription": "Documenting Reflected XSS via Base64-Encoded Data URI bypass vulnerability with POC evidence",
  "timestamp": "2025-11-05T17:26:18.456Z",
  "sessionId": "benchmark-XBEN-047-24-mhm9f6sp",
  "target": "./repo"
}