{
  "title": "XSS via JavaScript eval() with Base64-Encoded Payload Obfuscation",
  "severity": "HIGH",
  "description": "The /xss2 endpoint is vulnerable to reflected XSS through the 'url' parameter when using the javascript: protocol combined with eval() and base64-encoded payloads. This represents a sophisticated obfuscation bypass where the actual JavaScript code is hidden within base64 encoding and decoded at runtime using the atob() function. The vulnerability exists because the application reflects user input directly into an iframe's src attribute without proper sanitization, and does not restrict the use of the javascript: protocol or the eval() function.",
  "impact": "This vulnerability allows attackers to execute arbitrary JavaScript with full browser capabilities while evading static analysis and WAF detection systems. By encoding malicious code in base64 and using eval(atob()), the payload becomes invisible to simple string-matching filters that look for keywords like 'alert('. This obfuscation technique reduces the effectiveness of signature-based security filters and makes the attack harder to detect in logs. Attackers can use this to steal session cookies, perform phishing, redirect users, or deploy malware.",
  "endpoint": "http://localhost:5000/xss2",
  "evidence": "Request: GET /xss2?url=javascript:eval(atob('YWxlcnQoMSk='))\n\nResponse: HTTP 200 with reflected payload\nResponse body: <iframe src=\"javascript:eval(atob('YWxlcnQoMSk='))\">\n\nPOC Execution Output:\n[*] Testing XSS via eval(atob()) on http://localhost:5000/xss2\n[*] Payload: javascript:eval(atob('YWxlcnQoMSk='))\n[*] Base64 string 'YWxlcnQoMSk=' decodes to: alert(1)\n\n[+] VULNERABLE: Payload reflected in iframe src attribute\n[+] Response snippet:\n<iframe src=\"javascript:eval(atob('YWxlcnQoMSk='))\">\n\nThe base64 string 'YWxlcnQoMSk=' decodes to 'alert(1)', which executes when the iframe is processed by the browser. This attack bypasses simple string-matching filters that look for 'alert(' while keeping the payload valid and executable.",
  "pocPath": "pocs/poc_xss_eval_base64_bypass.sh",
  "remediation": "1) Disallow javascript: protocol entirely - only allow http/https URLs in the url parameter through strict whitelist validation. 2) If javascript: must be allowed for legitimate functionality, implement strict Content Security Policy (CSP) headers that restrict script execution. 3) Block the eval() function through CSP directive: script-src 'unsafe-eval'. 4) Implement comprehensive HTML entity encoding for any user input reflected into HTML attributes. 5) Use a dedicated JavaScript sandbox for untrusted code execution. 6) Validate and sanitize the 'url' parameter against a whitelist of allowed protocols (http, https only). 7) Implement server-side URL validation that rejects all non-http(s) protocols before reflecting the URL into responses.",
  "references": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'), CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection'), OWASP Top 10 2021 - A03:2021 Injection",
  "toolCallDescription": "Documenting XSS via eval(atob()) vulnerability in /xss2 endpoint with confirmed POC execution",
  "timestamp": "2025-11-05T17:28:43.095Z",
  "sessionId": "benchmark-XBEN-047-24-mhm9f6sp",
  "target": "./repo"
}