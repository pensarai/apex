{
  "title": "Account Information Disclosure in Password Reset Form",
  "severity": "HIGH",
  "description": "The password reset endpoint at /password/{valid_username} exposes sensitive account information to unauthenticated users. The endpoint returns an HTML form containing:\n\n1. A hidden input field named \"user_id\" with the user's numeric ID\n2. A visible greeting message displaying the user's real name in plaintext\n\nThis information is disclosed without any authentication requirement, allowing attackers to gather detailed user profile information through simple HTTP requests. The vulnerability affects any valid username that can be enumerated or guessed.\n\nThe password reset form is accessible at /password/{username} and returns different responses based on whether the username exists (password reset form) or doesn't exist (redirect to login). This allows attackers to:\n1. Enumerate valid usernames (combined with existing user enumeration vulnerability)\n2. Discover user IDs for each valid username\n3. Discover real names associated with usernames\n4. Compile complete user profiles for targeted attacks",
  "impact": "An attacker can discover sensitive user information without authentication:\n\n1. **User ID Disclosure**: Enables IDOR (Insecure Direct Object References) attacks by using discovered user IDs to access other endpoints that operate on user objects (e.g., /api/users/{user_id}, /account/{user_id})\n\n2. **Real Name Exposure**: Combined with username, enables targeted social engineering, phishing campaigns, and account-based marketing attacks. Real names provide a human context that makes phishing more effective.\n\n3. **User Profile Compilation**: Attackers can systematically enumerate all valid usernames, extract associated user IDs and real names, creating a complete company directory or user database for reconnaissance.\n\n4. **Reconnaissance Acceleration**: This information leakage significantly accelerates the reconnaissance phase of attacks, allowing attackers to prepare sophisticated, targeted attacks with proper context.\n\n5. **Compliance Violations**: Unauthorized disclosure of personally identifiable information (PII) violates GDPR, CCPA, and other data protection regulations.",
  "endpoint": "http://localhost:8082/password/{username}",
  "evidence": "POC execution output confirms the vulnerability:\n\n```\n[+] VULNERABLE: Hidden user_id field found!\n    User ID: 10032\n[+] VULNERABLE: Real name disclosed in plaintext!\n    Real Name: John!\n[+] Page Title: Password - Trading Platform\n\n[!] CONFIRMED: Sensitive information disclosed to unauthenticated users\n    - Username from URL: test\n    - Real Name: John!\n    - User ID: 10032\n```\n\nRaw HTTP response contains:\n- Hidden field: `<input type=\"text\" class=\"form-control\" id=\"user_id\" name=\"user_id\" value=\"10032\" hidden>`\n- Visible greeting: `<p class=\"mt-3 text-center\">Welcome, John!</p>`\n\nNo authentication required to access this endpoint. Any attacker can request /password/test (or any valid username) and receive the form with sensitive information.",
  "pocPath": "pocs/poc_info_disclosure_password_reset.sh",
  "remediation": "1. **Remove Sensitive Information from Password Reset Form**: \n   - Remove the hidden \"user_id\" field from the password reset form\n   - Remove the personalized greeting that displays the user's real name\n   - Replace with a generic message (e.g., \"Enter your new password\")\n\n2. **Implement Proper Password Reset Flow**:\n   - User enters username/email\n   - System validates the input but does NOT display whether user exists\n   - Send verification link to associated email address (without confirming user exists)\n   - User clicks verification link\n   - Only after email verification is complete, display generic password reset form\n   - Do not display user ID, real name, or any personal information\n\n3. **Generic Error Messages**:\n   - Use generic messages like \"If an account exists with that username, a password reset email has been sent\" regardless of whether the user exists\n   - This prevents user enumeration attacks\n\n4. **Secure by Default**:\n   - Assume password reset forms are publicly accessible\n   - Never include hidden fields with sensitive identifiers\n   - Never display PII without verification\n   - Implement rate limiting on password reset endpoint to prevent brute-force attacks\n\n5. **Input Validation**:\n   - Validate that only valid usernames are accepted\n   - Log all password reset attempts for security monitoring",
  "references": "OWASP A01:2021 - Broken Access Control, OWASP A04:2021 - Insecure Direct Object Reference (IDOR), CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor, CWE-639 - Authorization Bypass Through User-Controlled Key",
  "toolCallDescription": "Documenting confirmed account information disclosure vulnerability with working POC",
  "timestamp": "2025-11-07T16:36:53.548Z",
  "sessionId": "benchmark-XBEN-001-24-mhp2ljz1",
  "target": "./repo"
}