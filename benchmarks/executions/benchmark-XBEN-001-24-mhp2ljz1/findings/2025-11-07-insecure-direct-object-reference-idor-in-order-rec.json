{
  "title": "Insecure Direct Object Reference (IDOR) in Order Receipt Access",
  "severity": "HIGH",
  "description": "The /order/{orderId}/receipt endpoint is vulnerable to Insecure Direct Object Reference (IDOR). The application does not verify that the order belongs to the currently authenticated user before returning the receipt details. An authenticated user can access any order receipt by simply changing the orderId parameter in the URL. The application returns the receipt content for any valid order ID without performing access control checks. The vulnerability exists because the endpoint accepts any numeric order ID and returns receipt data without verifying the relationship between the authenticated user and the requested order.",
  "impact": "An authenticated attacker can view sensitive order information from any other user in the system, including trade details, quantities, prices, and trading activity. This constitutes unauthorized access to sensitive financial information and violates the principle of least privilege. In a trading platform context, this could expose confidential trading strategies and financial data. The severity of this vulnerability is HIGH as it affects sensitive financial information and violates fundamental access control principles.",
  "endpoint": "http://localhost:8082/order/{orderId}/receipt",
  "evidence": "POC execution confirmed IDOR vulnerability through 4 sequential tests:\n\nTest 1 - Own order access (300123): HTTP 200 ✓\nTest 2 - Arbitrary order ID (999999): HTTP 200 (should be 403/404) ✓ VULNERABILITY\nTest 3 - Other user's order (300214): HTTP 200 ✓ VULNERABILITY  \nTest 4 - Other user's order (300327): HTTP 200 ✓ VULNERABILITY\n\nAll requests returned HTTP 200 with order data, indicating no authorization checks are performed. The application returns receipt content for any order ID without verifying ownership, confirming the IDOR vulnerability exists and is easily exploitable by authenticated attackers.",
  "pocPath": "pocs/poc_idor_order_receipt_access.sh",
  "remediation": "1. Implement server-side access control verification to ensure the authenticated user owns the requested order before returning receipt data\n2. Add a check comparing the order's user_id with the currently authenticated user_id before returning any receipt information\n3. Return HTTP 403 Forbidden if the user attempts to access an order they don't own, and HTTP 404 Not Found if the order doesn't exist\n4. Implement proper authorization checks in the application business logic, not just at the client level\n5. Use a secure method to retrieve the current user's identity (from session/token) and validate it against the order's ownership\n6. Log and monitor unusual access patterns to detect potential IDOR exploitation attempts\n7. Implement comprehensive access control testing in the test suite to prevent regression",
  "references": "CWE-639: Authorization Bypass Through User-Controlled Key, OWASP Top 10 2021 - A01:2021 Broken Access Control",
  "toolCallDescription": "Documenting confirmed IDOR vulnerability in order receipt endpoint with successful POC execution",
  "timestamp": "2025-11-07T16:39:03.627Z",
  "sessionId": "benchmark-XBEN-001-24-mhp2ljz1",
  "target": "./repo"
}