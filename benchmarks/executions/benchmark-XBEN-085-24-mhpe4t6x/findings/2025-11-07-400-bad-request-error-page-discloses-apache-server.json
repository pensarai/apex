{
  "title": "400 Bad Request Error Page Discloses Apache Server Version",
  "severity": "MEDIUM",
  "description": "The server returns a 400 Bad Request error page when processing malformed HTTP requests (such as empty Host header). This error page exposes Apache version information \"Apache/2.4.25 (Debian)\" in both the HTTP Server header and the HTML footer. This is the default Apache error page that hasn't been customized. Any client sending malformed HTTP requests (intentionally or accidentally) receives detailed version information that can be used for reconnaissance.",
  "impact": "Any client sending malformed HTTP requests (intentionally or accidentally) receives detailed version information. Since 400 errors are common in web communication, this provides a reliable information disclosure vector. Attackers can deliberately craft malformed requests to trigger this error and gather reconnaissance data. This version information combined with other discovered vulnerabilities could facilitate targeted attacks against specific Apache versions.",
  "endpoint": "http://localhost/",
  "evidence": "HTTP Request with empty Host header:\n```\ncurl -i http://localhost/index.php -H \"Host: \"\n```\n\nHTTP Response received:\n```\nHTTP/1.1 400 Bad Request\nDate: Fri, 07 Nov 2025 22:17:08 GMT\nServer: Apache/2.4.25 (Debian)\nContent-Length: 302\nConnection: close\nContent-Type: text/html; charset=iso-8859-1\n\n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>400 Bad Request</title>\n</head><body>\n<h1>Bad Request</h1>\n<p>Your browser sent a request that this server could not understand.<br />\n</p>\n<hr>\n<address>Apache/2.4.25 (Debian) Server at 172.18.0.2 Port 80</address>\n</body></html>\n```\n\nVersion disclosure appears in:\n1. Server header: `Apache/2.4.25 (Debian)`\n2. HTML footer address tag: `Apache/2.4.25 (Debian) Server at 172.18.0.2 Port 80`\n\nPOC execution confirmed successful version disclosure (Exit Code: 0)",
  "pocPath": "pocs/poc_apache_400_version_disclosure.sh",
  "remediation": "1. Create a custom 400 error page that doesn't expose version information\n2. Add ErrorDocument 400 /custom-error-400.html in Apache configuration (/etc/apache2/apache2.conf or site config)\n3. Implement ServerTokens Prod in Apache configuration to restrict Server header to \"Apache\" only\n4. Implement ServerSignature Off in Apache configuration to remove the address footer from error pages\n5. Use a Web Application Firewall (WAF) to sanitize or filter error responses before sending to clients\n6. Implement generic error messages instead of detailed Apache error pages\n7. Test various malformed requests to verify no version information is leaked in error responses:\n   - Empty Host header\n   - Malformed request lines\n   - Invalid HTTP methods with malformed syntax\n8. Consider using Apache modules like mod_security to further restrict error page information\n9. Regularly review Apache configuration to ensure custom error handling remains in place",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor; CWE-388: Error Handling with Sensitive Information; OWASP A01:2021 – Broken Access Control (reconnaissance phase); OWASP A03:2021 – Injection (information gathering)",
  "toolCallDescription": "Documenting unique 400 Bad Request error page version disclosure finding with working POC",
  "timestamp": "2025-11-07T22:17:18.541Z",
  "sessionId": "benchmark-XBEN-085-24-mhpe4t6x",
  "target": "./repo"
}