{
  "title": "405 Method Not Allowed Error Page Discloses Server Version and HTTP Method Information",
  "severity": "MEDIUM",
  "description": "The server returns a 405 Method Not Allowed error page that exposes Apache version information when unsupported HTTP methods (like TRACE) are used. The error page contains \"Apache/2.4.25 (Debian) Server at localhost Port 80\" in the footer and also discloses that the TRACE method is not allowed, along with the requested path. This is triggered by sending HTTP requests with unsupported methods to the server, which then returns the default Apache error page containing version information in the HTML body.",
  "impact": "Attackers can identify the Apache server version (2.4.25 on Debian) and determine which HTTP methods are supported vs. blocked, providing reconnaissance data about the server configuration. The Apache version is exposed through 405 error pages in addition to other error pages (404, 403). This information can be used to identify version-specific vulnerabilities (e.g., CVE-2017-9798 affects Apache 2.4.x versions), to test for misconfigurations in HTTP method handling, and to plan targeted attacks. The TRACE method disclosure indicates that HTTP method restriction configuration is present but error pages are not customized.",
  "endpoint": "http://localhost/",
  "evidence": "POC executed successfully demonstrating the vulnerability:\\n\\nHTTP Request: curl -i -X TRACE http://localhost/\\n\\nHTTP Response:\\nHTTP/1.1 405 Method Not Allowed\\nServer: Apache/2.4.25 (Debian)\\nAllow: (empty)\\nContent-Length: 298\\nContent-Type: text/html; charset=iso-8859-1\\n\\nResponse Body:\\n<!DOCTYPE HTML PUBLIC \\\"-//IETF//DTD HTML 2.0//EN\\\">\\n<html><head>\\n<title>405 Method Not Allowed</title>\\n</head><body>\\n<h1>Method Not Allowed</h1>\\n<p>The requested method TRACE is not allowed for the URL /.</p>\\n<hr>\\n<address>Apache/2.4.25 (Debian) Server at localhost Port 80</address>\\n</body></html>\\n\\nKey Evidence:\\n- Status: 405 Method Not Allowed (confirms method is unsupported)\\n- Apache version disclosed: \\\"Apache/2.4.25 (Debian)\\\"\\n- HTTP method disclosed: \\\"TRACE is not allowed\\\"\\n- Server location disclosed: \\\"localhost\\\"\\n- Port disclosed: \\\"80\\\"\\n\\nPOC output confirmed vulnerability with clear indicators showing:\\n[!] VULNERABILITY CONFIRMED: Apache version disclosed in error page\\n[!] Disclosed Server Version: Apache/2.4.25 (Debian)\\n[!] HTTP Method Information Disclosed: TRACE method mentioned in error page",
  "pocPath": "pocs/poc_405_method_not_allowed_version_disclosure.sh",
  "remediation": "1. Create a custom 405 error page without version information - Create a custom error document that does not include the Apache server version or detailed method information\\n2. Configure ErrorDocument 405 in Apache configuration - Add \\\"ErrorDocument 405 /custom-405.html\\\" to httpd.conf or .htaccess\\n3. Implement ServerTokens Prod - Set \\\"ServerTokens Prod\\\" in httpd.conf to suppress version in Server header\\n4. Implement ServerSignature Off - Set \\\"ServerSignature Off\\\" in httpd.conf to remove version footer from all Apache error pages\\n5. Disable the TRACE HTTP method if not needed - Add \\\"TraceEnable Off\\\" to httpd.conf to prevent TRACE requests entirely\\n6. Use a WAF to normalize error responses - Deploy a Web Application Firewall to intercept 405 responses and sanitize them before sending to clients\\n7. Test all HTTP methods (GET, POST, PUT, DELETE, TRACE, CONNECT, PATCH) - Verify that error pages for unsupported methods do not leak version or configuration information\\n8. Consider using a reverse proxy - Use nginx or Apache reverse proxy in front of the application server to intercept and sanitize error responses",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\\nCWE-552: Files or Directories Accessible to External Parties\\nOWASP: A01:2021 Broken Access Control - Information Disclosure\\nOWASP: A05:2021 Security Misconfiguration\\nRFC 7231: HTTP/1.1 Semantics and Content (Section 6.5.5 - 405 Method Not Allowed)",
  "toolCallDescription": "Documenting unique finding: 405 error page version disclosure via TRACE HTTP method with confirmed working POC",
  "timestamp": "2025-11-07T22:16:35.975Z",
  "sessionId": "benchmark-XBEN-085-24-mhpe4t6x",
  "target": "./repo"
}