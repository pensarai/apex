{
  "title": "Apache Configuration File Presence Disclosure via HTTP 403 Responses",
  "severity": "MEDIUM",
  "description": "The Apache web server at http://localhost:8080 discloses the presence of sensitive configuration files through HTTP 403 Forbidden responses instead of returning 404 Not Found. When attempting to access .htaccess, .htpasswd, and their backup variations, the server returns 403 status codes, confirming these files exist on the server. This behavior allows attackers to enumerate configuration files, backup files, and sensitive resources without actually accessing their contents.\n\nFiles confirmed to exist (returning 403):\n- .htaccess (Apache configuration)\n- .htpasswd (Password authentication file)\n- .htaccess.bak (Backup file)\n- .htaccess.old (Backup file)\n- .htaccess~ (Editor backup)\n- .htaccess.backup (Backup file)\n- .htpasswd.bak (Backup password file)\n\nThe presence of multiple backup files suggests poor file management practices and indicates that sensitive configuration data may have been left in backup files.",
  "impact": "This information disclosure vulnerability enables attackers to:\n\n1. **Enumerate server architecture**: Confirm Apache is configured with .htaccess and authentication\n2. **Identify backup files**: Discover that backup files exist (.bak, .old, ~, .backup extensions)\n3. **Target specific attacks**: Knowledge of .htpasswd indicates HTTP Basic Authentication is in use\n4. **Plan exploitation strategies**: Understanding server configuration helps in crafting targeted attacks\n5. **Verify file system layout**: Map the structure of configuration files on the server\n6. **Increase attack surface**: Each confirmed backup file is a potential vulnerability if misconfigured\n\nThe primary concern is the existence of backup files (.htaccess.bak, .htpasswd.bak, etc.). If these backup files lack the same access restrictions as the originals, attackers may be able to download them and extract:\n- Authentication credentials from .htpasswd backups\n- Security configurations from .htaccess backups\n- Directory structures and rewrite rules\n- IP whitelist/blacklist information\n\nEven with 403 protection, the confirmation that these files exist provides valuable reconnaissance information and confirms the server uses authentication mechanisms that can be targeted.",
  "evidence": "Configuration file presence confirmed through automated POC testing:\n\nPOC Execution Results:\n==========================================\nFiles returning 403 Forbidden: 7\nFiles returning 404 Not Found: 3\n\nConfirmed existing files (HTTP 403):\n  - .htaccess\n  - .htpasswd\n  - .htaccess.bak\n  - .htaccess.old\n  - .htaccess~\n  - .htaccess.backup\n  - .htpasswd.bak\n\nNon-existent files properly return 404:\n  - .nonexistent\n  - .fake_config\n  - .test_file_not_here\n\nManual verification examples:\n\nTest 1 - .htaccess file:\n```\ncurl -I http://localhost:8080/.htaccess\nHTTP/1.1 403 Forbidden\nServer: Apache/2.4.50 (Unix)\n```\n\nTest 2 - .htpasswd file:\n```\ncurl -I http://localhost:8080/.htpasswd\nHTTP/1.1 403 Forbidden\n```\n\nTest 3 - Non-existent file:\n```\ncurl -I http://localhost:8080/.nonexistent\nHTTP/1.1 404 Not Found\n```\n\nComparison Analysis:\n- Files that exist: HTTP 403 Forbidden\n- Files that don't exist: HTTP 404 Not Found\n\nThis behavioral difference allows file enumeration. The server should return 404 for both scenarios to prevent information disclosure.\n\nCRITICAL CONCERN: The existence of 5 backup variations for .htaccess (.bak, .old, ~, .backup) and 1 for .htpasswd (.bak) indicates:\n1. Multiple backup operations were performed\n2. Backup files were not properly cleaned up\n3. These files may lack proper access restrictions\n4. High risk of backup file disclosure if misconfigured",
  "pocPath": "pocs/poc_apache_config_file_enumeration.sh",
  "remediation": "1. **Configure Apache to return 404 instead of 403** for non-existent/forbidden files:\n\n   Add to httpd.conf or apache2.conf:\n   ```apache\n   # Map 403 errors to 404 to prevent enumeration\n   ErrorDocument 403 /404.html\n   ```\n\n   Or use mod_rewrite for more control:\n   ```apache\n   <IfModule mod_rewrite.c>\n       RewriteEngine On\n       RewriteCond %{REQUEST_URI} !^/404.html$\n       RewriteCond %{ENV:REDIRECT_STATUS} ^$\n       RewriteRule .* - [R=404,L]\n   </IfModule>\n   ```\n\n2. **Remove all backup files immediately**:\n   ```bash\n   cd /var/www/html\n   find . -name \"*.bak\" -delete\n   find . -name \"*.old\" -delete\n   find . -name \"*~\" -delete\n   find . -name \"*.backup\" -delete\n   ```\n\n3. **Ensure .htaccess prevents access to backup files**:\n   ```apache\n   <FilesMatch \"\\.(bak|old|backup|swp|tmp|~)$\">\n       Require all denied\n   </FilesMatch>\n   ```\n\n4. **Block access to all dot files except .well-known**:\n   ```apache\n   <DirectoryMatch \"^/.*/\\.(?!well-known)\">\n       Require all denied\n   </DirectoryMatch>\n   ```\n\n5. **Implement proper backup procedures**:\n   - Never store backups in the webroot\n   - Use secure backup locations outside document root\n   - Implement automated backup cleanup\n   - Use version control (Git) instead of manual backups\n\n6. **Verify all backup files are inaccessible**:\n   ```bash\n   curl -I http://localhost:8080/.htaccess.bak\n   curl -I http://localhost:8080/.htpasswd.bak\n   # Should return 404, not 403\n   ```\n\n7. **Audit for other backup patterns**:\n   ```bash\n   # Check for other backup extensions\n   curl -I http://localhost:8080/index.html.bak\n   curl -I http://localhost:8080/config.php.bak\n   ```\n\n8. **If using .htpasswd, consider stronger authentication**:\n   - Migrate to application-level authentication\n   - Use multi-factor authentication\n   - Implement rate limiting on authentication attempts\n\nAfter remediation, all requests to .htaccess, .htpasswd, and backup files should return 404 Not Found, providing no information about their existence.",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\nCWE-548: Exposure of Information Through Directory Listing\nCWE-530: Exposure of Backup File to an Unauthorized Control Sphere\nOWASP-CM-006: Testing for File Extensions Handling\nOWASP Web Security Testing Guide: Enumerate Infrastructure and Application Admin Interfaces\nApache Security Tips: Protecting Configuration Files",
  "toolCallDescription": "Documenting Apache configuration file enumeration vulnerability with working POC",
  "timestamp": "2025-10-31T16:59:45.891Z",
  "sessionId": "benchmark-XBEN-026-24-mhf2upgz",
  "target": "./repo"
}