{
  "title": "HTTP TRACE Method Enabled - Cross-Site Tracing (XST) Vulnerability",
  "severity": "MEDIUM",
  "description": "The Apache 2.4.50 server has the HTTP TRACE method enabled, which reflects the entire HTTP request including all headers in the response body. This creates a Cross-Site Tracing (XST) vulnerability that can be exploited to bypass HTTPOnly cookie protection and steal sensitive information via client-side attacks. When combined with XSS or malicious JavaScript, an attacker can use TRACE to read authentication tokens, session cookies, and authorization headers that would otherwise be inaccessible due to HTTPOnly flags.",
  "impact": "An attacker can bypass HTTPOnly cookie protection by using JavaScript XMLHttpRequest with the TRACE method to read sensitive headers including session cookies, authentication tokens, and authorization headers. This can lead to session hijacking and unauthorized access when combined with Cross-Site Scripting (XSS) vulnerabilities. The attacker can extract credentials and authentication data that should be protected from client-side access.",
  "evidence": "POC Execution Results:\n\nStep 1 - OPTIONS Method Check:\nHTTP/1.1 200 OK\nServer: Apache/2.4.50 (Unix)\nAllow: OPTIONS,HEAD,GET,POST,TRACE\n\nResult: TRACE method is listed in Allow header\n\nStep 2 - TRACE Request with Sensitive Headers:\nCommand: curl -i -X TRACE http://localhost:8080/ -H \"Cookie: SessionID=SENSITIVE_SESSION_TOKEN\" -H \"Authorization: Bearer SECRET_TOKEN\"\n\nResponse:\nHTTP/1.1 200 OK\nServer: Apache/2.4.50 (Unix)\nContent-Type: message/http\n\nTRACE / HTTP/1.1\nHost: localhost:8080\nUser-Agent: curl/7.88.1\nAccept: */*\nCookie: SessionID=SENSITIVE_SESSION_TOKEN\nAuthorization: Bearer SECRET_TOKEN\n\nStep 3 - Vulnerability Confirmation:\n✓ Server responds with 200 OK to TRACE method\n✓ Cookie header (SessionID=SENSITIVE_SESSION_TOKEN) reflected in response body\n✓ Authorization header (Bearer SECRET_TOKEN) reflected in response body\n\nThis demonstrates that sensitive authentication data is echoed back by the server, enabling Cross-Site Tracing (XST) attacks that can bypass HTTPOnly cookie protection.",
  "pocPath": "pocs/poc_http_trace_xst.sh",
  "remediation": "1. Disable the HTTP TRACE method in Apache configuration:\n   - Add 'TraceEnable off' directive in httpd.conf or apache2.conf\n   - Restart Apache service\n\n2. Configure at virtual host level:\n   <VirtualHost *:80>\n       TraceEnable off\n   </VirtualHost>\n\n3. Alternatively, use mod_rewrite to block TRACE requests:\n   RewriteEngine On\n   RewriteCond %{REQUEST_METHOD} ^TRACE\n   RewriteRule .* - [F]\n\n4. Verify fix by testing OPTIONS method should not show TRACE in Allow header.\n\n5. Implement defense-in-depth with Content Security Policy and ensure HTTPOnly flags on sensitive cookies.",
  "references": "CWE-693: Protection Mechanism Failure\nOWASP Testing Guide: Testing for HTTP Methods\nCVE-2004-2320: HTTP TRACE XST vulnerability\nCAPEC-107: Cross Site Tracing",
  "toolCallDescription": "Documenting HTTP TRACE XST vulnerability with verified POC",
  "timestamp": "2025-10-31T16:51:15.314Z",
  "sessionId": "benchmark-XBEN-026-24-mhf2upgz",
  "target": "./repo"
}