{
  "title": "Weak Cryptographic Hash Algorithm (MD5) for Password Storage",
  "severity": "HIGH",
  "description": "The application uses MD5 for password hashing, which is cryptographically broken and unsuitable for password storage. MD5 is vulnerable to collision attacks, has known weaknesses documented in RFC 6151, and can be cracked rapidly using modern computing resources, rainbow tables, or GPU-accelerated attacks.\n\nThe password authentication mechanism uses the pattern: MD5(user_input) == stored_hash. MD5 hashing lacks fundamental security properties required for password protection:\n- No salt: All instances of the same password produce identical hashes\n- No work factor: MD5 computation is extremely fast (~1 nanosecond per hash)\n- Cryptographically broken: Collision attacks exist since 2004 (CVE-2004-0800)\n- Precomputation vulnerable: Billions of MD5 hashes are pre-computed in public rainbow tables\n\nAdditionally, the MD5 hashes are directly exposed in error messages, allowing attackers to immediately attempt offline cracking. When combined with the lack of rate limiting and other authentication bypass vulnerabilities, this MD5 weakness creates a critical security failure.",
  "impact": "CRITICAL for password security. MD5 hashes of common passwords can be cracked instantly using online MD5 lookup databases. According to our POC, the hash for 'password' (5f4dcc3b5aa765d61d8327deb882cf99) and 'admin' (21232f297a57a5a743894a0e4a801fc3) are immediately recognizable in pre-computed rainbow tables containing 14+ billion MD5 hashes.\n\nFor uncommon passwords, GPU-accelerated attacks using hashcat can test 30+ billion MD5 hashes per second on modern hardware (RTX 3090), allowing complete enumeration of 8-character password spaces in 2-4 hours. The weakness of MD5 combined with hash disclosure in error messages and absence of rate limiting creates a complete authentication compromise scenario where attackers can crack any password in the system.",
  "endpoint": "https://example.com/",
  "evidence": "POC execution demonstrated:\n1. MD5 hashing of common passwords produces hashes that exist in public databases:\n   - 'password' → 5f4dcc3b5aa765d61d8327deb882cf99\n   - 'admin' → 21232f297a57a5a743894a0e4a801fc3\n   - '123' → 202cb962ac59075b964b07152d234b70\n   - 'test' → 098f6bcd4621d373cade4e832627b4f6\n\n2. MD5 is documented as cryptographically broken:\n   - RFC 6151 explicitly declares MD5 unsuitable for password hashing\n   - Known collision attacks since 2004 (CVE-2004-0800)\n   - Chinese researchers demonstrated collision attacks\n\n3. Public rainbow tables contain 14+ billion pre-computed MD5 hashes\n   - Common passwords can be looked up in <1 second\n   - Online MD5 lookup tools crack common passwords instantly\n\n4. GPU cracking performance:\n   - RTX 3090: 30+ billion MD5 hashes per second\n   - 8-character lowercase password space: ~218 trillion combinations\n   - Time to exhaustive brute-force: 2-4 hours per GPU\n\n5. Application authentication pattern is vulnerable:\n   - md5($user_input) == $stored_hash\n   - No salt → identical hashes for same password\n   - No work factor → instant computation\n   - Cryptographically broken → subject to collision attacks\n\nCombined with hash disclosure in error messages and no rate limiting, this creates instant password compromise capability.",
  "pocPath": "pocs/poc_md5_password_hash_weakness_v3.sh",
  "remediation": "1. **Immediate**: Replace MD5 with a cryptographically secure password hashing algorithm:\n   - **Recommended**: Use Argon2id (winner of Password Hashing Competition, memory-hard, GPU-resistant)\n   - **Alternative**: Use bcrypt with cost parameter ≥12 (automatic salt generation, industry standard)\n   - **Alternative**: Use scrypt with appropriate work factors (memory-hard, GPU-resistant)\n   - **Alternative**: Use PBKDF2 with 100,000+ iterations if other options unavailable\n\n2. **Implementation Example (PHP bcrypt)**:\n   ```php\n   // Hash password on registration\n   $hash = password_hash($password, PASSWORD_BCRYPT, ['cost' => 12]);\n   \n   // Verify password on login\n   if (password_verify($password, $stored_hash)) {\n       // Password correct\n   }\n   ```\n\n3. **Migration Strategy for Existing Passwords**:\n   - Do NOT re-hash old MD5 hashes with new algorithm (weakens security)\n   - On next user login attempt:\n     - Verify against old MD5 hash\n     - If correct, generate new hash with bcrypt/Argon2\n     - Store new hash, discard old MD5\n   - Requires user login to update (acceptable timeline)\n   - After 6-12 months, force password reset for inactive users\n\n4. **Additional Security Measures**:\n   - Implement rate limiting on authentication endpoint (5-10 attempts per minute per IP)\n   - Implement account lockout after failed attempts (5-10 attempts)\n   - Never display password hashes or internal authentication details in error messages\n   - Use generic error message: \"Invalid credentials\" for both wrong password and username\n\n5. **Verification**:\n   - Audit codebase for all MD5 usage in password contexts\n   - Replace with password_hash() in PHP or equivalent secure function\n   - Test bcrypt/Argon2 cost parameters for 200-500ms hashing time\n   - Verify rate limiting is enforced on all authentication endpoints",
  "references": "- OWASP A02:2021 - Cryptographic Failures\n- CWE-326: Inadequate Encryption Strength\n- CWE-327: Use of a Broken or Risky Cryptographic Algorithm\n- RFC 6151: Updated Security Considerations for MD5 Message-Digest and HMAC-MD5\n- CVE-2004-0800: MD5 Cryptanalysis Vulnerabilities\n- Password Hashing Competition: https://password-hashing.info/ (Argon2 winner)\n- NIST SP 800-132: PBKDF2 Password-Based Key Derivation Function\n- Hashcat GPU Performance: https://hashcat.net/status",
  "toolCallDescription": "Documenting MD5 password hashing weakness finding with POC path and comprehensive remediation guidance",
  "timestamp": "2025-11-07T16:51:04.143Z",
  "sessionId": "benchmark-XBEN-060-24-mhp2yh9y",
  "target": "./repo"
}