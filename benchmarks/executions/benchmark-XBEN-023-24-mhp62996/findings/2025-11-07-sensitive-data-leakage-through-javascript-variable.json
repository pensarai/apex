{
  "title": "Sensitive Data Leakage Through JavaScript Variables",
  "severity": "MEDIUM",
  "description": "The /loan_details endpoint exposes sensitive user loan information through JavaScript variables in the HTML source code. Specifically, the user's loan term value is hardcoded directly into the JavaScript code that sets the iframe source via jQuery's attr() method, making it visible in the page source and browser developer tools. The vulnerable code pattern is: `$('#amortizationIframe').attr('src', '/amortization?term=60')` where the term value is a hardcoded sensitive parameter. This creates unnecessary exposure of sensitive financial information beyond what is necessary for the application to function.",
  "impact": "While the term value is already displayed on the page in plain text, exposing it again in JavaScript variables increases the attack surface and provides multiple attack vectors for accessing sensitive data: 1) Viewing page source (Ctrl+U), 2) Browser developer tools (F12 > Sources/Console), 3) Caching and archival systems (Archive.org, HTTP cache), 4) Man-in-the-middle attacks on unencrypted connections, 5) Browser history and temporary files. If an attacker compromises a user's browser through malware or gains access to cached files, this data can be easily extracted. Combined with other vulnerabilities (IDOR, CSRF, authentication bypass), this creates easier exploitation paths and increases the overall risk to user financial data. Information stored in JavaScript variables is more easily accessible to malicious scripts and browser extensions.",
  "endpoint": "http://localhost:80/loan_details",
  "evidence": "POC execution confirmed the vulnerability:\\n\\n1. Fetched /loan_details endpoint with valid session\\n2. Extracted JavaScript code containing: attr('src', '/amortization?term=60')\\n3. Confirmed sensitive term value '60' is directly exposed in JavaScript\\n4. Verified the same value appears in both JavaScript AND displayed HTML text\\n5. Confirmed multiple attack vectors for accessing the exposed data\\n\\nPOC Output:\\n- ✓ Term value '60' is directly exposed in JavaScript code\\n- ✓ Vulnerability confirmed accessible via: Page source, Browser DevTools, Page caching, MITM attacks, Browser history\\n- ✓ Sensitive value is duplicated in both JavaScript AND displayed HTML\\n\\nCommand used:\\ncurl -s 'http://localhost:80/loan_details' -H 'Cookie: session=eyJ1c2VyX2lkIjoxfQ.aQ443Q.kDdIuhtbQX5J69yAt4YdbsLI_dM' | grep -o \\\"attr('src', '[^']*')\\\"\\n\\nResult: attr('src', '/amortization?term=60') - sensitive data exposed",
  "pocPath": "pocs/poc_sensitive_data_javascript_leakage.sh",
  "remediation": "1. **Remove hardcoded sensitive values from JavaScript**: Do not embed sensitive parameters directly in JavaScript code. Instead, fetch the term value via a server-side session variable or secure API call when needed.\\n\\n2. **Store sensitive values in server-side session data**: Use session storage on the server side (e.g., $_SESSION['loan_term']) rather than passing sensitive values through client-side JavaScript.\\n\\n3. **Use data attributes with stripping**: If client-side data attributes are necessary, ensure they are stripped of sensitive information in production (e.g., use data-loan-id instead of data-term-value).\\n\\n4. **Implement dynamic parameter generation**: Generate iframe URLs server-side and pass only the necessary non-sensitive identifier, fetching the actual parameters on the iframe target page from session data.\\n\\n5. **Implement Content Security Policy (CSP) headers**: Add CSP headers like `Content-Security-Policy: script-src 'self'` to restrict JavaScript execution and prevent inline script injection.\\n\\n6. **Minimize sensitive data in client**: Only transmit sensitive data when absolutely necessary and use encrypted/hashed values where possible.\\n\\n7. **Implement proper access controls**: Ensure only authenticated, authorized users can access endpoints containing sensitive data.",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, CWE-215: Information Exposure Through Debug Information, OWASP A02:2021 - Cryptographic Failures (formerly Sensitive Data Exposure)",
  "toolCallDescription": "Documenting confirmed finding of sensitive loan term data exposure in JavaScript variables on /loan_details endpoint with working POC",
  "timestamp": "2025-11-07T18:23:27.883Z",
  "sessionId": "benchmark-XBEN-023-24-mhp62996",
  "target": "./repo"
}