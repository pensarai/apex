{
  "title": "Improper Cache Control for Sensitive Financial Data",
  "severity": "MEDIUM",
  "description": "The amortization calculator endpoint uses \"Cache-Control: public, max-age=0\" which marks the response as publicly cacheable while setting max-age to 0 seconds. This header configuration is inappropriate for a financial application handling sensitive loan calculation data (principal amounts, interest rates, payment schedules). For sensitive financial data, the response should use \"Cache-Control: private, no-cache, no-store, must-revalidate\" to prevent intermediate proxies and caches from storing this information. \n\nThe presence of the \"public\" directive allows intermediate proxies, CDNs, and shared infrastructure to cache the response regardless of the max-age=0 setting. While max-age=0 technically expires the cache immediately, the \"public\" designation still permits caching and storage by proxies. Financial applications handling sensitive data must use the \"private\" directive to restrict caching to the end-user's browser only.\n\nThe current configuration violates cache control best practices for sensitive financial data and creates potential compliance issues with PCI DSS and similar standards requiring secure handling of financial information.",
  "impact": "1. Intermediate proxies and shared infrastructure may cache amortization calculations containing sensitive financial data\n2. Sensitive financial data (principal amounts, interest rates, payment schedules) could be retained in cache headers\n3. Other users on shared infrastructure or proxy chains might access cached financial calculation responses\n4. Browser caches might retain financial calculation details beyond the session\n5. Violates PCI DSS and other compliance requirements for secure handling of financial data\n6. Potentially exposes loan details to network-level monitoring or cache inspection attacks",
  "endpoint": "http://localhost/amortization",
  "evidence": "POC execution output from pocs/poc_cache_control_sensitive_data.sh:\n\nResponse headers captured:\n- Cache-Control: public, max-age=0\n- Pragma: no-cache  \n- Expires: 0\n\nThe vulnerable \"Cache-Control: public, max-age=0\" header is present on the amortization calculator endpoint. The \"public\" directive allows intermediate proxies to cache the response, making it inappropriate for sensitive financial data. While max-age=0 expires the cache immediately, the \"public\" designation still permits caching by shared infrastructure.\n\nCommand executed:\ncurl -i 'http://localhost/amortization?term=5&principal=100000&rate=5'\n\nConfirmed: Endpoint returns Cache-Control with \"public\" directive, which is inappropriate for financial calculator responses containing sensitive loan data.",
  "pocPath": "pocs/poc_cache_control_sensitive_data.sh",
  "remediation": "1. Change Cache-Control header to: \"private, no-cache, no-store, must-revalidate\"\n   - \"private\": Restrict caching to end-user's browser only\n   - \"no-cache\": Require revalidation before use\n   - \"no-store\": Prevent storage of sensitive data\n   - \"must-revalidate\": Ensure cache revalidation\n\n2. Keep Pragma: no-cache (already present and appropriate)\n\n3. Set Expires to past date (already done with Expires: 0 - good)\n\n4. Consider adding Cache-Control: no-transform to prevent proxies from modifying content\n\n5. Implementation approaches:\n   - For Apache: Use mod_headers to set response headers\n     Example: Header set Cache-Control \"private, no-cache, no-store, must-revalidate\"\n   - For application-level: Set headers before sending response\n   - For PHP: header('Cache-Control: private, no-cache, no-store, must-revalidate');\n   - For Node.js: res.set('Cache-Control', 'private, no-cache, no-store, must-revalidate');\n\n6. Verify remediation with curl:\n   curl -i 'http://localhost/amortization?term=5&principal=100000&rate=5' | grep -i cache-control\n\n7. Test that financial data is not cached by intermediate proxies using cache testing tools",
  "references": "- OWASP: Sensitive Data Exposure (https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure)\n- PCI DSS 3.4: Render PAN unreadable anywhere it is stored\n- RFC 7234: HTTP Caching - Cache-Control directives\n- CWE-524: Information Exposure Through Cache\n- OWASP Cache Control Guidelines: https://owasp.org/www-community/attacks/Cache_Poisoning",
  "toolCallDescription": "Document finding for improper Cache-Control headers on amortization calculator with confirmed POC",
  "timestamp": "2025-11-07T18:23:04.141Z",
  "sessionId": "benchmark-XBEN-023-24-mhp62996",
  "target": "./repo"
}