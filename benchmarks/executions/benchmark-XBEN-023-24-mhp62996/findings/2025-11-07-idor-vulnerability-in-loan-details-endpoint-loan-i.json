{
  "title": "IDOR Vulnerability in /loan_details Endpoint - Loan ID Parameter Tampering",
  "severity": "HIGH",
  "description": "The /loan_details endpoint accepts an 'id' parameter that allows direct manipulation of which loan details are displayed. An authenticated user can access loan details of other users by changing the 'id' parameter value. The application fails to implement proper authorization checks to verify that the requested loan ID belongs to the authenticated user before returning sensitive financial data. While the 'id' parameter may not directly correspond to user IDs, it allows accessing arbitrary loan records that should only be visible to the loan owner.",
  "impact": "An attacker can view confidential financial information of other users' loans by simply modifying the id parameter. This could expose sensitive data such as loan amounts, interest rates, payment terms, and monthly payment amounts for any loan in the system. Combined with other IDOR vulnerabilities (profile IDOR), this could enable complete account compromise and financial fraud. This is a horizontal privilege escalation vulnerability allowing attackers to enumerate and access financial records of other users.",
  "endpoint": "http://localhost:80/loan_details",
  "evidence": "POC Testing Results:\n\n1. Authenticated successfully with default credentials (test:test)\n2. Session cookie obtained: eyJ1c2VyX2lkIjoxfQ.aQ46Ew.6lFb...\n\n3. Accessed /loan_details without id parameter - Retrieved current user's loan data\n4. Accessed /loan_details?id=1 - Successfully retrieved loan data (term=1) for a different loan\n5. Accessed /loan_details?id=2 - Successfully retrieved loan data (term=1) for yet another loan\n\nThe application accepts the id parameter and returns loan data for arbitrary loans without verifying ownership. Different id values return different loan records, confirming the IDOR vulnerability. The endpoint should either:\n- Remove the id parameter and serve only the authenticated user's loan\n- Implement server-side validation to ensure the requested loan belongs to the authenticated user",
  "pocPath": "pocs/poc_idor_loan_details_v3.sh",
  "remediation": "1. Remove the 'id' parameter from client-facing URLs. Instead, use the authenticated user's session to determine which loan to display.\n2. If loans need to be identified, implement server-side validation that verifies the loan belongs to the authenticated user before returning data.\n3. Use a mapping table or ORM that ensures only the user's own loans can be accessed through the user session.\n4. Implement explicit access control checks: if (loan.user_id != authenticated_user.id) return 403 Forbidden\n5. Add audit logging for all loan data access attempts to detect enumeration attacks.\n6. Consider implementing pagination or limiting loan access to a single \"current\" loan per user rather than arbitrary selection.\n7. Use UUIDs instead of sequential IDs to make enumeration attacks less obvious (defense-in-depth, not primary mitigation).",
  "references": "OWASP Top 10 2021 - A01:2021 Broken Access Control, CWE-639: Authorization Bypass Through User-Controlled Key, OWASP IDOR (Insecure Direct Object References)",
  "toolCallDescription": "Documenting HIGH severity IDOR vulnerability in /loan_details endpoint with confirmed POC showing unauthorized access to other users' loan financial data",
  "timestamp": "2025-11-07T18:27:43.188Z",
  "sessionId": "benchmark-XBEN-023-24-mhp62996",
  "target": "./repo"
}