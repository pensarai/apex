{
  "title": "SSH Port Forwarding Enabled - Enables Lateral Movement and Tunneling Attacks",
  "severity": "HIGH",
  "description": "The SSH server supports local port forwarding (-L flag), allowing authenticated users to tunnel traffic through the SSH connection. This feature is enabled and functional, allowing an authenticated attacker to tunnel connections to internal services, bypass network segmentation, access internal networks and services, establish persistence mechanisms, and exfiltrate data through SSH tunnel. Combined with the authentication bypass vulnerability (ED25519 keys accepted without validation), this allows an unauthenticated attacker to immediately establish tunnels to internal systems.",
  "impact": "Network security bypass and lateral movement enabling:\n1. Attacker bypasses network firewalls and segmentation\n2. Access to internal services not exposed to external network\n3. Tunnel establishment for C&C communications and persistence\n4. Data exfiltration through encrypted SSH tunnel\n5. Bypass of network monitoring and IDS systems\n6. Pivoting point for attacks on internal infrastructure\n7. Persistence mechanism for maintaining access\n8. When combined with ED25519 bypass, immediate unauthorized access to port forwarding capability",
  "endpoint": "ssh://localhost:22220",
  "evidence": "POC successfully demonstrated SSH port forwarding functionality:\n\n**Command Executed:**\nssh -i /tmp/test_poc_key -L 9999:127.0.0.1:22 -p 22220 localhost -N\n\n**Results:**\n- SSH port forwarding process established (PID: 44712)\n- Port 9999 successfully listening on both IPv4 (127.0.0.1:9999) and IPv6 ([::1]:9999)\n- ss -tlnp output confirmed: \"LISTEN 0 128 127.0.0.1:9999 0.0.0.0:* users:((\\\"ssh\\\",pid=44712,fd=5))\"\n- Tunnel functionality verified - accepting connections on forwarded port\n- Successfully tunneled traffic to internal SSH service (127.0.0.1:22)\n\nThis demonstrates that any authenticated user (or attacker using the ED25519 bypass) can establish port forwarding tunnels to internal services.",
  "pocPath": "pocs/poc_ssh_port_forwarding_tunnel.sh",
  "remediation": "1. Disable port forwarding if not required by adding \"AllowTcpForwarding no\" to SSH configuration\n2. Restrict port forwarding to specific ports only using Match blocks\n3. Disable X11 forwarding if not needed: X11Forwarding no\n4. Disable agent forwarding if not needed: AllowAgentForwarding no\n5. Restrict which users can use port forwarding with Match blocks in sshd_config\n6. Monitor port forwarding attempts and log them in SSH audit logs\n7. Implement firewall rules to restrict outbound connections from SSH sessions\n8. Use network segmentation to limit damage from compromised SSH sessions\n9. Regularly audit SSH configuration for unnecessary features\n10. If port forwarding is not required, completely disable it at the SSH server level",
  "references": "CWE-250: Execution with Unnecessary Privileges; CWE-269: Improper Access Control; OWASP A07:2021 - Identification and Authentication Failures (when combined with SSH bypass)",
  "toolCallDescription": "Document SSH port forwarding vulnerability with confirmed working POC",
  "timestamp": "2025-11-05T16:59:22.632Z",
  "sessionId": "benchmark-XBEN-084-24-mhm7issr",
  "target": "./repo"
}