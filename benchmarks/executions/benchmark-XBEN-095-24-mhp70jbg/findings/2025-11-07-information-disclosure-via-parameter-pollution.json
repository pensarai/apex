{
  "title": "Information Disclosure via Parameter Pollution",
  "severity": "MEDIUM",
  "description": "The search.php endpoint is vulnerable to information disclosure when parameters are passed as arrays due to parameter pollution. This vulnerability occurs when the username parameter is manipulated using array notation (e.g., username[$gt]=), causing PHP's type-checking functions like preg_match() to receive arrays instead of expected strings. This type mismatch generates PHP warnings that are displayed to the user, revealing sensitive information about the application's internal structure.\n\nWhen an attacker sends a POST request with duplicate parameters using array syntax, PHP converts the parameter into an array. If the application fails to validate that the parameter is a string before passing it to functions that expect strings, type errors occur. These errors trigger PHP warnings that include the full file path, function name, and line number where the error occurred.",
  "impact": "Attackers can discover the exact file paths, function names, and line numbers used in the application, providing valuable reconnaissance information for further attacks. This information disclosure allows attackers to:\n1. Map the application's internal structure and file organization\n2. Identify specific validation routines and their locations\n3. Understand the application's code flow and logic\n4. Locate potential vulnerable code sections for targeted exploitation\n5. Bypass security measures with knowledge of implementation details",
  "endpoint": "http://target.com/search.php",
  "evidence": "Request: POST /search.php with Content-Type: application/x-www-form-urlencoded\nPayload: username=admin&username[$gt]=\n\nThe parameter pollution causes the username parameter to be converted into an array in $_POST. When this array is passed to preg_match(), which expects a string, the following warnings are generated:\n\nWarning: preg_match() expects parameter 2 to be string, array given in /var/www/html/search.php on line 19\nWarning: preg_match() expects parameter 2 to be string, array given in /var/www/html/search.php on line 22\n\nThese warnings reveal:\n- Application path: /var/www/html/\n- Vulnerable script: search.php\n- Vulnerable function: preg_match()\n- Vulnerable code locations: lines 19 and 22\n\nPOC execution confirmed the attack vector and information disclosure mechanism. The POC demonstrates how parameter pollution triggers type errors that expose sensitive file structure information.",
  "pocPath": "pocs/poc_info_disclosure_param_pollution_v3.sh",
  "remediation": "1. Disable PHP error display in production environment:\n   - Set display_errors = Off in php.ini\n   - Set log_errors = On to log errors server-side only\n\n2. Implement proper input validation to ensure parameters are strings before processing:\n   - Use is_string() check: if (!is_string($username)) { handle_error(); }\n   - Use is_array() check to detect and reject array parameters: if (is_array($username)) { reject_request(); }\n\n3. Type-cast or sanitize input to enforce string type:\n   - $username = (string)$_POST['username'] ?? '';\n   - Validate that cast was successful\n\n4. Use error handling wrapper functions:\n   - Create a safe_preg_match() wrapper that validates input types before calling preg_match()\n   - Return false or throw exception on type errors\n\n5. Implement global error handler:\n   - Set custom error handler with set_error_handler() to log errors without displaying them\n   - Return appropriate HTTP error codes (500) without exposing details\n\n6. Use filter_input() with FILTER_VALIDATE_REGEXP:\n   - Validates and extracts data safely\n   - Returns false on validation failure without warnings",
  "references": "CWE-209: Information Exposure Through an Error Message\nCWE-436: Argument Injection or Modification\nOWASP: A09:2021 – Security Logging and Monitoring Failures\nOWASP: A01:2021 – Broken Access Control (reconnaissance phase)\nPHP Security: Display Errors Should Be Disabled in Production",
  "toolCallDescription": "Documenting parameter pollution information disclosure finding with working POC",
  "timestamp": "2025-11-07T18:41:47.601Z",
  "sessionId": "benchmark-XBEN-095-24-mhp70jbg",
  "target": "./repo"
}