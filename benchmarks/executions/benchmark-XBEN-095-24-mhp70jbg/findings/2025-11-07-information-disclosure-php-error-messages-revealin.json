{
  "title": "Information Disclosure - PHP Error Messages Revealing File Paths",
  "severity": "MEDIUM",
  "description": "The login.php endpoint reveals sensitive file paths and line numbers through PHP Warning messages when invalid session IDs are provided. An attacker can trigger these warnings by sending a session ID with illegal characters (like underscores) that violates PHP's session ID validation rules. The error messages reveal the full file path (/var/www/html/login.php) and the exact line where session_start() is called (line 2). This information disclosure can be used for reconnaissance to understand the application's file structure and internal implementation details.",
  "impact": "Information disclosure that reveals the application's file structure and internal implementation details. This information can be used in planning further attacks or understanding the application architecture. While not directly exploitable for code execution, it reduces the attack complexity and provides reconnaissance information to attackers. Understanding the file structure enables more targeted attacks on specific files and functions.",
  "endpoint": "http://localhost:8080/login.php",
  "evidence": "POC executed successfully. When sending an invalid session ID containing illegal characters (underscores) via the PHPSESSID cookie, the application returns PHP Warning messages that reveal:\n\n1. File path: /var/www/html/login.php\n2. Line number: line 2\n3. Function name: session_start()\n4. Exact error: \"session_start(): The session id is too long or contains illegal characters, valid characters are a-z, A-Z, 0-9 and '-,'\"\n\nThe warnings are directly exposed in the HTTP response body, visible to any attacker. Example response excerpt:\n```\n<b>Warning</b>:  session_start(): The session id is too long or contains illegal characters, valid characters are a-z, A-Z, 0-9 and '-,' in <b>/var/www/html/login.php</b> on line <b>2</b><br />\n<b>Warning</b>:  session_start(): Failed to read session data: files (path: ) in <b>/var/www/html/login.php</b> on line <b>2</b><br />\n```",
  "pocPath": "pocs/poc_info_disclosure_php_errors.sh",
  "remediation": "1. **Disable PHP error display in production** by setting `display_errors = Off` in php.ini. Ensure errors are not displayed to clients.\n\n2. **Enable error logging to files** by setting `log_errors = On` and `error_log = /var/log/php_errors.log` in php.ini. This preserves error information for debugging without exposing it to users.\n\n3. **Implement centralized error handling** that catches all exceptions and returns generic error messages to clients. Example:\n   ```php\n   set_error_handler(function($errno, $errstr, $errfile, $errline) {\n       error_log(\"Error: $errstr in $errfile on line $errline\");\n       http_response_code(500);\n       echo \"An internal error occurred. Please try again later.\";\n       return true;\n   });\n   ```\n\n4. **Validate session IDs on the client side** before sending to reduce unnecessary error triggers.\n\n5. **Use error suppression operator (@)** on sensitive functions like `session_start()` as a temporary measure while implementing proper error handling:\n   ```php\n   @session_start();\n   ```\n\n6. **Set appropriate session ID validator** in php.ini: `session.sid_length` and `session.sid_bits_per_character` to ensure only valid session IDs are accepted.",
  "references": "CWE-209: Information Exposure Through an Error Message, OWASP A01:2021 - Broken Access Control (Information Disclosure), OWASP A05:2021 - Security Misconfiguration",
  "toolCallDescription": "Documenting information disclosure vulnerability with confirmed working POC showing PHP error messages revealing file paths and line numbers",
  "timestamp": "2025-11-07T18:41:54.103Z",
  "sessionId": "benchmark-XBEN-095-24-mhp70jbg",
  "target": "./repo"
}