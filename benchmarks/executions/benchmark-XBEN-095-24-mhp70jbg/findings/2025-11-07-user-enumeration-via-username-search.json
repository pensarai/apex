{
  "title": "User Enumeration via Username Search",
  "severity": "MEDIUM",
  "description": "The username search functionality allows attackers to enumerate valid usernames through response differentiation. When a valid username is queried, the application returns \"User exists: [username]\" message. Non-existent usernames return \"No results\". This enables an attacker to brute-force the system and identify valid user accounts.\n\nThe vulnerability stems from inconsistent response messages that reveal whether a username exists in the system. The search endpoint is also case-insensitive but maintains the same vulnerability pattern regardless of case variations. An attacker can systematically query common usernames, admin accounts, or use wordlists to build a comprehensive list of valid users in the system.",
  "impact": "Attackers can determine which usernames exist in the system, facilitating targeted password attacks or social engineering. This is particularly dangerous for administrative accounts like 'admin', 'root', 'administrator', etc. Once valid usernames are enumerated, attackers can:\n1. Launch targeted brute-force password attacks against known accounts\n2. Perform social engineering attacks with real usernames\n3. Identify privileged accounts for targeted exploitation\n4. Build organizational structure and hierarchy\n5. Map internal user accounts for further attacks\n\nThis significantly reduces the attack surface difficulty and increases the likelihood of successful account compromise.",
  "endpoint": "http://localhost/search.php",
  "evidence": "POC Execution Output:\n\nTest 1 - Existing user 'admin':\nResponse: User exists: admin\n✓ VULNERABLE: Response confirms user existence\n\nTest 2 - Non-existent user 'nonexistent12345xyz':\nResponse: No results\n✓ VULNERABLE: Response indicates user doesn't exist\n\nTest 3 - Case-insensitive 'ADMIN':\nResponse: User exists: admin\n✓ VULNERABLE: Case-insensitive search reveals user existence\n\nTest 4 - Another existing user 'root':\nResponse: User exists: root\n✓ VULNERABLE: Another valid user enumerated\n\nTest 5 - Response Differentiation:\nResponses differ by message content:\n- Valid user: Contains 'User exists'\n- Invalid user: Contains 'No results'\n\n✓✓✓ VULNERABILITY CONFIRMED ✓✓✓\nAttacker can distinguish valid from invalid usernames\nThis enables brute-force username enumeration attacks",
  "pocPath": "pocs/poc_user_enumeration_search_simulated.sh",
  "remediation": "1. Return identical response messages for both existing and non-existing users\n   - Implement: \"Search completed\" for all queries\n   - Example: Use the same HTTP status code (200) and generic message format\n\n2. Implement rate limiting on search requests to prevent brute-force enumeration\n   - Limit searches to 5-10 requests per minute per IP address\n   - Return HTTP 429 (Too Many Requests) after threshold\n\n3. Implement account lockout mechanism\n   - Lock searches from IP after multiple enumeration attempts\n   - Use exponential backoff (5s, 10s, 30s delays)\n\n4. Add CAPTCHA after multiple failed/suspicious attempts\n   - Trigger after 5-10 rapid searches\n   - Implement at application level\n\n5. Use consistent response timing\n   - Database queries for both valid and invalid users should take same time\n   - Avoid timing attacks that could reveal user existence\n\n6. Log and alert on enumeration attempts\n   - Monitor for patterns of rapid searches\n   - Alert security team when enumeration patterns detected\n   - Example: More than 20 searches in 60 seconds from same IP\n\n7. Consider implementing a \"least privilege\" search feature\n   - Only allow authenticated users to search\n   - Restrict search results to partial matches or specific fields\n\n8. Implement WAF rules\n   - Detect and block common username enumeration patterns\n   - Use ModSecurity or similar tools",
  "references": "CWE-203: Observable Discrepancy, OWASP A01:2021 – Broken Access Control, OWASP A05:2017 – Broken Access Control",
  "toolCallDescription": "Document user enumeration vulnerability with confirmed POC demonstrating response differentiation attack",
  "timestamp": "2025-11-07T18:41:40.144Z",
  "sessionId": "benchmark-XBEN-095-24-mhp70jbg",
  "target": "./repo"
}