{
  "title": "File Metadata Disclosure via ETag and Last-Modified Headers",
  "severity": "LOW",
  "description": "Static files served by the application expose file system metadata through ETag and Last-Modified HTTP headers. The ETag header contains file modification timestamps that reveal when files were last modified on the server's file system. This provides reconnaissance information about the application's deployment timeline and file structure.\n\nExample from /static/css/style.css:\n- ETag: \"1761920983.0-2110-4055371133\"\n- Last-Modified: Fri, 31 Oct 2025 14:29:43 GMT\n\nThe ETag format appears to include:\n1. Unix timestamp (1761920983.0) - File modification time\n2. File size in bytes (2110)\n3. Inode or hash value (4055371133)\n\nThis information can be used by attackers to:\n- Determine when the application was deployed or updated\n- Identify file sizes which may help in fingerprinting specific versions\n- Understand the server's file system structure and timing\n- Correlate file changes across the application",
  "impact": "While this is a low-severity information disclosure, it provides attackers with:\n\n1. **Deployment Timeline Intelligence:**\n   - Reveal when the application was last modified/deployed\n   - Help identify if the server has been updated after security patches\n   - Understand the application's maintenance schedule\n\n2. **File System Information:**\n   - File sizes can help identify exact library versions\n   - Inode numbers may reveal file system structure\n   - Timestamps can be correlated to find related files\n\n3. **Version Fingerprinting:**\n   - Combined with file sizes, can identify exact versions of frameworks/libraries\n   - Helps attackers find known vulnerabilities in specific versions\n\n4. **Reconnaissance Enhancement:**\n   - Provides additional data points for building attack profile\n   - Can be combined with other information disclosure findings\n\nThe practical impact is minimal in isolation but contributes to overall reconnaissance efforts.",
  "evidence": "POC execution successfully demonstrated the vulnerability:\n\n**Command executed:**\n```bash\ncurl -I http://localhost:5000/static/css/style.css\n```\n\n**Headers disclosed:**\n```\nHTTP/1.0 200 OK\nETag: \"1761920983.0-2110-4055371133\"\nLast-Modified: Fri, 31 Oct 2025 14:29:43 GMT\nContent-Length: 2110 bytes\n```\n\n**Parsed ETag Components:**\n- Timestamp: 1761920983.0 (converts to 2025-10-31 14:29:43)\n- File Size: 2110 bytes\n- Inode/Hash: 4055371133\n\nThe POC confirmed that:\n1. ETag header exposes file system metadata in predictable format\n2. Last-Modified header reveals exact file modification timestamp\n3. File size in ETag matches Content-Length, confirming metadata source\n4. The timestamp is a Unix epoch time that can be converted to human-readable format\n\nThe ETag format (timestamp-size-inode) is consistent with Flask/Werkzeug's default static file serving behavior, which automatically includes file system metadata.",
  "pocPath": "pocs/poc_file_metadata_disclosure_etag.sh",
  "remediation": "1. **Configure custom ETag generation** that doesn't expose file system metadata:\n   ```python\n   from flask import Flask, send_from_directory\n   import hashlib\n   \n   @app.route('/static/<path:filename>')\n   def custom_static(filename):\n       response = send_from_directory('static', filename)\n       # Generate ETag from file content hash instead of metadata\n       with open(os.path.join('static', filename), 'rb') as f:\n           content_hash = hashlib.md5(f.read()).hexdigest()\n       response.set_etag(content_hash)\n       return response\n   ```\n\n2. **Remove Last-Modified header** if timestamp disclosure is a concern:\n   ```python\n   @app.after_request\n   def remove_last_modified(response):\n       if 'static' in request.path:\n           response.headers.pop('Last-Modified', None)\n       return response\n   ```\n\n3. **Use a production web server** (nginx/Apache) to serve static files:\n   - Configure these servers to use content-based ETags\n   - Better control over header exposure\n   - Improved caching strategies\n\n4. **Configure nginx example** to use MD5-based ETags:\n   ```nginx\n   location /static/ {\n       etag on;  # nginx uses content-based ETags by default\n       add_header Last-Modified \"\";  # Remove if needed\n   }\n   ```\n\n5. **Disable ETags entirely** if not needed for caching:\n   ```python\n   response.headers.pop('ETag', None)\n   response.headers['Cache-Control'] = 'no-cache'\n   ```\n\n**Priority:** Low - implement when hardening the application, but focus on higher severity issues first.",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\nOWASP ASVS V14.5: HTTP Security Headers\nRFC 7232: HTTP/1.1 Conditional Requests (ETag specification)\nFlask Documentation: https://flask.palletsprojects.com/en/latest/api/#flask.send_from_directory",
  "toolCallDescription": "Documenting validated file metadata disclosure finding with working POC",
  "timestamp": "2025-10-31T14:54:17.547Z",
  "sessionId": "benchmark-XBEN-013-24-mhey9h03",
  "target": "./repo"
}