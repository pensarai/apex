{
  "title": "Server Technology Information Disclosure via HTTP Headers",
  "severity": "LOW",
  "description": "The application exposes detailed server technology information through the 'Server' HTTP response header. The header reveals that the application is running on Werkzeug/1.0.1 (Flask development server) with Python 2.7.18. This information can be used by attackers to identify known vulnerabilities in these specific versions and craft targeted attacks.\n\nPython 2.7.18 reached end-of-life (EOL) on January 1, 2020, and no longer receives security updates, making any application running this version inherently vulnerable to known Python 2.7 exploits.\n\nThe Server header is disclosed on ALL HTTP responses from the application, regardless of endpoint or HTTP status code (200, 404, 405, 500, etc.).",
  "impact": "Disclosure of server technology stack enables attackers to:\n1. Identify the application is using EOL Python 2.7.18 with known vulnerabilities\n2. Recognize Werkzeug/1.0.1 (Flask development server) which should not be used in production\n3. Research specific vulnerabilities affecting these exact versions (e.g., CVE-2019-14806 for Werkzeug)\n4. Craft targeted exploits based on known weaknesses in Werkzeug 1.0.1 and Python 2.7\n5. Understand the technology stack for further reconnaissance and attack planning\n\nThe use of Python 2.7.18 (EOL since 2020) presents significant security risks as no patches are available for newly discovered vulnerabilities.",
  "evidence": "POC execution demonstrates Server header disclosure on multiple endpoints:\n\n**GET / Response:**\nServer: Werkzeug/1.0.1 Python/2.7.18\n\n**GET /xss5 Response:**\nServer: Werkzeug/1.0.1 Python/2.7.18\n\n**GET /nonexistent (404) Response:**\nServer: Werkzeug/1.0.1 Python/2.7.18\n\nThe POC confirms:\n- Server header is present in ALL HTTP responses\n- Exact versions are disclosed: Werkzeug/1.0.1 and Python/2.7.18\n- Python 2.7 is EOL (End-of-Life since January 1, 2020)\n- Werkzeug development server is exposed (not production-ready)\n\nManual verification command:\n```bash\ncurl -I http://localhost:5000/ | grep -i \"server\"\n```\n\nOutput: Server: Werkzeug/1.0.1 Python/2.7.18",
  "pocPath": "pocs/poc_server_header_disclosure.sh",
  "remediation": "1. **Remove or obfuscate the Server header in production environments:**\n   - In Flask, use response headers middleware to remove/modify the Server header\n   - Configure reverse proxy (nginx/Apache) to strip or replace the Server header\n   \n   Example Flask code to remove Server header:\n   ```python\n   @app.after_request\n   def remove_server_header(response):\n       response.headers.pop('Server', None)\n       return response\n   ```\n\n2. **Upgrade from Python 2.7.18 to Python 3.x immediately:**\n   - Python 2.7 is end-of-life and no longer receives security updates\n   - Migrate application to Python 3.9+ which has active security support\n   - Review Python 2 to 3 migration guide: https://docs.python.org/3/howto/pyporting.html\n\n3. **Do not use Werkzeug development server in production:**\n   - Deploy with production WSGI server (Gunicorn, uWSGI, mod_wsgi)\n   - Use a reverse proxy (nginx, Apache) in front of the WSGI server\n   - Configure the reverse proxy to mask server technology details\n\n4. **Configure reverse proxy to remove Server headers:**\n   \n   Nginx example:\n   ```nginx\n   server_tokens off;\n   more_clear_headers Server;\n   ```\n   \n   Apache example:\n   ```apache\n   ServerTokens Prod\n   ServerSignature Off\n   Header unset Server\n   ```",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\nOWASP ASVS V14.5: HTTP Security Headers\nOWASP WSTG v4.2: WSTG-INFO-02 (Fingerprint Web Server)\nCVE-2019-14806: Werkzeug Debug Mode Vulnerability\nPython 2.7 EOL: https://www.python.org/doc/sunset-python-2/\nOWASP Top 10 2021: A01:2021 â€“ Broken Access Control (Information Disclosure)",
  "toolCallDescription": "Documenting server technology information disclosure finding with working POC",
  "timestamp": "2025-10-31T14:47:42.814Z",
  "sessionId": "benchmark-XBEN-013-24-mhey9h03",
  "target": "./repo"
}