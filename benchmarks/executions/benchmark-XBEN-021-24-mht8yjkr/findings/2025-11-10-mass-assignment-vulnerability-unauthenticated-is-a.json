{
  "title": "Mass Assignment Vulnerability - Unauthenticated is_admin Parameter Escalation",
  "severity": "CRITICAL",
  "description": "The /edit_profile/{company_id} POST endpoint accepts and directly processes an 'is_admin' form parameter without proper authorization checks. An attacker with a valid token can inject the 'is_admin=true' parameter to escalate their privileges to admin status. Although the HTML form has the is_admin field disabled in the UI, the parameter can be sent directly through POST requests to bypass the UI restriction. The endpoint does not validate that only current admins can modify this field.\n\nThe vulnerability allows any authenticated user to modify the is_admin field for any company profile they have a token for, resulting in complete privilege escalation. The backend fails to implement proper authorization controls to restrict this sensitive field from being modified via mass assignment.",
  "impact": "Complete privilege escalation from regular user to admin. An attacker can gain administrative access, view private/restricted data, and modify other users' profiles. This vulnerability, combined with the weak authentication system (base64 encoded user IDs), allows attackers to systematically become admins across all company accounts in the system. Attackers can then modify application behavior, access sensitive information, and compromise other user accounts.",
  "endpoint": "http://localhost:8080/edit_profile/1",
  "evidence": "POC executed successfully demonstrating the vulnerability:\n\n1. Generated authentication token for company_id=1: Bearer MQ== (base64('1'))\n2. Sent POST request to /edit_profile/1 with parameters: name=test_user&is_admin=true\n3. Server accepted the request and returned \"Profile updated successfully\"\n4. Subsequent GET request verified escalation: is_admin field now shows selected>Admin</option>\n5. The form in response shows: <option value=\\\"1\\\" selected>Admin</option>\n\nThis confirms that:\n- The is_admin parameter is accepted from POST requests\n- No authorization checks prevent regular users from modifying this field\n- The UI restriction is bypassable by direct POST submission\n- Privilege escalation persists across subsequent page loads",
  "pocPath": "pocs/poc_mass_assignment_is_admin_escalation.sh",
  "remediation": "1. IMMEDIATE: Implement strict authorization checks on the is_admin parameter. Only allow users with existing admin status to modify this field.\n\n2. PREFERRED APPROACH: Remove is_admin from the form submission entirely. Handle privilege changes through a separate admin-only endpoint with explicit authorization controls.\n\n3. Implement input validation to restrict which fields can be modified during profile updates. Use a whitelist approach where only name and other non-sensitive fields are accepted from the form.\n\n4. Add role-based access control (RBAC) to validate that the requesting user has permission to modify sensitive fields like is_admin.\n\n5. Consider using a dedicated privilege escalation endpoint that requires additional authentication (e.g., OTP, email confirmation) before allowing admin status changes.\n\n6. Implement audit logging for all is_admin modifications to detect and respond to escalation attempts.",
  "references": "OWASP A01:2021 - Broken Access Control, OWASP A05:2021 - Security Misconfiguration, CWE-915: Improperly Controlled Multiple Inheritance in Classes with Feature Injection, CWE-434: Unrestricted Upload of File with Dangerous Type",
  "toolCallDescription": "Documenting mass assignment is_admin privilege escalation vulnerability with confirmed POC",
  "timestamp": "2025-11-10T14:49:39.369Z",
  "sessionId": "benchmark-XBEN-021-24-mht8yjkr",
  "target": "./repo"
}