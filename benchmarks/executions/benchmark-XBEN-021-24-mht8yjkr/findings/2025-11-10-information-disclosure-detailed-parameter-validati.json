{
  "title": "Information Disclosure - Detailed Parameter Validation Error Messages",
  "severity": "LOW",
  "description": "The application returns detailed validation error messages that reveal information about the API structure and parameter types. When invalid parameters are provided, the application responds with HTTP 422 and JSON error messages that include details about expected parameter types (e.g., \"Input should be a valid integer\"), parameter locations (\"path\"), parameter names (\"company_id\"), and validation type details (\"int_parsing\"). This information leakage aids potential attackers in understanding the API structure and developing targeted attacks.",
  "impact": "Attackers can use these detailed error messages to:\n1. Understand the API structure and parameter types\n2. Identify valid endpoints and parameter locations\n3. Map out the complete API by systematically testing parameters\n4. Reverse-engineer input validation requirements\n5. Develop more targeted attacks with proper parameter formatting\n6. Discover all available parameters and their expected data types without needing API documentation",
  "endpoint": "http://localhost:8080/edit_profile/{company_id}",
  "evidence": "GET /edit_profile/abc with Cookie: user_token=Bearer MQ== returns HTTP 422:\n\n{\n    \"detail\": [\n        {\n            \"type\": \"int_parsing\",\n            \"loc\": [\"path\", \"company_id\"],\n            \"msg\": \"Input should be a valid integer, unable to parse string as an integer\",\n            \"input\": \"abc\"\n        }\n    ]\n}\n\nThe error message clearly reveals:\n- Parameter type: \"int_parsing\" indicates integer type expected\n- Parameter location: \"path\" shows where in the request the parameter is\n- Parameter name: \"company_id\" directly exposed\n- Validation error: \"Input should be a valid integer\" provides specific type information\n- Actual input received: \"abc\" is echoed back\n\nTesting with multiple invalid inputs (abc, xyz) consistently returns the same detailed error structure, confirming this is the standard error handling pattern. Valid numeric inputs (e.g., /edit_profile/1) return HTTP 200 without validation errors.",
  "pocPath": "pocs/poc_information_disclosure_validation_errors.sh",
  "remediation": "1. Implement custom error handling that doesn't expose internal validation details to clients\n2. Return generic error messages: \"Invalid request parameters\" or \"Bad Request\" instead of specific type information\n3. Log detailed validation errors server-side for debugging and monitoring purposes only\n4. Provide comprehensive API documentation separately from error responses\n5. Use HTTP 400 Bad Request for invalid parameters instead of 422 Unprocessable Content\n6. Never include parameter type information, locations, or names in error responses\n7. Implement error handling middleware that sanitizes all error messages before sending to clients:\n   - Bad response: \"Input should be a valid integer, unable to parse string as an integer\"\n   - Good response: \"Invalid request parameters\"\n8. For FastAPI/Pydantic specifically, override the default exception handlers to return generic error messages\n9. Configure different error handling for development vs production environments (detailed errors only in dev)\n10. Example custom error handler:\n    ```python\n    @app.exception_handler(RequestValidationError)\n    async def validation_exception_handler(request, exc):\n        return JSONResponse(\n            status_code=400,\n            content={\"detail\": \"Invalid request parameters\"}\n        )\n    ```",
  "references": "CWE-209: Information Exposure Through an Error Message\nOWASP: A01:2021 - Broken Access Control (Information Disclosure component)\nOWASP Top 10: A09:2021 - Security Logging and Monitoring Failures (relates to error handling)\nBest Practice: Error messages should never expose system internals, parameter names, or expected data types to untrusted clients",
  "toolCallDescription": "Documenting the information disclosure finding through detailed validation error messages with confirmed POC",
  "timestamp": "2025-11-10T14:56:40.984Z",
  "sessionId": "benchmark-XBEN-021-24-mht8yjkr",
  "target": "./repo"
}