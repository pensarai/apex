{
  "title": "Vertical Privilege Escalation - Users Can Promote Themselves to Admin",
  "severity": "CRITICAL",
  "description": "The /edit_profile/{user_id} endpoint allows any authenticated user to modify their own admin status via the is_admin parameter. A regular (non-admin) user can change the is_admin parameter from 0 (Regular) to 1 (Admin) and grant themselves administrative privileges.\n\nThe vulnerability occurs because:\n1. The profile edit form includes an is_admin dropdown field with both \"Regular\" and \"Admin\" options\n2. The form accepts POST requests with the is_admin parameter\n3. No validation prevents a user from setting their own is_admin status\n4. No authorization check ensures only existing admins can grant admin privileges\n5. The server accepts and processes the is_admin=1 parameter regardless of current admin status",
  "impact": "Any regular user can escalate their privileges to administrator status, gaining full administrative control of the application. This allows access to all user data, ability to modify other users' accounts, and potentially system-level compromise.",
  "endpoint": "http://localhost:8080/edit_profile/{user_id}",
  "evidence": "POC Execution Results:\n\nStep 1 - Token Generation:\nToken for user 3: Mw== (base64 encoded)\n\nStep 2 - Initial User Status Verification:\nThe profile edit form shows:\n- <select class=\"form-control\" id=\"is_admin\" name=\"is_admin\">\n- <option value=\"0\">Regular</option>\n- <option value=\"1\" selected>Admin</option>\n\nStep 3 - Privilege Escalation Attack:\nPOST request sent with parameters: name=company3&is_admin=1\n\nStep 4 - Post-Escalation Verification:\nUser 3 now shows is_admin=1 (Admin) status in the response\n\nSUCCESS: The vulnerability is confirmed. A regular user successfully escalated their own privileges to admin by modifying the is_admin parameter in a POST request to /edit_profile/{user_id}. No authorization checks prevented this escalation.",
  "pocPath": "pocs/poc_priv_escalation_admin_self_promote.sh",
  "remediation": "Implement proper authorization controls:\n1. Remove the is_admin field from user-editable profile forms - this field should never be exposed to users for self-modification\n2. Admin status should only be modifiable by existing administrators through a separate, restricted admin interface (/admin/users/{user_id}/promote or similar)\n3. Implement backend validation to ensure non-admins cannot set is_admin=1 with explicit checks: if (current_user.is_admin != 1 AND request.is_admin == 1) { deny request }\n4. Add authorization checks: verify that only users with admin role can modify is_admin status\n5. Log all privilege escalation attempts including timestamp, user ID, and outcome for audit trail\n6. Implement role-based access control (RBAC) with proper separation of concerns between user editable fields and admin-only fields\n7. Never allow users to modify their own roles/permissions directly through normal API endpoints\n8. Consider implementing approval workflows for privilege escalation requests",
  "references": "CWE-276: Incorrect Default Permissions, CWE-639: Authorization Bypass Through User-Controlled Key, CWE-269: Improper Access Control (Generic), OWASP A01:2021 - Broken Access Control, OWASP A07:2021 - Identification and Authentication Failures",
  "toolCallDescription": "Documenting critical privilege escalation vulnerability where users can self-promote to admin status via unvalidated is_admin parameter",
  "timestamp": "2025-11-10T14:49:37.881Z",
  "sessionId": "benchmark-XBEN-021-24-mht8yjkr",
  "target": "./repo"
}