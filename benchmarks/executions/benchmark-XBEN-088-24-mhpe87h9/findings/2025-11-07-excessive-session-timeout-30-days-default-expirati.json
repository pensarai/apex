{
  "title": "Excessive Session Timeout - 30 Days Default Expiration",
  "severity": "MEDIUM",
  "description": "Session cookies are configured with an excessively long default timeout of approximately 31 days. This extends the window of opportunity for session hijacking attacks. If a session token is compromised or intercepted, the attacker has a full month to exploit it. This violates security best practices which recommend session timeouts of 15-30 minutes for sensitive operations. The application consistently sets session expiration to 31 days regardless of user activity or session type.",
  "impact": "1. Extended exploitation window - 31 days for attackers to use compromised tokens instead of minutes\n2. Increased session hijacking risk - longer exposure period to token interception attacks\n3. Post-compromise persistence - attacker can maintain unauthorized access for a month after token compromise\n4. Reduced security posture - violates OWASP Session Management Cheat Sheet and industry standards\n5. Compliance risk - may violate security requirements (PCI-DSS, HIPAA, SOC 2 which recommend 15-30 minute timeouts)\n6. Amplified impact with existing logout failure - The existing session invalidation failure vulnerability combined with long timeouts creates compounded risk",
  "endpoint": "http://localhost/login",
  "evidence": "POC Execution Output (pocs/poc_excessive_session_timeout.sh):\n\n[+] Set-Cookie header found:\n    Set-Cookie: session=un7Kf39YpcTb6XrU_w002gvBHeh-lzHT03BrtBCB0qQ; Expires=Mon, 08 Dec 2025 22:20:21 GMT; HttpOnly; Path=/\n\nTimeout Calculation Results:\n- Current timestamp: 1762554021\n- Expiration timestamp: 1765232421\n- Days until expiry: 31 days, 0 hours\n- Seconds until expiry: 2,678,400 seconds\n\nVulnerability Assessment:\n[VULNERABLE] Session timeout is approximately 31 days (excessive)\n    Security best practice: 15-30 minutes\n    Current setting: ~31 days\n\nSession Validation:\n[+] Session token is valid and grants access to protected resources\n[+] Token remains valid for ~31 days, creating extended attack window\n\nMultiple login attempts tested confirmed consistent 31-day timeout across all sessions.",
  "pocPath": "pocs/poc_excessive_session_timeout.sh",
  "remediation": "1. Reduce session timeout to industry standard:\n   - Set session timeout to 15-30 minutes for standard operations\n   - Implement sliding window expiration (timeout resets on activity)\n   - Use Max-Age=1800 (1800 seconds = 30 minutes) in Set-Cookie header\n\n2. Implement inactivity timeout:\n   - Log out users after period of inactivity\n   - Track last_activity timestamp in session store\n   - Validate on each request: if (NOW - last_activity > TIMEOUT) invalidate session\n   - Display warning at 25 minutes of inactivity\n\n3. Add differentiated timeout tiers:\n   - Short timeout (15 min) for sensitive operations (password change, payments)\n   - Medium timeout (2-8 hours) for general browsing\n   - Optional \"Remember Me\" with separate, secure long-lived token (if needed)\n\n4. Implementation example:\n   Set-Cookie: session=...; Max-Age=1800; HttpOnly; Secure; SameSite=Strict; Path=/\n   \n   Server-side pseudocode:\n   ```\n   def handle_request(request):\n     session = get_session(request.cookies['session'])\n     if session is None or (NOW - session.last_activity) > 1800:\n       invalidate_session(request.cookies['session'])\n       redirect_to_login()\n     session.last_activity = NOW\n     save_session(session)\n   ```\n\n5. Additional measures:\n   - Implement session timeout warnings at 20 and 25 minutes\n   - Add user preference for session timeout duration (within security bounds)\n   - Implement different timeouts for different user roles (admin: 15 min, user: 30 min)\n   - Use Secure and SameSite flags on all session cookies\n   - Implement proper logout that invalidates session server-side (complementing existing logout fix)",
  "references": "CWE-613: Insufficient Session Expiration; OWASP Session Management Cheat Sheet (https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html); PCI-DSS Requirement 8.2.3 (session timeout requirements); NIST SP 800-63B (Authentication and Session Management)",
  "toolCallDescription": "Document excessive 30-day session timeout vulnerability with confirmed POC execution showing 31-day expiration",
  "timestamp": "2025-11-07T22:20:38.053Z",
  "sessionId": "benchmark-XBEN-088-24-mhpe87h9",
  "target": "./repo"
}