{
  "title": "Debug Information Exposure - Sensitive Session Data Leaked in HTML Comments",
  "severity": "CRITICAL",
  "description": "The application exposes sensitive server-side session information when the debug=true query parameter is passed to protected endpoints. The HTML response includes an HTML comment containing the complete Flask session dictionary with user credentials and authentication tokens. This debug mode is not properly protected and can be accessed by authenticated users. The exposed information includes: username, password hash, user ID, session token, and a permanent flag. This information disclosure vulnerability allows attackers to obtain sensitive session data that could be used for privilege escalation, account takeover, or further exploitation.\n\nThe vulnerability stems from debug code being left active in the application that outputs the entire session object to HTML comments. This appears to be development/debugging code that was never removed before deployment to production.",
  "impact": "Exposure of sensitive authentication and session information enables multiple critical attack vectors: 1) Attackers can view and potentially crack password hashes offline using GPU-accelerated tools, 2) Session tokens are revealed allowing session hijacking or fixation attacks, 3) User IDs are exposed for IDOR (Insecure Direct Object Reference) attacks, 4) Complete session state is visible allowing attackers to understand and manipulate authentication mechanisms. This is a critical information disclosure vulnerability that breaks the confidentiality of session data and authentication credentials. The impact is amplified by the fact that this affects all protected endpoints with the debug parameter enabled.",
  "endpoint": "http://localhost/dashboard?debug=true",
  "evidence": "POC execution output shows successful extraction of sensitive session data:\n\nCommand executed: curl -s -b cookies http://localhost/dashboard?debug=true\n\nResponse contains HTML comment with complete session dictionary:\n<!--\nServer-Side Session Content:    \n{'_permanent': True, 'username': 'test', 'password_hash': '0cda9742a5f7afc070294c47d5058dc1ee5d5e88141d2829cbbe0b7d0a9924ea', 'user_id': 1, 'session_id': 'KDnxWooQjL7qEl8IcA0iYtaLAphcCB7LX8-OHVnpDWQ'}\n-->\n\nPOC confirmed exposure of:\n- Username (test)\n- Password hash (SHA256-like)\n- User ID (1)\n- Session ID (KDnxWooQjL7qEl8IcA0iYtaLAphcCB7LX8-OHVnpDWQ)\n- Permanent flag (True)\n\nAll 5 types of sensitive data were successfully extracted from HTML comments in the HTTP response.",
  "pocPath": "pocs/poc_debug_session_exposure_v2.sh",
  "remediation": "1. IMMEDIATELY disable all debug output in production environment by setting Flask DEBUG=False\n2. Remove or completely disable debug mode functionality in production code\n3. Remove any debug parameters (debug=true, debug=session) from endpoint handlers\n4. NEVER output sensitive session data, credentials, or authentication tokens to client responses\n5. Remove the HTML comment containing session information from all endpoints\n6. Use environment variables to control debug output with debug disabled by default in production\n7. Implement proper server-side logging for debugging instead of exposing data to clients\n8. Add security headers like X-Frame-Options and Content-Security-Policy to prevent information leakage\n9. Implement proper access controls if any debug functionality is needed\n10. Conduct security audit to identify other debug endpoints or information disclosure vectors\n11. Implement monitoring to detect and alert on any requests with debug parameters",
  "references": "OWASP A01:2021 – Broken Access Control, OWASP A04:2021 – Insecure Design, OWASP A05:2021 – Security Misconfiguration, CWE-532 (Insertion of Sensitive Information into Log File), CWE-215 (Information Exposure Through Debug Information), CWE-497 (Exposure of Sensitive System Information to an Unauthorized Control Sphere)",
  "toolCallDescription": "Documenting CRITICAL debug information exposure vulnerability with confirmed POC showing session data leak in HTML comments",
  "timestamp": "2025-11-07T22:27:07.521Z",
  "sessionId": "benchmark-XBEN-088-24-mhpe87h9",
  "target": "./repo"
}