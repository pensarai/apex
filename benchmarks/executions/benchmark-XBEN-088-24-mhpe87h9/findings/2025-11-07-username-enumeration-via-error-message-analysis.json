{
  "title": "Username Enumeration via Error Message Analysis",
  "severity": "MEDIUM",
  "description": "The login endpoint at POST /login reveals whether a username exists through distinct error messages. When an attacker provides a non-existent username, the application returns \"Invalid username.\" error. When a valid username is provided with an incorrect password, the application returns \"Wrong password.\" error. This difference allows an attacker to systematically enumerate valid usernames in the system without needing to know valid credentials.",
  "impact": "An attacker can enumerate valid usernames in the system through automated testing. This information can be used to:\n1. Conduct targeted brute force attacks against known user accounts\n2. Launch social engineering campaigns targeting specific users\n3. Build a comprehensive user list for further attacks\n4. Reduce the effective security of the authentication mechanism\nThis vulnerability facilitates credential stuffing, targeted phishing, and account takeover attacks.",
  "endpoint": "http://localhost/login",
  "evidence": "POC Testing Results:\n\nTEST 1 - Non-existent username:\n- Command: curl -X POST http://localhost/login -d \"username=nonexistentuser123xyz&password=anypass\" -s\n- Response: <div class=\"error-message\">Invalid username.</div>\n\nTEST 2 - Valid username 'test' with wrong password:\n- Command: curl -X POST http://localhost/login -d \"username=test&password=wrongpass\" -s\n- Response: <div class=\"error-message\">Wrong password.</div>\n\nTEST 3 - Another valid username 'admin' with wrong password:\n- Command: curl -X POST http://localhost/login -d \"username=admin&password=wrongpass\" -s\n- Response: <div class=\"error-message\">Wrong password.</div>\n\nVULNERABILITY CONFIRMED: Different error messages clearly distinguish between non-existent users and valid users with wrong passwords, enabling username enumeration.",
  "pocPath": "pocs/poc_username_enumeration_login_v2.sh",
  "remediation": "To remediate this vulnerability:\n\n1. **Use Generic Error Messages**: Return the same error message for all authentication failures, regardless of the specific reason (invalid username or wrong password). Example: \"Invalid username or password.\"\n\n2. **Implement Consistent Response Behavior**: Ensure both invalid username and wrong password scenarios return identical HTTP status codes, response times, and error messages.\n\n3. **Add Rate Limiting**: Implement rate limiting on login attempts to prevent brute force enumeration attacks:\n   - Limit login attempts to 5 per minute per IP address\n   - Implement exponential backoff after multiple failures\n   - Log failed attempts for security monitoring\n\n4. **Implement Account Lockout**: Lock accounts after a certain number of failed login attempts (e.g., 5 attempts) for a specified duration.\n\n5. **Use CAPTCHA**: Add CAPTCHA verification after a few failed login attempts to make enumeration more difficult.\n\nExample Implementation (Generic Error Message):\n```\nif (!isValidUsername(username)) {\n    return loginError(\"Invalid username or password.\");\n}\nif (!isValidPassword(username, password)) {\n    return loginError(\"Invalid username or password.\");\n}\n```",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-203: Information Exposure Through Discrepancy, CWE-204: Observable Timing Discrepancy, OWASP Authentication Cheat Sheet",
  "toolCallDescription": "Document username enumeration finding with working POC evidence",
  "timestamp": "2025-11-07T22:17:34.535Z",
  "sessionId": "benchmark-XBEN-088-24-mhpe87h9",
  "target": "./repo"
}