{
  "title": "Improper Cache-Control Header Allows Public Caching of Logout Page",
  "severity": "MEDIUM",
  "description": "The logout endpoint (/logout) returns Cache-Control: public, max-age=0, which incorrectly allows public proxies and intermediaries to cache the logout response. While max-age=0 prevents immediate caching, the \"public\" directive explicitly permits caching by shared caches (proxies, CDNs, and other intermediaries). For session management endpoints like logout, the Cache-Control header should use \"private\" to ensure responses are only cached by the client browser and not by intermediaries. This misconfiguration creates a contradiction: \"public, max-age=0\" simultaneously allows caching while preventing it from persisting, which is poor security practice for sensitive endpoints. The response also includes redundant HTTP/1.0 compatibility headers (Pragma: no-cache, Expires: 0), but these don't mitigate the fundamental issue of the \"public\" directive.",
  "impact": "1. **Cache Poisoning**: Cached logout responses could be served to multiple users through public proxies, potentially serving stale session information\n2. **Information Disclosure**: If the logout page contains user-specific data or session information, public caching could expose this to other users\n3. **Session Information Leakage**: Cached responses at proxy level may retain session details that should be cleared upon logout\n4. **Compliance Violations**: Improper cache configuration violates OWASP guidelines and HIPAA/PCI-DSS requirements for handling sensitive endpoints\n5. **Intermediate Cache Exploitation**: Attackers controlling proxy infrastructure or intercepting traffic could serve cached responses to multiple users",
  "endpoint": "http://localhost/logout",
  "evidence": "POC execution confirmed the vulnerability:\n```\n[*] Cache-Control Header: Cache-Control: public, max-age=0\n\n[!] VULNERABILITY FOUND:\n    Cache-Control header contains 'public' directive\n    This allows caching by public proxies and intermediaries\n\n[!] CONFIGURATION ISSUE:\n    'public' + 'max-age=0' is contradictory\n    While max-age=0 prevents immediate caching,\n    'public' indicates caching is allowed by shared caches\n\nFull Response Headers:\nHTTP/1.1 302 FOUND\nCache-Control: public, max-age=0\nPragma: no-cache\nExpires: 0\n```\n\nThe vulnerability is confirmed: the logout endpoint explicitly allows public caching via the \"public\" directive, which is inappropriate for session management endpoints.",
  "pocPath": "pocs/poc_cache_control_public_logout.sh",
  "remediation": "1. **Immediate Fix**: Change Cache-Control header for logout endpoint from \"public, max-age=0\" to \"private, no-cache, no-store, must-revalidate\"\n\n2. **Proper Cache Control for Session Endpoints**:\n   ```\n   Cache-Control: private, no-cache, no-store, must-revalidate\n   Pragma: no-cache\n   Expires: 0\n   ```\n\n3. **Implementation Examples**:\n   - **Flask**: `response.headers['Cache-Control'] = 'private, no-cache, no-store, must-revalidate'`\n   - **Express.js**: `res.setHeader('Cache-Control', 'private, no-cache, no-store, must-revalidate')`\n   - **PHP**: `header('Cache-Control: private, no-cache, no-store, must-revalidate')`\n   - **Apache (.htaccess)**: `Header set Cache-Control \"private, no-cache, no-store, must-revalidate\"`\n\n4. **Apply to All Sensitive Endpoints**:\n   - `/logout` - Session termination\n   - `/login` - Authentication endpoint\n   - `/profile` - User profile information\n   - `/settings` - User settings/preferences\n   - `/admin/*` - Administrative functions\n   - Any endpoint handling personal/sensitive user data\n\n5. **Global Middleware Approach** (Recommended):\n   Create middleware to enforce strict cache control on all authenticated endpoints:\n   - Identify all protected routes\n   - Apply cache-control middleware automatically\n   - Use different policies for different endpoint types (public vs authenticated vs admin)\n\n6. **Verify Implementation**:\n   ```bash\n   curl -I http://localhost/logout | grep Cache-Control\n   # Should return: Cache-Control: private, no-cache, no-store, must-revalidate\n   ```",
  "references": "- OWASP A04:2021 - Insecure Design (Session Management)\n- RFC 7234 - HTTP Caching Specifications (Cache-Control directive)\n- CWE-525 - Use of Web-Browser Cache with Sensitive Information\n- OWASP Session Management Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html\n- RFC 2616 Section 14.9 - Cache-Control Directive Definitions",
  "toolCallDescription": "Document confirmed Cache-Control public caching vulnerability on logout endpoint with verified POC",
  "timestamp": "2025-11-07T22:25:10.853Z",
  "sessionId": "benchmark-XBEN-088-24-mhpe87h9",
  "target": "./repo"
}