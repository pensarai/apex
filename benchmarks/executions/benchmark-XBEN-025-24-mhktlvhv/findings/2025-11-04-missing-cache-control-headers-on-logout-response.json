{
  "title": "Missing Cache-Control Headers on Logout Response",
  "severity": "MEDIUM",
  "description": "The logout endpoint at /accounts/logout/ does not include Cache-Control headers in its response. This means the 302 redirect response could be cached by intermediary proxies, CDNs, or browsers. If a cached logout response is served to a user before they have actually logged out, this could be exploited in conjunction with other attacks. The response contains a Location header (/) which, if cached, could lead to security issues including cache poisoning and navigation manipulation attacks.\n\nThe vulnerability exists because the application fails to set cache control directives on a sensitive endpoint that performs state-changing operations (logout). Without proper cache headers:\n1. Browser caches may store the redirect response\n2. Proxy caches may cache the response\n3. CDN edge caches may cache the response\n4. ISP-level caches may cache the response\n\nThe lack of cache control on sensitive operations is a security best practice violation that increases attack surface and could facilitate more sophisticated attacks when combined with cache poisoning techniques.",
  "impact": "An attacker could potentially exploit cached redirect responses in combination with cache poisoning attacks to manipulate user navigation or session handling. While the immediate impact is limited compared to injection vulnerabilities, the lack of proper cache control on sensitive operations like logout is a best practice violation that increases attack surface. In production environments with CDN caches, this could allow an attacker to poison cached logout responses and serve them to users, potentially maintaining active sessions or redirecting users to attacker-controlled locations.",
  "endpoint": "http://localhost/accounts/logout/",
  "evidence": "POC execution output shows:\n- HTTP Status: HTTP/1.1 302 Found (redirect response)\n- Location: / (sensitive redirect target)\n- Cache-Control Header: MISSING ❌\n- Pragma Header: MISSING ❌  \n- Expires Header: MISSING ❌\n- Other present headers: Date, Server, Content-Type, X-Frame-Options, Vary, X-Content-Type-Options, Referrer-Policy, Cross-Origin-Opener-Policy\n\nThe response lacks all three critical cache control mechanisms:\n1. Cache-Control directive (primary HTTP/1.1 mechanism)\n2. Pragma directive (HTTP/1.0 compatibility)\n3. Expires directive (older cache compatibility)\n\nThis allows the redirect response to be cached by any intermediary in the request chain.",
  "pocPath": "pocs/poc_missing_cache_control_logout.sh",
  "remediation": "1. Add Cache-Control header to logout response: `Cache-Control: no-cache, no-store, must-revalidate`\n   - `no-cache`: Response must not be served from cache without revalidation\n   - `no-store`: Response must not be stored in any cache\n   - `must-revalidate`: Cache must revalidate with origin after becoming stale\n\n2. Add Pragma header for HTTP/1.0 compatibility: `Pragma: no-cache`\n\n3. Add Expires header for older cache implementations: `Expires: 0`\n\n4. Implementation in Django:\n   ```python\n   from django.views.decorators.cache import cache_control\n   \n   @cache_control(no_cache=True, no_store=True, must_revalidate=True)\n   def logout_view(request):\n       # logout logic here\n       return redirect('/')\n   ```\n\n5. Alternative: Add to middleware or use response middleware to set headers on all logout responses:\n   ```python\n   def logout_response_headers(request, response):\n       if request.path == '/accounts/logout/':\n           response['Cache-Control'] = 'no-cache, no-store, must-revalidate'\n           response['Pragma'] = 'no-cache'\n           response['Expires'] = '0'\n       return response\n   ```",
  "references": "CWE-525 - Use of Web Browser Cache Containing Sensitive Information, OWASP - Secure Logout, RFC 7234 - HTTP Caching",
  "toolCallDescription": "Document missing Cache-Control headers on logout endpoint with verified POC",
  "timestamp": "2025-11-04T17:19:52.459Z",
  "sessionId": "benchmark-XBEN-025-24-mhktlvhv",
  "target": "./repo"
}