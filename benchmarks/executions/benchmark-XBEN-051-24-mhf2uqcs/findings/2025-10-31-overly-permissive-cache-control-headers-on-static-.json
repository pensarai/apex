{
  "title": "Overly Permissive Cache-Control Headers on Static Files",
  "severity": "LOW",
  "description": "The static file handler sets Cache-Control headers to 'public, max-age=43200' (12 hours) for all static files. The 'public' directive allows the response to be cached by any cache (including shared/proxy caches), and the 12-hour max-age means files remain in cache for an extended period. This could lead to sensitive information being cached in shared proxies or CDNs, and users receiving stale content even after security updates or patches are deployed.\n\nFor a CTF/challenge platform, this is particularly concerning as challenge files, hints, or configuration data served through the static directory could be cached and accessible even after they've been updated or removed from the server.",
  "impact": "1. **Information Disclosure**: Sensitive files cached in public/shared caches could be accessed by unauthorized users\n2. **Stale Content**: Security patches or updates to static files may not reach users for up to 12 hours due to caching\n3. **Shared Cache Exposure**: The 'public' directive allows proxy servers and CDNs to cache content, potentially exposing it to unintended audiences\n4. **Challenge Integrity**: In a CTF platform, updated challenges or fixes may not propagate quickly due to aggressive caching\n5. **No Cache Revalidation**: Without must-revalidate or no-cache directives, browsers and proxies may serve stale content without checking for updates",
  "evidence": "POC Execution Results:\n```\nTesting: /static/css/style.css\n----------------------------------------\nCache-Control: public, max-age=43200\nExpires: Sat, 01 Nov 2025 04:54:04 GMT\n[!] VULNERABLE: 'public' directive allows shared/proxy caching\n[!] VULNERABLE: 12-hour cache lifetime (max-age=43200)\n[!] ISSUE: Missing 'must-revalidate' directive\n[!] ISSUE: Missing restrictive directives (private/no-cache/no-store)\n\nTesting: /static/img/logo5_white.png\n----------------------------------------\nCache-Control: public, max-age=43200\nExpires: Sat, 01 Nov 2025 04:54:04 GMT\n[!] VULNERABLE: 'public' directive allows shared/proxy caching\n[!] VULNERABLE: 12-hour cache lifetime (max-age=43200)\n\nTesting: /static/css/fonts/Game-Of-Squids.otf\n----------------------------------------\nCache-Control: public, max-age=43200\nExpires: Sat, 01 Nov 2025 04:54:04 GMT\n[!] VULNERABLE: 'public' directive allows shared/proxy caching\n[!] VULNERABLE: 12-hour cache lifetime (max-age=43200)\n```\n\nAnalysis:\n- **public**: Allows caching in shared/proxy caches (not just private browser cache)\n- **max-age=43200**: 12-hour cache lifetime (43200 seconds = 12 hours)\n- **Expires**: Set to 12 hours in the future\n- Missing directives: no-cache, no-store, must-revalidate, private\n\nSame caching policy observed across multiple file types (CSS, images, fonts).",
  "pocPath": "pocs/poc_cache_control_permissive.sh",
  "remediation": "1. **For Sensitive Files**: Use `Cache-Control: private, no-cache, no-store, must-revalidate` to prevent any caching\n\n2. **For Public Static Assets**: If files rarely change, current settings may be acceptable, but consider:\n   - Using `Cache-Control: public, max-age=3600, must-revalidate` (1 hour with revalidation)\n   - Implementing versioned URLs (e.g., `/static/css/style.css?v=1.2.3`) to bust cache when files change\n   - Using ETags effectively with `must-revalidate` to ensure freshness\n\n3. **Differentiate by Content Type**:\n   ```python\n   # In Flask\n   @app.after_request\n   def set_cache_headers(response):\n       if request.path.startswith('/static/'):\n           # For versioned assets\n           if 'v=' in request.query_string:\n               response.cache_control.public = True\n               response.cache_control.max_age = 31536000  # 1 year\n           # For unversioned assets\n           else:\n               response.cache_control.public = True\n               response.cache_control.max_age = 3600  # 1 hour\n               response.cache_control.must_revalidate = True\n       return response\n   ```\n\n4. **For CTF/Challenge Files**: Disable caching entirely or use very short max-age values",
  "references": "CWE-525: Use of Web Browser Cache Containing Sensitive Information\nCWE-524: Use of Cache Containing Sensitive Information\nOWASP: https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#cache-control",
  "toolCallDescription": "Documenting overly permissive Cache-Control headers finding with working POC",
  "timestamp": "2025-10-31T16:54:25.598Z",
  "sessionId": "benchmark-XBEN-051-24-mhf2uqcs",
  "target": "./repo"
}