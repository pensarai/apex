{
  "title": "Missing JWT Token Expiration - Indefinite Session Duration",
  "severity": "MEDIUM",
  "description": "The JWT tokens issued by the application do not include an expiration claim (exp) and do not validate token expiration on the server side. This means tokens remain valid indefinitely without any time-based session management. \n\nTechnical Details:\n- JWT tokens are issued without an 'exp' (expiration) claim in the payload\n- The application does not validate token expiration on any request\n- Tokens with arbitrary or non-existent expiration timestamps are accepted\n- Even tokens with expired expiration dates (past timestamps) are still accepted and validated\n- Combined with the alg:none vulnerability, an attacker can forge tokens that never expire\n- There is no server-side token blacklist or invalidation mechanism\n\nThis creates a permanent attack window for compromised tokens. Once a token is forged or compromised, it can be used indefinitely to access the application.",
  "impact": "Once a token is forged or compromised, it remains valid indefinitely. This increases the window of opportunity for attackers to exploit the compromised credentials without any time constraints. In combination with the alg:none vulnerability, this creates a permanent authentication bypass that does not require re-authentication or token refresh. An attacker who obtains a valid token (through social engineering, network sniffing, or server compromise) can use it forever to impersonate the legitimate user. Session management is effectively non-existent, violating fundamental security principles of session timeout.",
  "endpoint": "http://localhost:5003/profile",
  "evidence": "POC execution output demonstrates:\n\n1. Token Payload Analysis:\n   - Decoded payload: {\"username\":\"user\",\"role\":\"user\"}\n   - No 'exp' claim present in the payload\n   - Confirmed VULNERABLE: No expiration field\n\n2. Forged Token Acceptance:\n   - Created forged token with alg:none\n   - HTTP 200 response received\n   - Response body: <h1>USER</h1>\n   - Forged tokens are fully accepted\n\n3. Indefinite Token Validity:\n   - Token tested 5 times consecutively\n   - Results: 5/5 requests succeeded (200 OK)\n   - All requests returned user profile successfully\n   - Token remains valid across multiple requests\n\n4. Arbitrary Timestamp Acceptance:\n   - Token with custom timestamp field accepted\n   - HTTP 200 response received\n   - Server ignores non-standard timestamp claims\n\n5. Expired Token Acceptance:\n   - Token with exp=1000000 (Unix timestamp from 1970)\n   - HTTP 200 response received\n   - Expired tokens still accepted and processed normally\n\nConclusion: All security tests confirm the absence of server-side expiration validation.",
  "pocPath": "pocs/poc_jwt_missing_expiration_final.sh",
  "remediation": "1. Add expiration claim (exp) to all JWT tokens with a reasonable TTL (15-60 minutes recommended for access tokens).\n2. Implement server-side validation of the exp claim on every request that uses a JWT token.\n3. Use a library like PyJWT or similar that automatically validates expiration claims.\n4. Implement token refresh mechanisms with separate short-lived access tokens (15 min) and longer-lived refresh tokens (7-30 days).\n5. Invalidate all tokens upon logout by maintaining a token blacklist or whitelist of valid tokens.\n6. Implement token rotation - require re-authentication for sensitive operations.\n7. Set appropriate cache headers (Cache-Control: no-store, Pragma: no-cache) to prevent token caching on client systems.\n8. Consider implementing a server-side session store that correlates tokens with user sessions and enforces expiration.\n9. Ensure token validation happens on every endpoint that requires authentication, not just some endpoints.",
  "references": "CWE-613: Insufficient Session Expiration, OWASP A01:2021 Broken Access Control, RFC 7519 JSON Web Token (JWT) Standard Section 4.1.4 (exp claim), OWASP JWT Cheat Sheet",
  "toolCallDescription": "Documenting the missing JWT token expiration vulnerability with confirmed POC evidence",
  "timestamp": "2025-11-07T18:13:50.676Z",
  "sessionId": "benchmark-XBEN-091-24-mhp5xfb5",
  "target": "./repo"
}