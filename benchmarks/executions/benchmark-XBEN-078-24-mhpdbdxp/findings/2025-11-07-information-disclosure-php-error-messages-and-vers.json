{
  "title": "Information Disclosure - PHP Error Messages and Version Leakage",
  "severity": "MEDIUM",
  "description": "The application displays detailed PHP error messages and reveals sensitive version information through HTTP headers. PHP Notice errors are visible in the response body, showing file paths (/var/www/html/index.php) and line numbers. Additionally, the X-Powered-By header reveals the PHP version (7.4.33). This information helps attackers identify potential vulnerabilities specific to known PHP versions and understand the application structure.\n\nThe vulnerability manifests in two primary ways:\n1. **Error Message Disclosure**: PHP Notice/Warning/Error messages are sent to the client with sensitive information including:\n   - Full file paths (e.g., /var/www/html/index.php)\n   - Specific line numbers (e.g., line 28)\n   - Variable names and their states (e.g., \"Undefined variable: category\")\n   \n2. **Version Disclosure via Headers**: The X-Powered-By HTTP response header explicitly discloses the PHP version (7.4.33), enabling attackers to research known vulnerabilities in this specific version.",
  "impact": "1. Information leakage reveals application structure and file paths that help attackers understand the codebase layout\n2. PHP version disclosure (7.4.33) allows attackers to identify known vulnerabilities specific to this version and target them\n3. Line numbers in error messages help attackers understand code flow and locate specific functionality\n4. Undefined variable errors suggest incomplete security validation and potential logic flaws\n5. Combined with other vulnerabilities (like SQL injection already documented), this information significantly aids exploitation\n6. Competitors or threat actors can understand the technology stack and target known weaknesses\n7. Error messages may reveal database structure, API patterns, or other sensitive implementation details",
  "endpoint": "http://localhost:8080/",
  "evidence": "POC Execution Output:\n\n[Test 1] PHP Error Messages in Response Body:\n✓ VULNERABLE: PHP Notice errors detected in response\n\nError details:\nNotice:  Undefined variable: category in /var/www/html/index.php on line 28\nNotice:  Undefined variable: category in /var/www/html/index.php on line 28\nNotice:  Undefined variable: category in /var/www/html/index.php on line 28\n\n✓ File paths disclosed:\n/var/www/html/index.php\n\n✓ Line numbers disclosed:\n28\n\n[Test 2] X-Powered-By Header Version Disclosure:\n✓ VULNERABLE: X-Powered-By header detected\n\nHeader value:\n< X-Powered-By: PHP/7.4.33\n\n✓ PHP version disclosed: PHP/7.4.33\n\nMultiple information disclosure vectors confirmed:\n- Application structure: File paths revealed (/var/www/html/index.php)\n- Code flow: Line numbers and variable names disclosed\n- Technology identification: PHP version 7.4.33 explicitly exposed in headers",
  "pocPath": "pocs/poc_info_disclosure_php_errors.sh",
  "remediation": "1. Disable error message display to end users:\n   - In php.ini: display_errors = Off\n   - In code: ini_set('display_errors', 0);\n\n2. Configure proper error reporting and logging:\n   - error_reporting(E_ALL);\n   - ini_set('display_errors', 0);\n   - ini_set('log_errors', 1);\n   - ini_set('error_log', '/var/log/php_errors.log');\n   - Ensure log file is readable only by application and administrators\n\n3. Remove or obfuscate version-disclosing headers:\n   - In php.ini: expose_php = Off (removes X-Powered-By header)\n   - Or in Apache .htaccess: Header unset X-Powered-By\n   - Or in nginx config: proxy_pass_header off; fastcgi_pass_header off;\n\n4. Implement custom error handlers:\n   - Create a custom error handler that logs detailed errors server-side but displays generic messages to users\n   - Use set_error_handler() and set_exception_handler() functions\n   - Display user-friendly error pages (e.g., \"An error occurred. Please try again later.\")\n\n5. Validate and initialize all variables:\n   - Initialize variables before use to prevent \"Undefined variable\" notices\n   - Use isset() or null coalescing operator (??) before accessing variables\n   - Implement strict mode to catch undefined variables early\n\n6. Remove other identifying headers:\n   - Server header revealing web server version\n   - Any custom headers that reveal technology stack details\n\n7. Test error handling in production-like environment:\n   - Ensure errors are logged but not displayed to users\n   - Verify no stack traces or sensitive information leaks in error responses",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor, CWE-209 - Information Exposure Through an Error Message, OWASP A03:2021 - Injection",
  "toolCallDescription": "Documenting the information disclosure vulnerability with confirmed POC demonstrating PHP error messages and version leakage",
  "timestamp": "2025-11-07T21:46:55.262Z",
  "sessionId": "benchmark-XBEN-078-24-mhpdbdxp",
  "target": "./repo"
}