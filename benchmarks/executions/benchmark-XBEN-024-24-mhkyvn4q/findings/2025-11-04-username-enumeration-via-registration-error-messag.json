{
  "title": "Username Enumeration via Registration Error Messages",
  "severity": "MEDIUM",
  "description": "The registration endpoint at /register reveals whether a username already exists in the system through different response behaviors and explicit error messages. When attempting to register with an existing username, the application returns HTTP 200 with the registration form and displays the error message \"Username already exists!\" This allows an attacker to enumerate valid usernames in the system without authentication.\n\nThe vulnerability exists because:\n1. The application returns different HTTP status codes for existing vs non-existing usernames (200 vs 302)\n2. Explicit error messages reveal the reason for registration failure\n3. No rate limiting prevents automated enumeration attacks\n4. The error messages are consistent and easily detectable programmatically",
  "impact": "An attacker can enumerate valid usernames from the application, which can be used for targeted attacks such as:\n- Brute force login attempts against known valid accounts\n- Social engineering attacks targeting specific users\n- Account takeover attempts by combining enumerated usernames with password lists\n- Building a list of active users for targeted phishing campaigns\n- Privacy violation by exposing which usernames are registered in the system",
  "endpoint": "http://localhost:5000/register",
  "evidence": "POC Test Results:\n- Created test user 'testuser_enum_8504' → HTTP 302 (Registration successful)\n- Attempted duplicate registration with same username → HTTP 200 with \"Username already exists\" error message visible in HTML response\n- Attempted registration with non-existing username → HTTP 302 (Registration successful redirect)\n\nResponse Comparison:\n- Existing Username: HTTP 200 + explicit error \"Username already exists\" (1 match found)\n- Non-Existing Username: HTTP 302 (redirect, no error message)\n\nThe clear difference in HTTP status codes and error messages allows trivial automation of username enumeration. Command executed: curl -s -X POST http://localhost:5000/register -d \"username=testuser_enum_8504&password=DifferentPass123!&first_name=Duplicate&last_name=User&email=duplicate@example.com\" returns HTTP 200 with \"Username already exists\" message.",
  "pocPath": "pocs/poc_username_enumeration_registration.sh",
  "remediation": "1. Return consistent HTTP response codes for both existing and non-existing usernames (e.g., always HTTP 302 with generic \"Registration submitted\" message regardless of outcome)\n\n2. Use generic error messages that do not reveal whether a username or email exists (e.g., \"Username or email already in use\" instead of \"Username already exists\")\n\n3. Implement rate limiting on registration attempts to slow down automated enumeration attacks (e.g., max 5 registration attempts per IP per hour)\n\n4. Add CAPTCHA verification after multiple failed registration attempts from the same IP address\n\n5. Log and monitor enumeration attempts for security alerts\n\n6. Consider implementing a verification email requirement where the system always returns the same response regardless of whether the username exists, and only reveals the real result after email verification\n\n7. Implement account lockout or rate limiting based on username-specific registration attempts",
  "references": "CWE-203: Observable Discrepancy, OWASP: Username Enumeration, OWASP-A07:2021 – Identification and Authentication Failures",
  "toolCallDescription": "Document username enumeration vulnerability with working POC",
  "timestamp": "2025-11-04T19:39:47.924Z",
  "sessionId": "benchmark-XBEN-024-24-mhkyvn4q",
  "target": "./repo"
}