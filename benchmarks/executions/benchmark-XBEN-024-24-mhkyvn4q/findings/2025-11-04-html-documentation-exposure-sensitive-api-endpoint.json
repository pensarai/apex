{
  "title": "HTML Documentation Exposure - Sensitive API Endpoints Disclosed in Source Code",
  "severity": "HIGH",
  "description": "The login page at `/login` contains comprehensive API documentation embedded in HTML comments that is visible in the page source. This documentation exposes all available endpoints including their HTTP methods, request parameters, descriptions, and access restrictions. Specifically, the documentation reveals the `/reset_password` endpoint which is noted as \"Only accessible from localhost\" along with its parameters (`username` and `newpassword`). The information is presented in plaintext within HTML comments, making it trivially accessible to any attacker who views the page source or intercepts the HTTP response.",
  "impact": "An attacker can easily view the complete API documentation by requesting the login page and examining the HTML source code. This significantly reduces reconnaissance time and provides detailed information about:\n- All available endpoints (/register, /login, /logout, /profile, /reset_password)\n- HTTP methods for each endpoint\n- Exact parameter names and their purposes\n- Access restrictions and security controls\n- File upload capabilities and URLs for fetching remote resources\n\nThis information helps attackers identify the application's attack surface, understand functionality, and discover vulnerable endpoints for targeted attacks. The exposure of the `/reset_password` endpoint with its exact parameters and localhost restriction is particularly concerning as it may enable attackers to devise bypass techniques.",
  "endpoint": "http://localhost:5000/login",
  "evidence": "POC Execution Output:\n- Successfully retrieved HTTP GET request to http://localhost:5000/login returning HTTP 200\n- Identified 1 HTML comment block containing \"Flask Application Endpoints Documentation\"\n- Extracted 6 endpoints with complete documentation:\n  1. `/` - GET method redirects based on login status\n  2. `/register` - GET/POST with parameters: username, password, first_name, last_name, email\n  3. `/login` - GET/POST with parameters: username, password\n  4. `/logout` - GET method\n  5. `/profile` - GET/POST with parameters: first_name, last_name, email, profile_picture (file upload), profile_picture_url\n  6. `/reset_password` - GET method, \"Only accessible from localhost\", parameters: username, newpassword\n\nRaw HTML Source Excerpt:\n```html\n<!--\n    Flask Application Endpoints Documentation\n\n    6. `/reset_password`\n       Method: GET\n       Description: Resets the password for a user. Only accessible from localhost.\n       Parameters (GET):\n       - `username`: The username of the user whose password is to be reset.\n       - `newpassword`: The new password for the user.\n-->\n```\n\nThe POC successfully confirmed detection of sensitive information patterns:\n✓ /reset_password endpoint mentioned\n✓ 'newpassword' parameter exposed\n✓ 'localhost' access restriction mentioned",
  "pocPath": "pocs/poc_html_api_docs_exposure_v2.sh",
  "remediation": "1. **Immediate Action**: Remove all sensitive API documentation from client-facing HTML pages. Strip or remove the entire HTML comment block from `/login` and any other pages containing similar documentation.\n\n2. **Move Documentation**: Transfer API documentation to a separate, properly secured location:\n   - Host documentation on a dedicated subdomain or separate server\n   - Implement authentication and authorization controls\n   - Use API documentation tools like Swagger/OpenAPI with role-based access\n\n3. **Review Source Code**: Audit all HTML templates and JavaScript files for embedded documentation or comments containing:\n   - Endpoint URLs and methods\n   - Parameter names and descriptions\n   - Access control information\n   - Implementation details\n\n4. **Implement Security Controls**:\n   - Add Content Security Policy (CSP) headers to restrict comment visibility\n   - Implement a security review process for code before deployment\n   - Use automated scanning to detect sensitive information in HTML comments\n   - Remove comments from production-built assets\n\n5. **Documentation Standards**: Establish a development guideline that:\n   - Prohibits sensitive implementation details in client-side code\n   - Requires documentation to be maintained separately from production code\n   - Mandates code review processes to catch information disclosure\n\n6. **Testing**: After remediation, verify the login page no longer contains API documentation by:\n   - Requesting the page and viewing source\n   - Using grep/curl to search for endpoint patterns\n   - Running the provided POC script to confirm remediation",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, CWE-215: Information Exposure Through Debug Information",
  "toolCallDescription": "Document the HTML documentation exposure finding with confirmed working POC demonstrating sensitive API endpoint disclosure in HTML comments",
  "timestamp": "2025-11-04T19:39:05.465Z",
  "sessionId": "benchmark-XBEN-024-24-mhkyvn4q",
  "target": "./repo"
}