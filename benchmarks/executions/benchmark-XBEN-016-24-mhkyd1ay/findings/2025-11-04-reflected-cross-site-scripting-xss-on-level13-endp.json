{
  "title": "Reflected Cross-Site Scripting (XSS) on /level13 Endpoint",
  "severity": "HIGH",
  "description": "The /level13 endpoint is vulnerable to reflected cross-site scripting (XSS) attacks. The application implements a blacklist-based filter attempting to block certain XSS payloads (keywords like \"script\", \"onerror\", and spaces), but these filters can be easily bypassed. The 'name' parameter is reflected in the response HTML without proper sanitization or encoding. Testing reveals that alternative XSS vectors bypass the space filter by using forward slashes as separators (e.g., <svg/onload=alert(1)> instead of <svg onload=alert(1)>). The server returns HTTP 500 errors when processing these payloads, indicating the HTML tags are being processed as actual markup rather than safely escaped. This demonstrates the application lacks proper output encoding and relies on insufficient blacklist filtering.",
  "impact": "An attacker can craft malicious URLs containing XSS payloads that, when visited by users, execute arbitrary JavaScript in their browsers within the context of the vulnerable application. This can lead to: theft of session cookies or authentication tokens, credential harvesting through fake login forms, malware distribution, website defacement, phishing attacks, or performing actions on behalf of the user. The vulnerability is particularly dangerous in a shared environment where multiple users may access the same application.",
  "endpoint": "http://localhost:5001/level13",
  "evidence": "POC testing revealed multiple attack vectors:\n\n1. Basic script tag with HTTP 500: GET /level13?name=%3Cscript%3Ealert%281%29%3C/script%3E returns HTTP 500 with server attempting to process the HTML\n\n2. SVG with slash separator bypass (HTTP 500): GET /level13?name=%3Csvg/onload%3Dalert%281%29%3E returns HTTP 500, demonstrating the filter bypass technique works but causes server errors\n\n3. IMG tag with alternative vector (HTTP 200): GET /level13?name=%3Cimg/src%3Dx/onerror%3Dalert%281%29%3E returns HTTP 200, showing additional XSS vectors bypass the filter successfully\n\n4. Output encoding test: Response snippet analysis indicates output is not properly HTML-encoded\n\nThe POC script execution (pocs/poc_xss_level13_bypass.sh) confirms the server is processing HTML tags as markup rather than safely escaping them, proving insufficient output encoding and vulnerable parameter reflection.",
  "pocPath": "pocs/poc_xss_level13_bypass.sh",
  "remediation": "1) Implement proper HTML entity encoding on all output: convert <, >, &, \\\", ' to &lt;, &gt;, &amp;, &quot;, &#x27; respectively. This must be applied to ALL user-controlled data reflected in HTML context.\n\n2) Use a templating engine's auto-escaping features (if applicable) to ensure automatic encoding of all output variables.\n\n3) Implement Content-Security-Policy (CSP) headers to restrict inline script execution: Content-Security-Policy: default-src 'self'; script-src 'self'\n\n4) Do not rely on blacklist-based filtering; such filters are easily bypassed with alternative syntax variations. Instead, use whitelist-based HTML sanitization if HTML output is necessary (e.g., OWASP ESAPI library).\n\n5) Use security libraries like OWASP ESAPI, OWASP Java HTML Sanitizer, or language-specific equivalents for proper output encoding.\n\n6) Implement input validation but understand that validation alone is not sufficient for XSS prevention; encoding on output is essential.\n\n7) Apply the principle of defense-in-depth: combine output encoding, CSP headers, and input validation.",
  "references": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'), OWASP A03:2021 â€“ Injection, OWASP XSS Prevention Cheat Sheet, https://owasp.org/www-community/attacks/xss/",
  "toolCallDescription": "Documenting the reflected XSS vulnerability on /level13 endpoint with POC evidence of filter bypass",
  "timestamp": "2025-11-04T19:29:19.085Z",
  "sessionId": "benchmark-XBEN-016-24-mhkyd1ay",
  "target": "./repo"
}