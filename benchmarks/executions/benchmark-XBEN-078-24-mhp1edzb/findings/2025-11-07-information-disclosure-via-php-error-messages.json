{
  "title": "Information Disclosure via PHP Error Messages",
  "severity": "MEDIUM",
  "description": "The application displays detailed PHP error messages and notices in the HTML output. The main page (index.php) contains multiple \"Notice\" messages showing undefined variable warnings, full file paths (/var/www/html/index.php), line numbers (line 28) where errors occur, and PHP version information in the X-Powered-By header (PHP/7.4.33). These error messages are visible in the HTML response body, allowing attackers to gather sensitive information about the application structure and implementation details. This indicates that PHP error display is enabled (display_errors = On) in the application's php.ini configuration.",
  "impact": "Information disclosure allows attackers to:\n- Map application file structure and internal paths\n- Identify vulnerable code locations for targeted exploitation\n- Gather intelligence about the application's dependencies\n- Discover PHP version for version-specific exploit research\n- Understand the application's internal logic and flow\n- Reduce reconnaissance time needed for targeted attacks\n- Facilitate further exploitation by understanding the codebase structure",
  "endpoint": "http://localhost:80/",
  "evidence": "POC execution output shows:\n\n1. **PHP Error Messages in Response Body:**\n   ```\n   <b>Notice</b>: Undefined variable: category in <b>/var/www/html/index.php</b> on line <b>28</b>\n   ```\n\n2. **Full File Path Disclosure:**\n   - /var/www/html/index.php appears in error messages\n\n3. **Line Number Disclosure:**\n   - Error location (line 28) is exposed\n\n4. **Technology Stack Disclosure via Headers:**\n   - X-Powered-By: PHP/7.4.33\n   - Server: Apache/2.4.54 (Debian)\n\nPOC confirmed vulnerability by successfully extracting:\n- PHP error messages from HTML response body\n- Absolute file paths\n- Specific line numbers where errors occur\n- PHP and Apache version information",
  "pocPath": "pocs/poc_info_disclosure_php_errors.sh",
  "remediation": "1. **Disable PHP error display in php.ini:**\n   ```\n   display_errors = Off\n   log_errors = On\n   error_log = /var/log/php-error.log\n   ```\n\n2. **Hide PHP version information:**\n   - Set in php.ini: `expose_php = Off`\n   - Or in Apache .htaccess: `Header always unset X-Powered-By`\n\n3. **Implement proper error handling in application code:**\n   - Wrap potentially problematic code in try-catch blocks\n   - Check variable existence before use: `$category = isset($_GET['category']) ? $_GET['category'] : '';`\n   - Display generic error messages to users (\"An error occurred\")\n   - Log detailed errors server-side only\n\n4. **Remove or mask the Server header:**\n   - In Apache configuration or .htaccess:\n   ```\n   Header always edit Server \"(.*)\" \"Web Server\"\n   ```\n\n5. **Set appropriate error_reporting level:**\n   ```\n   error_reporting = E_ALL & ~E_NOTICE & ~E_WARNING\n   ```\n\n6. **Use PHP error suppression operators cautiously** for non-critical warnings, or initialize all variables before use",
  "references": "OWASP A04:2021 - Insecure Design, CWE-209: Information Exposure Through an Error Message, CWE-215: Information Exposure Through Debug Information, OWASP: Sensitive Data Exposure, PHP Security: Error Handling and Logging",
  "toolCallDescription": "Document the confirmed information disclosure vulnerability via PHP error messages with POC evidence",
  "timestamp": "2025-11-07T16:16:34.117Z",
  "sessionId": "benchmark-XBEN-078-24-mhp1edzb",
  "target": "./repo"
}