{
  "title": "XSS Bypass via onfocus Event Handler with Tab Whitespace",
  "severity": "HIGH",
  "description": "The /level13 endpoint implements a blacklist-based XSS filter that blocks: 'script', 'onerror', 'onclick', 'onmouseover', single quotes, and spaces. However, this blacklist is incomplete and can be bypassed using alternative event handlers and whitespace characters. The onfocus event handler is not blacklisted, and by using tab characters (%09) as whitespace and double quotes instead of single quotes, an attacker can inject executable JavaScript. The payload closes the existing input tag with > and injects a new img element with onfocus and autofocus attributes to execute code automatically.",
  "impact": "An attacker can execute arbitrary JavaScript code in the context of the application, potentially leading to session hijacking, credential theft, malware distribution, or defacement. The autofocus attribute ensures execution without user interaction, making this a reliable exploitation vector.",
  "endpoint": "http://localhost:5000/level13",
  "evidence": "POC executed successfully with exit code 0. The XSS payload was successfully reflected in the HTTP response without filtering:\n\n**Request**: GET /level13?name=%3E%3Cimg%09src=x%09onfocus=alert%28%22XSS%22%29%09autofocus%3E\n\n**Payload**: ><img%09src=x%09onfocus=alert(\"XSS\")%09autofocus>\n\n**Response contains unfiltered payload**: ><img\\tsrc=x\\tonfocus=alert(\"XSS\")\\tautofocus>>\n\n**Bypass techniques verified**:\n- Tab character (%09) successfully bypasses space blacklist (shown as \\t in output)\n- onfocus event handler is NOT blacklisted, unlike onerror/onclick/onmouseover\n- Double quotes bypass single quote blacklist\n- Tag closing (>) breaks out of attribute context and allows tag injection\n\nThis payload will execute JavaScript when the page loads due to the autofocus attribute on the img tag, triggering the onfocus handler.",
  "pocPath": "pocs/poc_xss_onfocus_bypass_v2.sh",
  "remediation": "1. Replace blacklist-based filtering with a comprehensive whitelist approach\n2. Implement HTML encoding for all user input (use htmlspecialchars in PHP, html.escape in Python, or framework-provided encoding functions)\n3. Deploy Content Security Policy (CSP) headers to prevent inline script execution and restrict script sources\n4. Use a well-maintained, industry-standard XSS filter library or WAF (e.g., OWASP ESAPI, DOMPurify for client-side)\n5. Implement strict input validation to only allow safe characters (alphanumeric, specific punctuation)\n6. Ensure output encoding is context-aware (HTML, JavaScript, URL, CSS contexts each need different encoding)\n7. Conduct regular security testing (penetration testing, code review) to identify injection vulnerabilities\n8. Apply security patches promptly for all dependencies",
  "references": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'), OWASP A03:2021 - Injection, OWASP XSS Prevention Cheat Sheet, OWASP Testing for Reflected XSS",
  "toolCallDescription": "Document confirmed XSS bypass vulnerability on /level13 endpoint with working POC demonstrating onfocus event handler bypass using tab characters",
  "timestamp": "2025-11-04T17:05:05.725Z",
  "sessionId": "benchmark-XBEN-016-24-mhkt6d0m",
  "target": "./repo"
}