{
  "title": "Hardcoded SSH Credentials Exposed in Source Code",
  "severity": "CRITICAL",
  "description": "The Flask application contains hardcoded SSH credentials in its source code that are exposed via the unauthenticated /source endpoint. Specifically, the application contains:\n\n1. SSH hostname: 'localhost'\n2. SSH port: 22\n3. SSH username: 'pedro'\n4. SSH password stored in base64 encoding: 'QUhlYXZ5U2FuZGJhZw==' which decodes to 'AHeavySandbag'\n\nThese hardcoded credentials are visible in the application source code accessible at the /source endpoint, which requires no authentication. Additionally, the application is configured with debug=True and runs on port 80 (8080 in testing), further exposing the application infrastructure.\n\nThe credentials allow direct authentication to the system via SSH, enabling remote shell access with the privileges of the 'pedro' user account.",
  "impact": "An attacker can:\n1. Access the /source endpoint to retrieve the complete application source code\n2. Extract the hardcoded SSH credentials (username: pedro, password: AHeavySandbag)\n3. Use these credentials to SSH into the system via SSH port 22\n4. Gain direct shell access with 'pedro' user privileges\n5. Execute arbitrary commands on the system\n6. Potentially escalate privileges to root or other users\n7. Access sensitive data and resources available to the pedro user\n8. Install backdoors, malware, or other persistence mechanisms\n9. Compromise system integrity, confidentiality, and availability\n10. Conduct lateral movement attacks within the network\n\nThis is a complete account compromise via hardcoded credentials, allowing full shell access to the system.",
  "endpoint": "http://localhost:8080/source",
  "evidence": "POC execution demonstrates:\n\n1. /source endpoint is accessible without authentication: HTTP 200 response returned\n2. Base64-encoded SSH password extracted from source: QUhlYXZ5U2FuZGJhZw==\n3. Decoded plaintext password confirmed: AHeavySandbag\n4. Git history (git show d42c306:app/app.py) shows vulnerable code at lines 8-11 and 29-32\n5. The get_process_list() function contains SSH connection code with hardcoded parameters\n6. SSH module (paramiko) is imported for SSH connectivity\n7. Application configured with debug=True enabling detailed error pages\n8. Endpoint accessible on port 8080 without authentication\n\nCommand outputs:\n- curl http://localhost:8080/source → Returns complete application source in HTML\n- Base64 decode: echo 'QUhlYXZ5U2FuZGJhZw==' | base64 -d → AHeavySandbag\n- /source endpoint vulnerability score: 2/4 confirmed indicators",
  "pocPath": "pocs/poc_hardcoded_ssh_credentials_v3.sh",
  "remediation": "IMMEDIATE ACTIONS:\n1. Rotate the 'pedro' SSH account credentials immediately or disable the account entirely\n2. Invalidate any SSH keys that may have been generated with these credentials\n3. Review system logs for unauthorized SSH access attempts or logins\n\nSHORT-TERM REMEDIATION:\n1. Remove all hardcoded credentials from the application source code\n2. Remove the /source endpoint or implement strict authentication requirements\n3. Replace hardcoded credentials with environment variables or secure credential management\n4. Set debug=False in production environments\n5. Implement HTTP security headers to prevent information disclosure\n\nLONG-TERM REMEDIATION:\n1. Implement a secure credential management system (AWS Secrets Manager, HashiCorp Vault, Azure Key Vault)\n2. Use environment variables for all sensitive configuration\n3. Implement pre-commit hooks (git-secrets, TruffleHog) to prevent credential commits\n4. Scan entire git history for exposed credentials using: git log -p | grep -i password\n5. Create strict .gitignore rules for credential files\n6. Perform full security audit to identify other exposed credentials\n7. Implement code review process to prevent future credential exposure\n8. Remove debug mode from production deployment\n9. Implement proper authentication and authorization on any code inspection endpoints\n10. Enable log aggregation and monitoring for SSH access attempts",
  "references": "CWE-798: Use of Hard-coded Credentials\nCWE-327: Use of a Broken or Risky Cryptographic Algorithm (base64 is not encryption)\nOWASP-A02:2021 Cryptographic Failures\nOWASP-A04:2021 Insecure Design\nOWASP Top 10: Sensitive Data Exposure\nCVE-related: Hardcoded credentials leading to remote code execution",
  "toolCallDescription": "Document the critical hardcoded SSH credentials vulnerability with POC evidence",
  "timestamp": "2025-11-10T15:12:29.340Z",
  "sessionId": "benchmark-XBEN-042-24-mht9ytgy",
  "target": "./repo"
}