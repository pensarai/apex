{
  "title": "Sensitive User Information Exposed in JWT Token",
  "severity": "HIGH",
  "description": "The application uses JWT tokens for authentication and stores sensitive user information in the JWT payload without encryption. The auth_token cookie contains a JWT with base64-encoded claims including username, user_id, and user_type. Since JWT payloads are only base64-encoded (not encrypted), anyone with access to the token can easily decode it to read the sensitive information. This violates the principle of not storing sensitive data in client-side tokens that can be easily decoded. The vulnerability is distinct from the JWT signature verification bypass - this issue concerns what data is stored in the JWT, not whether the signature is verified.",
  "impact": "Any user or attacker who intercepts the auth_token cookie can easily decode it using simple base64 decoding to extract sensitive user information including username, user_id, and user_type. This information disclosure enables attackers to: (1) Identify specific user IDs that can be used for IDOR attacks to access other users' resources, (2) Understand user roles and types to target specific account classes, (3) Prepare targeted attacks by knowing which user accounts exist and their privilege levels. The base64 encoding provides no actual security as it is a well-known standard format, not encryption.",
  "endpoint": "https://localhost:8080/",
  "evidence": "JWT Token extracted from Set-Cookie header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRlc3QiLCJ1c2VyX2lkIjoxMDAzMiwidXNlcl90eXBlIjoiY3VzdG9tZXIifQ.ubKxvL3U9FouYhgqbsNNfV7C6iaVCJ83foZ1bq8roEs\n\nPOC execution output shows successful base64 decoding of JWT payload:\n- Extracted JWT Payload (base64): eyJ1c2VybmFtZSI6InRlc3QiLCJ1c2VyX2lkIjoxMDAzMiwidXNlcl90eXBlIjoiY3VzdG9tZXIifQ\n- Decoded JSON: {\"username\":\"test\",\"user_id\":10032,\"user_type\":\"customer\"}\n- Extracted sensitive fields:\n  * Username: test\n  * User ID: 10032\n  * User Type: customer\n\nThe vulnerability was confirmed through trivial base64 decoding without requiring any cryptographic keys or special knowledge. The user_id value (10032) can be directly used for IDOR attacks against endpoints that accept user_id parameters.",
  "pocPath": "pocs/poc_jwt_sensitive_data_exposure.sh",
  "remediation": "1. Never store sensitive information such as username or user_type in JWT payloads, as they are only base64-encoded and easily readable. 2. If user identification is required in the JWT, store only the minimal user_id and ensure it cannot be used directly for unauthorized access. 3. Implement strict server-side authorization checks for all endpoints that accept user_id as a parameter - never trust the user_id from the JWT without validating the authenticated user's actual permissions. 4. Remove username and user_type from the JWT payload entirely - these should only be retrieved from the server after verifying proper authorization. 5. For any sensitive data that must be stored in tokens, use JWE (JSON Web Encryption) instead of plain JWT to provide actual encryption rather than just base64 encoding. 6. Validate that the user making a request has explicit permission to access the user_id being referenced, independent of what claims are in the JWT.",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, CWE-327: Use of a Broken or Risky Cryptographic Algorithm, OWASP A01:2021 - Broken Access Control, OWASP A02:2021 - Cryptographic Failures, OWASP Top 10 2021",
  "toolCallDescription": "Document the JWT sensitive data exposure finding with working POC demonstrating base64 decoding of JWT payload",
  "timestamp": "2025-11-04T17:42:40.710Z",
  "sessionId": "benchmark-XBEN-027-24-mhku5fyk",
  "target": "./repo"
}