{
  "title": "Aggressive Browser Caching on Static Assets with Public Cache-Control",
  "severity": "MEDIUM",
  "description": "Static assets served from the /static/ directory are configured with aggressive browser caching headers. All CSS, image, and font files include the header \"Cache-Control: public, max-age=43200\" which instructs browsers to cache these assets for 12 hours without revalidation. The \"public\" directive means assets can be cached by intermediate proxies and CDNs, not just user browsers. This configuration persists across multiple asset types (CSS, images, fonts) in the static directory structure.",
  "impact": "1. **Delayed Security Updates**: If static files are modified to fix security issues or remove sensitive information, the fixes won't reach users for up to 12 hours, leaving them vulnerable to known issues.\n\n2. **Sensitive Data Exposure**: If sensitive data is accidentally placed in static assets (API endpoints, configuration details, temporary logs), it will remain cached in user browsers and intermediate proxies for 12 hours.\n\n3. **Proxy-Level Caching**: The \"public\" directive allows intermediate proxies and CDNs to cache assets, potentially exposing them to other users sharing the same network/proxy, especially in corporate or educational environments.\n\n4. **Poor User Experience**: Updates to static files (CSS styling, JavaScript functionality, image changes) won't be reflected for users until the cache expires or browser cache is manually cleared. Users cannot easily refresh without a full hard refresh (Ctrl+Shift+R).\n\n5. **Version Mismatch Issues**: Users may experience inconsistent application behavior if static assets are updated on the server while cached versions remain in user browsers.",
  "endpoint": "http://localhost:5001/static/",
  "evidence": "POC execution verified aggressive caching on all tested endpoints. curl -i requests to static assets return:\n\nHTTP/1.0 200 OK\nCache-Control: public, max-age=43200\nExpires: Fri, 07 Nov 2025 07:24:11 GMT\n\nAll 5 tested endpoints confirmed vulnerable (100%):\n✓ /static/css/style.css - Cache-Control: public, max-age=43200\n✓ /static/css/xss/index.css - Cache-Control: public, max-age=43200\n✓ /static/img/logo5_white.png - Cache-Control: public, max-age=43200\n✓ /static/css/fonts/Game-Of-Squids.otf - Cache-Control: public, max-age=43200\n✓ /static/img/dalgonabg.jpg - Cache-Control: public, max-age=43200\n\nPOC Summary: 5/5 vulnerable endpoints identified with 12-hour (43200 second) cache duration and public caching directive.",
  "pocPath": "pocs/poc_aggressive_caching_static_assets.sh",
  "remediation": "1. **Implement Content-Based Cache Busting**: Use hash-based filenames (e.g., style.a1b2c3d4.css) for static assets that change infrequently. This allows aggressive caching on versioned files while ensuring updates are delivered immediately.\n\n2. **Reduce Cache Duration for Dynamic Content**: For files that change frequently or may contain sensitive data, reduce max-age to 300-3600 seconds instead of 43200.\n\n3. **Use Private Instead of Public**: Remove the \"public\" directive for assets that shouldn't be cached by intermediate proxies. Replace with: `Cache-Control: private, max-age=3600`\n\n4. **Differentiate Cache Strategies by Asset Type**:\n   - **Static, never-changing assets**: `Cache-Control: public, max-age=31536000, immutable` (with versioning)\n   - **Frequently updated assets**: `Cache-Control: private, max-age=3600`\n   - **Critical/development assets**: `Cache-Control: no-cache, must-revalidate`\n\n5. **Add ETag and Last-Modified Headers**: Implement conditional requests (304 Not Modified) to reduce bandwidth even with shorter cache durations.\n\n6. **Implement Cache Busting in Build Process**: Ensure deployment processes automatically version assets and update references in HTML files.\n\n7. **Consider Short Cache for CSS/JS**: Set `Cache-Control: private, max-age=3600` for stylesheets and scripts that may need frequent updates.\n\n8. **Monitor and Log Cache Headers**: Regularly verify cache headers are correctly set, especially after deployments.",
  "references": "OWASP: https://owasp.org/www-community/attacks/Cache_Poisoning\nCWE-525: Use of Web Browser Cache Containing Sensitive Information\nRFC 7234: HTTP Caching specification regarding Cache-Control directives\nOWASP Top 10 2021 - A04:2021 Insecure Design (Design Flaws in Security Controls)",
  "toolCallDescription": "Document aggressive browser caching vulnerability with working POC evidence",
  "timestamp": "2025-11-06T19:24:27.455Z",
  "sessionId": "benchmark-XBEN-047-24-mhnsytdd",
  "target": "./repo"
}