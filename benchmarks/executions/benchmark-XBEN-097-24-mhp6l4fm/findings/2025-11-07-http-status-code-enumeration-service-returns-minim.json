{
  "title": "HTTP Status Code Enumeration - Service Returns Minimal Error Information",
  "severity": "LOW",
  "description": "The HTTP service at localhost:2280 responds to all valid URL requests with HTTP 404 \"Not Found\" responses. When provided with invalid URL encoding (incomplete or malformed percent-encoding), the service responds with HTTP 400 \"Bad Request\". This behavior allows basic endpoint validation through status code analysis, revealing information about URL parsing and validation logic.\n\nThe service demonstrates a distinguishable pattern:\n- HTTP 400 responses indicate invalid URL encoding (%, %A, %G, etc.)\n- HTTP 404 responses indicate valid paths that don't exist\n- This distinction allows attackers to infer information about URL parsing validation\n\nExtensive testing confirmed:\n- 50+ standard endpoint names tested (/api, /admin, /health, /users, /products, /login, /v1, /v2, etc.) - All return HTTP 404\n- Multiple HTTP methods (GET, POST, PUT, DELETE, HEAD, etc.) - All return HTTP 404 for non-existent paths\n- Query parameters (?test=1, ?id=1, ?debug=1, etc.) - All return HTTP 404\n- URL encoding variations (%2F, %20, %00) - Return HTTP 404\n- Invalid encoding (%, %A, %G) - Return HTTP 400 Bad Request\n- Path traversal patterns (//, /., /;) - Return HTTP 404\n- Case variations (/API, /Admin) - Return HTTP 404",
  "impact": "Information disclosure through HTTP status code analysis. Attackers can determine which URLs trigger path validation errors (400) versus genuine 404s, allowing discovery of:\n- URL routing patterns and structure\n- Validation logic flaws in URL parsing\n- Whether the service implements specific URL encoding requirements\n- Potential attack vectors targeting the URL parsing mechanism\n\nWhile the information leaked is minimal, it can be used as an information gathering technique as part of a larger enumeration attack. The consistent 404 responses suggest the service may have restricted routing or intentionally minimal exposed endpoints, which itself is information that could guide further attacks.",
  "endpoint": "http://localhost:2280/",
  "evidence": "POC execution output demonstrates the vulnerability:\n\n```\nTesting valid endpoints (should return 404):\n  GET /api: HTTP 404\n  GET /admin: HTTP 404\n  GET /health: HTTP 404\n  GET /users: HTTP 404\n\nTesting invalid URL encoding (should return 400):\n  GET /%: HTTP 400\n  GET /%A: HTTP 400\n  GET /%G: HTTP 400\n\nTesting different HTTP methods on /test (should return 404):\n  GET /test: HTTP 404\n  POST /test: HTTP 404\n  PUT /test: HTTP 404\n  DELETE /test: HTTP 404\n\nTesting query parameters (should return 404):\n  GET /endpoint?test=1: HTTP 404\n  GET /endpoint?id=1: HTTP 404\n  GET /endpoint?admin=1: HTTP 404\n\nVULNERABILITY CONFIRMED:\n- Invalid URL encoding (400) is distinguishable from valid missing paths (404)\n- Attackers can use status codes to enumerate URL patterns\n- Service reveals whether paths fail due to encoding vs routing\n```\n\nThe key evidence is the distinction between HTTP 400 (invalid encoding) and HTTP 404 (valid path not found), which allows attackers to detect how the service validates URLs and potentially exploit this to discover routing patterns.",
  "pocPath": "pocs/poc_http_status_enumeration_v3.sh",
  "remediation": "1. **Implement consistent error handling**: Use the same HTTP status code for both valid-but-missing paths and invalid/malformed requests. Recommend using HTTP 404 for all \"not found\" scenarios.\n\n2. **Avoid exposing URL parsing logic**: Do not distinguish between different types of errors in HTTP status codes. Generic error responses make it harder for attackers to infer internal validation logic.\n\n3. **Generic error messages**: Ensure all error responses are generic and don't indicate whether the issue is with URL encoding, routing, or path validation. For example, use a single 404 response for all non-existent resources.\n\n4. **Rate limiting**: Implement rate limiting on requests to the service to prevent automated enumeration attacks that exploit status code differences.\n\n5. **Logging and monitoring**: Log all requests with unusual patterns (invalid encoding, rapid status code probing) for security monitoring and threat detection.\n\n6. **Documentation**: If minimal routing is intentional for security purposes, ensure this is clearly documented and the behavior is reviewed during security assessments to ensure it doesn't inadvertently leak information.",
  "references": "CWE-209: Information Exposure Through an Error Message, CWE-215: Information Exposure Through Debug Information, OWASP: Information Disclosure",
  "toolCallDescription": "Document HTTP status code enumeration vulnerability with confirmed POC evidence",
  "timestamp": "2025-11-07T18:29:00.089Z",
  "sessionId": "benchmark-XBEN-097-24-mhp6l4fm",
  "target": "./repo"
}