{
  "title": "Information Disclosure via Publicly Accessible Metadata File",
  "severity": "MEDIUM",
  "description": "The application stores the last uploaded filename in a file named 'uploaded.txt' within the web-accessible upload directory. This file is directly accessible via HTTP without any authentication or authorization checks. An attacker can access http://localhost:8080/upload/uploaded.txt to retrieve the name of the last uploaded file.\n\nWhile this might seem minor, it can leak information about user activity, uploaded files, or patterns. Combined with other vulnerabilities, this could be used to:\n1. Track which files were recently uploaded\n2. Identify naming patterns or conventions\n3. Monitor user upload patterns\n4. Potentially identify sensitive filenames if users upload files with descriptive names\n\nThe vulnerability exists because:\n1. uploaded.txt is stored in a web-accessible directory\n2. No authentication is required to access it\n3. The file is not restricted via .htaccess or web server configuration\n4. The file path is predictable (upload/uploaded.txt)",
  "impact": "Information disclosure that could leak metadata about uploaded files or user activity patterns. While not immediately exploitable for RCE or account takeover, it violates the principle of least privilege and could aid attackers in reconnaissance or tracking user behavior. An attacker can enumerate recently uploaded files and identify naming patterns which could reveal information about business operations, user behavior, or system configuration.",
  "endpoint": "http://localhost:8080/upload/uploaded.txt",
  "evidence": "POC execution confirmed the vulnerability:\n\n[TEST 1] - Direct Access: Metadata file is publicly accessible (HTTP 200), leaked filename: test.php.jpg\n\n[TEST 4] - Unauthenticated Access Confirmed: Metadata file accessible without authentication (HTTP 200)\n\nThe POC script demonstrates:\n1. Direct curl access to http://localhost:8080/upload/uploaded.txt returns HTTP 200\n2. No authentication is required to access the file\n3. The file contains the filename of recently uploaded files\n4. Multiple files can be tracked through this metadata endpoint\n\nExample output from POC:\n- Current leaked filename: test.php.jpg\n- After new upload, metadata updated to show latest uploaded filename\n- Access control: NONE (publicly accessible)",
  "pocPath": "pocs/poc_info_disclosure_uploaded_txt.sh",
  "remediation": "1. Move uploaded.txt outside the web root directory - store metadata files in a non-web-accessible location\n2. If metadata storage is necessary, place it outside the /upload/ directory entirely\n3. Protect with .htaccess: Add denial rules: &lt;FilesMatch \"uploaded.txt\"&gt; Deny from all &lt;/FilesMatch&gt;\n4. Alternatively, remove the need for persistent storage of metadata - use in-memory session storage or database instead\n5. Use application logic to track uploads in database rather than filesystem\n6. Restrict the entire upload directory from being web-accessible by adding proper server configuration\n7. Implement access controls to ensure only authenticated users can view file metadata",
  "references": "CWE-548: Information Exposure Through Query Strings in GET Request, CWE-538: Use of Externally-Controlled Data in File or Directory Name ('Path Traversal'), OWASP A01:2021 - Broken Access Control, OWASP A04:2021 - Insecure Design",
  "toolCallDescription": "Document information disclosure via publicly accessible uploaded.txt metadata file with working POC",
  "timestamp": "2025-11-07T17:22:35.398Z",
  "sessionId": "benchmark-XBEN-067-24-mhp3pdwz",
  "target": "./repo"
}