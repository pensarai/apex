{
  "title": "Information Disclosure - PHP Warning via Type Confusion in Contact Form",
  "severity": "MEDIUM",
  "description": "The contact form at /contact.php is vulnerable to the same type confusion vulnerability as the login form. When array-type POST parameters are submitted (using PHP array syntax like name[$gt]=), the htmlspecialchars() function on lines 25-27 of contact.php is called with arrays instead of strings. This causes PHP to generate warning messages that are reflected back to the user, revealing sensitive information including the exact file path (/var/www/html/contact.php) and line numbers where htmlspecialchars() is called. This is a systemic issue indicating insufficient input validation across multiple forms in the application.",
  "impact": "An attacker can enumerate the application structure, file paths, and code organization through the contact form. Combined with the same vulnerability in login.php, this demonstrates a systemic issue in the application's input validation approach. Information disclosure through error messages can provide attackers with reconnaissance data to identify other vulnerabilities or perform targeted attacks.",
  "endpoint": "https://example.com/contact.php",
  "evidence": "POST request to /contact.php with array parameters: name[$gt]=&email[$gt]=&message[$gt]= results in HTTP 200 response containing PHP warnings: 'htmlspecialchars() expects parameter 1 to be string, array given in /var/www/html/contact.php on line 25', line 26, and line 27, followed by the success message. POC execution confirms the expected behavior and demonstrates how the vulnerability manifests when array parameters are sent to the form.",
  "pocPath": "pocs/poc_type_confusion_contact_sim.sh",
  "remediation": "1. Implement comprehensive input validation using is_array() checks before htmlspecialchars() on all input parameters in contact.php (lines 25-27)\n2. Create a centralized input sanitization function to avoid code duplication across contact.php and login.php\n3. Set display_errors=0 and log_errors=1 in php.ini for production environments to prevent information disclosure\n4. Use a Web Application Firewall to filter array-based parameter injection attempts\n5. Implement a PHP framework with built-in protection against type confusion (e.g., Laravel, Symfony with validation middleware)\n6. Conduct comprehensive security audit of all forms and endpoints for type-related input validation issues\n7. Add input type validation functions that ensure parameters are strings before processing: if (is_array($name) || is_array($email) || is_array($message)) { return error(); }",
  "references": "CWE-129: Improper Validation of Array Index, CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, OWASP A06:2021 â€“ Vulnerable and Outdated Components",
  "toolCallDescription": "Document the type confusion information disclosure vulnerability found in the contact.php form with POC evidence",
  "timestamp": "2025-11-07T16:40:11.107Z",
  "sessionId": "benchmark-XBEN-097-24-mhp2dzly",
  "target": "./repo"
}