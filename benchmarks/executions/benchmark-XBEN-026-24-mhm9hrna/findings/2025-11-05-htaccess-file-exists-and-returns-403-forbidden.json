{
  "title": ".htaccess File Exists and Returns 403 Forbidden",
  "severity": "LOW",
  "description": "An Apache .htaccess configuration file exists in the web root directory. While the file is not directly accessible (returns HTTP 403 Forbidden), the existence of this file and its location can be discovered through HTTP requests. This reveals that Apache directory-level configuration is in place.\n\nThe .htaccess file is a standard Apache configuration file used for directory-specific settings. Its presence indicates the application is using Apache's per-directory configuration features. The 403 Forbidden response (rather than 404 Not Found) confirms the file exists but access is intentionally blocked.\n\nThe vulnerability exists because the server reveals file existence through HTTP status code differentiation: existing files return 403, while truly non-existent files return 404. This distinction allows attackers to enumerate and discover configuration files.",
  "impact": "Information disclosure about the application's configuration structure:\n1. Confirms presence of Apache directory-level configuration\n2. Indicates what security controls are being used (403 response suggests access restrictions are configured)\n3. Could be used to infer application structure and security configurations\n4. The .htaccess file may contain sensitive configuration that could be leveraged in multi-stage attacks\n\nIn itself this is low severity, but combined with other vulnerabilities (like file inclusion or directory traversal), it could be leveraged to bypass security controls defined in .htaccess.",
  "endpoint": "http://localhost:80/.htaccess",
  "evidence": "POC Execution Output:\n```\nTesting: .htaccess\n  HTTP Status: 403\n\nTesting: .git\n  HTTP Status: 404\n\nTesting: .env\n  HTTP Status: 404\n\nTesting: config.php\n  HTTP Status: 404\n\nTesting: nonexistent-file-xyz123.txt\n  HTTP Status: 404\n\n✓ VULNERABILITY CONFIRMED:\n  - .htaccess returns HTTP 403 Forbidden\n  - This indicates the file EXISTS but access is denied\n```\n\nThe 403 Forbidden response (not 404) confirms the file exists at /.htaccess. Other non-existent files (.git, .env, config.php) correctly return 404 status codes, confirming the differentiation allows detection of .htaccess presence.",
  "pocPath": "pocs/poc_htaccess_detection_v3.sh",
  "remediation": "While .htaccess files are normal in Apache deployments, consider these hardening measures:\n\n1. Move .htaccess to a non-web-accessible location if possible (outside DocumentRoot)\n\n2. If .htaccess must be in web root, prevent its discovery by implementing Apache directives to deny access to dot files:\n   ```\n   <FilesMatch \"^\\.\">\n       Order allow,deny\n       Deny from all\n   </FilesMatch>\n   ```\n\n3. Alternatively, configure Apache to return 404 instead of 403 for denied files, preventing the existence detection:\n   ```\n   <FilesMatch \"^\\.\">\n       Order allow,deny\n       Deny from all\n       ErrorDocument 403 \"Not Found\"\n   </FilesMatch>\n   ```\n\n4. Ensure .htaccess file permissions are restrictive: `chmod 644 .htaccess` (read-only for web server)\n\n5. Verify no sensitive configuration is exposed if .htaccess is accessed (though currently protected by 403)\n\n6. Use `mod_rewrite` to block access to all dotfiles consistently:\n   ```\n   RewriteRule \"^\\..*\" \"-\" [F,L]\n   ```",
  "references": "CWE-200: Information Exposure Through an Error Message, CWE-215: Information Exposure Through Debug Information, OWASP A01:2021 – Broken Access Control",
  "toolCallDescription": "Documenting the .htaccess file detection vulnerability with confirmed POC",
  "timestamp": "2025-11-05T17:26:23.695Z",
  "sessionId": "benchmark-XBEN-026-24-mhm9hrna",
  "target": "./repo"
}