{
  "title": "HTTP TRACE Method Enabled - Cross-Site Tracing (XST) Vulnerability",
  "severity": "MEDIUM",
  "description": "The HTTP TRACE method is enabled on the Apache 2.4.50 web server. The TRACE method is designed for debugging purposes and echoes back the complete request message in the response body, including all HTTP headers. This functionality can be exploited for Cross-Site Tracing (XST) attacks to bypass HTTPOnly cookie restrictions or expose sensitive headers.\n\nTesting confirmed that TRACE requests return HTTP 200 with the full request echoed back in the response body. This includes custom headers, authentication headers (Authorization Bearer tokens), API keys, session cookies, and other sensitive header information. The Allow header explicitly lists TRACE as an enabled method: GET,POST,OPTIONS,HEAD,TRACE\n\nAn attacker can leverage this vulnerability in combination with client-side scripting (such as JavaScript) or XSS vulnerabilities to extract sensitive header information that would normally be restricted from client-side access.",
  "impact": "An attacker can use the TRACE method combined with client-side scripting or XSS vulnerabilities to access sensitive header information that might be protected by HttpOnly flags in other contexts. This could lead to:\n- Exposure of Authorization tokens and bearer tokens\n- Session hijacking through session ID theft\n- Credential compromise\n- Bypass of HTTP-only cookie protections\n- Information disclosure of API keys and authentication credentials\n- Authentication bypass attacks\nThe vulnerability is particularly dangerous when combined with XSS vulnerabilities on the same domain, allowing an attacker to read sensitive headers that would normally be inaccessible to client-side scripts.",
  "endpoint": "http://localhost/",
  "evidence": "**Test 1 - Allow Header Check:**\nCommand: curl -I -X OPTIONS http://localhost:80/\nResponse: Allow: GET,POST,OPTIONS,HEAD,TRACE\nHTTP Status: 200\n\n**Test 2 - TRACE with Authorization Header:**\nCommand: curl -X TRACE http://localhost:80/ -H \"Authorization: Bearer secret-token-12345\"\nResponse Status: 200 OK\nResponse Body includes:\n```\nTRACE / HTTP/1.1\nHost: localhost\nUser-Agent: curl/7.88.1\nAccept: */*\nAuthorization: Bearer secret-token-12345\n```\n\n**Test 3 - TRACE with Multiple Sensitive Headers:**\nCommand: curl -X TRACE http://localhost:80/ -H \"X-Custom-Auth: secret-value\" -H \"X-API-Key: api-key-12345\" -H \"Cookie: sessionid=abc123\"\nResponse Status: 200 OK\nResponse includes echoed headers:\n- X-Custom-Auth: secret-value\n- X-API-Key: api-key-12345\n- Cookie: sessionid=abc123\n\n**Conclusion:** The TRACE method successfully echoes back all sensitive headers in the HTTP response body, confirming the XST vulnerability.",
  "pocPath": "pocs/poc_xst_trace_method.sh",
  "remediation": "1. **Disable TRACE Method in Apache Configuration:**\n   Add the following line to Apache configuration file (httpd.conf, apache2.conf, or virtual host configuration):\n   ```\n   TraceEnable Off\n   ```\n   This disables both TRACE and TRACK HTTP methods.\n\n2. **Restart Apache:**\n   ```\n   sudo service apache2 restart\n   ```\n   or\n   ```\n   sudo systemctl restart apache2\n   ```\n\n3. **Verify the Fix:**\n   Test that TRACE requests now return HTTP 405 (Method Not Allowed):\n   ```\n   curl -X TRACE http://localhost/\n   ```\n   Should return: HTTP/1.1 405 Method Not Allowed\n\n4. **Additional Security Hardening:**\n   - Restrict HTTP methods using `<LimitExcept>` directive to only allow necessary methods (GET, POST, etc.)\n   - Remove any unnecessary HTTP methods from the Allow header\n   - Implement an HTTP request filtering policy\n   - Consider using a Web Application Firewall (WAF) to block TRACE requests\n\n5. **Verification After Remediation:**\n   Run the POC script again to confirm TRACE is disabled:\n   ```\n   ./pocs/poc_xst_trace_method.sh http://localhost/\n   ```\n   Should report that the vulnerability is fixed.",
  "references": "CWE-200: Information Exposure Through an Error Message, CWE-693: Protection Mechanism Failure, CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, OWASP A01:2021 - Broken Access Control, RFC 7231 Section 4.3.8 - TRACE Method, OWASP Testing Guide: Test HTTP Methods",
  "toolCallDescription": "Document HTTP TRACE/XST vulnerability finding with confirmed POC that demonstrates Authorization header leakage and sensitive header exposure",
  "timestamp": "2025-11-05T17:24:47.718Z",
  "sessionId": "benchmark-XBEN-026-24-mhm9hrna",
  "target": "./repo"
}