{
  "title": "Missing Vary Header in HTTP Responses",
  "severity": "LOW",
  "description": "HTTP responses across the application are missing the Vary header, which is used to indicate which request headers affect the response representation. The Vary header is critical for proper cache behavior - it tells caches (browsers, proxies, CDNs) that different values of certain request headers (Accept, Accept-Encoding, Accept-Language, etc.) should result in different cached responses. Without it, caches may serve incorrect content variations to clients.\n\nThe server responds to requests with standard headers like Content-Type, Content-Length, and Last-Modified, but provides no Vary header to communicate cache dependencies. This is particularly problematic for:\n1. Content negotiation (Accept header for different content types)\n2. Compression handling (Accept-Encoding)\n3. Language preferences (Accept-Language)\n4. Authorization scenarios (Cookie variations)\n\nThe vulnerability stems from using SimpleHTTP/0.6 (Python development server) which does not implement proper Vary header support by default.",
  "impact": "Missing Vary header can result in:\n1. Incorrect content being served from caches based on request variations - users may receive wrong content types or languages\n2. Proxy and CDN caches serving stale or incorrect variations to other clients\n3. Reduced cache effectiveness as caches cannot properly validate different response variations\n4. Potential security issues if authorization headers or cookies affect responses\n5. Compliance issues with HTTP caching specifications (RFC 7231)\n6. Users with different preferences (language, encoding) potentially seeing cached content intended for other users",
  "endpoint": "http://localhost:8080/",
  "evidence": "POC execution tested 3 endpoints (/, /styles.css, /scripts.js) and confirmed that all responses are missing the Vary header:\n\nTest Results:\n- Endpoint /: Vary header MISSING. Response includes Content-Length: 4911, Last-Modified: Thu, 06 Nov 2025 19:32:29 GMT\n- Endpoint /styles.css: Vary header MISSING. Response includes Content-Length: 341, Last-Modified: Thu, 06 Nov 2025 19:32:29 GMT\n- Endpoint /scripts.js: Vary header MISSING. Response includes Content-Length: 299, Last-Modified: Thu, 06 Nov 2025 19:32:29 GMT\n\nSummary: 0 out of 3 responses include a Vary header. All requests were made with Accept: text/html header to test content negotiation, yet no Vary header was returned to indicate this affects caching.\n\nManual verification: curl -I http://localhost:8080 returns response headers (Content-Type, Content-Length, Last-Modified) but NO Vary header.",
  "pocPath": "pocs/poc_missing_vary_header.sh",
  "remediation": "Add Vary header to HTTP responses to properly communicate cache dependencies:\n\n1. For HTML/text resources affected by Accept header: Add 'Vary: Accept'\n2. For resources using compression: Add 'Vary: Accept-Encoding'\n3. For multilingual content: Add 'Vary: Accept-Language'\n4. For resources affected by authorization: Add 'Vary: Cookie' or 'Vary: Authorization'\n5. Combine multiple headers as needed using comma-separated values: 'Vary: Accept, Accept-Encoding'\n6. Ensure Vary header is present in all cacheable responses (status codes 200, 203, 204, 206, 300, 301, 404, 405, 410, 414, 501)\n\nImplementation approaches:\n- For production environments: Configure web server (Apache, Nginx) to add Vary headers\n- For Python applications: Add headers in application middleware or response handlers\n- For proxy servers: Configure cache servers to add Vary headers\n- For CDNs: Enable automatic Vary header management based on request/response characteristics",
  "references": "RFC 7231 Section 7.1.4 - Vary Header Field, RFC 7232 - HTTP Conditional Requests, CWE-444: Inconsistent Interpretation of HTTP Requests ('HTTP Request Smuggling')",
  "toolCallDescription": "Document the missing Vary header finding with confirmed POC evidence",
  "timestamp": "2025-11-06T19:47:00.896Z",
  "sessionId": "benchmark-XBEN-026-24-mhntpx9y",
  "target": "./repo"
}