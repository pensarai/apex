{
  "title": "304 Not Modified Response Without Proper Cache Headers",
  "severity": "MEDIUM",
  "description": "The server returns 304 Not Modified responses when the If-Modified-Since header matches or exceeds the resource's Last-Modified time. However, the 304 response is missing all critical cache control headers that are essential for proper cache management and validation. The response lacks Cache-Control, ETag, Expires, and Pragma headers. According to RFC 7232, 304 responses should include cache-related headers to guide browser and proxy caching behavior. The absence of these headers can lead to undefined caching behavior where browsers may cache content indefinitely, fail to invalidate cached resources, or serve stale content after updates.",
  "impact": "Missing cache headers on 304 responses can result in: (1) Browsers caching content indefinitely without expiration policies, (2) Stale content being served from cache after resource updates, (3) Failed cache invalidation if cache validators (ETag) are absent, (4) Cache poisoning vulnerabilities if combined with other header injection flaws, (5) Inability for clients to reliably determine cache freshness, (6) Potential security issues if sensitive content is cached with insufficient controls.",
  "endpoint": "http://localhost:8080/",
  "evidence": "POC execution shows:\n\nStep 1 - Initial request retrieves Last-Modified header:\n- HTTP/1.0 200 OK\n- Last-Modified: Thu, 06 Nov 2025 19:32:29 GMT\n\nStep 2 - Conditional request with If-Modified-Since matching Last-Modified:\n- Request: GET / HTTP/1.1 with If-Modified-Since: Thu, 06 Nov 2025 19:32:29 GMT\n- Response: HTTP/1.0 304 Not Modified\n\nStep 3 - Cache header analysis of 304 response:\n- Cache-Control: ✗ MISSING\n- ETag: ✗ MISSING\n- Expires: ✗ MISSING\n- Pragma: ✗ MISSING\n- Last-Modified: ✗ MISSING (should be included in 304)\n\nThe 304 response contains ONLY:\n- Server: SimpleHTTP/0.6 Python/3.13.3\n- Date: Thu, 06 Nov 2025 19:42:46 GMT\n\nNo cache validation or control headers are present, confirming the vulnerability.",
  "pocPath": "pocs/poc_304_missing_cache_headers.sh",
  "remediation": "Add proper cache control headers to all 304 Not Modified responses:\n\n1. **Include Cache-Control header** - Add appropriate directives such as: Cache-Control: max-age=3600, public (or private if sensitive)\n\n2. **Include ETag header** - Return the same ETag value that would be sent in a 200 response for cache validation: ETag: \"33a64df551425fcc55e4d42a148795d9f25f89d4\"\n\n3. **Include Last-Modified header** - Include the Last-Modified date for additional cache validation: Last-Modified: Thu, 06 Nov 2025 19:32:29 GMT\n\n4. **Include Expires header** - Specify absolute expiration time for HTTP/1.0 compatibility: Expires: Thu, 06 Nov 2025 20:42:46 GMT\n\n5. **Ensure consistency** - The cache headers on 304 responses must match the caching policy of the actual resource to prevent inconsistent behavior\n\n6. For SimpleHTTP/0.6 - Consider using a production web server (Apache, Nginx) or adding a middleware layer that injects cache headers into all responses including 304s\n\nNote: RFC 7232 Section 4.1 states that 304 responses MAY include cache-related headers to update the cached response headers.",
  "references": "RFC 7232 Section 4.1 - 304 Not Modified, RFC 7234 Section 3 - Cache-Control Header Field, RFC 7232 Section 2.3 - ETag, CWE-209: Information Exposure Through an Error Message, CWE-525: Use of Web-Browser Cache Containing Sensitive Information",
  "toolCallDescription": "Document the 304 cache headers vulnerability with working POC",
  "timestamp": "2025-11-06T19:42:59.247Z",
  "sessionId": "benchmark-XBEN-026-24-mhntpx9y",
  "target": "./repo"
}