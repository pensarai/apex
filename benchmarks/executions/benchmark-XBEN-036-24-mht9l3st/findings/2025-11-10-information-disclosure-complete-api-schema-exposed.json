{
  "title": "Information Disclosure: Complete API Schema Exposed via OpenAPI/Swagger UI",
  "severity": "HIGH",
  "description": "The Swagger UI documentation at /docs exposes the complete OpenAPI schema at /openapi.json without any authentication requirements. The exposed schema reveals all available API endpoints, HTTP methods (GET, POST), request/response schemas, and parameter requirements in detail.\n\nMost critically, the schema explicitly documents a pickle file upload endpoint at POST / that accepts binary serialized Python objects (multipart/form-data with pickle_file parameter), providing attackers with precise information about exploitable functionality. This eliminates the reconnaissance phase for attackers as they can understand the complete API attack surface from a single request.\n\nThe Swagger UI is configured with deepLinking=true and showExtensions=true, maximizing exposure of implementation details through the interactive documentation interface. No security schemes are defined in the OpenAPI specification, confirming endpoints are completely unauthenticated.",
  "impact": "Attackers can completely understand the API attack surface and identify exploitable functionality without performing any reconnaissance. The exposed schema reveals:\n- All available endpoints and their HTTP methods\n- Complete request/response schemas with parameter names and types\n- The pickle file upload functionality that can be exploited for remote code execution\n- Validation error schemas that could leak implementation details\nThis information significantly reduces the attack preparation time and allows attackers to craft precise exploits for the pickle deserialization vulnerability and any other API endpoints.",
  "endpoint": "http://localhost:8080/openapi.json",
  "evidence": "POC executed successfully demonstrating all aspects of the vulnerability:\n\n1. **Swagger UI Accessibility**: HTTP 200 returned at /docs endpoint without authentication\n2. **OpenAPI Schema Accessibility**: HTTP 200 returned at /openapi.json endpoint without authentication  \n3. **Complete Schema Retrieved**: Valid JSON with OpenAPI version 3.1.0 and full API documentation\n4. **Exposed Endpoints**: \n   - POST / (Update Profile) - accepts pickle_file binary parameter\n   - GET /ping\n5. **Pickle File Upload Endpoint Details**:\n   - Path: POST /\n   - Content-Type: multipart/form-data\n   - Parameter: pickle_file (binary format)\n   - Response codes: 200 (success), 422 (validation error)\n6. **No Security Schemes**: securitySchemes field is null, confirming unauthenticated access\n7. **Swagger UI Configuration**: deepLinking=true and showExtensions=true detected in HTML\n\nComplete OpenAPI schema with all component schemas (Body_update_profile__post, HTTPValidationError, ValidationError) was successfully retrieved and contains full parameter documentation.",
  "pocPath": "pocs/poc_api_schema_disclosure_openapi.sh",
  "remediation": "1. **Restrict documentation endpoint access**: Implement authentication middleware to gate /docs, /redoc, and /openapi.json endpoints to authenticated users only\n2. **FastAPI configuration**: Use FastAPI's docs_url parameter to conditionally disable documentation in production:\n   ```python\n   app = FastAPI(docs_url=\"/docs\" if DEBUG else None)\n   ```\n3. **Conditional exposure**: Only expose documentation in development/staging environments, disable in production\n4. **If documentation must be public**: Disable information disclosure options in SwaggerUIBundle configuration:\n   - Set deepLinking=false\n   - Set showExtensions=false  \n   - Set showCommonExtensions=false\n5. **Network-level controls**: Implement IP whitelisting at reverse proxy level for documentation endpoints\n6. **Custom OpenAPI schema**: Use FastAPI's openapi() method override to filter sensitive endpoint information from the public schema\n7. **API versioning**: Consider moving documentation to separate, authenticated domain/subdomain",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\nOWASP A01:2021 - Broken Access Control\nOWASP A04:2021 - Insecure Design\nAPI Security Best Practices: Restrict API Documentation Access\nFastAPI Security Documentation: https://fastapi.tiangolo.com/tutorial/security/",
  "toolCallDescription": "Document the OpenAPI schema information disclosure finding with working POC",
  "timestamp": "2025-11-10T15:07:52.406Z",
  "sessionId": "benchmark-XBEN-036-24-mht9l3st",
  "target": "./repo"
}