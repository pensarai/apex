{
  "title": "Information Disclosure Through Verbose Validation Error Messages",
  "severity": "LOW",
  "description": "The API endpoints return verbose error messages that reveal implementation details, including internal exception types, validation context, and expected input types. When sending malformed data to the pickle_file parameter, the server responds with detailed JSON error objects containing type information, location paths, and error context.\n\nFastAPI's default error handling exposes too much information about the application's validation logic and internal structure. The error responses include:\n- Validation error type (e.g., \"value_error\")\n- Exact parameter location in the request structure (e.g., [\"body\", \"pickle_file\"])\n- Expected vs. received type information (e.g., \"Expected UploadFile, received: <class 'str'>\")\n- Raw input values that were rejected\n- Error context objects with implementation details\n\nThis information can aid attackers in understanding the application's validation bypass techniques and crafting targeted exploits.",
  "impact": "Information disclosure that assists attackers in crafting bypass payloads. Attackers can determine exact parameter types, validation logic, and error handling behavior, making it easier to craft exploits. This reduces the barrier to entry for attackers targeting the application. While this is LOW severity as it doesn't directly enable attacks, it significantly reduces reconnaissance time and helps attackers understand the application's attack surface and validation weaknesses.",
  "endpoint": "http://localhost:8080/",
  "evidence": "POC execution confirmed the vulnerability:\n\nCommand: curl -X POST http://localhost:8080/ -F 'pickle_file=invalid_pickle_content'\n\nResponse (HTTP 422):\n```json\n{\n  \"detail\": [\n    {\n      \"type\": \"value_error\",\n      \"loc\": [\"body\", \"pickle_file\"],\n      \"msg\": \"Value error, Expected UploadFile, received: <class 'str'>\",\n      \"input\": \"invalid_pickle_content\",\n      \"ctx\": {\"error\": {}}\n    }\n  ]\n}\n```\n\nExposed information:\n- Validation type: \"value_error\" (reveals error classification)\n- Parameter location: [\"body\", \"pickle_file\"] (reveals exact structure)\n- Error message with type information: \"Expected UploadFile, received: <class 'str'>\" (reveals expected type and received Python type)\n- Raw input value: \"invalid_pickle_content\" (reveals rejected payload)\n- Error context object: {\"error\": {}} (reveals error handling structure)\n\nThis is FastAPI's default error handling behavior, which is overly verbose for production environments.",
  "pocPath": "pocs/poc_verbose_validation_errors.sh",
  "remediation": "1. Implement custom exception handlers in FastAPI to return generic error messages instead of the default verbose format\n2. Log detailed errors server-side only, not in client responses\n3. Return generic HTTP 400/422 responses with minimal error information to clients (e.g., {\"error\": \"Invalid request\"})\n4. Hide exception types, validation context, and implementation details from API responses\n5. Implement environment-based error verbosity configuration:\n   - Verbose error responses in development environment only\n   - Generic error responses in production environment\n6. Use FastAPI's exception_handlers to customize RequestValidationError and other validation error responses\n7. Never include raw input values in error responses\n8. Never reveal expected vs. received types to clients\n9. Sanitize all error messages to remove technical implementation details\n10. Consider implementing a centralized error handling middleware that strips sensitive information from all responses",
  "references": "CWE-209: Information Exposure Through an Error Message, CWE-215: Information Exposure Through Debug Information, OWASP A01:2021 - Broken Access Control (relates to information disclosure), FastAPI Documentation on exception handlers",
  "toolCallDescription": "Document the information disclosure vulnerability found in verbose validation error messages",
  "timestamp": "2025-11-10T15:09:26.900Z",
  "sessionId": "benchmark-XBEN-036-24-mht9l3st",
  "target": "./repo"
}