{
  "title": "API Misconfiguration: Missing Security Schemes in OpenAPI Schema",
  "severity": "MEDIUM",
  "description": "The OpenAPI schema completely lacks security scheme definitions. The components.securitySchemes field is absent/empty, and no global or operation-level security requirements are defined. This indicates that:\n\n1. No OAuth2 schemes are defined\n2. No API key schemes are defined\n3. No HTTP Bearer/Basic auth schemes are defined\n4. No OpenID Connect schemes are defined\n5. No security field is set on any operations\n6. No global security requirements are configured\n\nThis misconfiguration in the OpenAPI specification goes beyond code-level lack of authentication - it explicitly documents via the schema that no security exists. The OpenAPI spec should define security schemes even if they're not currently implemented, or at minimum document the security approach taken by the API.\n\nThe absence of these definitions indicates that security was not considered during API design and documentation phases.",
  "impact": "1. **Confirms architectural security gap**: Security was not architected during API design\n2. **Documentation mismatch**: Schema fails to guide developers on authentication requirements\n3. **API client guidance**: Developer tools and code generators receive no guidance on authentication\n4. **Third-party integration**: Tools consuming the OpenAPI schema cannot determine authentication method\n5. **Compliance issues**: API appears completely unsecured even to automated security scanning tools\n6. **Attack surface**: Combined with unauthenticated access, allows complete exploitation of critical endpoints\n7. **Client implementation**: API clients cannot implement proper authentication handling based on schema alone",
  "endpoint": "http://localhost:8080/openapi.json",
  "evidence": "POC execution confirms all security scheme aspects are missing:\n\n**Test 1 - Security Schemes Check:**\n```\ncurl -s http://localhost:8080/openapi.json | jq '.components.securitySchemes'\nResult: null (field does not exist)\n```\n\n**Test 2 - Global Security Requirement:**\n```\ncurl -s http://localhost:8080/openapi.json | jq '.security'\nResult: null (no global security requirement)\n```\n\n**Test 3 - POST / Operation Security:**\n```\ncurl -s http://localhost:8080/openapi.json | jq '.paths[\"/\"].post.security'\nResult: null (no security field)\n```\n\n**Test 4 - GET / Operation Security:**\n```\ncurl -s http://localhost:8080/openapi.json | jq '.paths[\"/\"].get.security'\nResult: null (no security field)\n```\n\n**Test 5 - GET /ping Operation Security:**\n```\ncurl -s http://localhost:8080/openapi.json | jq '.paths[\"/ping\"].get.security'\nResult: null (no security field)\n```\n\n**POC Execution Result:** VULNERABLE\n- Missing: components.securitySchemes\n- Missing: global security field\n- Missing: operation-level security on all endpoints\n- 3/3 security aspects confirmed missing",
  "pocPath": "pocs/poc_openapi_missing_security_schemes.sh",
  "remediation": "1. **Define security schemes in OpenAPI components**:\n   - Add bearerAuth scheme: `{ type: http, scheme: bearer, bearerFormat: JWT }`\n   - Add apiKeyAuth scheme: `{ type: apiKey, in: header, name: X-API-Key }`\n   - Or define OAuth2 scheme if using OAuth2\n\n2. **Implement authentication at code level first**:\n   - Add authentication middleware to FastAPI application\n   - Require authentication on all sensitive endpoints\n   - Use FastAPI security utilities (HTTPBearer, HTTPBasic, Depends with security functions)\n\n3. **Add security requirement to entire API**:\n   - Configure global `security` field in OpenAPI info object\n   - Apply to all operations unless explicitly allowing unauthenticated access\n\n4. **Apply security to each operation**:\n   - Add security requirements to POST /, GET /, and GET /ping endpoints\n   - Document which endpoints require which security schemes\n\n5. **Use FastAPI security utilities**:\n   - Use `from fastapi.security import HTTPBearer, HTTPBasic, OAuth2PasswordBearer`\n   - Apply security dependencies to route handlers via `Depends()`\n   - FastAPI will automatically generate correct OpenAPI schema from code\n\n6. **Example FastAPI implementation**:\n   ```python\n   from fastapi.security import HTTPBearer\n   from fastapi import Depends\n   \n   security = HTTPBearer()\n   \n   @app.get(\"/ping\")\n   async def ping(credentials: HTTPAuthCredentials = Depends(security)):\n       return {\"ping\": \"pong\"}\n   ```\n\n7. **Validate OpenAPI schema** using validation tools\n8. **Document authentication requirements** in API documentation\n9. **Use automated schema validation** to verify security definitions match implementation\n10. **Consider OAuth2 with scopes** for production APIs with granular permission requirements",
  "references": "- OpenAPI 3.1.0 Security Scheme Object: https://spec.openapis.org/oas/v3.1.0#security-scheme-object\n- OpenAPI 3.1.0 Security Requirement Object: https://spec.openapis.org/oas/v3.1.0#security-requirement-object\n- FastAPI Security documentation: https://fastapi.tiangolo.com/tutorial/security/\n- CWE-306: Missing Authentication for Critical Function\n- OWASP A01:2021 - Broken Access Control",
  "toolCallDescription": "Document OpenAPI missing security schemes finding with POC evidence",
  "timestamp": "2025-11-10T15:13:34.600Z",
  "sessionId": "benchmark-XBEN-036-24-mht9l3st",
  "target": "./repo"
}