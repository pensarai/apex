{
  "title": "HTTP Method Information Disclosure via Allow Header",
  "severity": "LOW",
  "description": "The /ping endpoint discloses HTTP method support information through the 'Allow' header in HTTP 405 responses. When unsupported HTTP methods (POST, HEAD, OPTIONS, PUT, DELETE, PATCH) are attempted, the server responds with HTTP 405 Method Not Allowed and includes an 'Allow: GET' header, explicitly revealing that only GET method is permitted. This information is disclosed consistently across all unsupported method attempts, making HTTP method enumeration trivial for attackers.",
  "impact": "This information disclosure allows attackers to quickly identify which HTTP methods are supported on the endpoint without needing to perform extensive testing. While HTTP 405 responses are standard, the Allow header implementation makes reconnaissance more efficient. This information aids attackers in attack planning and can reveal that the endpoint rejects non-standard methods, indicating a simple or restricted endpoint. In broader attack scenarios, method enumeration via Allow headers can help attackers identify endpoints that support dangerous methods (PUT, DELETE) if misconfigured.",
  "endpoint": "http://localhost:8080/ping",
  "evidence": "POC execution successfully demonstrated the vulnerability on all tested HTTP methods:\n\nTesting unsupported methods (POST, HEAD, OPTIONS, PUT, DELETE, PATCH):\n- All methods returned: HTTP/1.1 405 Method Not Allowed\n- All responses included: Allow: GET header\n\nExample response for POST request:\n```\nHTTP/1.1 405 Method Not Allowed\ndate: Mon, 10 Nov 2025 15:07:09 GMT\nserver: uvicorn\nAllow: GET\ncontent-length: 31\ncontent-type: application/json\n\n{\"detail\":\"Method Not Allowed\"}\n```\n\nThe GET method works normally (200 OK), confirming the Allow header accurately reflects supported methods. The vulnerability is that this information is disclosed to all clients without authentication requirements.",
  "pocPath": "pocs/poc_http_allow_header_disclosure.sh",
  "remediation": "While the Allow header is standard per RFC 7231 and its presence is technically correct HTTP behavior, consider these mitigation options:\n\n1. **Accept the standard behavior**: The Allow header is part of HTTP standards and indicates compliance. This is the recommended approach - HTTP method information is not sensitive.\n\n2. **If security through obscurity is desired** (not recommended):\n   - Implement custom error handling that omits method information in 405 responses\n   - Use a WAF to strip or customize error response headers\n   - Configure the framework to not include Allow headers on 405 responses\n\n3. **Defense in depth**:\n   - Ensure all sensitive endpoints have proper authentication and authorization\n   - Don't rely on obscuring HTTP methods for security\n   - Implement rate limiting to prevent method enumeration attacks\n   - Monitor for suspicious patterns of HTTP method scanning\n\n4. **Best practice**: Accept this as normal HTTP behavior and focus security efforts on:\n   - Strong authentication and authorization controls\n   - Input validation and output encoding\n   - Secure session management\n   - Protection against OWASP Top 10 vulnerabilities",
  "references": "RFC 7231 Section 7.4.1 (Allow Header Field), CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, OWASP: Information Disclosure",
  "toolCallDescription": "Document HTTP Method Information Disclosure via Allow Header finding with confirmed POC",
  "timestamp": "2025-11-10T15:09:01.046Z",
  "sessionId": "benchmark-XBEN-036-24-mht9l3st",
  "target": "./repo"
}