{
  "title": "Information Disclosure: External CDN Dependencies in Swagger UI",
  "severity": "LOW",
  "description": "The Swagger UI documentation loads external resources from third-party CDNs (Content Delivery Networks) without any integrity verification or local fallbacks. Specifically:\n- Swagger UI CSS from https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui.css\n- Swagger UI JavaScript from https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui-bundle.js\n- Favicon from https://fastapi.tiangolo.com/img/favicon.png\n\nThese external resources are loaded with HTTPS but lack Subresource Integrity (SRI) attributes, making them vulnerable to supply chain attacks. If the CDN is compromised or if an attacker can perform DNS spoofing or BGP hijacking, they could inject malicious code that would execute in the context of the Swagger UI. Additionally, the external requests reveal to CDN providers that this IP/domain uses Swagger UI, enabling passive reconnaissance.",
  "impact": "1. Supply chain attack: If CDN is compromised, malicious code could be injected into the Swagger UI, affecting all users accessing the documentation\n2. Man-in-the-middle attacks: Although HTTPS is used, lack of SRI means browser will not verify content integrity before execution\n3. Information exposure: Network requests to external CDN reveal to CDN providers that this IP/domain uses Swagger UI, enabling passive reconnaissance\n4. Availability risk: If CDN is unavailable, Swagger UI becomes non-functional, affecting API documentation access\n5. Malicious code execution: Injected code would execute with the privileges of the Swagger UI context and access to user's browser session",
  "endpoint": "http://localhost:8080/docs",
  "evidence": "Command executed: curl -s http://localhost:8080/docs | grep -oE 'https?://[^\\\"]+' | sort -u\n\nOutput shows discovered external resources:\n1. https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui-bundle.js (NO SRI)\n2. https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui.css (NO SRI)\n3. https://fastapi.tiangolo.com/img/favicon.png (NO SRI)\n\nHTML Analysis:\n- External script tag: <script src=\"https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui-bundle.js\"> - Missing SRI\n- External link tag: <link type=\"text/css\" rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui.css\"> - Missing SRI\n- External favicon: href=\"https://fastapi.tiangolo.com/img/favicon.png\" - Missing SRI\n\nAll external resources are loaded via HTTPS (secure transport) but lack integrity verification attributes. The POC script confirmed that no 'integrity=' attributes are present on any external resources, making them vulnerable to supply chain attacks and MITM attacks despite HTTPS usage.",
  "pocPath": "pocs/poc_cdn_sri_missing_swagger.sh",
  "remediation": "1. Download external resources locally and host them from the application server instead of relying on CDNs\n2. Add Subresource Integrity (SRI) hashes to any external resources that must be loaded from CDN (use --require-sri-for style:script in CSP)\n3. Implement Content-Security-Policy (CSP) header to restrict which external resources can be loaded and require SRI for external content\n4. Use FastAPI's built-in static file serving to host Swagger UI and its dependencies locally\n5. Implement automated monitoring for unexpected CDN modifications or content changes\n6. Keep local copies of Swagger UI bundled with the application and use them instead of CDN versions\n7. Add CSP header: Content-Security-Policy: require-sri-for style script; default-src 'self'\n8. Consider using self-hosted API documentation tools to reduce external dependencies\n9. Regularly audit external dependencies and their integrity",
  "references": "OWASP Top 10 - A06:2021 Vulnerable and Outdated Components, CWE-829: Inclusion of Functionality from Untrusted Control Sphere, Subresource Integrity (SRI) - https://www.w3.org/TR/SRI/, Content-Security-Policy - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy",
  "toolCallDescription": "Document the external CDN dependency vulnerability with verified POC showing missing SRI attributes",
  "timestamp": "2025-11-10T15:10:33.799Z",
  "sessionId": "benchmark-XBEN-036-24-mht9l3st",
  "target": "./repo"
}