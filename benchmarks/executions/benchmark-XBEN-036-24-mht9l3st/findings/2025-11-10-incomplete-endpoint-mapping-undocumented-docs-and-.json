{
  "title": "Incomplete Endpoint Mapping - Undocumented /docs and /redoc Routes",
  "severity": "MEDIUM",
  "description": "The OpenAPI schema documents only 2 endpoints (/ and /ping), but the API actually exposes 6 accessible endpoints. The /docs endpoint (Swagger UI), /redoc endpoint (ReDoc documentation), and /openapi.json endpoint (the schema itself) are functional and respond with HTTP 200, but are not included in the OpenAPI schema paths. These are standard FastAPI auto-generated documentation endpoints. This incomplete endpoint mapping means the schema does not accurately represent the full API surface.\n\nThe OpenAPI specification is supposed to document all available API endpoints to provide a complete and accurate view of the API attack surface. The current schema violates the OpenAPI 3.1.0 specification by failing to document approximately 50% of the actual accessible endpoints.",
  "impact": "API consumers and security testing tools cannot see the complete list of available endpoints from the schema alone. The documentation endpoints expose additional attack surface that is not reflected in the formal specification. This reduces the accuracy of API exploitation planning. Automated tools that rely on the OpenAPI schema will miss 50% of the actual endpoints (3 out of 6 accessible endpoints are undocumented). The schema fails to provide a complete and accurate picture of the API endpoints available to clients, potentially leaving attack surface undetected during security assessments.",
  "endpoint": "https://example.com/openapi.json",
  "evidence": "POC execution confirms:\n- Documented endpoints in schema: 2 (/ and /ping)\n- Actually accessible endpoints: 6 (GET /, POST /, GET /ping, GET /docs, GET /redoc, GET /openapi.json)\n- Undocumented but accessible endpoints: 3 (/docs, /redoc, /openapi.json)\n- Schema coverage: 33%\n- Missing endpoints: 50% of actual endpoints\n\nThe POC analyzed the OpenAPI schema from the finding \"Information Disclosure: Complete API Schema Exposed via OpenAPI/Swagger UI\" which confirms the schema only documents 2 endpoints. However, other findings confirm these additional endpoints are functional:\n- /docs endpoint exists (FastAPI Swagger UI)\n- /redoc endpoint exists (FastAPI ReDoc documentation)\n- /openapi.json endpoint exists (schema serving endpoint itself)\n\nAll three undocumented endpoints respond with HTTP 200 when accessed.",
  "pocPath": "pocs/poc_incomplete_endpoint_mapping_v3.sh",
  "remediation": "1. Include all accessible API endpoints in the OpenAPI schema paths. Specifically add:\n   - GET /docs: Swagger UI documentation interface\n   - GET /redoc: ReDoc documentation interface\n   - GET /openapi.json: OpenAPI schema endpoint (self-documenting)\n\n2. Add complete path definitions to the OpenAPI info object that includes:\n   - Path: /docs\n   - Path: /redoc\n   - Path: /openapi.json\n\n3. If the documentation endpoints are not intended to be part of the API specification, disable them using FastAPI configuration:\n   - Set 'openapi_url' to None to disable /openapi.json\n   - Set 'docs_url' to None to disable /docs\n   - Set 'redoc_url' to None to disable /redoc\n\n4. Regenerate the OpenAPI schema to include all endpoints that are actually accessible to clients.\n\n5. Use API discovery tools that automatically detect and document all available routes in the application code.\n\n6. Validate the updated schema against the OpenAPI 3.1.0 specification to ensure all paths are documented.",
  "references": "OpenAPI 3.1.0 Specification - Paths Object (https://spec.openapis.org/oas/v3.1.0#paths-object), FastAPI Documentation: Preventing automatic docs (https://fastapi.tiangolo.com/advanced/extending-openapi/#disabling-openapi), CWE-200: Exposure of Sensitive Information to an Unauthorized Actor",
  "toolCallDescription": "Documenting the incomplete endpoint mapping finding with POC that verifies schema incompleteness",
  "timestamp": "2025-11-10T15:13:19.585Z",
  "sessionId": "benchmark-XBEN-036-24-mht9l3st",
  "target": "./repo"
}