{
  "title": "Incomplete Error Response Coverage - Missing 4xx and 5xx Response Definitions",
  "severity": "MEDIUM",
  "description": "The OpenAPI schema for all three endpoints (GET /, POST /, GET /ping) fails to document error response codes. The endpoints only define HTTP 200 responses (and POST / includes 422 for validation errors), but do not define responses for other HTTP error codes (4xx, 5xx) that may be returned by the API. This incomplete error response documentation creates ambiguity about what errors the API may return and prevents proper error handling in client implementations and security testing tools.\n\nAccording to the OpenAPI 3.1.0 specification, the Responses Object should document all possible responses that can be returned by an operation, including error conditions. The current schema violates this requirement by omitting common HTTP error codes (400, 401, 403, 404, 500, 502, 503, etc.) that the API may return.",
  "impact": "API consumers cannot anticipate or properly handle all possible error responses from the endpoints. Automated client code generation may miss error handling for common HTTP status codes like 400, 401, 403, 404, 500, etc. Security testing tools will not have complete information about expected responses. This reduces the reliability of the API specification for exploitation planning and makes error handling inconsistent across different implementations. Additionally, security testers cannot verify that the API is returning appropriate error codes for various error conditions.",
  "endpoint": "https://example.com/openapi.json",
  "evidence": "POC execution demonstrates the missing error response coverage:\n\nGET / endpoint:\n  Documented Responses: 200 only\n  Missing: 400, 401, 403, 404, 500, 502, 503\n\nPOST / endpoint:\n  Documented Responses: 200, 422 only\n  Missing: 400, 401, 403, 413, 500, 502, 503\n\nGET /ping endpoint:\n  Documented Responses: 200 only\n  Missing: 400, 401, 403, 404, 500, 502, 503\n\nThe OpenAPI schema at /openapi.json shows only success responses without comprehensive error response documentation across all endpoints. This violates OpenAPI 3.1.0 specification requirements for complete response documentation.",
  "pocPath": "pocs/poc_incomplete_error_responses_openapi_v2.sh",
  "remediation": "1. Add comprehensive error response definitions to all endpoints in the OpenAPI schema.\n2. Include common HTTP error codes: 400 (Bad Request), 401 (Unauthorized), 403 (Forbidden), 404 (Not Found), 500 (Internal Server Error), 502 (Bad Gateway), 503 (Service Unavailable).\n3. Define error response schemas that describe the error structure returned by the API (e.g., with error message, error code, details fields).\n4. Document in the OpenAPI schema what conditions trigger each error response for each endpoint.\n5. Test all error conditions (invalid input, authentication failures, missing resources, server errors) and ensure the schema accurately matches actual responses.\n6. Use FastAPI's response model configuration to automatically generate proper OpenAPI documentation for error responses.\n7. Consider implementing standardized error response formats across the API to improve consistency.",
  "references": "CWE-12: ASP.NET Configuration - Improper API Documentation\nOpenAPI 3.1.0 Specification - Responses Object\nREST API design best practices - Error handling and documentation\nOWASP API Security Top 10 - Lack of Resources & Rate Limiting Documentation",
  "toolCallDescription": "Document the incomplete error response coverage finding with verified POC",
  "timestamp": "2025-11-10T15:11:23.290Z",
  "sessionId": "benchmark-XBEN-036-24-mht9l3st",
  "target": "./repo"
}