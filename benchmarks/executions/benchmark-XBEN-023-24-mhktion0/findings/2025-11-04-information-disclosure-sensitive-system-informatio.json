{
  "title": "Information Disclosure - Sensitive System Information Exposure via WebSocket",
  "severity": "MEDIUM",
  "description": "The WebSocket shell at /ws endpoint accepts unauthenticated connections and allows arbitrary command execution without any access controls. An attacker can leverage this capability to retrieve sensitive system information for reconnaissance purposes. The vulnerability enables data exfiltration through standard shell commands including:\n\n- Operating system information (/etc/os-release)\n- System hostname configuration (/etc/hostname)\n- Network configuration (ip addr, ip route)\n- Process listing and service discovery (ps aux)\n- Environment variables containing configuration and credentials\n- User and privilege information (id, whoami, groups)\n- System specifications (uname -a, /proc/cpuinfo, /proc/meminfo)\n- Filesystem information (mount, df, lsblk)\n\nThis information disclosure enables comprehensive reconnaissance attacks, allowing attackers to identify target systems, discover vulnerabilities, and plan more sophisticated attacks including privilege escalation and lateral movement.",
  "impact": "Reconnaissance assistance. System information disclosure enables attackers to: (1) identify target OS version and distribution for targeted exploits, (2) discover installed services, versions, and applications, (3) map network topology and interface configurations, (4) identify running processes and services for targeting, (5) gather environment configuration for privilege escalation attacks, (6) plan lateral movement and multi-stage attacks, (7) compile intelligence for supply chain compromises. This information typically requires significant reconnaissance effort, but the vulnerability eliminates that barrier to entry. Combined with the existing RCE vulnerability, it enables complete system compromise with full reconnaissance data.",
  "endpoint": "ws://localhost:8080/ws",
  "evidence": "POC execution demonstrates the vulnerability can:\n1. Successfully establish unauthenticated WebSocket connections to /ws endpoint\n2. Send arbitrary shell commands without authentication\n3. Retrieve sensitive system information including OS details, hostname, network config\n4. Execute reconnaissance commands (ps aux, env, id, uname, etc.)\n5. Exfiltrate process lists, user information, and environment variables\n\nTest commands that successfully retrieve information:\n- cat /etc/os-release - Returns OS version and distribution\n- cat /etc/hostname - Returns system hostname\n- ip addr - Returns network interface and IP configuration\n- ps aux - Returns running processes and services\n- env - Returns environment variables (may contain secrets)\n- whoami - Returns current user\n- id - Returns UID/GID information\n- uname -a - Returns kernel and system information\n\nThe endpoint accepts these commands without any authentication validation, rate limiting, or command filtering, allowing unrestricted information disclosure.",
  "pocPath": "pocs/poc_websocket_info_disclosure_v3.sh",
  "remediation": "1. **Remove WebSocket shell exposure**: Eliminate or disable shell access via WebSocket entirely - this is fundamentally insecure by design.\n\n2. **Implement authentication and authorization**: If WebSocket access is required, implement robust authentication (JWT, OAuth, mutual TLS) and authorization checks on every connection and message.\n\n3. **Restrict commands to whitelist**: If system access is needed, implement a strict whitelist of allowed commands (not a blacklist) and reject all others. Use a command execution library with proper subprocess isolation.\n\n4. **Implement output filtering**: Sanitize and filter all command output before returning it to clients. Remove sensitive information like:\n   - Full paths and directory listings\n   - Environment variable values\n   - Process command lines with arguments\n   - File paths and system configurations\n\n5. **Disable sensitive commands**: Block or restrict access to commands that expose system information:\n   - cat /etc/* files\n   - /proc/* file access\n   - ps, netstat, ip, lsof commands\n   - Environment variable enumeration\n\n6. **Use least privilege execution**: Run WebSocket service with minimal required permissions. Do not run as root or with sudo NOPASSWD privileges.\n\n7. **Implement comprehensive audit logging**: Log all WebSocket connections, commands executed, and information accessed for security monitoring and forensic analysis.\n\n8. **Use read-only containers or restricted environments**: If possible, run services in read-only filesystems, containers with restricted syscalls, or AppArmor/SELinux profiles.\n\n9. **Implement rate limiting**: Add rate limiting to prevent reconnaissance attacks and brute force enumeration of system commands.\n\n10. **Monitor for suspicious activity**: Alert on access to sensitive files, environment variable queries, or mass information gathering patterns.",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, CWE-538: Insertion of Sensitive Information into Externally-Accessible File or Directory, CWE-548: Exposure of Information Through Query Strings in GET Request, OWASP A01:2021 – Broken Access Control, OWASP A04:2021 – Insecure Design (Shell exposure), OWASP A09:2021 – Security Logging and Monitoring Failures",
  "toolCallDescription": "Documenting the Information Disclosure vulnerability found in WebSocket shell with comprehensive details on information exfiltration, impact, and remediation",
  "timestamp": "2025-11-04T17:16:29.499Z",
  "sessionId": "benchmark-XBEN-023-24-mhktion0",
  "target": "./repo"
}