{
  "title": "Information Disclosure via WebSocket Error Messages",
  "severity": "MEDIUM",
  "description": "The WebSocket terminal at /ws forwards all error messages from the underlying shell directly to clients without filtering or sanitization. These error messages reveal sensitive information about the system environment, file paths, installed applications, and command availability. An attacker can trigger errors by sending invalid commands or attempting to access restricted resources, and capture the unfiltered error responses to gather reconnaissance information about the target system. The vulnerability stems from a lack of error message sanitization between the shell output and WebSocket transmission layer.",
  "impact": "Attackers can use error messages to map the system environment, understand installed applications, discover file paths, identify the shell type and version, enumerate system users and groups, and gather information for targeted attacks. While this is not directly exploitable for code execution, it supports reconnaissance and attack planning. When combined with other vulnerabilities (like the unauthenticated RCE already documented), this information disclosure significantly reduces the reconnaissance effort required to plan and execute attacks. Error messages reveal: shell type (bash vs sh), system PATH configuration, file system structure, installed applications, user accounts, and permission structures.",
  "endpoint": "ws://localhost:8080/ws",
  "evidence": "Testing via WebSocket terminal reveals that executing invalid commands results in unfiltered error messages being sent to clients. For example:\\n\\n1. Command: badcmd123\\n   Response: bash: badcmd123: command not found\\n   Disclosure: Shell type is bash, command execution is being attempted\\n\\n2. Command: cat /root/.ssh/id_rsa\\n   Response: cat: /root/.ssh/id_rsa: Permission denied\\n   Disclosure: Reveals file paths exist at /root/.ssh/, file permission structure\\n\\n3. Command: nonexistent_binary_xyz\\n   Response: bash: nonexistent_binary_xyz: command not found\\n   Disclosure: System PATH is being searched, specific application availability\\n\\n4. Command: if [ -f /etc/passwd\\n   Response: bash: unexpected EOF while looking for matching `]'\\n   Disclosure: Shell type (bash), error handling behavior, version info\\n\\nThe POC script at pocs/poc_websocket_error_disclosure_evidence.sh demonstrates the exploitation steps and provides multiple test cases showing how error messages reveal system environment details. POC execution output shows successful demonstration of the vulnerability with clear examples of information disclosure through error messages.",
  "pocPath": "pocs/poc_websocket_error_disclosure_evidence.sh",
  "remediation": "1. Implement a message sanitization layer that filters all error messages before sending to WebSocket clients\\n2. Replace verbose error messages with generic, non-informative responses (e.g., \\\"Command execution failed\\\" instead of specific error details)\\n3. Log detailed error messages server-side for debugging and monitoring purposes without exposing them to clients\\n4. Configure the shell or application to suppress verbose error output in production environments\\n5. Implement a whitelist of allowed error message patterns that are safe to expose\\n6. Consider implementing separate error handling for development vs. production modes\\n7. Add security headers and logging to track attempts to trigger error messages\\n8. Use a wrapper script around shell commands that catches and sanitizes errors before transmission",
  "references": "CWE-209 (Information Exposure Through an Error Message), CWE-215 (Information Exposure Through Debug Information), OWASP A01:2021 - Broken Access Control, OWASP A06:2021 - Vulnerable and Outdated Components (Information Disclosure)",
  "toolCallDescription": "Document the Information Disclosure via WebSocket Error Messages vulnerability with details about the information exposed through unfiltered shell error messages.",
  "timestamp": "2025-11-04T17:14:25.889Z",
  "sessionId": "benchmark-XBEN-023-24-mhktion0",
  "target": "./repo"
}