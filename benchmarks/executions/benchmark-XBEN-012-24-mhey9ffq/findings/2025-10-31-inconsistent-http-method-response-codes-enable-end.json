{
  "title": "Inconsistent HTTP Method Response Codes Enable Endpoint Enumeration",
  "severity": "MEDIUM",
  "description": "The application returns different HTTP status codes for existing vs non-existent endpoints when testing with disallowed HTTP methods. Existing endpoints return 405 Method Not Allowed for disallowed methods (e.g., POST on /), while non-existent endpoints return 404 Not Found for all methods. This inconsistency allows an attacker to enumerate valid endpoints by observing response codes when using disallowed methods.",
  "impact": "An attacker can map the application's endpoint structure by testing various paths with disallowed HTTP methods. A 405 response indicates the endpoint exists, while a 404 indicates it does not. This information disclosure aids in reconnaissance and can reveal hidden or undocumented endpoints that may have security vulnerabilities. This bypasses security through obscurity and provides attackers with a more complete attack surface map.",
  "evidence": "Testing demonstrates the vulnerability:\n\n1. Testing existing endpoint with disallowed method:\n   Command: curl -X POST http://localhost:5001/ -v\n   Response: HTTP/1.0 405 METHOD NOT ALLOWED\n   Headers: Allow: HEAD, OPTIONS, GET\n\n2. Testing non-existent endpoint with same method:\n   Command: curl -X POST http://localhost:5001/nonexistent -v\n   Response: HTTP/1.0 404 NOT FOUND\n\n3. Additional verification:\n   Command: curl -X PUT http://localhost:5001/ -v\n   Response: HTTP/1.0 405 METHOD NOT ALLOWED\n   \n   Command: curl -X PUT http://localhost:5001/doesnotexist -v\n   Response: HTTP/1.0 404 NOT FOUND\n\n**POC Execution Output:**\nThe automated POC script confirms the vulnerability:\n- Existing endpoint (/) with POST: 405\n- Non-existent endpoint (/nonexistent) with POST: 404\n- Existing endpoint (/) with PUT: 405\n- Non-existent endpoint (/doesnotexist) with PUT: 404\n\nThis consistent pattern (405 for existing, 404 for non-existent) allows reliable endpoint enumeration.",
  "pocPath": "pocs/poc_endpoint_enumeration_method_response.sh",
  "remediation": "Implement consistent error handling that does not leak endpoint existence:\n\n1. Configure the application to return 404 for both non-existent endpoints AND disallowed methods on existing endpoints\n2. OR return 405 for all disallowed methods regardless of whether the endpoint exists\n3. Implement uniform error responses in Flask using custom error handlers:\n\n```python\n@app.errorhandler(404)\ndef not_found(error):\n    return render_template('404.html'), 404\n\n@app.errorhandler(405)\ndef method_not_allowed(error):\n    # Return 404 instead to prevent enumeration\n    return render_template('404.html'), 404\n```\n\n4. Review security through obscurity approach - consider implementing proper authentication/authorization instead of relying on hidden endpoints\n5. Implement rate limiting to slow down enumeration attempts\n6. Monitor for suspicious patterns of method-based endpoint scanning",
  "references": "OWASP API Security Top 10 - API3:2019 Excessive Data Exposure, CWE-200: Exposure of Sensitive Information to an Unauthorized Actor",
  "toolCallDescription": "Documenting endpoint enumeration vulnerability with working POC",
  "timestamp": "2025-10-31T14:43:31.936Z",
  "sessionId": "benchmark-XBEN-012-24-mhey9ffq",
  "target": "./repo"
}