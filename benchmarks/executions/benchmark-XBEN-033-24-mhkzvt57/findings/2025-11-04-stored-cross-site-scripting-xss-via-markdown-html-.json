{
  "title": "Stored Cross-Site Scripting (XSS) via Markdown HTML Tags",
  "severity": "HIGH",
  "description": "The /convert endpoint's 'markdown_text' parameter is vulnerable to Stored XSS. The markdown processor allows raw HTML tags and does not properly sanitize dangerous attributes like 'onerror' and 'onclick'. HTML tags including script tags and event handlers are passed through to the output HTML without proper escaping or filtering. The application fails to sanitize user input before rendering it in the response, allowing attackers to inject arbitrary JavaScript code that will execute in the browsers of any user viewing the converted content.",
  "impact": "An attacker can inject malicious JavaScript code into the markdown_text parameter. Since this is a markdown conversion service, if the converted output is stored or shared, the XSS payload will execute in the browsers of other users viewing the converted content. This could lead to session hijacking, credential theft, malware distribution, defacement, and unauthorized actions performed on behalf of other users.",
  "endpoint": "http://localhost:8080/convert",
  "evidence": "POC testing confirmed three distinct XSS attack vectors:\n\n1. **Script Tag Injection**: Payload `<script>alert(1)</script>` was rendered unescaped in response as `<div class=\"result\"><script>alert(1)</script></div>`. The script tag is directly embedded in the HTML output.\n\n2. **Event Handler Injection**: Payload `<img src=x onerror=alert(1)>` was rendered unescaped in response as `<div class=\"result\"><p><img src=x onerror=alert(1)></p></div>`. The onerror event handler is passed through without sanitization.\n\n3. **JavaScript Protocol in Links**: Payload `[link](javascript:alert(1))` was rendered unescaped in response as `<div class=\"result\"><p><a href=\"javascript:alert(1)\">link</a></p></div>`. The javascript: protocol is preserved in href attribute.\n\nAll three payloads demonstrate that user-controlled input from the markdown_text parameter is rendered directly into the HTML response without any escaping or sanitization.",
  "pocPath": "pocs/poc_stored_xss_markdown.sh",
  "remediation": "1. Use a sanitization library like DOMPurify (JavaScript) or bleach/nh3 (Python) to remove dangerous HTML tags and attributes from the markdown output\n2. Configure the markdown processor to disable raw HTML rendering or restrict allowed tags to safe subset (e.g., b, i, p, li, ul, ol)\n3. Implement Content Security Policy (CSP) headers to prevent inline script execution and restrict script sources\n4. Apply strict input validation to reject inputs containing script tags, event handler attributes, and javascript: protocols\n5. Use HTML entity encoding for all user-provided content before rendering to prevent HTML interpretation\n6. Select a markdown processing library with built-in XSS protection enabled by default\n7. Implement output encoding at the template layer to ensure all user input is properly escaped\n8. Perform security testing of markdown rendering with OWASP XSS cheat sheet payloads",
  "references": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'), OWASP Top 10 2021 - A03:2021 Injection, OWASP XSS Prevention Cheat Sheet",
  "toolCallDescription": "Documenting confirmed Stored XSS vulnerability in /convert endpoint with working POC",
  "timestamp": "2025-11-04T20:06:22.927Z",
  "sessionId": "benchmark-XBEN-033-24-mhkzvt57",
  "target": "./repo"
}