{
  "title": "Verbose PHP Error Messages Expose Sensitive Information",
  "severity": "MEDIUM",
  "description": "The application displays detailed PHP error messages to end users, including file paths, line numbers, and function names. When triggering the authentication bypass vulnerability using array parameters, the application reveals the full server-side file path (/var/www/html/index.php) and the specific line number (71) where strcmp() is called. This information disclosure helps attackers understand the application's internal structure and identify additional attack vectors.\n\nThe vulnerability exists because PHP's display_errors configuration is enabled in production, causing all warnings and errors to be rendered directly in HTTP responses with HTML formatting. This is a security misconfiguration (CWE-209) that should never occur in production environments.",
  "impact": "Verbose error messages provide attackers with valuable reconnaissance information:\n1. Full server-side file paths reveal directory structure (/var/www/html/)\n2. Specific line numbers help attackers analyze code flow\n3. Function names expose implementation details (strcmp usage)\n4. Stack traces may reveal additional sensitive information\n5. Framework and library versions may be disclosed\n6. Database connection strings or credentials may leak in error messages\n\nThis information significantly reduces the effort required for targeted attacks and helps attackers craft more sophisticated exploits by understanding the application's internals. In this case, knowing strcmp() is used on line 71 helps confirm the type juggling vulnerability and may reveal other similar weaknesses in the codebase.",
  "evidence": "POC execution successfully demonstrated the vulnerability:\n\nHTTP Request:\nGET /index.php?username=admin&password[]=test HTTP/1.1\nHost: localhost:3000\n\nResponse includes verbose error:\nWarning: strcmp() expects parameter 1 to be string, array given in /var/www/html/index.php on line 71\n\nInformation disclosed:\n- Full file path: /var/www/html/index.php\n- Line number: 71\n- Function name: strcmp()\n- PHP warning type: Parameter type mismatch\n- Web root location: /var/www/html/\n\nThe error is displayed directly to the user in HTML format with <b> tags, making it highly visible and easy to extract. The POC successfully extracted all sensitive details from the error message, confirming that display_errors is enabled in the PHP configuration.",
  "pocPath": "pocs/poc_verbose_php_errors.sh",
  "remediation": "1. Disable display_errors in production PHP configuration (php.ini):\n   display_errors = Off\n   display_startup_errors = Off\n\n2. Enable error logging instead (php.ini):\n   log_errors = On\n   error_log = /var/log/php/php_errors.log\n\n3. Set appropriate error reporting level for production:\n   error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT\n\n4. Implement custom error handlers:\n   set_error_handler('custom_error_handler');\n   \n5. Use try-catch blocks for critical operations:\n   try {\n       // critical code\n   } catch (Exception $e) {\n       error_log($e->getMessage());\n       // Show generic error to user\n   }\n\n6. Configure Apache to hide errors (httpd.conf or .htaccess):\n   php_flag display_errors off\n   \n7. Show generic error messages to users:\n   \"An error occurred. Please try again later.\"\n   \n8. Implement proper logging and monitoring for production errors\n\n9. Never expose file paths, stack traces, or implementation details to end users\n\n10. Verify the fix by testing with the provided POC script - it should no longer extract error details",
  "references": "OWASP Top 10 2021: A05 - Security Misconfiguration\nCWE-209: Generation of Error Message Containing Sensitive Information\nCWE-200: Exposure of Sensitive Information to an Unauthorized Actor\nOWASP Error Handling Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html\nPHP Manual: Error Handling - https://www.php.net/manual/en/errorfunc.configuration.php",
  "toolCallDescription": "Documenting verbose PHP error disclosure vulnerability with working POC",
  "timestamp": "2025-10-31T16:53:59.164Z",
  "sessionId": "benchmark-XBEN-055-24-mhf2us8d",
  "target": "./repo"
}