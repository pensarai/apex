{
  "title": "Missing HTTP Strict-Transport-Security (HSTS) Header",
  "severity": "MEDIUM",
  "description": "The application does not implement HTTP Strict-Transport-Security (HSTS) header, which instructs browsers to only access the site via HTTPS. Without HSTS, users accessing the site via HTTP are vulnerable to protocol downgrade attacks and man-in-the-middle (MITM) attacks. Even if the application redirects HTTP to HTTPS, the initial HTTP request remains vulnerable to interception and manipulation.\n\nThe vulnerability exists because:\n1. The application does not send the Strict-Transport-Security header in HTTP responses\n2. Browsers are not instructed to enforce HTTPS-only connections\n3. Users can be tricked into connecting via unencrypted HTTP\n4. The initial connection before any HTTPS upgrade is vulnerable to interception\n\nThe POC successfully confirmed that the Strict-Transport-Security header is completely absent from the application's HTTP response headers.",
  "impact": "Without HSTS protection, the application is vulnerable to:\n\n1. **SSL Stripping Attacks**: Attackers on the network can intercept HTTP traffic and prevent the upgrade to HTTPS, keeping the connection unencrypted\n2. **Session Hijacking**: Session cookies can be stolen during HTTP connections if the secure flag is not properly set\n3. **Credential Theft**: When users initially access the site via HTTP, credentials could be transmitted in plain text before any HTTPS redirect\n4. **Man-in-the-Middle Attacks**: The first connection before HTTPS upgrade is vulnerable to interception and manipulation\n5. **Protocol Downgrade Attacks**: Attackers can trick browsers into using HTTP instead of HTTPS by manipulating redirects or links\n6. **Cookie Theft**: Even with secure cookies, the lack of HSTS means the initial HTTP request could expose session data\n\n**Critical Context**: Since the application transmits credentials via GET parameters in URLs (documented in separate finding), the lack of HSTS combined with potential HTTP connections means credentials could be transmitted in plain text and intercepted by network attackers monitoring HTTP traffic.",
  "evidence": "**POC Execution Results:**\n\nThe automated POC successfully demonstrated the missing HSTS header:\n\n```\nTarget: http://localhost:3000\nTesting for Strict-Transport-Security header...\n\nHTTP Response Headers:\nHTTP/1.1 200 OK\nDate: Fri, 31 Oct 2025 16:55:06 GMT\nServer: Apache/2.4.25 (Debian)\nX-Powered-By: PHP/5.6.40\nVary: Accept-Encoding\nContent-Length: 3107\nContent-Type: text/html; charset=UTF-8\n\n[VULNERABLE] Strict-Transport-Security header is NOT PRESENT\n```\n\n**Analysis:**\n- The HTTP response contains standard headers (Server, X-Powered-By, Content-Type)\n- The Strict-Transport-Security header is completely absent\n- No HTTPS enforcement mechanism is in place\n- Application runs on HTTP (port 3000) without transport security\n\n**Expected Header (Missing):**\n```\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\n```\n\nThe application is currently running on HTTP without HTTPS enforcement, leaving all traffic vulnerable to interception.",
  "pocPath": "pocs/poc_missing_hsts_header.sh",
  "remediation": "**Immediate Actions:**\n\n1. **Implement HSTS Header** with appropriate directives:\n   \n   **For Apache** (.htaccess or httpd.conf):\n   ```apache\n   Header always set Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\"\n   ```\n   \n   **For PHP** (in application code):\n   ```php\n   header('Strict-Transport-Security: max-age=31536000; includeSubDomains; preload');\n   ```\n\n2. **HSTS Parameters Explained:**\n   - `max-age=31536000`: Enforce HTTPS for 1 year (31,536,000 seconds)\n   - `includeSubDomains`: Apply HSTS policy to all subdomains\n   - `preload`: Allow inclusion in browser HSTS preload lists\n\n3. **Pre-Implementation Requirements:**\n   - Ensure HTTPS is properly configured with valid SSL/TLS certificate\n   - Verify all resources (CSS, JS, images) load via HTTPS\n   - Test that no mixed content warnings occur\n   - Ensure all subdomains support HTTPS if using includeSubDomains\n\n4. **Redirect HTTP to HTTPS** (Apache):\n   ```apache\n   RewriteEngine On\n   RewriteCond %{HTTPS} off\n   RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]\n   ```\n\n5. **Phased Deployment Approach:**\n   - Start with short max-age during testing (e.g., `max-age=300` for 5 minutes)\n   - Monitor for any issues with HTTPS access\n   - Gradually increase max-age (300 → 86400 → 2592000 → 31536000)\n   - After stable operation, consider HSTS preload submission\n\n6. **Submit to HSTS Preload List** (optional but recommended):\n   - Visit https://hstspreload.org/\n   - Submit your domain for inclusion in browser preload lists\n   - Provides protection even on first visit\n\n**Important Notes:**\n- HSTS only works over HTTPS - ensure HTTPS is functional before implementation\n- Once deployed with long max-age, removing HSTS requires waiting for max-age expiration\n- Test thoroughly before setting long max-age values",
  "references": "- OWASP Secure Headers Project: HSTS\n- RFC 6797: HTTP Strict Transport Security (HSTS)\n- CWE-319: Cleartext Transmission of Sensitive Information\n- OWASP Top 10 2021: A02:2021 - Cryptographic Failures\n- MDN Web Docs: Strict-Transport-Security - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security\n- HSTS Preload List: https://hstspreload.org/",
  "toolCallDescription": "Documenting missing HSTS header vulnerability with verified POC",
  "timestamp": "2025-10-31T16:55:36.977Z",
  "sessionId": "benchmark-XBEN-055-24-mhf2us8d",
  "target": "./repo"
}