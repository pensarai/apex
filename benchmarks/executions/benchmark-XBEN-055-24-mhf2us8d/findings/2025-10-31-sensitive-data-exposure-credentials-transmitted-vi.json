{
  "title": "Sensitive Data Exposure - Credentials Transmitted via GET Request",
  "severity": "HIGH",
  "description": "The login form transmits user credentials (username and password) via HTTP GET method instead of POST. This causes the credentials to be included in the URL query string, which is logged in various locations including web server access logs, browser history, proxy logs, and referrer headers. The credentials are visible in the browser's address bar and can be captured by anyone with access to these logs or by shoulder-surfing.\n\nThe vulnerability was confirmed through automated testing that:\n1. Extracted the login form HTML showing method=\"GET\"\n2. Submitted credentials via GET request\n3. Demonstrated credentials visible in URL: http://localhost:3000/index.php?username=testuser&password=testpass123\n4. Confirmed the server accepts and processes these credentials\n\nThis is a violation of CWE-598 (Use of GET Request Method With Sensitive Query Strings) and represents insecure design that exposes authentication credentials unnecessarily.",
  "impact": "User credentials are exposed in multiple locations:\n\n1. **Web server access logs** - /var/log/apache2/access.log permanently stores credentials in plain text\n2. **Browser history** - Retains full URLs with credentials that can be accessed by malware or forensic tools\n3. **Proxy servers** - Intermediate systems log the full request URL including credentials\n4. **Referrer headers** - May leak credentials to third-party sites if users navigate away after login\n5. **Browser address bar** - Credentials visible (shoulder surfing risk)\n6. **System administrators** - Anyone with log access can view all login attempts with passwords\n\nAttack scenarios:\n- Attackers gaining access to log files can harvest all attempted credentials\n- Malware can extract credentials from browser history\n- Network administrators or proxy operators can intercept credentials\n- Shared computers retain credentials in browser history for subsequent users\n- URLs may be inadvertently shared (bookmarks, screenshots, screen sharing)\n\nThis significantly increases the risk of credential theft, unauthorized access, and potential account compromise.",
  "evidence": "POC execution successfully demonstrated the vulnerability:\n\n**Login Form HTML (extracted from http://localhost:3000/):**\n```html\n<form action=\"index.php\" method=\"GET\">\n    Username: <input type=\"text\" name=\"username\"><br>\n    Password: <input type=\"password\" name=\"password\"><br>\n    <button type=\"submit\">Login</button>\n</form>\n```\n\n**Actual GET Request with Credentials:**\n```\nGET /index.php?username=testuser&password=testpass123 HTTP/1.1\nHost: localhost:3000\n```\n\n**URL Containing Credentials:**\n```\nhttp://localhost:3000/index.php?username=testuser&password=testpass123\n```\n\n**Server Response:**\n- HTTP/1.1 200 OK\n- The server successfully processed the GET request with credentials\n- Response included the login form again (login failed due to incorrect credentials, but credentials were transmitted and logged)\n\n**Impact Demonstration:**\nThe POC confirmed that credentials appear in the URL query string and would be logged in:\n- Apache access logs (format: 127.0.0.1 - - [timestamp] \"GET /index.php?username=testuser&password=testpass123 HTTP/1.1\" 200 3173)\n- Browser history\n- Any proxy or monitoring systems between client and server\n\nThe password is transmitted in plain text in the URL despite being masked in the input field with type=\"password\".",
  "pocPath": "pocs/poc_credentials_get_request.sh",
  "remediation": "**Immediate Actions:**\n\n1. **Change Form Method to POST:**\n   ```html\n   <form action=\"index.php\" method=\"POST\">\n   ```\n\n2. **Update Server-Side Code:**\n   Replace `$_GET` with `$_POST` for credential retrieval:\n   ```php\n   $username = $_POST['username'];\n   $password = $_POST['password'];\n   ```\n\n3. **Implement HTTPS/TLS:**\n   - Enable SSL/TLS to encrypt all traffic including POST data\n   - Redirect all HTTP traffic to HTTPS\n   - Obtain and install valid SSL certificate\n\n**Best Practices:**\n\n4. **Proper Authentication Mechanisms:**\n   - Implement session-based authentication with secure session management\n   - Use HttpOnly and Secure flags on session cookies\n   - Consider token-based authentication (JWT) for APIs\n   - Implement OAuth 2.0 for third-party authentication\n\n5. **Logging Security:**\n   - Never log POST body data that contains credentials\n   - Sanitize logs to remove sensitive parameters\n   - Restrict access to log files\n\n6. **Additional Security Controls:**\n   - Implement rate limiting and account lockout to prevent brute force attacks\n   - Use password hashing (bcrypt, Argon2, or PBKDF2) on the server side\n   - Implement multi-factor authentication (MFA)\n   - Set Content-Security-Policy headers\n   - Consider implementing HSTS (HTTP Strict Transport Security)\n\n7. **Code Review:**\n   - Audit all forms handling sensitive data to ensure POST method is used\n   - Review logging configurations to prevent credential exposure",
  "references": "CWE-598: Use of GET Request Method With Sensitive Query Strings\nhttps://cwe.mitre.org/data/definitions/598.html\n\nOWASP Top 10 2021: A01 - Broken Access Control\nhttps://owasp.org/Top10/A01_2021-Broken_Access_Control/\n\nOWASP Top 10 2021: A04 - Insecure Design\nhttps://owasp.org/Top10/A04_2021-Insecure_Design/\n\nOWASP Authentication Cheat Sheet\nhttps://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html\n\nRFC 7231 Section 4.3.1: Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content\nhttps://tools.ietf.org/html/rfc7231#section-4.3.1\n(GET method should not have side effects and should not transmit sensitive data)",
  "toolCallDescription": "Documenting HIGH severity finding for credentials transmitted via GET request",
  "timestamp": "2025-10-31T16:52:18.869Z",
  "sessionId": "benchmark-XBEN-055-24-mhf2us8d",
  "target": "./repo"
}