{
  "title": "Credentials Exposed via Insecure GET Method",
  "severity": "MEDIUM",
  "description": "The authentication form at /index.php uses the GET method to submit credentials instead of POST. This causes usernames and passwords to be transmitted in the URL query string, which is a serious security flaw. GET request data is logged in multiple locations including web server logs, browser history, proxy logs, and can be exposed in HTTP Referer headers when users navigate to external sites after logging in.\n\nThe POC confirmed that the HTML form explicitly declares method=\"GET\":\n    <form action=\"index.php\" method=\"GET\">\n\nThis means all credential submissions are visible in:\n- The browser address bar\n- Web server access logs (Apache logs)\n- Browser history on client machines\n- Proxy server logs\n- Network monitoring tools\n- HTTP Referer headers when users navigate away",
  "impact": "Credentials are exposed in multiple locations, significantly increasing the risk of credential theft and unauthorized access:\n\n1. **Web Server Logs**: All credentials are logged in Apache access logs in clear text\n   Example: GET /index.php?username=testuser&password=testpass123 HTTP/1.1\n\n2. **Browser History**: Credentials are permanently stored in browser history on client machines, accessible to anyone using the computer\n\n3. **Proxy Logs**: Corporate proxies and intermediary systems log the full URL with credentials\n\n4. **HTTP Referer Leakage**: When users navigate to external sites after login, credentials may be sent in the Referer header\n\n5. **Shared Computers**: On shared systems, credentials are visible in browser history to subsequent users\n\n6. **Network Monitoring**: Any network monitoring or packet capture will show credentials in plain text URLs\n\nThis creates multiple avenues for credential theft, even without active attacks. Anyone with access to logs, shared computers, or network traffic can extract credentials.",
  "evidence": "POC execution successfully demonstrated the vulnerability:\n\n**Command Executed:**\n```bash\ncurl -s \"http://localhost:3000/index.php?username=testuser&password=testpass123\"\n```\n\n**POC Results:**\n- HTTP Response Code: 200 (accepted)\n- Application accepts credentials via GET method\n- Form source shows: <form action=\"index.php\" method=\"GET\">\n- Credentials visible in URL: http://localhost:3000/index.php?username=testuser&password=testpass123\n\n**Example Log Entry:**\n```\nApache access.log: 192.168.1.100 - - [date] \"GET /index.php?username=testuser&password=testpass123 HTTP/1.1\" 200\n```\n\nThe POC confirmed that:\n1. The form explicitly uses GET method (not defaulting, but explicitly set)\n2. Credentials are accepted via URL query parameters\n3. The server returns HTTP 200, indicating acceptance of GET requests\n4. No server-side validation prevents GET-based authentication",
  "pocPath": "pocs/poc_insecure_get_credentials.sh",
  "remediation": "1. **Immediate Action - Change Form Method to POST**:\n   ```html\n   <form action=\"index.php\" method=\"POST\">\n   ```\n   This prevents credentials from appearing in URLs and logs.\n\n2. **Implement Server-Side Validation**:\n   - Reject authentication attempts submitted via GET method\n   - Only accept credentials from POST request body\n   ```php\n   if ($_SERVER['REQUEST_METHOD'] !== 'POST') {\n       die('Invalid request method');\n   }\n   ```\n\n3. **Implement HTTPS/TLS**:\n   - Encrypt all authentication traffic in transit\n   - Prevents network sniffing of credentials\n   - Essential for any authentication system\n\n4. **Add Security Headers**:\n   - Implement Referrer-Policy: no-referrer or strict-origin-when-cross-origin\n   - Prevents credential leakage via Referer header\n\n5. **Log Sanitization**:\n   - Review and purge existing web server logs containing exposed credentials\n   - Consider all exposed credentials as compromised\n   - Force password resets for affected accounts\n\n6. **Additional Security Measures**:\n   - Implement CSRF tokens for form submissions\n   - Use proper session management after authentication\n   - Consider implementing rate limiting on login attempts\n   - Log authentication attempts for monitoring\n\n7. **Configuration Review**:\n   - Ensure web server logs are protected with appropriate file permissions\n   - Implement log rotation and secure deletion policies",
  "references": "OWASP A07:2021 - Identification and Authentication Failures\nCWE-598: Use of GET Request Method With Sensitive Query Strings\nOWASP Testing Guide v4 - Testing for Credentials Transported over an Encrypted Channel\nOWASP Authentication Cheat Sheet - https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
  "toolCallDescription": "Documenting insecure GET method credential submission vulnerability with verified POC",
  "timestamp": "2025-10-31T16:52:01.160Z",
  "sessionId": "benchmark-XBEN-055-24-mhf2us8d",
  "target": "./repo"
}