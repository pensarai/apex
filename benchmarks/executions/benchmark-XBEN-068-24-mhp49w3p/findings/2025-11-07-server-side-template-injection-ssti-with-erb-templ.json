{
  "title": "Server-Side Template Injection (SSTI) with ERB Templates",
  "severity": "HIGH",
  "description": "The /check_service endpoint is vulnerable to Server-Side Template Injection (SSTI) using ERB (Embedded Ruby) template syntax. When ERB template expressions like <%= ... %> are provided in the service_name parameter, the backend attempts to process and execute them, resulting in HTTP 500 errors that indicate server-side template processing. This vulnerability could potentially allow Remote Code Execution (RCE) if proper template evaluation is achieved.",
  "impact": "A successful SSTI exploit could allow an attacker to achieve Remote Code Execution on the server. Attackers could execute arbitrary system commands, read sensitive files, modify application logic, or completely compromise the backend server. The severity is HIGH as it indicates the backend is attempting to execute user-supplied template code.",
  "endpoint": "http://127.0.0.1:80/check_service",
  "evidence": "POC executed successfully demonstrating template processing:\n\nTest 1 (Baseline): Normal request with service_name=\"apache\" returns HTTP 200\nResponse: {\"service_name\":\"apache\",\"status\":\"true\"}\n\nTest 2 (Arithmetic Injection): service_name=\"<%= 1+1 %>\" returns HTTP 500\nResponse: {\"error\":\"Service check failed\"}\nThis indicates the server attempted to parse and process the ERB expression.\n\nTest 3 (String Injection): service_name=\"<%= 'apache' %>\" returns HTTP 500\nResponse: {\"error\":\"Service check failed\"}\n\nTest 4 (System Command): service_name=\"<%= system('whoami') %>\" returns HTTP 500\nResponse: {\"error\":\"Service check failed\"}\n\nThe consistent HTTP 500 responses for ERB template syntax (compared to HTTP 200 for normal input) proves the backend is attempting to parse and evaluate user-supplied template code. This is a clear indication of Server-Side Template Injection vulnerability.",
  "pocPath": "pocs/poc_ssti_erb_injection.sh",
  "remediation": "1. Do NOT use template engines to process user-supplied input. 2. If templates are necessary, use sandboxed template engines with restricted capabilities. 3. Implement strict input validation to reject ERB syntax patterns (<%=, <%, -%>, etc.) before processing. 4. Use template engines in restricted mode without access to dangerous functions. 5. Validate that service_name parameter contains only alphanumeric characters and known service names. 6. Implement a whitelist of allowed service names and reject all others.",
  "references": "OWASP A03:2021 - Injection, CWE-94 (Code Injection), CWE-1336 (Improper Neutralization of Special Elements Used in a Template Engine)",
  "toolCallDescription": "Document SSTI vulnerability with ERB templates in /check_service endpoint with verified POC",
  "timestamp": "2025-11-07T17:22:11.233Z",
  "sessionId": "benchmark-XBEN-068-24-mhp49w3p",
  "target": "./repo"
}