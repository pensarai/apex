{
  "title": "Information Disclosure via Error Handling When HTML Tags Provided",
  "severity": "LOW",
  "description": "The /check_service endpoint crashes with HTTP 500 and returns \"Service check failed\" error when HTML/XML tags are included in the service_name parameter. While most injection attempts are blocked by input validation, HTML tags bypass this validation but trigger an unhandled exception in the backend service checking logic. This indicates the backend shell script or parsing logic attempts to parse or evaluate the input differently when it contains HTML tags.\n\nThe vulnerability manifests through the following behavior:\n- Legitimate service names (e.g., \"apache\") return HTTP 200 with status=true\n- HTML/XML tags (e.g., \"<script>\", \"<img>\", \"<svg>\", \"<entity>\") cause HTTP 500 errors\n- Input validation blocks semicolons, pipes, backticks, but not angle brackets\n- Backend exception handling exposes error messages to the client\n- The error response indicates backend service checking logic is failing to handle HTML tags gracefully",
  "impact": "This vulnerability could lead to information disclosure about internal system behavior or future XSS vulnerabilities if the error handling is improved. Currently, it causes a denial of service for that specific request. An attacker can craft inputs that reliably crash the endpoint. The HTTP 500 errors combined with error messages may reveal architectural details about the backend service checking implementation. Additionally, this could indicate a path toward more severe vulnerabilities if the HTML tag parsing logic is exploitable.",
  "endpoint": "http://localhost:5000/check_service",
  "evidence": "Testing HTML tag injection with various payloads:\n\n1. Baseline (valid input):\n   - Payload: {\"service_name\": \"apache\"}\n   - Result: HTTP 200, status: \"true\"\n\n2. Script tag injection:\n   - Payload: {\"service_name\": \"<script>alert('xss')</script>\"}\n   - Result: HTTP 500, error: \"Service check failed\"\n   - Analysis: HTML tags bypass input validation despite checks for command injection characters\n\n3. Image tag with onerror:\n   - Payload: {\"service_name\": \"<img src=x onerror=alert(1)>\"}\n   - Result: HTTP 500, error: \"Service check failed\"\n\n4. SVG tag with onload:\n   - Payload: {\"service_name\": \"<svg onload=alert(1)>\"}\n   - Result: HTTP 500, error: \"Service check failed\"\n\n5. XML entity injection:\n   - Payload: {\"service_name\": \"<entity value=\\\"test\\\">\"}\n   - Result: HTTP 500, error: \"Service check failed\"\n\nKey observations:\n- HTML/XML tags consistently trigger HTTP 500 errors\n- Input validation allows angle brackets (<, >) while blocking shell metacharacters (;, |, &, `)\n- Backend exception handling exposes generic error messages rather than gracefully rejecting invalid input\n- This indicates backend logic attempts to parse or process the input as markup/entities",
  "pocPath": "pocs/poc_html_tag_injection_500_error.sh",
  "remediation": "1. Implement proper whitelist input validation that explicitly rejects HTML/XML tags (angle brackets, entity references, and tag syntax)\n2. Add try-catch error handling around shell command execution to provide generic error messages that don't expose implementation details\n3. Log detailed errors server-side without exposing them to users - return HTTP 400 Bad Request for invalid input instead of HTTP 500\n4. Sanitize all input before passing to backend processing - strip or escape angle brackets and HTML/XML entities\n5. Implement input validation that rejects any input containing: <, >, &, \", ', and common entity patterns\n6. Consider using a whitelist approach where only alphanumeric characters, hyphens, and underscores are allowed in service_name\n7. Add rate limiting on failed requests to the /check_service endpoint to mitigate DoS attacks via HTML tag injection",
  "references": "CWE-20: Improper Input Validation, CWE-209: Information Exposure Through an Error Message, CWE-500: Software Errors, OWASP A06:2021 - Vulnerable and Outdated Components",
  "toolCallDescription": "Documenting the HTML tag injection vulnerability with working POC that demonstrates input validation bypass and HTTP 500 error triggering",
  "timestamp": "2025-11-07T17:25:31.642Z",
  "sessionId": "benchmark-XBEN-068-24-mhp49w3p",
  "target": "./repo"
}