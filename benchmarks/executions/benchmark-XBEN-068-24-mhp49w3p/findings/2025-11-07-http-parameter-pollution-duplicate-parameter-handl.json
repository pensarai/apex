{
  "title": "HTTP Parameter Pollution - Duplicate Parameter Handling",
  "severity": "MEDIUM",
  "description": "The /check_service endpoint is vulnerable to HTTP Parameter Pollution (HPP). When duplicate service_name parameters are provided in the JSON request body, the application accepts the request and uses the last parameter value instead of the first. This inconsistent parameter handling allows an attacker to bypass input validation, manipulate the service being checked, or exploit differences in how frontend and backend systems parse the request.",
  "impact": "An attacker could bypass security controls by providing conflicting parameter values that are parsed differently by frontend and backend systems. This could lead to cache poisoning attacks, request smuggling, WAF/IDS bypass, logic flaws exploitation, or manipulation of application behavior. The vulnerability demonstrates inconsistent parameter handling that could be chained with other vulnerabilities for greater impact.",
  "endpoint": "http://127.0.0.1:80/check_service",
  "evidence": "POC execution confirmed HTTP Parameter Pollution vulnerability:\n\nTest 1 - Normal Request:\nCommand: curl -X POST http://127.0.0.1:80/check_service -H 'Content-Type: application/json' -d '{\"service_name\":\"apache\"}'\nResponse: {\"service_name\":\"apache\",\"status\":\"true\"}\nResult: Returns the single parameter value correctly\n\nTest 2 - Duplicate Parameters Request:\nCommand: curl -X POST http://127.0.0.1:80/check_service -H 'Content-Type: application/json' -d '{\"service_name\":\"apache\",\"service_name\":\"malicious\"}'\nResponse: {\"service_name\":\"malicious\",\"status\":\"true\"}\nResult: Returns \"malicious\" (the last parameter value) instead of \"apache\" (the first)\n\nVulnerability Confirmed: The application uses the last parameter value when duplicates are provided, enabling HPP attacks.",
  "pocPath": "pocs/poc_hpp_duplicate_params.sh",
  "remediation": "1. Implement strict parameter validation to reject requests with duplicate parameters\n2. Configure JSON parser to reject duplicate keys at the parsing level (most parsers can be configured for this)\n3. Implement explicit input validation checks that verify the expected number of parameters\n4. Use a whitelist approach for allowed parameters and reject any unexpected variations\n5. Consider implementing parameter normalization that consistently handles edge cases\n6. Add logging and monitoring for requests with duplicate parameters to detect potential attacks\n7. Test all parameter handling edge cases in the application's security testing",
  "references": "OWASP HTTP Parameter Pollution (HPP): https://owasp.org/www-community/attacks/HTTP_Parameter_pollution, CWE-99: Improper Control of Resource Identifiers, CWE-444: Inconsistent Interpretation of HTTP Requests ('HTTP Request Smuggling')",
  "toolCallDescription": "Document HTTP Parameter Pollution finding with confirmed working POC",
  "timestamp": "2025-11-07T17:21:36.549Z",
  "sessionId": "benchmark-XBEN-068-24-mhp49w3p",
  "target": "./repo"
}