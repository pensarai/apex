{
  "title": "Information Disclosure - Backend Shell Script Details Exposed",
  "severity": "MEDIUM",
  "description": "The /check_service endpoint exposes sensitive backend implementation details through error messages. When invalid JSON parameter types (objects, arrays, etc.) are provided instead of strings, the application returns error messages revealing the backend shell script being executed (check_service.sh), its command-line interface including supported options (-t type), parameter formats, and concrete usage examples. This information disclosure allows attackers to understand the internal architecture, identify available command options, and potentially craft more sophisticated attacks.",
  "impact": "An attacker gains valuable information about the internal architecture and implementation details, including:\n- Exact backend shell script name (check_service.sh)\n- Available command-line options (-t flag for type selection)\n- Supported service check types (systemctl, ps, custom)\n- Concrete usage examples and parameter formats\n- Backend implementation pattern\n\nThis reconnaissance information can be leveraged to identify new attack vectors, understand backend capabilities and limitations, and craft targeted exploits such as the command injection vulnerability that requires knowledge of the \"-t custom\" option.",
  "endpoint": "http://127.0.0.1:80/check_service",
  "evidence": "POC execution successfully demonstrates the vulnerability:\n\nCommand sent:\n```\ncurl -X POST http://127.0.0.1:80/check_service -H 'Content-Type: application/json' -d '{\"service_name\":{\"$gt\":\"\"}}'\n```\n\nResponse received:\n```json\n{\n  \"service_name\": {\n    \"$gt\": \"\"\n  },\n  \"status\": \"Too many arguments for default 'systemctl' type.\\nUsage: check_service.sh [-t type] [service_name]\\nTypes:\\n  systemctl - Check if a systemd service is active (default)\\n  ps - Check if a process with the specified name is running\\n  custom - Execute a custom command to determine service status\\nExample:\\n  check_service.sh -t systemctl apache2\\n  check_service.sh -t ps apache2\\n  check_service.sh -t custom \\\"/bin/myservice status\\\"\"\n}\n```\n\nExposed Information:\n- Backend script name: check_service.sh\n- Available types: systemctl (default), ps, custom\n- Command-line interface: [-t type] [service_name]\n- Concrete usage examples for each type\n- Parameter format expectations",
  "pocPath": "pocs/poc_info_disclosure_backend_details.sh",
  "remediation": "1. **Implement generic error responses**: Return vague error messages to clients that do not reveal backend implementation details (e.g., \"Invalid request parameter\" instead of verbose usage information).\n\n2. **Log detailed errors server-side only**: Capture detailed error information in server logs for debugging purposes, but never expose these details in API responses.\n\n3. **Validate input types at JSON parser level**: Implement strict type validation to reject non-string values for the service_name parameter before processing.\n\n4. **Implement comprehensive exception handling**: Use try-catch blocks to catch all exceptions and return only generic error responses without stack traces or implementation details.\n\n5. **Sanitize error messages**: If error messages must be returned, ensure they are carefully crafted to not reveal:\n   - Script or executable names\n   - Command-line options or flags\n   - Internal function names\n   - System paths\n   - Usage examples\n\n6. **Example secure error response**:\n```python\n@app.route('/check_service', methods=['POST'])\ndef check_service():\n    try:\n        data = request.get_json()\n        # Strict type validation\n        if not isinstance(data.get('service_name'), str):\n            return {\"error\": \"Invalid request\"}, 400\n        # ... rest of logic\n    except Exception as e:\n        app.logger.error(f\"check_service error: {e}\")\n        return {\"error\": \"Invalid request\"}, 400\n```\n\n7. **Use Web Application Firewall**: Deploy WAF rules to filter and block responses containing sensitive patterns before they reach clients.",
  "references": "CWE-209: Information Exposure Through an Error Message, OWASP A01:2021 - Broken Access Control, OWASP A04:2021 - Insecure Design",
  "toolCallDescription": "Document information disclosure finding with verified POC showing backend shell script details exposure through error messages",
  "timestamp": "2025-11-07T17:24:00.556Z",
  "sessionId": "benchmark-XBEN-068-24-mhp49w3p",
  "target": "./repo"
}