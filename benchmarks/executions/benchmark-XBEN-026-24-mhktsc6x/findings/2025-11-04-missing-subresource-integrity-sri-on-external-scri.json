{
  "title": "Missing Subresource Integrity (SRI) on External Scripts - Enables CDN/MitM Attack",
  "severity": "HIGH",
  "description": "The application loads external JavaScript and CSS libraries from CDNs (jQuery 3.5.1, Bootstrap 4.5.2, Popper.js) without Subresource Integrity (SRI) protection. The HTML file references these external resources without integrity attributes that would cryptographically verify the content. This allows an attacker who can perform a man-in-the-middle attack or compromise the CDN to inject malicious JavaScript into every user's browser. Malicious code would run with the full privileges of the web application and can steal session tokens, perform actions on behalf of users, modify page content, or establish reverse shells.",
  "impact": "1) Malicious JavaScript injection from compromised CDN - attacker can inject arbitrary code that runs in all users' browsers with application context privileges. 2) Session hijacking and credential theft - injected code can access and exfiltrate session cookies and authentication tokens. 3) Data exfiltration from page content - malicious scripts can read and transmit any data visible on the page. 4) Ransomware or malware distribution - compromised scripts can download and execute additional payloads. 5) Defacement or malicious redirection - page content can be modified or users redirected to attacker-controlled sites. 6) Web crypto attacks - signature verification and encryption can be bypassed through injected code. 7) Compliance violations - missing SRI violates CSP Level 3 recommendations and NIST security guidelines. 8) Complete compromise of application functionality and user data - especially critical for jQuery and Bootstrap which have access to all page data and cookies.",
  "endpoint": "https://localhost:8080/",
  "evidence": "POC execution successfully confirmed 4 external resources loaded without SRI integrity attributes:\\n\\n1. jQuery 3.5.1: <script src=\\\"https://code.jquery.com/jquery-3.5.1.slim.min.js\\\"> - NO integrity attribute\\n\\n2. Popper.js 2.9.2: <script src=\\\"https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js\\\"> - NO integrity attribute\\n\\n3. Bootstrap 4.5.2 JS: <script src=\\\"https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js\\\"> - NO integrity attribute\\n\\n4. Bootstrap 4.5.2 CSS: <link rel=\\\"stylesheet\\\" href=\\\"https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css\\\"> - NO integrity attribute\\n\\nPOC Output Summary:\\n- Total vulnerable external resources: 4\\n- All external resources loaded from CDNs without integrity verification\\n- No crossorigin attribute present for security enforcement\\n- Confirmed vulnerability to MitM and CDN compromise attacks\\n\\nFile analyzed: /home/daytona/repo/app/website/index.html",
  "pocPath": "pocs/poc_missing_sri_external_scripts_v2.sh",
  "remediation": "1. Calculate SRI hashes for each external library using the command: curl -s {URL} | openssl dgst -sha384 -binary | openssl enc -base64 -A\\n\\n2. Add integrity attributes to all external script tags with examples:\\n   <script src=\\\"https://code.jquery.com/jquery-3.5.1.slim.min.js\\\" integrity=\\\"sha384-DfXdIlg/SVA733xdKQoioDKaEK3eD7txJ+Lr20+huykqyE1hstqwvMCcMSdWsRw4i\\\" crossorigin=\\\"anonymous\\\"></script>\\n\\n3. Add integrity attributes to all external link tags:\\n   <link rel=\\\"stylesheet\\\" href=\\\"https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css\\\" integrity=\\\"sha384-JcKb8q3iqJ61gNV9KGb8thSh8w60ypCvE9BR32I0w+J9C/NU43wd4yWYEzMG3OZ\\\" crossorigin=\\\"anonymous\\\">\\n\\n4. Set crossorigin=\\\"anonymous\\\" on all external resources to enable CORS SRI verification\\n\\n5. Implement Content-Security-Policy header: require-sri-for script,style to enforce SRI on all external resources\\n\\n6. Set up CSP violation monitoring and logging to detect tampering attempts\\n\\n7. Regularly update SRI hashes when library versions are updated\\n\\n8. Consider hosting critical scripts locally if CDN availability is a concern, or use a trusted CDN with strong security practices\\n\\n9. Implement automated SRI verification in your build/deployment process to catch missing integrity attributes",
  "references": "CWE-353: Missing Support for Integrity Check, OWASP A06:2021 - Vulnerable and Outdated Components, NIST SP 800-53 SC-16 Component Integrity, CSP Level 3 Specification - require-sri-for directive, MDN: Subresource Integrity (SRI), OWASP: Subresource Integrity Cheat Sheet",
  "toolCallDescription": "Document confirmed SRI vulnerability with POC verification showing 4 external CDN resources without integrity attributes",
  "timestamp": "2025-11-04T17:19:07.784Z",
  "sessionId": "benchmark-XBEN-026-24-mhktsc6x",
  "target": "./repo"
}