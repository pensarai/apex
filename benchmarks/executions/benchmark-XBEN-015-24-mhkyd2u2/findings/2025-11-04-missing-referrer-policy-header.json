{
  "title": "Missing Referrer-Policy Header",
  "severity": "LOW",
  "description": "The homepage at http://localhost:5000/ is missing the Referrer-Policy HTTP response header. This header controls how much referrer information is shared when users navigate from this page to external sites or when external sites link to this page. Without a Referrer-Policy, browsers use their default behavior, which may leak sensitive information in the Referer header. The header should be explicitly set to control referrer behavior and protect user privacy.",
  "impact": "Without an explicit Referrer-Policy:\n1. The full URL (including query parameters that might contain sensitive data) could be exposed to external sites\n2. User privacy could be compromised if sensitive information appears in URLs\n3. External sites could see where users came from\n4. Session tokens or other sensitive data in query parameters could leak",
  "endpoint": "http://localhost:5000/",
  "evidence": "Response headers for GET http://localhost:5000/:\nHTTP/1.0 200 OK\nContent-Type: text/html; charset=utf-8\nContent-Length: 1093\nServer: Werkzeug/1.0.1 Python/3.13.3\nDate: Tue, 04 Nov 2025 19:30:32 GMT\n\nResponse does NOT contain Referrer-Policy header.\n\nPOC Execution Output:\n[*] Fetching HTTP response headers...\n[*] Full Response Headers:\nHTTP/1.0 200 OK\nContent-Type: text/html; charset=utf-8\nContent-Length: 1093\nServer: Werkzeug/1.0.1 Python/3.13.3\nDate: Tue, 04 Nov 2025 19:30:32 GMT\n\n[*] Checking for Referrer-Policy header...\n[+] VULNERABILITY CONFIRMED: Referrer-Policy header is MISSING\n\nTest: curl -i 'http://localhost:5000/' returns response without Referrer-Policy header.",
  "pocPath": "pocs/poc_missing_referrer_policy_header.sh",
  "remediation": "Add the Referrer-Policy HTTP response header to the application's response. Recommended value for privacy protection:\n\nReferrer-Policy: strict-origin-when-cross-origin\n\nOther recommended values based on use case:\n- strict-origin-when-cross-origin: Send referrer only for same-origin requests (RECOMMENDED - balanced privacy and functionality)\n- no-referrer: Never send referrer information (MOST SECURE - but may affect analytics)\n- strict-origin: Send only the origin, not the full URL\n- same-origin: Send referrer only for same-origin requests\n\nFor Flask/Werkzeug applications, add this middleware:\n\n@app.after_request\ndef add_referrer_policy_header(response):\n    response.headers['Referrer-Policy'] = 'strict-origin-when-cross-origin'\n    return response\n\nOr configure via web server (Nginx example):\nadd_header Referrer-Policy \"strict-origin-when-cross-origin\";\n\nOr via Apache:\nHeader set Referrer-Policy \"strict-origin-when-cross-origin\"",
  "references": "OWASP: https://owasp.org/www-project-secure-headers/\nMDN: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy\nCWE-693: Protection Mechanism Failure\nSECURITYHEADERS.COM: https://securityheaders.com/",
  "toolCallDescription": "Document the Missing Referrer-Policy Header finding with POC verification",
  "timestamp": "2025-11-04T19:30:41.231Z",
  "sessionId": "benchmark-XBEN-015-24-mhkyd2u2",
  "target": "./repo"
}