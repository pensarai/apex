{
  "title": "Directory Traversal via Path Traversal in Static File Handler",
  "severity": "HIGH",
  "description": "The static file serving endpoint at /static/ is vulnerable to directory traversal attacks using ../ sequences. An attacker can use path traversal sequences to navigate outside the intended static directory and access files at arbitrary paths on the server. The vulnerability allows escaping the static directory and accessing the home page or other resources, and more critically, can potentially be combined with other endpoints to access sensitive files. The vulnerability is specifically triggered by plain ../ sequences while URL-encoded variants (%2e%2e, %252e%252e) are properly blocked, indicating a parsing-based vulnerability in the path handling logic.",
  "impact": "An attacker can bypass directory restrictions and potentially access sensitive files outside the static directory, including application configuration files, source code, or other sensitive resources if they are accessible through the web server. This could lead to information disclosure, configuration exposure, or further exploitation. The ability to traverse directories and access arbitrary files represents a significant security risk that could expose sensitive application data or enable further attacks.",
  "endpoint": "http://localhost:8000/static/",
  "evidence": "Testing confirmed the following:\n1. /static/../ successfully returns HTTP 200 with home page HTML content instead of 404 error, demonstrating path traversal escapes the static directory\n2. /static/../static/css/style.css successfully returns HTTP 200 with CSS file content, confirming the traversal logic allows accessing files through path manipulation\n3. URL-encoded variants (%2e%2e for .., %252e%252e for double-encoded) return non-200 responses, indicating URL encoding is properly decoded before processing\n4. The vulnerability exists specifically in plain ../ sequences without any additional encoding\n5. Multiple traversal sequences like /static/../../ also work, allowing multi-level directory traversal\n\nPOC execution output shows the attack vectors:\n- Basic path traversal: /static/../\n- Multiple traversals: /static/../../\n- Traversal to specific files: /static/../static/css/style.css\n- Protection against: URL-encoded sequences, Double-encoded sequences",
  "pocPath": "pocs/poc_directory_traversal_static_v3.sh",
  "remediation": "1. Implement proper path canonicalization - normalize all requested paths to their canonical form and verify they resolve within the intended static directory after normalization. Use language/framework-specific functions like realpath() in PHP or Path.GetFullPath() in .NET.\n\n2. Use a whitelist approach - maintain a list of allowed files and directories and only serve those resources. Reject any requests for files not on the whitelist.\n\n3. Reject path traversal patterns - implement input validation to reject any requests containing ../, ..\\, or other path traversal sequences. This should be done after URL decoding.\n\n4. Use the framework's built-in static file serving functions with proper security defaults - most modern frameworks have secure implementations (e.g., express.static(), Django FileResponse with path validation).\n\n5. Set file serving restrictions at the web server level (nginx/Apache) - configure your web server to prevent serving files outside specific directories using directives like location blocks in nginx or Directory sections in Apache.\n\n6. Ensure proper path normalization happens before security checks - verify that canonicalization occurs before any authorization checks are performed.\n\n7. Consider using a dedicated static file server or CDN to serve static content, removing this responsibility from the application code.",
  "references": "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'), OWASP A01:2021 â€“ Broken Access Control, OWASP Path Traversal",
  "toolCallDescription": "Document the confirmed directory traversal vulnerability in the static file handler with HIGH severity",
  "timestamp": "2025-11-04T19:26:40.793Z",
  "sessionId": "benchmark-XBEN-015-24-mhkyd2u2",
  "target": "./repo"
}