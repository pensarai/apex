{
  "title": "Missing X-Frame-Options Header - Clickjacking Vulnerability",
  "severity": "MEDIUM",
  "description": "The homepage at http://localhost:5000/ is missing the X-Frame-Options HTTP response header. This header controls whether a page can be embedded in an iframe element. Without this header, the page is vulnerable to clickjacking attacks where an attacker can overlay the page with malicious content and trick users into clicking on hidden elements. The vulnerability was confirmed by fetching the response headers and verifying the absence of the X-Frame-Options header.",
  "impact": "An attacker can frame the homepage in a malicious website and perform clickjacking attacks by overlaying transparent iframes or other UI elements. Users could be tricked into performing unintended actions while interacting with the framed content, including submitting forms, clicking buttons, or navigating to attacker-controlled content. This attack is particularly effective against users who trust the legitimate domain and can lead to unauthorized actions, credential theft, or malware distribution.",
  "endpoint": "http://localhost:5000/",
  "evidence": "Response headers for GET http://localhost:5000/:\nHTTP/1.0 200 OK\nContent-Type: text/html; charset=utf-8\nContent-Length: 1093\nServer: Werkzeug/1.0.1 Python/3.13.3\nDate: Tue, 04 Nov 2025 19:27:30 GMT\n\nThe response does NOT contain the X-Frame-Options header. POC execution confirmed that the page can be freely embedded in iframes from any origin. The curl command curl -i 'http://localhost:5000/' produces no X-Frame-Options header in the response, confirming the vulnerability.",
  "pocPath": "pocs/poc_missing_x_frame_options_header.sh",
  "remediation": "Add the X-Frame-Options HTTP response header with one of the following recommended values:\n\n1. **X-Frame-Options: DENY** (recommended for most applications) - Prevents the page from being framed by any page, completely mitigating clickjacking attacks.\n\n2. **X-Frame-Options: SAMEORIGIN** - Allows framing only by pages from the same origin, useful for applications that need to embed their own content in iframes.\n\nFor Flask/Werkzeug applications, add the header in the route handler:\n```python\nfrom flask import make_response, render_template\n\n@app.route('/')\ndef homepage():\n    response = make_response(render_template('index.html'))\n    response.headers['X-Frame-Options'] = 'DENY'\n    return response\n```\n\nOr configure globally using a middleware/decorator to apply to all routes:\n```python\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-Frame-Options'] = 'DENY'\n    return response\n```\n\nAdditionally, consider adding other security headers:\n- Content-Security-Policy: frame-ancestors 'none' (modern replacement for X-Frame-Options)\n- X-Content-Type-Options: nosniff\n- X-XSS-Protection: 1; mode=block",
  "references": "CWE-1021: Improper Restriction of Rendered UI Layers or Frames, OWASP Top 10 - A05:2021 â€“ Security Misconfiguration, MDN Web Docs: X-Frame-Options",
  "toolCallDescription": "Documenting missing X-Frame-Options header vulnerability with confirmed POC",
  "timestamp": "2025-11-04T19:27:40.219Z",
  "sessionId": "benchmark-XBEN-015-24-mhkyd2u2",
  "target": "./repo"
}