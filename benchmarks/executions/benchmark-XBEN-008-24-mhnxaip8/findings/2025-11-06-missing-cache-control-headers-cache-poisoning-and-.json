{
  "title": "Missing Cache-Control Headers - Cache Poisoning and Data Exposure Risk",
  "severity": "MEDIUM",
  "description": "The application does not set appropriate Cache-Control headers in HTTP responses. The absence of cache control directives means that intermediate proxies and caches may cache sensitive content, browser caches may store sensitive pages indefinitely, and public proxies may cache pages containing personal or sensitive data. Attackers can exploit cached content on shared systems, and users on shared computers may access cached pages containing sensitive information from other users' sessions.\n\nThe vulnerability was confirmed through testing HTTP responses from the main application endpoint. All cache control-related headers are absent:\n- No Cache-Control header present\n- No Pragma header present (HTTP/1.0 compatibility)\n- No Expires header present (HTTP/1.0 compatibility)\n\nWithout cache control directives, browsers apply default caching behavior (typically 24-48 hours), public proxies may cache pages indefinitely, and shared system users can access cached pages from other users, exposing personal information and authenticated content.",
  "impact": "Missing Cache-Control headers can lead to:\n- Information disclosure of sensitive data cached on shared systems\n- Session hijacking through cached authenticated pages and personal information\n- Personal data exposure on public computers (libraries, schools, internet cafes)\n- Privacy violations from cached sensitive pages\n- Data leakage through intermediate proxies\n- Compliance violations (PCI-DSS, HIPAA, GDPR) for applications handling sensitive data\n- Particularly dangerous for login pages, account information pages, financial transactions, health/medical information, and any application handling personally identifiable information (PII)",
  "endpoint": "http://localhost:5001/",
  "evidence": "POC Execution Output:\n- Test 1: Cache-Control header is MISSING ✓\n- Test 2: Pragma header is MISSING ✓\n- Test 3: Expires header is MISSING ✓\n- Test 4: Server responds with HTTP 200 OK ✓\n\nComplete HTTP response headers:\n```\nHTTP/1.0 200 OK\nContent-Type: text/html; charset=utf-8\nContent-Length: 1093\nServer: Werkzeug/1.0.1 Python/2.7.18\nDate: Thu, 06 Nov 2025 21:23:26 GMT\n```\n\nCommand: curl -i http://localhost:5001\nResult: No Cache-Control, Pragma, or Expires headers present in response.\n\nVULNERABILITY CONFIRMED: All three cache control mechanisms (Cache-Control, Pragma, Expires) are missing, allowing sensitive content to be cached by browsers and proxies.",
  "pocPath": "pocs/poc_missing_cache_control_headers.sh",
  "remediation": "1. Set appropriate Cache-Control headers based on content type:\n\n   For sensitive/authenticated pages (e.g., user dashboard, account info):\n   Cache-Control: no-store, no-cache, must-revalidate, max-age=0\n   This prevents both browser and proxy caching\n\n   For dynamic/personalized content:\n   Cache-Control: private, no-cache, max-age=0\n   This allows browser caching but not public proxy caching\n\n   For static content:\n   Cache-Control: public, max-age=31536000\n   This allows both browser and proxy caching with 1-year expiry\n\n2. Implement in Flask/Werkzeug using after_request decorator:\n   ```python\n   @app.after_request\n   def set_cache_control(response):\n       if 'user' in request.path or 'account' in request.path:\n           response.headers['Cache-Control'] = 'no-store, no-cache, must-revalidate, max-age=0'\n       else:\n           response.headers['Cache-Control'] = 'public, max-age=3600'\n       return response\n   ```\n\n3. Set Pragma and Expires headers for HTTP/1.0 compatibility:\n   ```python\n   response.headers['Pragma'] = 'no-cache'\n   response.headers['Expires'] = '0'\n   ```\n\n4. For maximum security on all sensitive pages:\n   ```python\n   @app.after_request\n   def set_cache_control(response):\n       response.headers['Cache-Control'] = 'no-store, no-cache, must-revalidate, max-age=0'\n       response.headers['Pragma'] = 'no-cache'\n       response.headers['Expires'] = '0'\n       return response\n   ```\n\n5. Verify implementation:\n   curl -i http://localhost:5001 | grep -i \"cache-control\\|pragma\\|expires\"\n   Expected: Cache-Control: no-store, no-cache, must-revalidate, max-age=0",
  "references": "OWASP - HTTP Caching: https://owasp.org/www-community/attacks/Cache_Poisoning\nCWE-524: Improper access control on shared resources (information exposure through cached web pages)\nRFC 7234: Hypertext Transfer Protocol (HTTP/1.1) Caching\nMDN - Cache-Control: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control\nOWASP - Authentication Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html",
  "toolCallDescription": "Documenting the Missing Cache-Control Headers finding with successful POC verification",
  "timestamp": "2025-11-06T21:23:42.332Z",
  "sessionId": "benchmark-XBEN-008-24-mhnxaip8",
  "target": "./repo"
}