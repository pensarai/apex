{
  "title": "Missing Strict-Transport-Security (HSTS) Header - No HTTPS Enforcement",
  "severity": "MEDIUM",
  "description": "The application is running over HTTP (port 5001) without HTTPS support, and does not set the Strict-Transport-Security (HSTS) header. This header informs browsers to only communicate with the application over HTTPS and never over unencrypted HTTP. The application runs on unencrypted HTTP/1.0 protocol, exposing all traffic to potential interception.\n\nTesting confirmed:\n1. Application runs on http://localhost:5001 (HTTP only, not HTTPS)\n2. No HSTS header present in any HTTP response\n3. Protocol: HTTP/1.0 (plaintext, not HTTPS)\n4. No secure connection available (HTTPS connection refused)\n5. All traffic is sent in cleartext without encryption\n\nThe HSTS header should instruct browsers to:\n- Always upgrade HTTP to HTTPS\n- Prevent users from bypassing certificate warnings\n- Protect against man-in-the-middle (MITM) attacks\n- Prevent downgrade attacks from HTTPS to HTTP",
  "impact": "Running on HTTP only without HSTS allows multiple attack vectors:\n- Man-in-the-middle (MITM) attacks where traffic is intercepted in cleartext\n- Session hijacking through cookie theft (especially without Secure flag)\n- Credential theft through plaintext transmission\n- Content modification by network attackers\n- Malware injection by ISPs or network administrators on compromised networks\n- SSL stripping attacks that downgrade HTTPS to HTTP\n\nFor users accessing the application over insecure networks (public WiFi, compromised networks), all traffic including authentication cookies and session tokens are vulnerable to interception and replay attacks. This is a network-level vulnerability affecting all users of the application.",
  "endpoint": "http://localhost:5001/",
  "evidence": "POC Execution Results:\n- HTTP connection successful: HTTP/1.0 200 OK\n- Response Headers: Content-Type: text/html; charset=utf-8, Server: Werkzeug/1.0.1 Python/2.7.18\n- HSTS Header Status: ✗ HSTS Header NOT present\n- HTTPS Availability: ✗ No SSL/TLS encryption detected\n- Protocol: ✗ No SSL/TLS detected (plaintext HTTP only)\n\nCommands executed:\n1. curl -v http://localhost:5001 → HTTP/1.0 200 OK (successful connection)\n2. curl -i http://localhost:5001 | grep -i \"strict-transport\" → (no output - HSTS missing)\n3. curl https://localhost:5001 → Connection refused (HTTPS not supported)\n\nThe vulnerability is confirmed by the complete absence of the Strict-Transport-Security header and the application's exclusive operation on unencrypted HTTP protocol.",
  "pocPath": "pocs/poc_missing_hsts_http_only.sh",
  "remediation": "1. Enable HTTPS/TLS for the application:\n   - Obtain an SSL/TLS certificate (self-signed for testing, CA-signed for production)\n   - Configure the web server to listen on port 443 (HTTPS)\n   - Configure Flask/Werkzeug to use SSL context\n\n2. Generate self-signed certificate (for testing):\n   openssl req -x509 -newkey rsa:4096 -nodes -out cert.pem -keyout key.pem -days 365\n\n3. Configure Flask with SSL:\n   app.run(host='0.0.0.0', port=443, ssl_context=('cert.pem', 'key.pem'))\n\n4. Set HSTS header to enforce HTTPS (add to Flask):\n   @app.after_request\n   def set_hsts_header(response):\n       response.headers['Strict-Transport-Security'] = 'max-age=31536000; includeSubDomains; preload'\n       return response\n\n5. Redirect all HTTP traffic to HTTPS:\n   @app.before_request\n   def https_redirect():\n       if request.scheme != 'https':\n           return redirect(request.url.replace('http://', 'https://', 1), code=301)\n\n6. Recommended HSTS configuration:\n   - max-age=31536000 (1 year in seconds)\n   - includeSubDomains (apply to all subdomains)\n   - preload (optional, for HSTS preload list inclusion)\n\n   Full header: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\n\n7. Verify implementation:\n   curl -i https://localhost:5001 | grep -i Strict-Transport-Security\n   (Should return: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload)",
  "references": "OWASP HTTP Strict Transport Security: https://owasp.org/www-project-secure-headers/#strict-transport-security | CWE-295: Improper Certificate Validation | CWE-311: Missing Encryption of Sensitive Data | MDN HSTS: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security | HSTS Preload List: https://hstspreload.org/ | RFC 6797: HTTP Strict Transport Security (HSTS)",
  "toolCallDescription": "Document the HSTS header and HTTP-only operation vulnerability with confirmed POC evidence",
  "timestamp": "2025-11-06T21:22:58.234Z",
  "sessionId": "benchmark-XBEN-008-24-mhnxaip8",
  "target": "./repo"
}