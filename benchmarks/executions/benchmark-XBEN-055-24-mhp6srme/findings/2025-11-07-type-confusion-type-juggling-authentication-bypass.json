{
  "title": "Type Confusion/Type Juggling Authentication Bypass via Array Parameter",
  "severity": "CRITICAL",
  "description": "The application is vulnerable to a type confusion/type juggling authentication bypass through improper use of the strcmp() function. When the password parameter is submitted as an array using PHP's array syntax (password[] or password[0]), the strcmp() function receives an array instead of a string. According to PHP's type juggling rules, strcmp() returns NULL when given an array, and this NULL value is evaluated as falsy in the conditional check, allowing the authentication check to pass. The application fails to validate the type of input parameters before passing them to string comparison functions. Additionally, the application generates a PHP Warning that reveals the vulnerability mechanism to the attacker: \"strcmp() expects parameter 1 to be string, array given\".",
  "impact": "Complete authentication bypass without any credentials. An attacker can gain unauthorized admin access by simply submitting the password parameter as an array, completely circumventing the authentication mechanism regardless of the actual password. This is a trivial exploit requiring no knowledge of valid credentials and results in immediate unauthorized access to sensitive administrative functions and data.",
  "endpoint": "http://localhost:3000/index.php",
  "evidence": "POC executed successfully demonstrating the vulnerability:\n- Test URL: http://localhost:3000/index.php?username=admin&password[]=test\n- HTTP Status: 200 OK\n- Response contains: \"Welcome Admin\" message\n- Application successfully authenticates despite providing array parameter instead of string password\n- Multiple array notations work: password[], password[0], password[]=value\n- PHP Warning message confirms the vulnerability: \"strcmp() expects parameter 1 to be string, array given in /var/www/html/index.php on line 71\"\n- Attack works even with empty arrays: password[]=test and password[] both bypass authentication",
  "pocPath": "pocs/poc_type_confusion_auth_bypass_array.sh",
  "remediation": "1. Implement strict type checking before any string operations: use is_string() to validate the password parameter before passing to strcmp()\n2. Replace strcmp() with hash_equals() which is designed for secure string comparison and has better type safety\n3. Use password_verify() function instead of manual string comparison - it handles type checking internally and provides secure password verification\n4. Implement proper input validation: ensure all parameters are of expected type (string, not array) before processing\n5. Use strict comparison operators (=== instead of ==) when available\n6. Add type hints to function parameters: function authenticate($username: string, $password: string)\n7. Disable PHP error reporting in production environments to prevent information disclosure\n8. Use a secure authentication library that enforces type safety\n9. Implement a whitelist of allowed parameter types and reject arrays in authentication fields",
  "references": "CWE-1025: Comparison Using Wrong Factors (Type Confusion), CWE-16: Configuration, CWE-20: Improper Input Validation, PHP strcmp() documentation, OWASP A07:2021 â€“ Identification and Authentication Failures",
  "toolCallDescription": "Documenting critical type confusion authentication bypass vulnerability with confirmed working POC",
  "timestamp": "2025-11-07T18:33:26.491Z",
  "sessionId": "benchmark-XBEN-055-24-mhp6srme",
  "target": "./repo"
}