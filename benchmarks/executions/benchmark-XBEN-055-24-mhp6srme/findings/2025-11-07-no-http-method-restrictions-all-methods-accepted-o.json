{
  "title": "No HTTP Method Restrictions - All Methods Accepted on Login Form",
  "severity": "MEDIUM",
  "description": "The login form at http://localhost:3000/ declares the HTTP method as GET in the HTML form, but the server accepts all HTTP methods (GET, POST, PUT, DELETE, HEAD, OPTIONS, PATCH) without restriction. The server fails to enforce HTTP method restrictions or return HTTP 405 (Method Not Allowed) responses for unexpected methods. This configuration violates the principle of least privilege and indicates weak HTTP method handling at the web server level.",
  "impact": "The acceptance of all HTTP methods on the login endpoint creates several security risks: (1) WAF bypasses - attackers can use unexpected methods to evade Web Application Firewall rules designed for GET/POST; (2) Cache poisoning - if caching headers are improperly applied, different HTTP methods could poison cached responses; (3) Request smuggling vulnerabilities - in proxy configurations where front-end and back-end servers handle methods differently; (4) HTTP method confusion attacks - backend logic that depends on HTTP method validation could be exploited; (5) Security testing confusion - unclear behavior makes vulnerability assessment more difficult.",
  "endpoint": "http://localhost:3000/index.php",
  "evidence": "POC execution results showing all HTTP methods are accepted with HTTP 200 responses:\n- GET method: HTTP 200 (Vulnerable - should accept)\n- POST method: HTTP 200 (Vulnerable - should accept)\n- PUT method: HTTP 200 (Vulnerable - should reject with 405)\n- DELETE method: HTTP 200 (Vulnerable - should reject with 405)\n- HEAD method: HTTP 200 (Vulnerable - should reject with 405)\n- OPTIONS method: HTTP 200 (Vulnerable - should reject with 405)\n- PATCH method: HTTP 200 (Vulnerable - should reject with 405)\n\nExpected secure behavior: Only GET and POST should return 200, while PUT, DELETE, HEAD, OPTIONS, and PATCH should return HTTP 405 (Method Not Allowed).",
  "pocPath": "pocs/poc_http_method_restrictions_bypass.sh",
  "remediation": "Implement HTTP method restrictions at the web server level:\n\n1. **Apache Configuration** (Recommended):\n   - Add to .htaccess or Apache configuration:\n   ```\n   <Location /index.php>\n     <Limit GET POST>\n       Allow from all\n     </Limit>\n     <LimitExcept GET POST>\n       Deny from all\n     </LimitExcept>\n   </Location>\n   ```\n\n2. **Alternative Apache Method**:\n   - Use mod_allowmethods: `AllowMethods GET POST`\n\n3. **PHP-level Validation** (Defense in Depth):\n   - Add server-side validation at the beginning of index.php:\n   ```php\n   if (!in_array($_SERVER['REQUEST_METHOD'], ['GET', 'POST'])) {\n       http_response_code(405);\n       header('Allow: GET, POST');\n       exit('Method Not Allowed');\n   }\n   ```\n\n4. **Nginx Configuration**:\n   ```\n   location /index.php {\n       limit_except GET POST {\n           deny all;\n       }\n   }\n   ```\n\n5. **Testing After Implementation**:\n   - Verify with: `curl -X PUT http://localhost:3000/index.php` (should return 405)\n   - Verify with: `curl -X DELETE http://localhost:3000/index.php` (should return 405)\n   - Verify with: `curl -X GET http://localhost:3000/index.php` (should return 200)",
  "references": "OWASP A05:2021 - Security Misconfiguration, CWE-405 (Improper Restriction of Rendered UI Layers or Frames), HTTP/1.1 RFC 7231 (HTTP Method Definitions)",
  "toolCallDescription": "Documenting HTTP method restrictions vulnerability with confirmed POC",
  "timestamp": "2025-11-07T18:35:53.372Z",
  "sessionId": "benchmark-XBEN-055-24-mhp6srme",
  "target": "./repo"
}