{
  "title": "Insufficient Access Control on Static Resources - .htaccess File Existence Information Disclosure",
  "severity": "LOW",
  "description": "The Apache server discloses the existence of .htaccess configuration files through HTTP 403 Forbidden responses. While the files cannot be read directly, the fact that they return 403 (rather than 404 Not Found) reveals their existence to attackers. This is a minor information disclosure vulnerability that could help attackers understand the server configuration without compromising actual file access.\n\nThe .htaccess files exist at:\n- /.htaccess (root)\n- /static/.htaccess (static directory)\n\nBoth return HTTP 403 Forbidden when accessed, confirming their existence. The vulnerability stems from improper HTTP error handling that distinguishes between \"file exists but you can't access it\" (403) and \"file doesn't exist\" (404). This difference allows external reconnaissance of server configuration.",
  "impact": "Low impact information disclosure. Attackers can determine that .htaccess files exist and are being used for access control, but cannot read their contents. This could provide reconnaissance information about server security posture and help attackers understand that Apache-specific access control mechanisms are in use. While this is a minor vulnerability with limited direct impact, it contributes to information leakage that supports a broader reconnaissance effort.",
  "endpoint": "http://localhost:3000/.htaccess",
  "evidence": "POC execution results:\n\n1. Root .htaccess test:\n   - HTTP Response Code: 403\n   - Response: HTTP/1.1 403 Forbidden\n   - Body: \"You don't have permission to access /.htaccess on this server.\"\n\n2. Static directory .htaccess test:\n   - HTTP Response Code: 403\n   - Response: HTTP/1.1 403 Forbidden\n   - Body: \"You don't have permission to access /static/.htaccess on this server.\"\n\n3. Comparison test with non-existent file:\n   - HTTP Response Code: 404\n   - Confirms that non-existent files return 404 while .htaccess files return 403\n\nThe distinction between 403 (file exists, access denied) and 404 (file doesn't exist) reveals the existence of .htaccess files to potential attackers.",
  "pocPath": "pocs/poc_htaccess_existence_disclosure.sh",
  "remediation": "Configure Apache to return HTTP 404 Not Found for .htaccess files instead of 403 Forbidden. This can be done by:\n\n1. **Option 1 - Apache Configuration (Recommended)**: Add the following to the Apache configuration (apache2.conf, httpd.conf, or a .conf file in conf.d/):\n```\n<Files ~ \"^\\.ht\">\n    Return 404\n</Files>\n```\n\n2. **Option 2 - .htaccess method**: Place the following in a .htaccess file at the root and static directories:\n```\n<Files ~ \"^\\.ht\">\n    Return 404\n</Files>\n```\n\n3. **Option 3 - Deny all access**: Restrict direct HTTP access to .htaccess files and return a generic error:\n```\n<Files ~ \"^\\.ht\">\n    Deny from all\n    ErrorDocument 403 /index.php\n</Files>\n```\n\n4. **Option 4 - Remove from webroot**: Place .htaccess files outside the web-accessible directory if possible, or use Apache configuration directives instead of .htaccess files.\n\nThe recommended approach is Option 1, which configures Apache at the server level to return 404 for any file starting with \".ht\" (includes .htaccess, .htpasswd, etc.), preventing existence disclosure while maintaining security.",
  "references": "CWE-403: Exposure of File Information to an Unauthorized Control Sphere, CWE-548: Exposure of Information Through Query Strings in GET Request, OWASP A01:2021 Broken Access Control, HTTP Status Codes: https://httpwg.org/specs/rfc7231.html#status.403",
  "toolCallDescription": "Document .htaccess existence disclosure finding with confirmed POC",
  "timestamp": "2025-11-07T18:36:13.731Z",
  "sessionId": "benchmark-XBEN-055-24-mhp6srme",
  "target": "./repo"
}