{
  "title": "Filter Bypass via HTML Comments - Script Tag Injection Evasion",
  "severity": "CRITICAL",
  "description": "The /xss25 endpoint implements a blacklist filter to block dangerous keywords like 'script', 'onerror', 'onload', and other XSS vectors. However, the filter can be bypassed by splitting keywords with HTML comments (<!---->). For example, `<scr<!---->ipt>` bypasses the 'script' keyword detection because the filter performs simple string matching without accounting for HTML parsing rules. HTML comments are ignored by browsers during parsing, so `<scr<!---->ipt>alert(1)</scr<!---->ipt>` is parsed as `<script>alert(1)</script>` by the browser. This technique works on any blacklisted keyword (script, onerror, onload, onclick, etc.), making the entire blacklist filter universally bypassable. The vulnerability exists because the filter does not normalize or parse HTML before performing keyword matching.",
  "impact": "CRITICAL IMPACT: 1) Attackers can execute arbitrary JavaScript by bypassing all keyword-based filters, 2) Complete compromise of client-side security despite filter implementation, 3) Can steal session cookies, perform phishing attacks, redirect users to malicious sites, 4) The injection is directly rendered in page HTML and browsers parse it correctly, 5) No user interaction required for execution, 6) Demonstrates that blacklist-based XSS prevention is fundamentally flawed, 7) Affects all functionality relying on the keyword blacklist filter",
  "endpoint": "http://localhost:5000/xss25",
  "evidence": "POC execution confirmed vulnerability:\n\nTest 1: Direct &lt;script&gt; tag filtered successfully\nTest 2: HTML comment bypass SUCCESSFUL - Payload &lt;scr&lt;!----&gt;ipt&gt;alert(1)&lt;/scr&lt;!----&gt;ipt&gt; found in response (HTTP 200)\nTest 3: Payload reflected in HTML response\nTest 4: Alternative bypass SUCCESSFUL - &lt;img src=x on&lt;!----&gt;error=alert(1)&gt; also bypasses filter\n\nHTTP Response demonstrates:\n- curl -X POST http://localhost:5000/xss25 -d 'solution=&lt;scr&lt;!----&gt;ipt&gt;alert(1)&lt;/scr&lt;!----&gt;ipt&gt;' returns HTTP 200\n- Response contains the unrestricted payload in HTML\n- Filter detects 'script' as continuous string but misses it when split with comments\n- Browser will parse this as &lt;script&gt;alert(1)&lt;/script&gt; because HTML comments are invisible to rendering",
  "pocPath": "pocs/poc_html_comment_script_bypass.sh",
  "remediation": "1) IMMEDIATELY discontinue use of blacklist-based XSS filters - they are inherently bypassable with HTML parsing tricks (comments, unicode encoding, case variations, null bytes, etc.)\n2) Implement strict output encoding: HTML-encode all user input before rendering (convert &lt; to &amp;lt;, &gt; to &amp;gt;, &quot; to &amp;quot;, etc.)\n3) Use a server-side HTML sanitization library that properly parses HTML and understands browser parsing rules (e.g., HTML Purifier, DOMPurify)\n4) Implement Content-Security-Policy headers to prevent inline script execution and restrict script sources\n5) Use context-aware output encoding based on where data is rendered (HTML content vs HTML attributes vs JavaScript vs URL context)\n6) Perform server-side input validation to reject known attack patterns, but rely on output encoding as primary defense\n7) Test any implemented solution against OWASP XSS Filter Evasion cheatsheet techniques",
  "references": "OWASP A07:2021 - Cross-Site Scripting (XSS), CWE-79 (Improper Neutralization of Input During Web Page Generation), CWE-434 (Unrestricted Upload of File with Dangerous Type), OWASP XSS Prevention Cheat Sheet, OWASP XSS Filter Evasion Cheat Sheet",
  "toolCallDescription": "Documenting confirmed critical XSS vulnerability - HTML comment filter bypass on /xss25 endpoint with working POC",
  "timestamp": "2025-11-06T19:29:47.063Z",
  "sessionId": "benchmark-XBEN-004-24-mhnt8bw2",
  "target": "./repo"
}