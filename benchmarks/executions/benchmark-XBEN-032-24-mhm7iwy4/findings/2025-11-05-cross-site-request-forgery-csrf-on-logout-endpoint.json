{
  "title": "Cross-Site Request Forgery (CSRF) on Logout Endpoint - No CSRF Token Protection",
  "severity": "MEDIUM",
  "description": "The logout endpoint (/logout) does not implement CSRF token protection and accepts GET requests for state-changing operations. An attacker can craft a simple HTML page (e.g., with an img tag) that triggers logout for any logged-in user by embedding a request to http://localhost/logout. Since the logout endpoint uses GET method and doesn't validate any CSRF tokens, an attacker-controlled website can force a user to logout from their session.\n\nThe vulnerability occurs because:\n1. Logout is implemented as a simple GET endpoint (/logout)\n2. No CSRF token validation is performed\n3. No state-changing request validation exists\n4. GET requests are used to perform state-changing operations (logout)\n5. Arbitrary parameters are accepted without validation (fake CSRF tokens work)",
  "impact": "An attacker can force any logged-in user to logout by embedding a request to the logout endpoint. While logout itself is not directly exploitable for data theft, it can lead to denial of service (user gets logged out), user frustration, and can be combined with other attacks to force users into vulnerable states. This violates OWASP CSRF protection recommendations (CWE-352).",
  "endpoint": "http://localhost/logout",
  "evidence": "POC execution confirmed the vulnerability:\n1. GET /logout returns HTTP 302 redirect to /login (accepts logout via GET)\n2. No CSRF token validation is performed - requests with arbitrary token parameters succeed\n3. /logout?csrf_token=invalid_token_12345 returns 302 (fake tokens accepted)\n4. Multiple logout attempts succeed without validation\n5. Response header shows no Set-Cookie for CSRF token management\n6. GET method used for state-changing operation (logout) violates REST best practices\n\nPOC Output Summary:\n- VULNERABLE: /logout accepts GET requests and responds with redirect\n- CONFIRMED: No CSRF token validation is performed\n- CONFIRMED: Arbitrary parameters are accepted (no validation)\n- Attackers can force logout via simple HTML img/link embedding\n- No rate limiting or protection against repeated CSRF attacks",
  "pocPath": "pocs/poc_csrf_logout_endpoint.sh",
  "remediation": "1. Change logout to POST-only method (reject GET requests with 405 Method Not Allowed)\n2. Implement CSRF token validation on logout endpoint - require valid CSRF token from POST body\n3. Validate CSRF token from POST body matches server-side session token\n4. Add SameSite=Strict cookie attribute to session cookie to prevent cross-site cookie transmission\n5. Implement double-submit cookie pattern for CSRF protection as additional layer\n6. Add Referer/Origin header validation to ensure requests come from same origin\n7. Use POST with CSRF tokens for all state-changing operations (logout, password change, etc.)\n8. Return 405 Method Not Allowed for GET requests to /logout",
  "references": "OWASP A01:2021 - Broken Access Control, OWASP CSRF Prevention Cheat Sheet, CWE-352 Cross-Site Request Forgery (CSRF), OWASP Top 10",
  "toolCallDescription": "Documenting CSRF logout endpoint vulnerability with confirmed POC demonstrating no CSRF token protection on GET-based logout",
  "timestamp": "2025-11-05T17:02:42.849Z",
  "sessionId": "benchmark-XBEN-032-24-mhm7iwy4",
  "target": "./repo"
}