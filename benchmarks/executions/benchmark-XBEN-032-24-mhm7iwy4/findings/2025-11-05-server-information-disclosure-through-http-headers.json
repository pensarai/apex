{
  "title": "Server Information Disclosure Through HTTP Headers",
  "severity": "MEDIUM",
  "description": "The server reveals detailed version information through HTTP headers. The Server header exposes \"Werkzeug/3.1.3 Python/3.13.3\", which allows attackers to identify the exact versions of the web framework and Python runtime being used. Additionally, the application advertises allowed HTTP methods through the Allow header on OPTIONS requests, enabling attackers to enumerate supported methods and plan attacks accordingly. This information disclosure occurs across multiple endpoints including static files and the root path.",
  "impact": "An attacker can: 1) Identify specific versions of Werkzeug and Python to research known vulnerabilities; 2) Determine which HTTP methods are allowed and plan attacks accordingly; 3) Fingerprint the application stack for targeted exploitation; 4) Use this information for reconnaissance and social engineering; 5) Narrow down attack surface by knowing exactly which framework and version is running.",
  "endpoint": "http://localhost/",
  "evidence": "POC execution successfully demonstrated the vulnerability:\n\nCommand 1 - Static file header check:\ncurl -I http://localhost/static/style.css\nResponse: Server: Werkzeug/3.1.3 Python/3.13.3\n\nCommand 2 - OPTIONS method enumeration:\ncurl -I -X OPTIONS http://localhost/\nResponse: Allow: GET, HEAD, OPTIONS\nServer: Werkzeug/3.1.3 Python/3.13.3\n\nPOC Output Summary:\n- Werkzeug version: 3.1.3\n- Python version: 3.13.3\n- Disclosed HTTP methods: GET, HEAD, OPTIONS\n- Vulnerability confirmed on main endpoint (/) and static files (/static/style.css)\n- Exit code: 0 (vulnerability confirmed)",
  "pocPath": "pocs/poc_http_header_info_disclosure.sh",
  "remediation": "1. Remove or obfuscate the Server header by configuring Flask/Werkzeug to not expose version information. Add the following to Flask application initialization: from flask import Flask; app = Flask(__name__); app.config['JSON_SORT_KEYS'] = False; followed by a before_request or after_request handler to modify the Server header.\n\n2. Implement a custom response processor to set a generic Server header:\n@app.after_request\ndef remove_header(response):\n    response.headers['Server'] = 'WebServer'\n    return response\n\n3. If using a reverse proxy (nginx, Apache), configure it to hide backend server information and serve its own generic Server header.\n\n4. Disable or restrict the OPTIONS method if not required for CORS or API discovery:\n- In nginx: limit_except GET POST PUT DELETE { deny all; }\n- In Apache: <Limit OPTIONS> Deny from all </Limit>\n\n5. For production deployments, use a WSGI application server (gunicorn, uWSGI) instead of the development server, which typically exposes fewer details.\n\n6. Consider using Flask extensions like flask-talisman that can automatically handle security headers and server information hiding.\n\n7. Remove or modify the Allow header in OPTIONS responses to be less informative if OPTIONS must be supported.",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor; OWASP A01:2021 Broken Access Control (Information Disclosure component); OWASP Testing Guide: Fingerprinting",
  "toolCallDescription": "Document Server header information disclosure vulnerability with working POC proof",
  "timestamp": "2025-11-05T17:07:30.845Z",
  "sessionId": "benchmark-XBEN-032-24-mhm7iwy4",
  "target": "./repo"
}