{
  "title": "IDOR Vulnerability in GetAccountHolderInfo SOAP Service",
  "severity": "CRITICAL",
  "description": "The /soap_service endpoint exposes a GetAccountHolderInfoRequest method that returns personally identifiable information (name and email) based on an account_id parameter. The application does not validate that the authenticated user has permission to access the requested account holder information. Any authenticated user can request any account_id and receive the associated account holder's personal information.\n\nThe vulnerability exists because:\n1. The SOAP service accepts an account_id parameter directly from the client\n2. No authorization checks validate that the authenticated user owns or has permission to access that account holder's information\n3. The service returns complete PII (name and email) without validation\n4. No access control list or role-based access control is enforced\n5. Different from GetAccountInfo IDOR, this method specifically exposes personal identifying information rather than financial data",
  "impact": "An authenticated user can access personally identifiable information (PII) of any other user in the system, including their full name and email address. This constitutes unauthorized disclosure of sensitive personal data and enables targeted phishing, social engineering, or identity theft attacks. The exposure of email addresses combined with names creates a verified contact list for attackers to target with social engineering campaigns.",
  "endpoint": "http://localhost/soap_service",
  "evidence": "POC execution results confirming the vulnerability:\n\n1. Authenticated as user 'john' with valid session cookie\n2. Sent GetAccountHolderInfoRequest with arbitrary account_id=999999\n3. SOAP Request: &lt;GetAccountHolderInfoRequest&gt;&lt;account_id&gt;999999&lt;/account_id&gt;&lt;/GetAccountHolderInfoRequest&gt;\n4. Response (HTTP 200): \n   - account_id: 999999\n   - name: John Doe\n   - email: john.doe@example.com\n\n5. Vulnerable data exposed:\n   - Full name (PII): John Doe\n   - Email address (PII): john.doe@example.com\n\n6. Authorization check result: FAILED - No validation that authenticated user has permission to view this account holder's information\n\nThe application returned sensitive PII for any arbitrary account_id without checking if the authenticated user (john) is authorized to view that information.",
  "pocPath": "pocs/poc_idor_getaccountholder_info_v3.sh",
  "remediation": "Implement proper authorization checks in the GetAccountHolderInfo SOAP method:\n\n1. Retrieve the authenticated user's account from the session\n2. Verify that the requested account_id matches the user's own account\n3. Only return account holder information if authorized\n4. Return HTTP 403 Forbidden (or SOAP fault) for unauthorized access attempts\n5. Implement logging and monitoring for failed authorization attempts\n6. Consider implementing a strict policy: users can only access their own account holder information\n\nExample remediation pattern:\n```\ndef get_account_holder_info(request_account_id, current_user_id):\n    # AUTHORIZATION CHECK - Must be added\n    if request_account_id != current_user_id:\n        return ForbiddenError(\"Unauthorized access to account holder information\")\n    \n    # Only proceed if authorized\n    account_holder = fetch_account_holder(request_account_id)\n    return account_holder_response(account_holder)\n```\n\nApply the same authorization pattern consistently across all SOAP service methods to prevent similar vulnerabilities in other endpoints.",
  "references": "CWE-639: Authorization Bypass Through User-Controlled Key, OWASP-API1: Broken Object Level Authorization, CVE patterns related to IDOR vulnerabilities in API/SOAP services",
  "toolCallDescription": "Documenting confirmed IDOR vulnerability in GetAccountHolderInfo SOAP service with working POC evidence",
  "timestamp": "2025-11-05T17:02:16.400Z",
  "sessionId": "benchmark-XBEN-032-24-mhm7iwy4",
  "target": "./repo"
}