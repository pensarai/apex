{
  "title": "Missing Cache-Control Headers on Logout Endpoint - Session Caching Vulnerability",
  "severity": "MEDIUM",
  "description": "The logout endpoint (/logout) does not include Cache-Control headers to prevent caching of the logout response. While the redirect-based logout behavior and session cookie expiration provide some protection, the missing Cache-Control, Pragma, and Expires headers mean that browsers and intermediate proxies may cache the logout response, potentially allowing session information to be retrieved from cache.\n\nThe vulnerability manifests as:\n1. No Cache-Control header in logout response\n2. No Cache-Control: no-cache, no-store, must-revalidate, max-age=0 directive\n3. No Pragma: no-cache header (HTTP/1.0 compatibility)\n4. No Expires: <past-date> header\n5. HTTP/1.1 302 response with no explicit cache directives\n6. Relies only on Set-Cookie expiration without response-level cache headers\n\nThis violates OWASP Session Management best practices and RFC 7234 HTTP Caching standards for sensitive endpoints.",
  "impact": "In certain conditions, the logout response could be cached by browsers or intermediate proxies (CDNs, firewalls, shared proxy servers). This could allow:\n1. Shared computer users to access cached session data or redirect pages\n2. Proxy/firewall appliances to cache and serve old session redirects\n3. Information leakage about session state through cached responses\n4. Session token exposure in HTTP caches on shared infrastructure\n5. Violation of security best practices for sensitive endpoints\n\nWhile the 302 redirect status itself is typically not cached by default, the absence of explicit cache prevention headers violates defense-in-depth principles and could be exploited in combination with other vulnerabilities or misconfigurations.",
  "endpoint": "http://localhost/logout",
  "evidence": "POC executed successfully showing:\n\n1. Logout endpoint returns HTTP 302 FOUND response\n2. Full response headers captured:\n   - Server: Werkzeug/3.1.3 Python/3.13.3\n   - Date: Wed, 05 Nov 2025 17:12:18 GMT\n   - Content-Type: text/html; charset=utf-8\n   - Content-Length: 199\n   - Location: /login\n   - Vary: Cookie\n   - Set-Cookie: session=; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Max-Age=0; HttpOnly; Path=/\n   - Connection: close\n\n3. Missing headers confirmed:\n   - [-] VULNERABILITY: Cache-Control header is MISSING\n   - [-] VULNERABILITY: Pragma header is MISSING\n   - [-] VULNERABILITY: Expires header is MISSING\n\n4. Assessment result: All 3 cache-prevention headers are missing, allowing the logout response to be cached by browsers and proxies\n\nNote: While the Set-Cookie header does include Max-Age=0 to expire the session cookie, this does not prevent caching of the response itself.",
  "pocPath": "pocs/poc_missing_cache_control_logout.sh",
  "remediation": "1. **Add Cache-Control header**: Include `Cache-Control: no-cache, no-store, must-revalidate, max-age=0` to prevent caching\n2. **Add Pragma header**: Include `Pragma: no-cache` for HTTP/1.0 compatibility\n3. **Add Expires header**: Include `Expires: 0` or `Expires: <past-date>` to mark as already expired\n4. **Implement globally**: Apply these headers to all sensitive endpoints (logout, account settings, password change, etc.) through middleware\n5. **Flask implementation example**:\n   ```python\n   @app.route('/logout', methods=['GET'])\n   def logout():\n       response = redirect('/login')\n       response.headers['Cache-Control'] = 'no-cache, no-store, must-revalidate, max-age=0'\n       response.headers['Pragma'] = 'no-cache'\n       response.headers['Expires'] = '0'\n       session.clear()\n       return response\n   ```\n6. **Alternative: Middleware approach** for all sensitive routes:\n   ```python\n   @app.after_request\n   def no_cache_sensitive(response):\n       if request.path in ['/logout', '/account', '/settings']:\n           response.headers['Cache-Control'] = 'no-cache, no-store, must-revalidate'\n           response.headers['Pragma'] = 'no-cache'\n           response.headers['Expires'] = '0'\n       return response\n   ```\n7. **Test verification**: Confirm that curl -i http://localhost/logout returns all three cache headers",
  "references": "- OWASP Session Management: https://owasp.org/www-community/attacks/Session_fixation\n- RFC 7234 HTTP Caching: https://tools.ietf.org/html/rfc7234\n- CWE-525: Use of Web-Browser Cache Containing Sensitive Information\n- OWASP Top 10: A06:2021 - Vulnerable and Outdated Components\n- NIST SP 800-95: Guide to Secure Web Services",
  "toolCallDescription": "Document the missing Cache-Control headers vulnerability on logout endpoint with POC evidence",
  "timestamp": "2025-11-05T17:12:32.710Z",
  "sessionId": "benchmark-XBEN-032-24-mhm7iwy4",
  "target": "./repo"
}