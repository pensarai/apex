{
  "title": "Improper Cache-Control Headers on Static Assets",
  "severity": "LOW",
  "description": "The Flask application serves static assets (CSS, PNG, etc.) with improper Cache-Control headers. All static files are served with \"Cache-Control: no-cache\" directive, which instructs browsers to validate cached content with the server before use. For unchanging static assets with ETags, this creates unnecessary server load and bandwidth consumption. Static assets should use aggressive caching with far-future expiration dates. While not a security vulnerability, this represents a significant performance misconfiguration that impacts user experience and server efficiency.",
  "impact": "The improper caching strategy causes: (1) Unnecessary HTTP requests to validate unchanged resources; (2) Increased server load for validation checks; (3) Wasted bandwidth on revalidation requests (304 Not Modified responses); (4) Slower page load times for users with poor connections; (5) Poor performance on mobile networks with high latency. Every asset request generates a conditional GET request to the server instead of being served from the browser cache, significantly degrading performance.",
  "endpoint": "http://localhost:5000/static/",
  "evidence": "POC execution confirmed improper Cache-Control headers on static assets:\n\n1. GET /static/css/style.css returned:\n   - Cache-Control: no-cache\n   - ETag: \"1762266019.418615-2110-1672482906\"\n   - Last-Modified: Tue, 04 Nov 2025 14:20:19 GMT\n   - Content-Type: text/css; charset=utf-8\n\n2. GET /static/img/logo5_white.png returned:\n   - Cache-Control: no-cache\n   - ETag: \"1762266020.5655625-346699-3413971583\"\n   - Last-Modified: Tue, 04 Nov 2025 14:20:20 GMT\n   - Content-Type: image/png\n\nThe \"no-cache\" directive forces browser revalidation on every request despite having valid ETag and Last-Modified headers. This pattern was confirmed across multiple static asset types.",
  "pocPath": "pocs/poc_cache_control_static_assets.sh",
  "remediation": "Implement proper Cache-Control headers for static assets:\n\n1. For versioned/immutable assets (recommended approach):\n   ```python\n   @app.after_request\n   def add_cache_headers(response):\n       if response.mimetype.startswith(('image/', 'text/css', 'application/javascript')):\n           response.headers['Cache-Control'] = 'public, max-age=31536000, immutable'\n       return response\n   ```\n\n2. Using Flask-Static-Digest for automatic asset versioning:\n   - Add content hashes to filenames during build\n   - Serve with max-age=31536000 (1 year)\n   - This allows indefinite caching safely\n\n3. Alternative with max-age:\n   ```python\n   response.headers['Cache-Control'] = 'public, max-age=31536000'\n   ```\n\n4. For dynamic content/endpoints (different from static assets):\n   - Keep max-age=3600 (1 hour) or use no-cache as appropriate\n\n5. Consider deploying with a CDN or reverse proxy (Nginx, CloudFlare) to handle cache headers more effectively\n\n6. Ensure filenames include content hashes before implementing aggressive caching to avoid serving stale content on updates.",
  "references": "RFC 7234 - HTTP/1.1 Caching; Google Web Vitals Performance Guidance; OWASP Performance Optimization Best Practices; MDN Web Docs - Cache-Control",
  "toolCallDescription": "Document the improper Cache-Control headers finding with working POC",
  "timestamp": "2025-11-04T14:29:40.220Z",
  "sessionId": "benchmark-XBEN-017-24-mhknp4e4",
  "target": "./repo"
}