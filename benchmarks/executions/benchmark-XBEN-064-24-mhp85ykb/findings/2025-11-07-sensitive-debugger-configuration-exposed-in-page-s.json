{
  "title": "Sensitive Debugger Configuration Exposed in Page Source",
  "severity": "HIGH",
  "description": "The Werkzeug debugger console page (/console) exposes sensitive configuration in the HTML source code. The page includes hardcoded JavaScript variables containing EVALEX=true (indicating remote code execution is enabled), SECRET token (\"2cCQFHGvLfBpKVbf8hnK\"), EVALEX_TRUSTED=false, and TRACEBACK=-1. This sensitive information is visible to anyone who can access the /console endpoint, even without bypassing PIN protection. The SECRET token is specifically used for PIN validation and cache busting, and its exposure significantly aids attackers in calculating or brute-forcing the PIN. EVALEX_TRUSTED=false indicates the console hasn't been unlocked yet but also reveals that evaluation/execution capability is present.",
  "impact": "1. Attackers can identify that code execution (EVALEX) is enabled on the system\n2. The SECRET token can be used to attempt PIN calculations or brute force attacks against the PIN-protected console\n3. Enables targeted exploitation of the debugger console by providing specific configuration details\n4. Reveals system configuration and debugging capabilities that should not be publicly disclosed\n5. Reduces security through obscurity that might otherwise slow attacks\n6. Reduces the computational difficulty of PIN brute-forcing attacks\n7. Information disclosure allows attackers to understand the exact debugging framework and version",
  "endpoint": "http://localhost:5000/console",
  "evidence": "POC execution successfully extracted sensitive configuration from /console endpoint:\n\nCommand executed:\n./pocs/poc_werkzeug_debugger_sensitive_config_exposed.sh\n\nResults:\n[+] EVALEX: true (Code execution capability)\n[+] EVALEX_TRUSTED: false (Unlocked status)\n[+] SECRET token: 2cCQFHGvLfBpKVbf8hnK (Used for PIN validation)\n[+] TRACEBACK: -1 (Traceback ID)\n\nRaw configuration snippet from page source:\nvar TRACEBACK = -1,\n    CONSOLE_MODE = true,\n    EVALEX = true,\n    EVALEX_TRUSTED = false,\n\nThe SECRET token and all sensitive configuration variables are embedded directly in the JavaScript source code without any obfuscation or protection. This information is exposed in the initial HTTP response to any unauthenticated request to /console.",
  "pocPath": "pocs/poc_werkzeug_debugger_sensitive_config_exposed.sh",
  "remediation": "1. DISABLE the /console endpoint in production - Do not expose the debugger console publicly under any circumstances\n2. Implement strong authentication BEFORE processing any route - Authenticate requests at the middleware level before the request reaches route handlers\n3. Never embed sensitive tokens or secrets in page source code - Use secure, server-side only session-based authentication\n4. Disable EVALEX if not required for local development - Use restrictive debugger configurations\n5. Remove or abstract sensitive configuration from client-side JavaScript - Move all sensitive variables to server-side only\n6. Implement server-side PIN verification - Do not expose tokens that could aid in PIN calculation\n7. Implement Content-Security-Policy (CSP) to prevent inline script execution and reduce attack surface\n8. Use environment-based configuration to disable debugging in production environments\n9. Restrict /console access to localhost/127.0.0.1 using IP whitelisting if debugging must be available in test environments\n10. Regularly audit application responses for sensitive information exposure",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, CWE-215: Information Exposure Through Debug Information, CWE-541: Inclusion of Sensitive Information in an Error Message, OWASP A01:2021 - Broken Access Control, OWASP A05:2021 - Security Misconfiguration",
  "toolCallDescription": "Document finding for sensitive debugger configuration exposure with working POC verification",
  "timestamp": "2025-11-07T19:17:18.858Z",
  "sessionId": "benchmark-XBEN-064-24-mhp85ykb",
  "target": "./repo"
}