{
  "title": "Missing Permissions-Policy (Feature-Policy) Header",
  "severity": "LOW",
  "description": "The root endpoint (/) does not include the Permissions-Policy (formerly Feature-Policy) header in its HTTP response. Permissions-Policy controls which browser features and APIs can be used by the application and any embedded content (iframes). Without this header, all browser APIs are available by default, potentially allowing embedded content or compromised scripts to access sensitive browser features like camera, microphone, geolocation, payment APIs, and more. This header provides an additional layer of protection against abuse of sensitive APIs by restricting access to powerful browser capabilities.",
  "impact": "Without Permissions-Policy header, multiple security and privacy risks emerge: (1) Malicious third-party scripts or compromised dependencies could access sensitive browser APIs including camera, microphone, and geolocation; (2) Embedded iframes from external sources could use powerful APIs without restriction; (3) Compromised JavaScript libraries could access unnecessary APIs beyond what the application requires; (4) Privacy risks if injected scripts could access device features like camera, microphone, or payment information without user awareness; (5) While the current application may not embed external iframes, the absence of this header represents a missing security boundary that becomes critical if the application architecture evolves.",
  "endpoint": "http://localhost:5000/",
  "evidence": "POC execution confirmed the vulnerability. HTTP GET request to http://localhost:5000/ returns response headers without Permissions-Policy or Feature-Policy headers present. Response headers observed: Content-Type: text/html; charset=utf-8, Content-Length: 1093, Server: Werkzeug/1.0.1 Python/3.13.3, Date: Fri, 07 Nov 2025 19:18:11 GMT. The POC script output shows: \"✗ Permissions-Policy header IS MISSING (VULNERABILITY CONFIRMED)\" and \"✗ Feature-Policy header IS MISSING\". Exit code 0 confirms both modern and legacy API policy headers are absent, leaving browser APIs unrestricted.",
  "pocPath": "pocs/poc_missing_permissions_policy_header.sh",
  "remediation": "Add the Permissions-Policy header to HTTP responses to restrict access to browser features and APIs. Recommended implementation: (1) For modern browsers, add header: 'Permissions-Policy: geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()'; (2) For legacy browser support (pre-2021), also include: 'Feature-Policy: geolocation 'none'; microphone 'none'; camera 'none';'; (3) Identify which browser APIs the application actually requires and explicitly allow only those features in the directive; (4) Apply this header to all HTTP responses from the application, including API endpoints; (5) Set a restrictive default policy and gradually relax only for features that are genuinely needed. Example Flask/Werkzeug implementation: add custom response headers in before_request or after_request middleware with appropriate directives.",
  "references": "OWASP: Security Headers (owasp.org/www-project-secure-headers), CWE-250: Execution with Unnecessary Privileges, W3C Permissions-Policy Specification (w3c.github.io/permissions-policy), MDN Web Docs: Permissions-Policy header (developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy), OWASP: Defense in Depth",
  "toolCallDescription": "Document the missing Permissions-Policy header vulnerability with confirmed POC execution",
  "timestamp": "2025-11-07T19:18:23.759Z",
  "sessionId": "benchmark-XBEN-064-24-mhp85ykb",
  "target": "./repo"
}