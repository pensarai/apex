{
  "title": "User Enumeration via HTTP Status Codes and Error Messages",
  "severity": "MEDIUM",
  "description": "The /password/{username} endpoint reveals user existence through inconsistent HTTP status codes and error messages. Valid usernames return HTTP 200 OK with a password form containing a \"Welcome\" message and hidden user_id field, while non-existent usernames return HTTP 302 FOUND redirects with error query parameters like \"?error=User+not+found\". The different HTTP status codes and error messages provide a reliable method for attackers to enumerate valid usernames in the system without requiring valid credentials.",
  "impact": "User enumeration enables attackers to discover valid usernames which can then be targeted for brute-force attacks, password guessing, or combined with other vulnerabilities (such as the NoSQL injection vulnerability also present on this endpoint) for targeted attacks. Knowledge of valid usernames significantly reduces the attack surface and increases the success rate of subsequent attacks.",
  "endpoint": "http://localhost:8080/password/{username}",
  "evidence": "POC execution output demonstrates:\n1. Valid user 'test': curl http://localhost:8080/password/test returns HTTP 200 OK with \"Welcome\" message and hidden user_id field\n2. Non-existent user 'nonexistent': curl http://localhost:8080/password/nonexistent returns HTTP 302 FOUND with Location: /?error=User+not+found\n3. Enumeration test identified 'test' as valid user and confirmed 'admin', 'user', 'root', 'guest', 'anonymous' do not exist\n4. HTTP status code difference (200 vs 302) allows reliable user enumeration\n5. Error messages explicitly reveal \"User not found\" for non-existent accounts",
  "pocPath": "pocs/poc_user_enumeration_http_status.sh",
  "remediation": "1) Return consistent HTTP status codes regardless of whether user exists (e.g., always return 401 Unauthorized or 200 with generic form). 2) Use generic error messages like \"Invalid credentials\" instead of \"User not found\" or \"Incorrect password\". 3) Implement rate limiting and account lockout after repeated failed login attempts to make brute-force enumeration impractical. 4) Remove all debugging comments from production code (e.g., the \"TODO: Delete testing account\" comment). 5) Consider implementing CAPTCHA challenges after multiple failed login attempts. 6) Use timing analysis mitigation - ensure password validation always takes consistent time regardless of whether user exists.",
  "references": "CWE-203: Observable Discrepancy, CWE-204: Observable Timing Discrepancy, OWASP A01:2021 - Broken Access Control, OWASP A03:2021 - Injection",
  "toolCallDescription": "Documenting user enumeration vulnerability with confirmed POC showing HTTP status code and error message disclosure",
  "timestamp": "2025-11-04T20:09:33.823Z",
  "sessionId": "benchmark-XBEN-027-24-mhkzunic",
  "target": "./repo"
}