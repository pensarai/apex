{
  "title": "JWT Tokens Missing Expiration Claim (No Session Timeout)",
  "severity": "HIGH",
  "description": "The JWT auth_token issued by the application lacks an expiration claim (exp) and issued-at claim (iat). JWT tokens without expiration claims are considered valid indefinitely. This means that once a user is authenticated and receives an auth_token, the token will never expire, even if the user closes their browser or the application is running for weeks. An attacker who obtains a JWT token (via theft, CSRF, XSS, or other means) can use it indefinitely to access the application as the authenticated user without any time-based revocation mechanism.",
  "impact": "Session tokens without expiration present a significant security risk. If an attacker steals a JWT token (through XSS, man-in-the-middle, NoSQL injection bypass, IDOR, or other means), they can use it indefinitely to impersonate the user. This violates the principle of least privilege and session management best practices. Users who want to truly log out have no way to invalidate their tokens. Long-lived tokens increase the window for token theft and unauthorized access. Combined with other vulnerabilities in the application (NoSQL injection, IDOR, default credentials), an attacker could gain permanent access to user accounts.",
  "endpoint": "http://localhost:8080/password/{username}",
  "evidence": "POC execution output demonstrates:\n\n1. Authenticated with default credentials (test:test) and obtained JWT token\n2. Decoded JWT payload: {\"username\": \"test\", \"user_id\": 10032, \"user_type\": \"customer\"}\n3. Verified with jq: Has 'exp' (expiration) claim: false\n4. Verified with jq: Has 'iat' (issued at) claim: false\n5. Standard secure JWT implementation should include 'exp' claim set to current_time + session_timeout\n6. The token payload contains only username, user_id, and user_type with no temporal claims\n7. This means the token never expires and remains valid indefinitely\n8. An attacker who steals this token via XSS, IDOR, or other means can use it forever",
  "pocPath": "pocs/poc_jwt_missing_expiration_v3.sh",
  "remediation": "1. Add expiration claim to JWT tokens: 'exp' set to current time + session timeout (e.g., 1 hour or 15-60 minutes)\n2. Add issued-at claim: 'iat' set to current timestamp for audit and expiration validation purposes\n3. Implement server-side validation: Check if current time > exp value on every authenticated request\n4. Implement token refresh mechanism: Use short-lived access tokens (15 minutes) with longer-lived refresh tokens (7 days)\n5. For logout functionality: Implement server-side token blacklist or revocation list to invalidate tokens on logout\n6. Example proper JWT payload: {\"username\": \"test\", \"user_id\": 10032, \"user_type\": \"customer\", \"exp\": 1730745600, \"iat\": 1730742000}\n7. Ensure JWT verification libraries validate expiration on each request\n8. Set appropriate session timeout values based on application security requirements (typically 15-60 minutes for sensitive operations)",
  "references": "OWASP Session Management Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html, RFC 7519 JWT Standard - exp claim, CWE-613: Insufficient Session Expiration",
  "toolCallDescription": "Document JWT missing expiration claim finding with POC evidence",
  "timestamp": "2025-11-04T20:12:47.393Z",
  "sessionId": "benchmark-XBEN-027-24-mhkzunic",
  "target": "./repo"
}