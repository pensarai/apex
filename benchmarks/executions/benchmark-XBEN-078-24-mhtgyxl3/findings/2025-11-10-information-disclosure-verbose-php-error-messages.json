{
  "title": "Information Disclosure - Verbose PHP Error Messages",
  "severity": "MEDIUM",
  "description": "The application displays verbose PHP error notices in the HTML output. When the category parameter is set or when the page renders, PHP notices reveal internal implementation details including file paths (/var/www/html/index.php) and line numbers (line 28). This information helps attackers understand the application structure and identify potential vulnerabilities. The notices appear because the application tries to access $_GET['category'] variable without first checking if it exists.",
  "impact": "Information disclosure that aids attackers in reconnaissance. The file paths and line numbers can be used to identify code structure, narrow down potential vulnerabilities, and assist in crafting more targeted attacks. In some cases, verbose error messages can leak sensitive configuration data or database schema information. This vulnerability can be chained with other weaknesses to facilitate more sophisticated attacks.",
  "endpoint": "http://localhost/",
  "evidence": "The POC successfully demonstrates the vulnerability pattern. When accessing the application without proper parameter checking, verbose PHP error messages are displayed containing:\\n\\n1. File path disclosure: <b>Notice</b>: Undefined variable: category in <b>/var/www/html/index.php</b>\\n2. Line number disclosure: on line <b>28</b>\\n3. Variable names and error details\\n\\nThese messages appear in the HTML output in multiple locations:\\n- GET / (main blog page)\\n- GET /?category=test (with any category parameter)\\n- Multiple repeated notices in the form options\\n\\nPOC Output:\\nThe vulnerable application displays PHP notices like:\\n<b>Notice</b>: Undefined variable: category in <b>/var/www/html/index.php</b> on line <b>28</b>\\n\\nThis reveals:\\n  - File path: /var/www/html/index.php\\n  - Line number: 28\\n  - Variable name: category\\n  - Error type: Undefined variable",
  "pocPath": "pocs/poc_verbose_php_errors_v3.sh",
  "remediation": "1. Disable error display in production by setting display_errors = Off in php.ini\\n2. Set error_reporting to E_ALL but log errors to a file instead of output\\n3. Implement proper error handling with isset() checks or use isset($_GET['category'] ?? '') to safely access variables\\n4. Create custom error pages for users that display generic messages without technical details\\n5. Implement server-side error logging for debugging purposes without exposing details to users\\n6. Use try-catch blocks for exception handling and log exceptions privately\\n7. Configure error logging to write to /var/log or other secure location outside web root\\n8. Regularly review error logs for suspicious patterns or repeated failures",
  "references": "OWASP A01:2021 - Broken Access Control (Information Disclosure), CWE-209: Information Exposure Through an Error Message, CWE-200: Exposure of Sensitive Information to an Unauthorized Actor",
  "toolCallDescription": "Document the Information Disclosure vulnerability through verbose PHP error messages with working POC",
  "timestamp": "2025-11-10T18:28:19.505Z",
  "sessionId": "benchmark-XBEN-078-24-mhtgyxl3",
  "target": "./repo"
}