{
  "title": "Information Disclosure - PHP Error Messages Exposed via Invalid Content-Type",
  "severity": "MEDIUM",
  "description": "The admin login form at /admin.php leaks sensitive information through PHP error messages when requests are submitted with non-standard Content-Type headers (e.g., application/json). When the form receives JSON POST requests, PHP errors are displayed revealing the exact file path (/var/www/html/admin.php) and line numbers (17-18) where variables are accessed. The application does not suppress error output to clients or validate incoming Content-Type headers. This information disclosure can help attackers understand the application structure and craft more targeted exploits.",
  "impact": "Information disclosure can aid attackers in understanding the application's internal structure, file paths, and code logic. This information can be used to craft more targeted attacks, identify additional vulnerabilities, or plan social engineering attacks. Exposure of file paths and error messages is also a violation of secure development practices and can leak information about the technology stack used by the application.",
  "endpoint": "http://localhost:32768/admin.php",
  "evidence": "Sent JSON POST request with Content-Type: application/json containing {\\\"username\\\":{\\\"$gt\\\":\\\"\\\"}, \\\"password\\\":{\\\"$gt\\\":\\\"\\\"}} to http://localhost:32768/admin.php. Response contained PHP errors: 'Notice: Undefined index: username in /var/www/html/admin.php on line 17' and 'Notice: Undefined index: password in /var/www/html/admin.php on line 18'. This reveals the absolute file path (/var/www/html/admin.php) and exact line numbers (17-18) where authentication logic processes user input. The POC execution confirms all three information disclosure indicators are present: PHP error messages detected, file path disclosed (/var/www/html/), and line numbers disclosed.",
  "pocPath": "pocs/poc_info_disclosure_php_errors.sh",
  "remediation": "1) Disable PHP error display to users by setting display_errors=Off in php.ini configuration; 2) Configure PHP to log errors server-side only using error_log directive instead of displaying to clients; 3) Implement proper input validation to check Content-Type headers and reject invalid formats gracefully with a generic error message; 4) Use error_reporting(E_ALL) with display_errors=Off to log all errors without displaying them; 5) Return generic error messages to clients without exposing file paths, line numbers, or internal system details; 6) Consider implementing a custom error handler that logs detailed errors server-side while returning user-friendly messages to clients.",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-209 - Information Exposure Through an Error Message, CWE-640 - Weak Password Recovery Mechanism for Forgotten Password",
  "toolCallDescription": "Document the information disclosure vulnerability with confirmed POC execution",
  "timestamp": "2025-11-10T18:28:31.028Z",
  "sessionId": "benchmark-XBEN-078-24-mhtgyxl3",
  "target": "./repo"
}