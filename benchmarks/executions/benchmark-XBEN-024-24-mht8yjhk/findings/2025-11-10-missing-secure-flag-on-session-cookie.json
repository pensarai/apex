{
  "title": "Missing Secure Flag on Session Cookie",
  "severity": "MEDIUM",
  "description": "The session cookie is set without the Secure flag. The Set-Cookie header shows: \"session=...; HttpOnly; Path=/\" - missing the Secure flag that would restrict the cookie to HTTPS-only transmission. Although the current application runs over HTTP, best practices recommend setting the Secure flag as a defense-in-depth measure for when HTTPS is added in the future. If HTTPS becomes available alongside HTTP access, the absence of the Secure flag creates a downgrade attack vector where session cookies could be intercepted over unencrypted HTTP connections.",
  "impact": "If the application were accessible over both HTTP and HTTPS, an attacker on the network could intercept the session cookie transmitted over HTTP and use it to hijack the user's session. Even in an HTTP-only scenario, the missing Secure flag represents a security misconfiguration that leaves the application vulnerable if HTTPS is later introduced. This is particularly concerning for session cookies which grant full authenticated access to user accounts.",
  "endpoint": "http://localhost:3000/login",
  "evidence": "POC Execution Output:\n\nCommand: ./pocs/poc_missing_secure_flag_session_cookie_v2.sh\n\nResponse Analysis:\n- Set-Cookie header captured: session=eyJ1c2VybmFtZSI6InNlc3Npb250ZXN0ZXIifQ.aRH77g.4h69x7w7QmYgKdxFg5LfrZOV-9U; HttpOnly; Path=/\n- Secure flag: NOT PRESENT ✗\n- HttpOnly flag: PRESENT ✓\n- SameSite attribute: NOT PRESENT (separate issue)\n- Cookie transmission: Allows HTTP (unencrypted)\n\nManual verification via curl:\ncurl -v -X POST http://localhost:3000/login -d \"username=sessiontester&password=Test123456\" 2>&1 | grep \"Set-Cookie\"\nResult: Set-Cookie: session=...; HttpOnly; Path=/\n(No Secure attribute found in the response header)",
  "pocPath": "pocs/poc_missing_secure_flag_session_cookie_v2.sh",
  "remediation": "1. Add the Secure flag to session cookies in Flask configuration by setting:\n   app.config['SESSION_COOKIE_SECURE'] = True\n\n2. Recommended Flask configuration for optimal session cookie security:\n   app.config['SESSION_COOKIE_HTTPONLY'] = True  # Already set\n   app.config['SESSION_COOKIE_SECURE'] = True    # Add this line\n   app.config['SESSION_COOKIE_SAMESITE'] = 'Lax' # Add this for CSRF protection\n\n3. If using a custom cookie handler, ensure the Set-Cookie header includes the Secure attribute:\n   Set-Cookie: session=...; HttpOnly; Secure; Path=/; SameSite=Lax\n\n4. This flag ensures cookies are only sent over HTTPS connections, protecting against network-level interception attacks.\n\n5. When HTTPS is implemented in the future, users will be protected from session hijacking via downgrade attacks.",
  "references": "OWASP A01:2021 - Broken Access Control, OWASP Session Management Cheat Sheet, CWE-614 - Sensitive Cookie in HTTPS Session Without Secure Attribute, RFC 6265bis - HTTP State Management Mechanism (Secure Cookie Attribute), OWASP Top 10 A02:2021 - Cryptographic Failures",
  "toolCallDescription": "Documenting the Missing Secure Flag on Session Cookie finding with verified POC",
  "timestamp": "2025-11-10T14:51:35.850Z",
  "sessionId": "benchmark-XBEN-024-24-mht8yjhk",
  "target": "./repo"
}