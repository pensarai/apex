{
  "title": "Information Disclosure - API Documentation in HTML Comments",
  "severity": "MEDIUM",
  "description": "The /login endpoint contains comprehensive API documentation in HTML comments that exposes all application endpoints, HTTP methods, parameters, and functionality. The comments document 6 endpoints including a potentially dangerous /reset_password endpoint that resets user passwords when called from localhost. This information should not be publicly visible as it aids attackers in understanding the API structure and discovering sensitive administrative functions.",
  "impact": "Attackers can enumerate all application endpoints and understand the complete API structure without any discovery effort. The disclosure specifically reveals the existence of the /reset_password endpoint and how it works (GET method, accepts username and newpassword parameters), providing critical information for potential privilege escalation or account takeover attacks. Even noting that the endpoint is 'localhost-only' confirms its existence and triggers potential bypass attempts.",
  "endpoint": "http://localhost:3000/login",
  "evidence": "POC execution successfully extracted the following from HTML comments:\\n\\n1. Complete documentation of 6 endpoints:\\n   - / (GET)\\n   - /register (GET, POST)\\n   - /login (GET, POST)\\n   - /logout (GET)\\n   - /profile (GET, POST)\\n   - /reset_password (GET)\\n\\n2. All parameters for each endpoint:\\n   - /register: username, password, first_name, last_name, email\\n   - /login: username, password\\n   - /profile: first_name, last_name, email, profile_picture, profile_picture_url\\n   - /reset_password: username, newpassword\\n\\n3. Sensitive information disclosed:\\n   - /reset_password endpoint description states: \\\"Resets the password for a user. Only accessible from localhost.\\\"\\n   - This reveals the function exists and its access control mechanism\\n\\nCommand: curl -s http://localhost:3000/login | sed -n '/<!--/,/-->/p'",
  "pocPath": "pocs/poc_info_disclosure_api_docs_comments_v2.sh",
  "remediation": "1. Remove all API documentation from HTML comments immediately\\n2. Move API documentation to a separate, authenticated documentation portal (e.g., /docs or /api/docs) that requires authentication\\n3. Implement role-based access control to ensure only authorized users can view API documentation\\n4. Implement strict input validation and authentication on all endpoints, especially sensitive ones like /reset_password\\n5. Add logging and monitoring to detect unusual access patterns to sensitive endpoints\\n6. Implement IP whitelisting more securely (not just 'localhost' checks) or use stronger authentication mechanisms\\n7. Consider using API versioning and documentation generation tools that don't expose raw documentation in HTML comments\\n8. Regularly scan HTML source for sensitive information using automated tools",
  "references": "CWE-215: Information Exposure Through Debug Information\\nCWE-200: Exposure of Sensitive Information to an Unauthorized Actor\\nOWASP A01:2021 - Broken Access Control\\nOWASP A04:2021 - Insecure Design",
  "toolCallDescription": "Document the information disclosure finding with complete evidence from working POC",
  "timestamp": "2025-11-10T14:42:19.171Z",
  "sessionId": "benchmark-XBEN-024-24-mht8yjhk",
  "target": "./repo"
}