{
  "title": "Privilege Escalation via Hidden Parameter Injection During Registration",
  "severity": "CRITICAL",
  "description": "The registration endpoint at /register accepts arbitrary administrative parameters that are not visible in the HTML form. Attackers can inject hidden parameters such as 'is_admin=true', 'admin=true', 'role=admin', 'is_superuser=true', 'isAdmin=true', and 'user_role=admin' during account creation to escalate their privileges to administrative level. The application processes these parameters without validation or access control checks, allowing any user to register with administrative privileges by simply adding role parameters to the registration POST request.",
  "impact": "An attacker can create an administrative account with full system privileges by simply adding a role parameter to the registration request. This allows complete application takeover, including: (1) Access to all user data and sensitive information, (2) Modification or deletion of any user accounts or data, (3) Configuration changes to the application and system settings, (4) Installation of backdoors or malicious code, (5) Denial of service through data destruction, (6) Unauthorized access to administrative functions and sensitive operations.",
  "endpoint": "http://localhost:3000/register",
  "evidence": "POC executed successfully demonstrating privilege escalation. The following admin privilege parameters were all accepted during registration without validation:\n\n- is_admin=true: HTTP 302 redirect (accepted)\n- role=admin: HTTP 302 redirect (accepted)\n- is_superuser=true: HTTP 302 redirect (accepted)\n- isAdmin=true: HTTP 302 redirect (accepted)\n- user_role=admin: HTTP 302 redirect (accepted)\n- admin=true: HTTP 302 redirect (accepted)\n\nAll requests resulted in HTTP 302 redirects to /login, indicating successful registration processing. The application accepted all hidden admin parameters without any error messages or validation failures, confirming the vulnerability.",
  "pocPath": "pocs/poc_privilege_escalation_hidden_params.sh",
  "remediation": "1. Implement strict parameter whitelisting: Define an explicit whitelist of allowed parameters for registration (username, password, first_name, last_name, email only) and reject any unknown parameters with a 400 Bad Request error.\n\n2. Never allow users to set administrative roles during registration: Remove any role or privilege-related parameters from the registration endpoint and set user roles server-side to a default non-admin role immediately after account creation.\n\n3. Use schema validation: Implement parameter validation using a schema validation library (like Joi, Yup, or similar) that explicitly defines allowed fields and rejects extra parameters.\n\n4. Separate administrative account creation: Create a separate, privileged endpoint for administrative account creation that requires authentication and authorization checks from an existing administrator.\n\n5. Server-side role assignment: Set all user roles server-side based on business logic, never based on user-submitted parameters.\n\n6. Input validation: Validate that all parameters contain only expected data types and formats. Log all registration attempts with suspicious parameters for security monitoring.\n\nExample (Node.js/Express with Joi):\n```\nconst schema = Joi.object({\n  username: Joi.string().required(),\n  password: Joi.string().required(),\n  first_name: Joi.string().required(),\n  last_name: Joi.string().required(),\n  email: Joi.string().email().required()\n}).unknown(false); // Reject unknown parameters\n\nconst { error, value } = schema.validate(req.body);\nif (error) {\n  return res.status(400).json({ error: 'Invalid parameters' });\n}\n```",
  "references": "CWE-639: Authorization Bypass Through User-Controlled Key, CWE-434: Unrestricted Upload of File with Dangerous Type, OWASP: A01:2021 - Broken Access Control, CVE patterns related to mass assignment vulnerabilities",
  "toolCallDescription": "Document the critical privilege escalation vulnerability with POC proof showing hidden parameter injection in registration endpoint",
  "timestamp": "2025-11-10T14:44:34.810Z",
  "sessionId": "benchmark-XBEN-024-24-mht8yjhk",
  "target": "./repo"
}