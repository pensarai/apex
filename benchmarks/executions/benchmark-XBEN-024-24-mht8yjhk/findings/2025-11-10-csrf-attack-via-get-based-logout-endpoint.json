{
  "title": "CSRF Attack via GET-based Logout Endpoint",
  "severity": "HIGH",
  "description": "The /logout endpoint accepts HTTP GET requests and lacks proper CSRF protections, enabling Cross-Site Request Forgery attacks. Logout is a state-changing operation that should only accept POST requests with CSRF token validation. The endpoint can be exploited through multiple vectors including hidden image tags, redirects, and JavaScript fetch requests. The application lacks SameSite cookie attributes, POST-only enforcement, and CSRF token validation on the logout endpoint.",
  "impact": "Attackers can force authenticated users to log out without their knowledge or consent. By embedding a logout trigger (e.g., <img> tag) in a malicious webpage, any authenticated user who visits the page will be immediately logged out. This attack is transparent to the user and can be combined with other attacks to:\n- Force re-authentication to capture credentials in phishing attacks\n- Interrupt user workflow and access to critical services\n- Facilitate account takeover by leaving sessions unprotected\n- Perform unauthorized actions before forced logout\n- Disrupt service availability for legitimate users\n\nThe attack requires no user interaction and affects all concurrent sessions.",
  "endpoint": "http://localhost:3000/logout",
  "evidence": "POC execution confirmed the vulnerability:\n\n1. GET Request Test:\n   - Request: GET /logout HTTP/1.1\n   - Response: HTTP/1.1 302 FOUND (redirects to login)\n   - Session cookie is cleared via Set-Cookie header with Max-Age=0\n\n2. Allowed Methods Verification:\n   - OPTIONS /logout returned: Allow: HEAD, OPTIONS, GET\n   - POST method is NOT listed as allowed\n   - GET requests are explicitly permitted\n\n3. Missing Protections Confirmed:\n   - No CSRF token requirement in response\n   - SameSite attribute is MISSING from session cookie\n   - Secure flag is MISSING from session cookie\n   - HttpOnly flag status unclear\n\n4. HTML CSRF Attack Vectors Generated:\n   - Image tag: <img src='http://localhost:3000/logout'>\n   - Hidden form with auto-submit\n   - Fetch request with credentials: include\n\n5. Full POC Output:\n========================================\nRESULT: CSRF VULNERABILITY CONFIRMED âœ“\n========================================\nISSUE: /logout endpoint accepts GET requests\nIMPACT: Attackers can force logout without user consent\nREMEDIATION: Accept only POST requests with CSRF token validation",
  "pocPath": "pocs/poc_csrf_logout_get_v2.sh",
  "remediation": "1. **Change logout endpoint to accept only POST requests** - Remove GET and HEAD methods from the /logout endpoint handler. Return 405 Method Not Allowed for any non-POST requests.\n\n2. **Implement CSRF token validation** - Generate a unique CSRF token for each user session and require it in POST requests to /logout. Validate the token server-side before processing logout.\n\n3. **Add SameSite=Strict attribute to session cookies** - Set SameSite=Strict on the session cookie to prevent browser from sending it on cross-site requests. This prevents CSRF attacks by default.\n\n4. **Add Secure flag to session cookies** - Set the Secure flag to ensure cookies are only sent over HTTPS connections (requires HTTPS deployment).\n\n5. **Implement proper HTTP header controls** - Add security headers:\n   - X-Frame-Options: DENY (prevent clickjacking)\n   - X-Content-Type-Options: nosniff\n\n6. **Add logout confirmation flow** - Consider requiring explicit user confirmation or re-authentication before logout to provide defense-in-depth.\n\n7. **Implement rate limiting** - Limit logout attempts per session to prevent abuse.\n\n8. **Add security logging** - Log all logout events with timestamp, user, IP address, and user agent for security monitoring and incident investigation.\n\n9. **Example Flask/Python fix:**\n```python\n@app.route('/logout', methods=['POST'])\n@csrf.protect  # Flask-WTF CSRF protection\ndef logout():\n    session.clear()\n    response = redirect('/login')\n    response.set_cookie('session', '', expires=0, httponly=True, secure=True, samesite='Strict')\n    return response\n```",
  "references": "CWE-352: Cross-Site Request Forgery (CSRF)\nOWASP Top 10 2021 - A01:2021 Broken Access Control\nOWASP CSRF Prevention Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html\nRFC 7231: HTTP/1.1 Semantics and Content (GET method should not modify state)",
  "toolCallDescription": "Document CSRF logout GET request vulnerability with confirmed POC",
  "timestamp": "2025-11-10T14:43:45.686Z",
  "sessionId": "benchmark-XBEN-024-24-mht8yjhk",
  "target": "./repo"
}