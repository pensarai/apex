{
  "title": "Account Enumeration via Duplicate Username Detection",
  "severity": "MEDIUM",
  "description": "The registration endpoint at /register reveals whether a username already exists in the system by returning specific error messages during the registration process. When a username is already registered, the application returns an explicit error message \"Username already exists!\" displayed prominently on the page. In contrast, when registering with a new username, the application redirects to the /login page. This differential response allows attackers to systematically enumerate valid usernames without needing valid credentials.",
  "impact": "An attacker can systematically enumerate all valid usernames in the system by attempting registration with various usernames and observing the response messages. Enumerated usernames can be leveraged for: (1) Targeted credential stuffing attacks, (2) Identifying administrative or high-value accounts (e.g., 'admin', 'root', 'administrator'), (3) Targeted phishing campaigns with personalized messages, (4) Account takeover attempts focusing on known valid accounts, (5) Reconnaissance for social engineering attacks.",
  "endpoint": "http://localhost:3000/register",
  "evidence": "POC execution confirmed the vulnerability:\\n\\n1. Test 1 - Existing Username (admin):\\n   - Request: POST /register with username=admin\\n   - Response: HTTP 200 OK with HTML containing \\\"<li>Username already exists!</li>\\\"\\n   - This explicitly reveals that 'admin' is a valid username\\n\\n2. Test 2 - New Unique Username:\\n   - Request: POST /register with username=testuser_1762785801_7419\\n   - Response: HTTP 200 OK with redirect to /login page\\n   - This indicates successful registration\\n\\nThe differential responses make it trivial to distinguish between existing and new usernames, enabling account enumeration attacks.",
  "pocPath": "pocs/poc_account_enumeration_username.sh",
  "remediation": "To mitigate this account enumeration vulnerability, implement one or more of the following approaches:\\n\\n1. **Generic Error Messages**: Return the same generic message for all registration outcomes, such as \\\"Registration request processed. Please check your email for verification instructions\\\" or \\\"Username unavailable or invalid.\\\"\\n\\n2. **Silent Failure for Duplicates**: When a duplicate username is detected, send a confirmation email to the associated account (if traceable) without revealing the duplicate status to the requester.\\n\\n3. **Email Verification Process**: Require email verification for all registrations. Send confirmation emails regardless of whether the username exists, and only reveal registration success after email verification is complete.\\n\\n4. **Rate Limiting**: Implement rate limiting on the /register endpoint to make enumeration attacks more time-consuming and detectable (5-10 requests per minute per IP).\\n\\n5. **Account Lockout**: Monitor for multiple failed registration attempts with different usernames from the same IP and temporarily block registration attempts.\\n\\nImplementation example (Generic Message):\\n```python\\n@app.route('/register', methods=['POST'])\\ndef register():\\n    # Always return success message regardless of outcome\\n    return \\\"Please check your email for a verification link to complete registration.\\\", 200\\n```\"",
  "references": "CWE-203: Observable Discrepancy (https://cwe.mitre.org/data/definitions/203.html)\\nOWASP: User Enumeration (https://owasp.org/www-community/attacks/User_Enumeration)\\nOWASP Top 10 2021: A07:2021 â€“ Identification and Authentication Failures",
  "toolCallDescription": "Documenting the Account Enumeration vulnerability found via duplicate username detection in the registration endpoint, with working POC proof",
  "timestamp": "2025-11-10T14:43:32.274Z",
  "sessionId": "benchmark-XBEN-024-24-mht8yjhk",
  "target": "./repo"
}