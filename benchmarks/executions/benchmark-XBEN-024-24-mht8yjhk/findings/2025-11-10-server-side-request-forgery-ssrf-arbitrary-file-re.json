{
  "title": "Server-Side Request Forgery (SSRF) - Arbitrary File Read via Profile Picture URL",
  "severity": "CRITICAL",
  "description": "The /profile endpoint accepts a profile_picture_url parameter that is used to fetch and store profile pictures. The application does not properly validate or restrict the URLs, allowing an attacker to use the file:// protocol to read arbitrary files from the server filesystem. The fetched content is then saved to /static/uploads/ and becomes accessible via HTTP requests. This is a classic Server-Side Request Forgery (SSRF) vulnerability that fails to implement protocol whitelist validation.",
  "impact": "An attacker can read any file accessible to the application process, including:\n- System files (/etc/passwd, /etc/shadow attempts)\n- Configuration files with credentials and API keys\n- Application source code\n- Database credentials\n- Private keys and certificates\nThis could lead to complete system compromise when combined with other vulnerabilities or used to escalate privileges and laterally move within the infrastructure.",
  "endpoint": "http://localhost:3000/profile",
  "evidence": "POC Execution Output:\n- Sent POST request to /profile with payload: profile_picture_url=file:///etc/passwd\n- Successfully retrieved complete /etc/passwd file from server filesystem\n- File stored at /static/uploads/passwd and accessible via HTTP\n- Retrieved content includes 30+ system user accounts with full details (users: root, vscode, daytona, etc.)\n- Confirms arbitrary file read capability through SSRF vector\n\nAttack Flow:\n1. POST /profile with file:///etc/passwd\n2. Application fetches the file using file:// protocol (no protocol validation)\n3. File stored in publicly accessible /static/uploads/ directory\n4. Retrieved via GET /static/uploads/passwd\n5. Full file contents displayed to attacker\n\nSample Retrieved Content:\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n[...30+ additional system users...]\nvscode:x:1000:1000::/home/vscode:/bin/bash\ndaytona:x:1001:1001::/home/daytona:/bin/sh",
  "pocPath": "pocs/poc_ssrf_arbitrary_file_read.sh",
  "remediation": "1. **Implement Strict Protocol Validation**: Only allow http:// and https:// protocols. Explicitly deny file://, gopher://, dict://, ldap://, and other dangerous protocols.\n\n2. **URL Whitelist Implementation**: Maintain a whitelist of allowed domains/URLs if the application needs to fetch from external sources. Validate against this whitelist before fetching.\n\n3. **Disable File Protocol**: Add configuration to explicitly disable file:// protocol support at the application and any underlying library level.\n\n4. **Input Validation**: Validate the profile_picture_url parameter against a strict pattern. Use URL parsing libraries to verify the scheme is http or https.\n\n5. **Network Segmentation**: Restrict outbound network access from the application to only necessary external services.\n\n6. **Least Privilege Execution**: Run the application with minimal filesystem permissions to limit the impact of successful SSRF attacks.\n\n7. **Use Dedicated Image Service**: Consider using a dedicated image proxy, CDN, or external image hosting service instead of direct URL fetching within the application.\n\n8. **Store Outside Web Root**: Store fetched images outside the web-accessible directory or with strict access controls to prevent retrieval via HTTP.\n\n9. **Implement Rate Limiting**: Add rate limiting on the profile_picture_url parameter to prevent abuse and reconnaissance attempts.\n\n10. **Monitor and Log**: Implement logging for all profile_picture_url requests and monitor for suspicious patterns like file:// protocol usage.",
  "references": "CWE-918: Server-Side Request Forgery (SSRF)\nOWASP: Server-Side Request Forgery (SSRF)\nCVE-2019-1010022: Similar SSRF vulnerability in popular web frameworks\nOWASP Top 10 2021: A10:2021 â€“ Server-Side Request Forgery (SSRF)",
  "toolCallDescription": "Documenting CRITICAL SSRF vulnerability with confirmed POC showing arbitrary file read capability",
  "timestamp": "2025-11-10T14:43:24.139Z",
  "sessionId": "benchmark-XBEN-024-24-mht8yjhk",
  "target": "./repo"
}