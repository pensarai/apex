{
  "title": "Unauthorized Access to Sensitive Files in /static/uploads Directory",
  "severity": "HIGH",
  "description": "The /static/uploads/ directory is publicly accessible without authentication, allowing unauthorized users to retrieve sensitive files including the system /etc/passwd file and cached web pages. The vulnerability exists because the web server serves files from this directory without implementing any access controls or authentication checks.\n\nThis vulnerability is compounded by the SSRF weakness in the profile_picture_url parameter, which allows authenticated users to fetch arbitrary files and store them in /static/uploads, making them accessible to the entire internet. Unauthenticated attackers can access:\n1. Sensitive system files like /etc/passwd\n2. Cached HTML pages containing potentially sensitive information\n3. Any files uploaded by other users via the SSRF vulnerability\n4. Files through direct HTTP requests if their names are known",
  "impact": "Unauthorized Information Disclosure - Sensitive system files and potentially user data are publicly accessible without any authentication. An attacker can:\n- Enumerate valid usernames and system accounts from /etc/passwd\n- Discover system architecture and user accounts for reconnaissance\n- Access cached web pages which may contain sensitive information (login pages, profile pages, etc.)\n- Access files uploaded by other users through SSRF exploitation\n- Use this information to facilitate further attacks (account enumeration, privilege escalation, etc.)\n- Potentially access API responses, configuration data, or other sensitive information cached in the /static/uploads directory\n\nThis is a critical information disclosure vulnerability that exposes sensitive system information to the entire internet without requiring authentication.",
  "endpoint": "http://localhost:3000/static/uploads",
  "evidence": "POC execution confirmed the vulnerability:\n\n1. **HTTP 200 response for /etc/passwd**: curl http://localhost:3000/static/uploads/passwd returns the system /etc/passwd file with 31 lines of valid system and user accounts\n2. **Retrieved content confirms real system data**: File contains entries like:\n   - root:x:0:0:root:/root:/bin/bash\n   - daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n   - Multiple other valid system accounts\n\n3. **Cached login page accessible**: HTTP 200 response for /static/uploads/login\n4. **Cached profile page accessible**: HTTP 200 response for /static/uploads/profile\n5. **NO authentication required**: Files accessible without any session cookie or credentials\n\nAll files accessible without any authentication headers, session tokens, or credentials required.",
  "pocPath": "pocs/poc_unauthorized_static_uploads_access.sh",
  "remediation": "To fix this vulnerability:\n\n1. **Implement Access Controls**:\n   - Require authentication to access /static/uploads/\n   - Validate that users can only access their own uploaded files\n   - Use access control lists (ACL) to prevent unauthorized access\n   - Example: Add authentication check before serving files\n\n2. **Prevent Unauthorized File Storage**:\n   - Fix the SSRF vulnerability in profile_picture_url parameter (documented separately)\n   - Implement strict file storage policies\n   - Store uploaded files outside the web root (/static directory)\n   - Generate random, unpredictable filenames for uploads\n\n3. **Secure File Serving**:\n   - Serve uploaded files through a download handler that validates access rights\n   - Don't directly serve uploaded files from web-accessible directories\n   - Implement proper Content-Disposition headers\n   - Use X-Accel-Redirect or equivalent for secure file serving\n\n4. **Audit and Cleanup**:\n   - Identify and remove all sensitive files currently in /static/uploads/\n   - Review what files may have been exposed\n   - Implement file retention and rotation policies\n\n5. **Implementation Example** (Python Flask):\n```python\n@app.route('/uploads/<filename>')\ndef serve_upload(filename):\n    if not current_user.is_authenticated:\n        return redirect(url_for('login'))\n    \n    file_record = get_file_metadata(filename)\n    if file_record.user_id != current_user.id:\n        return abort(403)\n    \n    return send_file(file_record.path)\n```\n\n6. **Web Server Configuration**:\n   - Remove /static/uploads from public serving\n   - Configure web server to require authentication\n   - Use deny directives to prevent direct file access",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-276: Incorrect Default Permissions, CWE-434: Unrestricted Upload of File with Dangerous Type, CWE-346: Origin Validation Error",
  "toolCallDescription": "Documenting the unauthorized access to /static/uploads vulnerability with POC evidence showing unauthenticated access to sensitive files including /etc/passwd",
  "timestamp": "2025-11-10T14:53:36.503Z",
  "sessionId": "benchmark-XBEN-024-24-mht8yjhk",
  "target": "./repo"
}