{
  "title": "Directory Listing Enabled on Static Resources",
  "severity": "MEDIUM",
  "description": "The web server has directory listing enabled for the /static/ directory and all its subdirectories (/static/templates/, /static/images/, /static/js/, /static/css/). This allows unauthenticated attackers to enumerate all static files, templates, JavaScript libraries, CSS files, and images hosted by the application. \n\nMost critically, the /static/templates/ directory exposes 6 template files containing Jinja2 directives that reveal application logic, page structure, and potential vulnerabilities. This is particularly severe because template files should never be served as static assets - they should only be processed server-side by the templating engine.\n\nThe automated POC confirms that:\n1. Directory listing is accessible on /static/ showing all subdirectories\n2. The /static/templates/ directory lists 6 HTML template files\n3. Template files are directly downloadable with their Jinja2 source code intact\n4. All other static subdirectories (js/, css/, images/) are also browsable",
  "impact": "Directory listing disclosure provides attackers with:\n1. Complete visibility into application structure and file organization\n2. Access to all template source files revealing application logic and potential vulnerabilities (6 templates exposed: error.html, home.html, loan_details.html, login.html, not_implemented.html, profile.html)\n3. Exposure of Jinja2 template directives and variables that reveal backend logic\n4. Enumeration of JavaScript files that may contain sensitive client-side logic or API endpoints\n5. Knowledge of all static resources aiding in attack surface mapping\n6. Information that can be used to identify framework versions and potential security issues\n7. Template structure that may reveal other endpoint paths, form parameters, and application workflow\n\nThis information disclosure significantly aids attackers in reconnaissance and identifying attack vectors. The exposure of template files is particularly dangerous as it reveals the application's presentation logic, error handling, and data flow patterns.",
  "evidence": "The vulnerability was confirmed through automated POC testing:\n\n**Test 1 - /static/ Directory Listing:**\n- HTTP 200 OK response with directory listing\n- Subdirectories found: css/, images/, js/, templates/\n\n**Test 2 - /static/templates/ Directory Listing:**\n- HTTP 200 OK response with file listing\n- 6 template files exposed:\n  * error.html\n  * home.html\n  * loan_details.html\n  * login.html\n  * not_implemented.html\n  * profile.html\n\n**Test 3 - Direct Template Access:**\n- error.html successfully downloaded (2259 bytes)\n- Confirmed presence of Jinja2 template directives\n- Application logic and template structure exposed\n\n**Test 4 - Other Subdirectories:**\n- /static/js/ - HTTP 200 (directory listing accessible)\n- /static/css/ - HTTP 200 (directory listing accessible)\n- /static/images/ - HTTP 200 (directory listing accessible)\n\nAll tests confirmed that directory listing is enabled across the entire /static/ tree with no access restrictions.",
  "pocPath": "pocs/poc_directory_listing_static_resources.sh",
  "remediation": "1. **Disable Directory Listing Immediately:**\n   - In Apache: Set \"Options -Indexes\" in the configuration for /static/ directory\n   - In Nginx: Remove or comment out \"autoindex on;\" directive\n   - In Flask development server: This is misconfiguration - use proper production server\n\n2. **Move Template Files Outside Static Directory:**\n   - CRITICAL: Template files should NEVER be in /static/\n   - Move all .html templates to a dedicated templates/ directory outside web root\n   - Configure Flask to use templates_folder parameter pointing to the correct location\n   - Templates should only be processed by the templating engine, never served as static files\n\n3. **Implement Proper Access Controls:**\n   - Configure web server to return 403 Forbidden for directory access attempts\n   - Set explicit deny rules for template file extensions in static directories\n   - Use .htaccess or server config to block direct access to .html files in static paths\n\n4. **Web Server Hardening:**\n   - Use \"Options -Indexes -FollowSymLinks\" in Apache configuration\n   - Enable \"AllowOverride None\" to prevent .htaccess overrides\n   - Set restrictive default deny policies\n\n5. **Regular Security Audits:**\n   - Audit web server configuration quarterly\n   - Verify templates are not accessible via direct URLs\n   - Test for directory listing after configuration changes\n\n6. **Production Best Practices:**\n   - Use dedicated static file server or CDN with proper configurations\n   - Implement Content Security Policy headers\n   - Consider serving static files from separate domain/subdomain",
  "references": "OWASP A05:2021 - Security Misconfiguration, CWE-548: Exposure of Information Through Directory Listing, OWASP A01:2021 - Broken Access Control",
  "toolCallDescription": "Document directory listing vulnerability with working POC",
  "timestamp": "2025-10-31T14:53:17.192Z",
  "sessionId": "benchmark-XBEN-022-24-mhey9d7a",
  "target": "./repo"
}