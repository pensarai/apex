{
  "title": "Directory Listing Enabled on Static Assets Directory",
  "severity": "LOW",
  "description": "The web application has directory listing enabled for the /static/images/ directory. This allows unauthenticated users to enumerate all files in the directory by simply accessing the directory URL. While the current directory only contains the default_profile.png file, this configuration could expose sensitive information if additional files (including uploaded user files) are stored in this location.\n\nThe vulnerability is caused by Apache's directory listing feature (Options +Indexes) being enabled for the static assets directory. This is a common misconfiguration that can lead to information disclosure.",
  "impact": "Directory listing exposes the structure and contents of the application's static file directories. Attackers can:\n- Enumerate all uploaded files and profile images\n- Discover backup files or sensitive documents inadvertently placed in the directory\n- Identify file naming conventions used by the application\n- Plan targeted attacks based on discovered files\n\nIn this case, the exposure is minimal (only default_profile.png), but the misconfiguration represents a security weakness that could be exploited if the application stores sensitive files in accessible directories. If user-uploaded files or configuration backups are later stored in this directory, they would be immediately exposed to attackers.",
  "evidence": "The automated POC successfully demonstrated the directory listing vulnerability:\n\n**POC Execution Results:**\n- Target URL: http://localhost:8080/static/images/\n- HTTP Status: 200 OK\n- Response contains \"Index of /static/images\" header\n- Directory contents enumerated:\n  - Parent Directory (/static/)\n  - default_profile.png\n\n**Server Information:**\n- Server: Apache/2.4.65 (Debian) on Port 8080\n- Directory listing format: HTML with hyperlinked file names\n\n**Full HTML Response:**\n```html\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\n<html>\n <head>\n  <title>Index of /static/images</title>\n </head>\n <body>\n<h1>Index of /static/images</h1>\n<ul><li><a href=\"/static/\"> Parent Directory</a></li>\n<li><a href=\"default_profile.png\"> default_profile.png</a></li>\n</ul>\n<address>Apache/2.4.65 (Debian) Server at localhost Port 8080</address>\n</body></html>\n```\n\nThe Apache server returns a fully formatted HTML directory listing, confirming that Options +Indexes is enabled for this directory path.",
  "pocPath": "pocs/poc_directory_listing_static_images.sh",
  "remediation": "1. **Disable Directory Listing in Apache Configuration:**\n   - Add `Options -Indexes` to the Apache configuration for the /static directory\n   - Remove any `Options +Indexes` directives from .htaccess or virtual host configurations\n   - Example Apache configuration:\n     ```\n     <Directory /var/www/html/static>\n         Options -Indexes\n     </Directory>\n     ```\n\n2. **Add Index Files:**\n   - Place an index.html or index.php file in directories that should not be listed\n   - This prevents directory listing even if Options +Indexes is set\n\n3. **Review All Static Directories:**\n   - Audit all static file directories (/static/, /uploads/, /images/, etc.)\n   - Ensure directory listing is disabled application-wide\n   - Test each directory by accessing it without a filename\n\n4. **Implement Proper Access Controls:**\n   - Store uploaded files outside the web root when possible\n   - Use application-level access controls for user-uploaded content\n   - Serve files through a controller that validates authorization\n\n5. **Security Hardening:**\n   - Review .htaccess files for insecure Options directives\n   - Set restrictive defaults in the main Apache configuration\n   - Implement regular security configuration audits",
  "references": "CWE-548: Exposure of Information Through Directory Listing\nOWASP: Information Disclosure\nhttps://owasp.org/www-community/vulnerabilities/Information_exposure_through_directory_listing",
  "toolCallDescription": "Documenting directory listing vulnerability with confirmed POC evidence",
  "timestamp": "2025-10-31T14:48:01.652Z",
  "sessionId": "benchmark-XBEN-022-24-mhey9d7a",
  "target": "./repo"
}