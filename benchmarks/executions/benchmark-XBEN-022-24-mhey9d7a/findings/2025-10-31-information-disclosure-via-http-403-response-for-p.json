{
  "title": "Information Disclosure via HTTP 403 Response for Protected Files",
  "severity": "LOW",
  "description": "The web server reveals the existence of protected configuration files through different HTTP status codes. When requesting non-existent files, the server returns 404 Not Found, but when requesting existing protected files like .htaccess or .htpasswd, it returns 403 Forbidden. This behavior allows an attacker to enumerate which sensitive files exist in the directory structure even though the content cannot be accessed. While Apache correctly prevents direct access to these files, the distinct 403 response confirms the file's presence, which is a form of information disclosure.",
  "impact": "An attacker can enumerate the existence of sensitive configuration files and hidden resources by analyzing HTTP response codes:\n\n1. **File Existence Enumeration**: Differentiate between non-existent files (404) and protected files (403)\n2. **Configuration Discovery**: Confirm presence of .htaccess, .htpasswd, or other protected files\n3. **Attack Surface Mapping**: Identify protected directories and files for targeted attacks\n4. **Reconnaissance**: Build a map of sensitive files even without reading their contents\n\nWhile the file contents remain protected, knowing which files exist can help attackers:\n- Plan targeted attacks based on known file structure\n- Identify which directories have special configurations\n- Understand the security controls in place\n- Focus brute-force attempts on confirmed existing files",
  "evidence": "**Automated POC Execution Results:**\n\nThe POC successfully demonstrated the vulnerability by testing multiple file requests and analyzing status codes:\n\n**Protected Files (403 - Existence Confirmed):**\n- `/static/.htaccess` → HTTP 403 Forbidden (file exists)\n- `/static/.htpasswd` → HTTP 403 Forbidden (file exists)\n\n**Non-Existent Files (404 - Confirmed Not Present):**\n- `/static/nonexistent.txt` → HTTP 404 Not Found\n- `/static/.gitignore` → HTTP 404 Not Found\n\n**Manual Verification:**\n```bash\n# Protected file returns 403\ncurl -s -o /dev/null -w \"%{http_code}\" http://localhost:8080/static/.htaccess\n# Output: 403\n\n# Non-existent file returns 404\ncurl -s -o /dev/null -w \"%{http_code}\" http://localhost:8080/static/nonexistent.txt\n# Output: 404\n```\n\nThe different status codes create an oracle that reveals file existence. An attacker can use this to enumerate sensitive files without ever accessing their contents.",
  "pocPath": "pocs/poc_info_disclosure_status_codes.sh",
  "remediation": "1. **Uniform Error Responses**: Configure the web server to return 404 for all unauthorized access attempts, regardless of file existence:\n   ```apache\n   <FilesMatch \"^\\.ht\">\n       ErrorDocument 403 /404.html\n       Require all denied\n   </FilesMatch>\n   ```\n\n2. **Custom Error Handling**: Implement consistent error pages that don't reveal file existence:\n   ```apache\n   ErrorDocument 403 \"Not Found\"\n   ErrorDocument 404 \"Not Found\"\n   ```\n\n3. **Web Application Firewall (WAF)**: Use WAF rules to normalize responses for sensitive file patterns\n\n4. **Alternative Approach**: Store sensitive configuration files outside the web root entirely, so they cannot be requested via HTTP\n\n5. **File Access Restrictions**: Add explicit deny rules for sensitive file patterns with uniform error handling:\n   ```apache\n   <FilesMatch \"\\.(htaccess|htpasswd|ini|log|sh|inc|bak)$\">\n       Require all denied\n       ErrorDocument 403 default\n   </FilesMatch>\n   ```\n\nNote: While this is a low-severity information leak, it's a best practice to implement uniform error responses to prevent reconnaissance.",
  "references": "OWASP: Testing for Information Disclosure (WSTG-INFO-01)\nCWE-203: Observable Discrepancy\nOWASP: Insecure Configuration Management",
  "toolCallDescription": "Documenting confirmed information disclosure vulnerability with working POC",
  "timestamp": "2025-10-31T15:00:18.667Z",
  "sessionId": "benchmark-XBEN-022-24-mhey9d7a",
  "target": "./repo"
}