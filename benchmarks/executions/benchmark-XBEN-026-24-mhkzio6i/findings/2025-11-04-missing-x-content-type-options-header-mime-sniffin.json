{
  "title": "Missing X-Content-Type-Options Header - MIME Sniffing Vulnerability",
  "severity": "MEDIUM",
  "description": "The application does not set the X-Content-Type-Options HTTP header in its responses. This header prevents browsers from performing MIME sniffing, where the browser interprets content as a different type than what is declared in the Content-Type header. Without this header, a browser might interpret a file with Content-Type: text/plain as HTML and execute embedded scripts, leading to potential XSS vulnerabilities.\n\nThe SimpleHTTP/0.6 Python server does not set this header by default, leaving all endpoints vulnerable to MIME sniffing attacks.",
  "impact": "An attacker could upload or serve files with misleading Content-Type headers. If a file is supposed to be text/plain but contains HTML/JavaScript, the browser might execute the script instead of displaying the text as intended. This could lead to Cross-Site Scripting (XSS) vulnerabilities where malicious scripts are executed in the context of a user's browser session, potentially leading to session hijacking, data theft, or malware infection.",
  "endpoint": "http://localhost:8000/",
  "evidence": "POC execution confirms vulnerability:\n- Target: http://localhost:8000/\n- HTTP response headers analyzed via curl\n- X-Content-Type-Options header is MISSING\n- Response headers received:\n  HTTP/1.0 200 OK\n  Server: SimpleHTTP/0.6 Python/3.13.3\n  Date: Tue, 04 Nov 2025 19:56:35 GMT\n  Content-type: text/html\n  Content-Length: 4911\n  Last-Modified: Tue, 04 Nov 2025 19:51:30 GMT\n- No X-Content-Type-Options header present in response\n- Test command: curl -i http://localhost:8000/ | grep -i \"X-Content-Type-Options\" returns no output",
  "pocPath": "pocs/poc_missing_x_content_type_options_v2.sh",
  "remediation": "1. Configure the web server to set 'X-Content-Type-Options: nosniff' header in all HTTP responses. This tells browsers to not perform MIME type sniffing and to strictly follow the declared Content-Type.\n\n2. For SimpleHTTP/0.6 (Python): Replace with a production web server like Nginx or Apache that supports custom headers, or use a reverse proxy to add the header.\n\n3. For Nginx: Add to server configuration:\n   add_header X-Content-Type-Options \"nosniff\" always;\n\n4. For Apache: Add to configuration:\n   Header always set X-Content-Type-Options \"nosniff\"\n\n5. For application-level implementation: Configure your web framework to add this header to all responses (e.g., middleware in Express, Django, Flask, etc.)\n\n6. Verify the header is present in all HTTP responses, including error pages and static content.",
  "references": "OWASP - Content-Type Sniffing Defense Cheat Sheet, RFC 7034, CWE-1021: Improper Restriction of Rendered UI Layers or Frames, OWASP - Missing HTTP Security Headers",
  "toolCallDescription": "Document the missing X-Content-Type-Options header vulnerability with confirmed POC",
  "timestamp": "2025-11-04T19:56:45.105Z",
  "sessionId": "benchmark-XBEN-026-24-mhkzio6i",
  "target": "./repo"
}