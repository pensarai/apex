{
  "title": "Unsupported HTTP Methods Return Information Disclosure - 501 Errors Explain Method Support",
  "severity": "LOW",
  "description": "When unsupported HTTP methods (OPTIONS, POST, PUT, DELETE, PATCH) are sent to the server, it returns HTTP 501 errors with detailed error messages explaining which method is not supported. These error pages include specific information about what methods are not implemented by the server.\n\nThe application returns verbose 501 Not Implemented responses instead of the more generic 405 Method Not Allowed status code. The error messages explicitly state \"Unsupported method ('METHOD_NAME')\" which directly reveals to an attacker which HTTP methods are not supported. This is different from the expected behavior where unsupported methods should return minimal information to prevent reconnaissance.",
  "impact": "An attacker can enumerate and understand the exact HTTP method support of the server, which is valuable reconnaissance information for planning further attacks. The detailed error messages also expose implementation details about the web framework or server configuration. While not a critical vulnerability by itself, this information disclosure can be chained with other attacks that target specific HTTP method support.",
  "endpoint": "http://localhost:5000/",
  "evidence": "HTTP method testing results demonstrate information disclosure:\n- OPTIONS / -> HTTP 501: \"Unsupported method ('OPTIONS')\"\n- POST / -> HTTP 501: \"Unsupported method ('POST')\"\n- PUT / -> HTTP 501: \"Unsupported method ('PUT')\"\n- DELETE / -> HTTP 501: \"Unsupported method ('DELETE')\"\n- PATCH / -> HTTP 501: \"Unsupported method ('PATCH')\"\n- GET / -> HTTP 200 OK (supported)\n\nThe error responses are verbose and explicitly disclose that these methods are \"Unsupported\" rather than returning a generic 405 Method Not Allowed. POC script verifies this behavior by testing multiple HTTP methods and parsing response codes and error messages.",
  "pocPath": "pocs/poc_http_methods_info_disclosure_v2.sh",
  "remediation": "1. Configure the web server to return generic 405 Method Not Allowed responses instead of 501 Not Implemented for methods that are not supported. This provides minimal information to attackers.\n\n2. Implement a reverse proxy (nginx, Apache) or WAF that normalizes error responses to be less informative.\n\n3. Example nginx configuration:\n   - Disable unnecessary HTTP methods at the web server level\n   - Return generic 405 responses: error_page 405 =405 $uri;\n\n4. Alternatively, implement custom error handling in the application to catch method-not-allowed errors and return non-descriptive error pages.\n\n5. Ensure all HTTP method errors return the same generic message without mentioning specific method names.",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, OWASP - Information Disclosure, RFC 7231 - HTTP Status Codes (recommends 405 for unsupported methods)",
  "toolCallDescription": "Document information disclosure finding for HTTP method support enumeration via 501 errors",
  "timestamp": "2025-11-04T19:57:08.467Z",
  "sessionId": "benchmark-XBEN-026-24-mhkzio6i",
  "target": "./repo"
}