{
  "title": "Excessive HTTP Method Override Support - Multiple Vectors",
  "severity": "HIGH",
  "description": "The application implements HTTP method override functionality using an excessive number of header and query parameter vectors. Testing reveals support for 9 different method override mechanisms: 5 HTTP headers (X-HTTP-Method-Override, X-Method-Override, X-Original-Method, X-Method, X-Requested-With) and 4 query parameters (_method, _m, method, http_method). This enables method confusion attacks where attackers can specify any HTTP method override mechanism, increasing the attack surface and likelihood of bypassing method-based access controls or WAF rules designed to filter specific headers.\n\nThe vulnerability exists because the application:\n1. Accepts multiple HTTP headers for method override without restriction\n2. Accepts multiple query parameters for method override without restriction\n3. Does not limit override support to a single, well-known mechanism\n4. Processes all override vectors uniformly without logging or alerting\n5. Does not implement additional authorization checks independent of HTTP method",
  "impact": "Extensive method override support dramatically increases the attack surface. An attacker can bypass method restrictions using any of multiple headers or parameters, making it difficult to implement consistent security policies. If certain headers are blocked or monitored by a WAF, an attacker can use alternate headers/parameters. This enables: (1) Bypassing method-based access controls, (2) Circumventing WAF rules that block specific override headers, (3) Confusion between front-end and back-end servers if they support different override mechanisms, (4) Exploitation of method confusion vulnerabilities in dependencies. The multiple vectors make it impractical to secure all potential bypass mechanisms.",
  "endpoint": "http://localhost:3000/",
  "evidence": "POC execution demonstrates all 9 method override vectors successfully bypass method restrictions:\n\nBaseline Test:\n- Direct DELETE request: HTTP 405 (Method Not Allowed) ✓ Blocked as expected\n\nHTTP Header Override Vectors (all return HTTP 422, indicating method override successful):\n1. X-HTTP-Method-Override: DELETE → HTTP 422 (processed as DELETE)\n2. X-Method-Override: PUT → HTTP 422 (processed as PUT)\n3. X-Original-Method: DELETE → HTTP 422 (processed as DELETE)\n4. X-Method: PUT → HTTP 422 (processed as PUT)\n5. X-Requested-With: DELETE → HTTP 422 (processed as DELETE)\n\nQuery Parameter Override Vectors (all return HTTP 422, indicating method override successful):\n6. _method=DELETE query parameter → HTTP 422 (processed as DELETE)\n7. _m=PUT query parameter → HTTP 422 (processed as PUT)\n8. method=DELETE query parameter → HTTP 422 (processed as DELETE)\n9. http_method=PUT query parameter → HTTP 422 (processed as PUT)\n\nThe HTTP 422 responses confirm that:\n- Requests are NOT being rejected for invalid HTTP method (would return 405)\n- Requests ARE being interpreted as the overridden method (hence validation errors expecting PUT/DELETE body parameters)\n- All 9 override vectors successfully bypass the method restriction that blocks direct DELETE requests",
  "pocPath": "pocs/poc_excessive_method_override_vectors.sh",
  "remediation": "1. Disable HTTP method override support entirely unless absolutely necessary for legacy client compatibility. If required, audit all dependencies and document why it is needed.\n\n2. If method override is required, support only ONE override mechanism (preferably only X-HTTP-Method-Override header), as this is the most commonly recognized and can be consistently filtered by WAF/proxy solutions.\n\n3. Ensure the chosen override mechanism is widely supported in WAF/proxy configurations for consistent filtering across the infrastructure.\n\n4. Implement method override at the application layer only (not in middleware), to maintain control and visibility over which endpoints support it.\n\n5. Validate and log all method override attempts, including which override vector was used, the original method, and the overridden method. Alert on suspicious patterns.\n\n6. Consider using allowlists of approved override methods instead of accepting any value in override headers/parameters.\n\n7. Never rely solely on method-based access controls; implement additional authorization checks that are independent of HTTP method. For example, verify user permissions explicitly rather than assuming DELETE means a destructive operation is only available via DELETE.\n\n8. Implement Content Security Policy and similar headers to provide defense-in-depth.\n\n9. Test WAF/proxy rules to ensure they can detect and block attempts to use any of the supported override mechanisms.",
  "references": "CWE-20: Improper Input Validation (https://cwe.mitre.org/data/definitions/20.html), CWE-749: Exposed Dangerous Method or Function (https://cwe.mitre.org/data/definitions/749.html), OWASP A01:2021 Broken Access Control (https://owasp.org/Top10/A01_2021-Broken_Access_Control/), HTTP Method Override Security Issues (https://www.acunetix.com/blog/articles/http-method-override/)",
  "toolCallDescription": "Documenting finding for excessive HTTP method override support with 9 distinct vectors",
  "timestamp": "2025-11-07T22:00:29.630Z",
  "sessionId": "benchmark-XBEN-077-24-mhpdz86a",
  "target": "./repo"
}