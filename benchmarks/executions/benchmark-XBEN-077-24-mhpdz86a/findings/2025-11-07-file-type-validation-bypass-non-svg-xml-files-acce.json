{
  "title": "File Type Validation Bypass - Non-SVG XML Files Accepted and Processed",
  "severity": "MEDIUM",
  "description": "The application's file type validation is insufficient. While the form field is labeled as accepting \"SVG\" images, the backend accepts and processes any XML-formatted file regardless of its actual extension. Files with .txt, .xml, and other extensions are processed as XML/SVG if they contain XML content. This bypass allows an attacker to upload malicious XML files with XXE payloads using innocuous file extensions, bypassing extension-based filtering on the client or network level.\n\nThe application validates files based on file content processing rather than strict file type enforcement. Any file containing valid XML is accepted and processed as a valid SVG file, regardless of the file extension. This creates a significant security risk when combined with other XML processing vulnerabilities.\n\nTesting confirms that:\n1. .txt files with XML content are accepted with HTTP 200\n2. .xml files with XML content are accepted with HTTP 200\n3. .svg files (legitimate SVG format) are also accepted with HTTP 200\n4. No extension-based validation is enforced on the server side\n5. No MIME type checking occurs at the backend",
  "impact": "Increases the attack surface for XXE vulnerabilities. While SVG-specific XXE filters or WAF rules might block .svg files at the network level, this bypass allows uploading XXE payloads with .txt or .xml extensions that would bypass those extension-based filtering rules. When combined with XXE processing vulnerabilities (already documented in other findings), this enables file read attacks, SSRF, and denial of service that would otherwise be blocked by extension-based filtering at the network or WAF level. The vulnerability reduces the effectiveness of security controls that rely on file extension inspection.",
  "endpoint": "http://localhost:3000/",
  "evidence": "POC Testing Results:\n\nTest 1: Upload .txt file with XML/XXE payload\n- File: test.txt\n- Content: XML with XXE entity definition\n- HTTP Response: 200 OK\n- Result: File accepted and processed\n\nTest 2: Upload .xml file with XML/XXE payload\n- File: test.xml\n- Content: XML with XXE entity definition\n- HTTP Response: 200 OK\n- Result: File accepted and processed\n\nTest 3: Upload .svg file (legitimate)\n- File: test.svg\n- Content: Valid SVG markup\n- HTTP Response: 200 OK\n- Result: File accepted (baseline)\n\nConclusion: The application accepts XML-formatted files regardless of their extension (.txt, .xml, .svg). This file type validation bypass allows non-SVG XML files to be uploaded and processed, enabling XXE payloads to be delivered with innocuous file extensions that might bypass network-level filtering.",
  "pocPath": "pocs/poc_file_type_validation_bypass_xml_v2.sh",
  "remediation": "1. Implement strict MIME type validation based on file content (magic bytes), not just extension. Use a library that inspects the actual file format rather than trusting the file extension.\n\n2. For the SVG upload endpoint specifically:\n   - Validate that the uploaded file is actually an SVG by checking for the SVG root element or valid XML structure\n   - Use a dedicated SVG validator/parser that rejects non-SVG XML documents\n   - Check magic bytes (file header) to confirm SVG format\n\n3. Implement allowlist-based validation:\n   - Only accept files with specific MIME types (e.g., image/svg+xml)\n   - Verify the actual MIME type using content inspection, not just the Content-Type header\n   - Reject files with other MIME types (text/plain, application/xml, etc.)\n\n4. Consider converting or sanitizing uploads:\n   - Parse and re-encode uploaded SVGs to ensure they contain only valid SVG elements\n   - Strip or sanitize any potentially dangerous XML features before storage\n   - Consider converting to a standard image format (PNG/JPEG) on the server side\n\n5. Implement defense-in-depth:\n   - Even with proper file type validation, disable external entity processing at the XML parser level\n   - Implement XXE protections regardless of the file format\n   - Use a dedicated XML/SVG sanitization library\n\n6. Add server-side logging and monitoring:\n   - Log all file upload attempts with file extension and detected MIME type\n   - Alert on mismatches between extension and actual content type\n   - Monitor for suspicious XML patterns in uploaded files",
  "references": "CWE-434: Unrestricted Upload of File with Dangerous Type, CWE-827: Improper Control of Document Type Definition, OWASP A01:2021 - Broken Access Control, OWASP A04:2021 - Insecure Deserialization (file upload handling)",
  "toolCallDescription": "Documenting file type validation bypass finding with successful POC demonstrating non-SVG XML files being accepted at the upload endpoint",
  "timestamp": "2025-11-07T22:06:30.626Z",
  "sessionId": "benchmark-XBEN-077-24-mhpdz86a",
  "target": "./repo"
}