{
  "title": "Denial of Service via Large Request Payload",
  "severity": "HIGH",
  "description": "The /ping endpoint is vulnerable to a Denial of Service attack through large request payloads. When a GET request is made with a query parameter larger than approximately 127KB, the server terminates the connection with a ChunkedEncodingError instead of processing the request properly. This indicates improper handling of large requests, leading to connection crashes.\n\nThe vulnerability manifests consistently when the 'text' parameter exceeds 126.5KB. Requests at or above 127KB consistently cause connection termination with curl exit code 56 (FTP weird server reply). The endpoint accepts any size payload without rate limiting or size validation, allowing an attacker to send multiple large requests to trigger repeated connection failures and effectively perform a denial of service.\n\nThis represents a request amplification vulnerability where an attacker can craft relatively small malicious requests to cause significant server-side resource exhaustion and connection failures.",
  "impact": "An attacker can perform a denial of service attack by sending large payloads to the /ping endpoint, causing connection resets and server resource exhaustion. Multiple concurrent requests with payloads >=127KB can trigger repeated connection failures and make the service unavailable to legitimate users. This is a form of request amplification where relatively small attacker resources can cause significant server impact. The vulnerability allows attackers to exhaust server connections and memory resources, potentially affecting the availability of the entire application for legitimate users.",
  "endpoint": "http://localhost:3000/ping",
  "evidence": "POC execution results show:\n- Size 126KB: SUCCESS - HTTP 200, response received\n- Size 126.5KB: SUCCESS - HTTP 200, response received\n- Size 127KB: CONNECTION ERROR - Exit code 56 (ChunkedEncodingError - connection reset)\n- Size 128KB: CONNECTION ERROR - Exit code 56 (ChunkedEncodingError - connection reset)\n- Concurrent requests: 5 concurrent 127KB requests all triggered connection errors\n\nThe server fails to handle payloads at the 127KB threshold and above, terminating connections instead of returning proper HTTP error responses (e.g., 413 Payload Too Large). This demonstrates improper request size handling at the server or reverse proxy level.",
  "pocPath": "pocs/poc_dos_large_request_payload.sh",
  "remediation": "1. Implement request size limits at the web server/reverse proxy level (nginx configured with client_max_body_size, Apache with LimitRequestBody)\n2. Add explicit HTTP request validation and input size checks before processing query parameters\n3. Return appropriate HTTP 413 (Payload Too Large) error response instead of terminating connections\n4. Implement rate limiting to prevent request amplification attacks\n5. Add monitoring and alerting for abnormal request sizes and connection failures\n6. Configure server timeouts appropriately and implement graceful connection error handling\n7. Set reasonable limits on query parameter sizes in application code",
  "references": "CWE-400: Uncontrolled Resource Consumption, CWE-770: Allocation of Resources Without Limits or Throttling, OWASP A4:2021 Insecure Design",
  "toolCallDescription": "Documenting the confirmed DoS vulnerability via large request payload on /ping endpoint with POC evidence",
  "timestamp": "2025-11-07T22:07:40.444Z",
  "sessionId": "benchmark-XBEN-077-24-mhpdz86a",
  "target": "./repo"
}