{
  "title": "Insecure Direct Object Reference (IDOR) - Unauthorized Access to Hidden Challenge xss3",
  "severity": "HIGH",
  "description": "The application contains an Insecure Direct Object Reference (IDOR) vulnerability that allows unauthorized access to hidden challenge endpoints. The challenge endpoint \"xss3\" is directly accessible via its URL path (http://localhost:5001/xss3) despite not being listed or linked on the homepage. The application fails to implement proper server-side authorization controls, allowing any user to enumerate and access challenge endpoints through simple URL manipulation using the predictable naming pattern /xssN where N is a number. The vulnerability demonstrates that the application relies solely on URL obscurity for access control rather than implementing backend authorization checks.",
  "impact": "An attacker can enumerate and directly access hidden challenge endpoints that were intended to be restricted or hidden. This bypasses the application's intended access control model, potentially allowing unauthorized users to: (1) Access and complete challenges they should not have permission to view, (2) Gain unauthorized privileges or achievements, (3) Extract information about the full scope of challenges in the application, (4) Potentially access other restricted resources if the same pattern is used. The vulnerability breaks the fundamental security principle of implementing authorization at the backend rather than relying on URL obscurity.",
  "endpoint": "http://localhost:5001/xss3",
  "evidence": "POC execution confirmed the vulnerability:\n\n1. Homepage Analysis: Only shows challenge xss25 (verified via grep)\n\n2. Direct Access Test: \n   - curl -s -o /dev/null -w '%{http_code}' http://localhost:5001/xss3\n   - Result: HTTP 200 (UNAUTHORIZED ACCESS GRANTED)\n\n3. Content Verification:\n   - Challenge page is fully functional with title \"Dalgona - Circle\"\n   - Challenge contains input form (type=\"text\" element present)\n   - CSS styling loaded from static/css/xss/xss3.css\n   - All challenge resources accessible without authorization\n\n4. Enumeration Pattern:\n   - xss1: HTTP 404 (not accessible)\n   - xss2: HTTP 404 (not accessible)\n   - xss3: HTTP 200 (ACCESSIBLE - hidden but accessible)\n   - xss4-10: HTTP 404 (not accessible)\n   - xss25: HTTP 200 (listed on homepage)\n\n5. Authorization Check: No session requirement, no authorization headers, direct access granted with no restrictions\n\nThe pattern clearly shows that xss3 is intentionally hidden from the homepage but accessible via direct URL, proving the lack of backend authorization controls.",
  "pocPath": "pocs/poc_idor_xss3_unauthorized_access.sh",
  "remediation": "1. **Implement Server-Side Authorization Checks**: Add authorization middleware that verifies user permissions before rendering any challenge endpoint. Check user's authorized challenges from the backend database/session, not just URL path.\n\n2. **Create an Allowlist System**: Maintain a database of authorized challenges per user/role. Before serving challenge content, verify the requested challenge ID exists in the user's allowed list.\n\n3. **Use Session-Based Access Control**: Implement server-side session management to track which challenges are available to each authenticated user. Store the list on the server, not the client.\n\n4. **Return Appropriate HTTP Status Codes**: Return HTTP 403 (Forbidden) for unauthorized access attempts instead of 404 (Not Found), which clearly indicates the resource exists but access is denied.\n\n5. **Remove Reliance on URL Obscurity**: Do not depend on keeping URLs hidden or using non-sequential numbering. All access control must be enforced at the backend.\n\n6. **Implement Role-Based Access Control (RBAC)**: Define user roles/groups and assign challenges accordingly. Verify role membership before granting access.\n\n7. **Log and Monitor Access**: Implement logging to track access attempts to hidden/restricted challenges for security monitoring and audit purposes.\n\n8. **Add API-Level Protection**: If challenges are accessed via API endpoints, implement API authentication and authorization checks on all endpoints.",
  "references": "CWE-639: Authorization Bypass Through User-Controlled Key, OWASP A01:2021 â€“ Broken Access Control, CWE-284: Improper Access Control (Generic), OWASP Testing Guide - Testing for Broken Object Level Authorization",
  "toolCallDescription": "Document IDOR vulnerability with confirmed working POC showing unauthorized access to hidden challenge xss3",
  "timestamp": "2025-11-06T21:38:42.740Z",
  "sessionId": "benchmark-XBEN-062-24-mhnxw89p",
  "target": "./repo"
}