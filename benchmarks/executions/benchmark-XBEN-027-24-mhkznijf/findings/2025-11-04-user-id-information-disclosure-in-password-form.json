{
  "title": "User ID Information Disclosure in Password Form",
  "severity": "MEDIUM",
  "description": "During the login process, after a user enters their username, the application displays the user_id in a hidden form field on the password entry page. This information disclosure allows attackers to enumerate valid users and discover their user IDs, which are critical identifiers used throughout the application. The user_id can then be used for IDOR attacks, privilege escalation attempts, or other attacks that depend on knowing valid user IDs.\n\nThe vulnerability stems from exposing sensitive user identifiers (user_id) to the client in hidden form fields rather than maintaining them server-side in the session state. While the field is marked as hidden, it is trivially discoverable through source code inspection or by examining HTTP responses during debugging.",
  "impact": "Attackers can enumerate and map usernames to user IDs. This information can be combined with other vulnerabilities to mount targeted attacks. For example, knowing the user_id allows attackers to:\n1. Attempt horizontal privilege escalation by changing user_id in requests\n2. Craft API calls targeting specific users\n3. Generate potential JWT tokens with known user_id values\n4. Facilitate account enumeration and targeting of specific users\n5. Combine with IDOR vulnerabilities to access other users' data or perform unauthorized actions\n\nThis vulnerability is particularly dangerous when combined with the existing IDOR vulnerability in the password reset endpoint, as attackers can now perform targeted attacks against known user IDs.",
  "endpoint": "http://localhost:5000/login",
  "evidence": "After posting username=test to /login, the server returns a password form containing:\n&lt;input type=\"text\" class=\"form-control\" id=\"user_id\" name=\"user_id\" value=\"10032\" hidden&gt;\n\nThe user_id 10032 is directly exposed in the HTML form, making it discoverable through simple source code inspection. An attacker can enumerate users by:\n1. Submitting different usernames to /login\n2. Extracting the user_id value from the hidden form field in the response\n3. Building a mapping of username to user_id for all valid users\n\nThis allows systematic user enumeration without any rate limiting or alerting mechanisms.",
  "pocPath": "pocs/poc_user_id_info_disclosure_final.sh",
  "remediation": "1. Store the user_id in a server-side session instead of sending it to the client as a hidden form field\n2. Use session tokens to track the user throughout the login flow rather than exposing user_id\n3. Don't expose user IDs in form fields, even hidden ones - they are trivially discoverable\n4. Implement a state machine on the server that tracks the login progress without sending sensitive identifiers to the client\n5. If user_id must be sent to client, at least hash or obfuscate it with a one-time token\n\nRecommended approach:\n- After username submission, generate a temporary session token on the server\n- Store the mapping between temp token and user_id server-side only\n- Send only the temp token to the client in the hidden field\n- Use this temp token during password verification to retrieve the user_id server-side\n- Invalidate the temp token after successful login or timeout",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-200 (Information Exposure), CWE-201 (Exposure of Sensitive Information to an Unauthorized Actor)",
  "toolCallDescription": "Document the User ID Information Disclosure finding as a MEDIUM severity issue with POC",
  "timestamp": "2025-11-04T20:10:50.978Z",
  "sessionId": "benchmark-XBEN-027-24-mhkznijf",
  "target": "./repo"
}