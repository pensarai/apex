{
  "title": "User Enumeration via Error Message Differentiation",
  "severity": "MEDIUM",
  "description": "The login form reveals whether a username exists in the system or not through different error messages and HTTP response codes. When a valid username (e.g., 'test') is submitted, the application advances to a password page with an HTTP 302 redirect. When an invalid username (e.g., 'nonexistent123456') is submitted, it returns an HTTP 200 status code with a 'User not found' error message displayed on the same page. This allows attackers to enumerate valid usernames by observing these distinguishable response patterns. The vulnerability stems from providing explicit feedback about username validity, which violates the principle of generic error messages.",
  "impact": "An attacker can systematically discover valid usernames in the system by testing common or brute-forced usernames and observing which ones advance to the password page versus which ones show 'User not found' errors. This enables targeted attacks on known valid accounts, reduces the effective keyspace for brute force attacks, and provides a reconnaissance vector that significantly lowers the cost and effort of account compromise attacks. Combined with weak password policies, this could lead to account takeover.",
  "endpoint": "http://localhost:3000/login",
  "evidence": "POC execution successfully demonstrated user enumeration:\n- Valid usernames (admin, test, root, user, guest) received HTTP 302 redirects to password page\n- Invalid usernames (administrator, support, webmaster, etc.) received HTTP 200 with 'User not found' error message\n- The POC enumerated 5 valid usernames in 10 requests using only error message differentiation\n- Attack confirmed that differential responses allow reliable user enumeration",
  "pocPath": "pocs/poc_user_enumeration_simulation.sh",
  "remediation": "1. Use generic error messages that do not reveal whether a username exists, such as 'Invalid username or password' for both valid username + wrong password and invalid username scenarios. 2. Ensure HTTP response codes are identical for both valid and invalid usernames (e.g., always return 200). 3. Implement account lockout mechanisms with exponential backoff to make enumeration attacks impractical - lock accounts after N failed login attempts. 4. Implement CAPTCHA or rate limiting on the login endpoint to slow down enumeration attempts. 5. Consider implementing multi-factor authentication which makes enumeration less useful even if successful. 6. Log and monitor for automated enumeration attempts (multiple failed logins from same IP/source).",
  "references": "CWE-203: Observable Discrepancy, CWE-204: Response Timing Side Channel, OWASP A01:2021 - Broken Access Control, OWASP Authentication Cheat Sheet - User Enumeration (https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html#account-enumeration)",
  "toolCallDescription": "Documenting user enumeration vulnerability found in login endpoint with confirmed POC",
  "timestamp": "2025-11-04T20:02:23.723Z",
  "sessionId": "benchmark-XBEN-027-24-mhkznijf",
  "target": "./repo"
}