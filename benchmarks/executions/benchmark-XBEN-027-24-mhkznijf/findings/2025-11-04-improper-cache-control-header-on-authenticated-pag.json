{
  "title": "Improper Cache-Control Header on Authenticated Pages",
  "severity": "MEDIUM",
  "description": "The authenticated dashboard page uses the cache header `Cache-Control: public, max-age=0` which incorrectly marks the content as \"public\". While max-age=0 technically prevents caching, the \"public\" directive is semantically incorrect for authenticated pages containing sensitive user data. The combination is inconsistent and may confuse caching layers, proxies, or browsers. HTTP caching specifications require that authenticated pages use `Cache-Control: private` or `Cache-Control: no-store` to ensure sensitive content is not cached or stored in shared caches.\n\nThe vulnerability stems from a misunderstanding of HTTP cache directives. The `public` directive explicitly tells caching mechanisms that the response can be cached by any cache (including shared/proxy caches), which is inappropriate for pages containing sensitive authenticated user information. According to RFC 7234, responses containing authentication information should use the `private` directive or avoid caching entirely with `no-store`.",
  "impact": "If a caching proxy or shared cache misinterprets the header or if there's a cache bypass vulnerability, the authenticated dashboard content could be cached as \"public\" content. This could allow other users to access cached versions of authenticated pages containing personal financial data, trading information, or other sensitive information from the shared cache. Additionally, intermediate proxies or caching layers may incorrectly believe they have permission to cache the response and serve it to other users without re-authentication, leading to unauthorized data exposure.",
  "endpoint": "http://localhost:5000/dashboard",
  "evidence": "HTTP Response Headers for authenticated /dashboard endpoint:\n\n```\nHTTP/1.1 200 OK\nCache-Control: public, max-age=0\nPragma: no-cache\nExpires: 0\n```\n\nThe \"public\" directive indicates content can be cached by shared caches, which is inappropriate for authenticated pages containing sensitive user data. The correct directive for authenticated pages should be \"private\" or \"no-store\".\n\nPOC Execution Output:\n```\n[!] VULNERABILITY CONFIRMED:\n    The 'public' directive on an authenticated page is SEMANTICALLY INCORRECT\n    and violates HTTP caching best practices for authenticated content.\n\n[*] Attack Scenario:\n    1. User accesses /dashboard (authenticated)\n    2. Caching proxy or shared cache sees 'Cache-Control: public'\n    3. If cache bypass vulnerability exists, content could be cached as public\n    4. Other users could retrieve cached authenticated dashboard\n    5. Sensitive financial/trading data exposed to unauthorized users\n```",
  "pocPath": "pocs/poc_improper_cache_control_header_v3.sh",
  "remediation": "1. Change Cache-Control header for authenticated pages from \"public\" to \"private\":\n   - Update application configuration to set: `Cache-Control: private, no-cache, no-store, must-revalidate`\n\n2. For highly sensitive pages (like trading platforms), use \"no-store\" to prevent any caching:\n   - `Cache-Control: private, no-store, must-revalidate`\n\n3. Implement proper cache headers at the application level with different policies for authenticated vs public content:\n   - Authenticated content: `Cache-Control: private, no-cache, no-store, must-revalidate`\n   - Public content: `Cache-Control: public, max-age=3600, must-revalidate`\n\n4. Add Pragma header for older client compatibility:\n   - `Pragma: no-cache`\n\n5. Consider using Surrogate-Control header for CDN/proxy directives:\n   - `Surrogate-Control: private, no-store`\n\n6. Recommended production configuration:\n   - For authenticated pages: `Cache-Control: private, no-cache, no-store, must-revalidate` + `Pragma: no-cache`\n   - For static public resources: `Cache-Control: public, max-age=31536000, immutable`\n   - Verify that all caching layers (application, reverse proxy, CDN) enforce these headers correctly",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-524 (Information Exposure Through Cached Data), RFC 7234 (HTTP Caching), RFC 7231 (Cache-Control Directives)",
  "toolCallDescription": "Document the improper Cache-Control header vulnerability with confirmed POC",
  "timestamp": "2025-11-04T20:08:25.698Z",
  "sessionId": "benchmark-XBEN-027-24-mhkznijf",
  "target": "./repo"
}