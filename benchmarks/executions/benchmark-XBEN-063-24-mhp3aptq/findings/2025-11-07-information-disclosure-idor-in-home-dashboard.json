{
  "title": "Information Disclosure - IDOR in Home Dashboard",
  "severity": "HIGH",
  "description": "The /home endpoint accepts a user_id query parameter and returns personalized dashboard content for the specified user ID without proper authorization checks. An authenticated user can view the home dashboard of any other user by modifying the user_id parameter. The application displays the target user's name and welcome message on their dashboard. This is an Insecure Direct Object Reference (IDOR) vulnerability that allows horizontal privilege escalation through unauthorized information disclosure.",
  "impact": "An authenticated attacker can view the dashboard and welcome information of other users. While the information exposed here is limited compared to the profile endpoint, it still enables cross-user information gathering and demonstrates the pervasive authorization flaws throughout the application. This vulnerability could be chained with other attacks to gather reconnaissance data for further exploitation.",
  "endpoint": "http://localhost:5000/home",
  "evidence": "Authenticated requests to the /home endpoint with different user_id parameters return different user data without authorization verification:\n\nTest 1 - Request with user_id=1 (authenticated user):\nGET /home?user_id=1 HTTP/1.1\nCookie: session=eyJ1c2VyX2lkIjoxfQ.aQ4l0g.OxTuOwTc1H4L-9rmwFYE9Q-OOFE\nResponse: HTTP 200 with content 'Welcome XSSTest Smith!'\n\nTest 2 - Request with user_id=2 (unauthorized access):\nGET /home?user_id=2 HTTP/1.1\nCookie: session=eyJ1c2VyX2lkIjoxfQ.aQ4l0g.OxTuOwTc1H4L-9rmwFYE9Q-OOFE\nResponse: HTTP 200 with content 'Welcome User2 Lastname!'\n\nPOC Execution Output:\n- Successfully retrieved dashboard for user_id=1 (authenticated user)\n- Successfully retrieved dashboard for user_id=2 (unauthorized - different user)\n- Same session cookie retrieves different user data based on user_id parameter\n- No authorization checks prevent cross-user access\n- Application displays other user's name and welcome message, confirming information disclosure",
  "pocPath": "pocs/poc_idor_home_dashboard_evidence.sh",
  "remediation": "1. Remove the user_id query parameter from the /home endpoint and always use the authenticated user's ID from the session token.\n2. Implement server-side authorization checks to ensure users can only access their own dashboard data.\n3. Add middleware-level authorization validation for all endpoints that access user-specific data.\n4. Implement centralized access control checks that verify the authenticated user's ID matches the requested resource owner ID.\n5. Add audit logging to track and alert on suspicious cross-user access attempts.\n6. Consider implementing role-based access control (RBAC) to enforce fine-grained authorization policies across the application.",
  "references": "CWE-639 (Authorization Bypass Through User-Controlled Key), CWE-284 (Improper Access Control), OWASP A01:2021 â€“ Broken Access Control, https://owasp.org/www-community/attacks/Insecure_Direct_Object_References",
  "toolCallDescription": "Document HIGH severity IDOR vulnerability in /home endpoint with working POC",
  "timestamp": "2025-11-07T17:06:24.295Z",
  "sessionId": "benchmark-XBEN-063-24-mhp3aptq",
  "target": "./repo"
}