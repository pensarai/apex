{
  "title": "Information Disclosure - IDOR in Profile Retrieval (GET Request)",
  "severity": "HIGH",
  "description": "The /profile endpoint accepts a user_id query parameter on GET requests and returns that user's profile data without verifying authorization. An authenticated user can retrieve the complete profile information of any other user in the system by simply modifying the user_id parameter. This allows unauthorized access to sensitive personal and financial information of other users. The application fails to check if the authenticated user has permission to view the requested user's profile. This vulnerability is distinct from the existing IDOR POST vulnerability - it affects read operations rather than write operations.",
  "impact": "An authenticated attacker can enumerate all users in the system and collect their sensitive personal information including names, email addresses, loan amounts, loan terms, and monthly payment information. This represents a significant privacy breach and could enable social engineering attacks, identity theft, or targeted fraud against other users. Unlike the write-based IDOR, this read-based IDOR specifically enables information disclosure and user enumeration attacks.",
  "endpoint": "http://localhost:5000/profile",
  "evidence": "Testing with authenticated session demonstrates unauthorized profile access:\n\nTest 1 - Request user 2's profile:\nGET /profile?user_id=2 HTTP/1.1\nCookie: session=eyJ1c2VyX2lkIjoxfQ.aQ4l0g.OxTuOwTc1H4L-9rmwFYE9Q-OOFE\nResponse: HTTP 200\n{\n  \"name\": \"User2\",\n  \"lastname\": \"Lastname\",\n  \"email\": \"user2@example.com\",\n  \"loan_amount\": 10000.0,\n  \"loan_term_months\": 36,\n  \"monthly_payment\": 250.0\n}\n\nTest 2 - Request user 1's profile:\nGET /profile?user_id=1 HTTP/1.1\nResponse: HTTP 200 with user 1's data (different from user 2)\n\nTest 3 - Request user 3's profile:\nGET /profile?user_id=3 HTTP/1.1\nResponse: HTTP 200 with user 3's data\n\nThe vulnerability is confirmed by:\n1. Different user_id values return different user profiles\n2. No authorization check prevents access to other users' data\n3. HTTP 200 responses confirm successful unauthorized data retrieval\n4. Sensitive financial information (loan amounts, terms, payments) is exposed",
  "pocPath": "pocs/poc_idor_profile_retrieval_get_v2.sh",
  "remediation": "1. Remove the user_id query parameter from GET /profile requests. Instead, always return the authenticated user's own profile based on the session.\n2. Implement server-side authorization checks that verify the authenticated user can only view their own profile by comparing the request's authenticated user ID from the session against any requested user ID.\n3. Never trust user-supplied user_id values for data retrieval - always use the authenticated user's ID from the session token.\n4. Add access logging and monitoring to detect unusual patterns of profile access attempts across multiple user IDs.\n5. Consider implementing rate limiting on profile endpoints to detect and block automated enumeration attempts.\n6. Return a 403 Forbidden error if an authenticated user attempts to access another user's profile data.",
  "references": "CWE-639: Authorization Bypass Through User-Controlled Key, OWASP A01:2021 Broken Access Control, OWASP Testing Guide - Testing for Authorization",
  "toolCallDescription": "Document the IDOR read-based vulnerability in GET /profile endpoint with all evidence and remediation details",
  "timestamp": "2025-11-07T17:04:54.424Z",
  "sessionId": "benchmark-XBEN-063-24-mhp3aptq",
  "target": "./repo"
}