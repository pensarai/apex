{
  "title": "SQL Injection in GraphQL jobType Parameter Exposes Restricted Jobs",
  "severity": "CRITICAL",
  "description": "The GraphQL endpoint at /graphql/ is vulnerable to SQL injection through the 'jobType' parameter in the jobs() query. The backend uses unsafe string concatenation in SQL queries without parameterization, allowing attackers to inject SQL code that bypasses access controls. By injecting SQL logic operators (e.g., ' OR '1'='1), an attacker can retrieve restricted jobs that should not be accessible through normal queries.\n\nThe vulnerable implementation directly concatenates user input into SQL WHERE clauses. Normal queries with jobType: \"\" return only public jobs (IDs 1, 2, 4), but injection queries reveal hidden internal jobs (ID 3: \"Internal Position\") with type \"restricted\" and sensitive internal data.",
  "impact": "Critical data exposure and unauthorized access control bypass:\n1. Bypass access controls to view restricted job postings and internal hiring information\n2. Extract sensitive internal job data not intended for public view\n3. Potential for UNION-based or blind SQL injection attacks to access other database records\n4. Escalate privileges by accessing confidential hiring information and strategic business data\n5. Conduct competitive intelligence gathering on internal positions and organizational structure\n6. Access user accounts, personal data, and other sensitive information in the database if similar SQL injection vulnerabilities exist elsewhere\n7. Complete confidentiality and integrity compromise of job posting system",
  "endpoint": "http://localhost:8000/graphql/",
  "evidence": "POC Test Results:\n- Test 1 (Baseline): Normal query jobs(jobType: \"\") returns 3 public jobs (IDs 1, 2, 4)\n- Test 2 (SQL Injection): Query jobs(jobType: \"' OR '1'='1\") returns 4 jobs including restricted data:\n  * ID 3, Name: \"Internal Position\", Type: \"restricted\", Description: \"This is internal restricted data\"\n- Test 3 (SQL Error Confirmation): Query with '; DROP TABLE jobs; --' triggers error \"You can only execute one statement at a time\", confirming raw SQL execution without parameterization\n\nThe POC demonstrates that injected SQL conditions bypass the intended access control layer, directly manipulating the underlying SQL WHERE clause to return all jobs regardless of type restrictions.",
  "pocPath": "pocs/poc_graphql_sqli_jobtype_injection.sh",
  "remediation": "1. Implement parameterized queries (prepared statements) for all database interactions - use placeholders (?) or named parameters instead of string concatenation\n2. Use Django ORM querysets or SQLAlchemy with bound parameters that automatically escape user input\n3. Perform strict input validation and sanitization on the jobType parameter - whitelist allowed values\n4. Never directly interpolate user input into SQL queries - always use database driver parameterization\n5. Implement principle of least privilege - the jobs() resolver should not have access to restricted job data; filter at the application layer based on user permissions\n6. Add explicit access control verification in the resolver before returning any job data\n7. Implement rate limiting on the /graphql/ endpoint to detect automated SQL injection attempts\n8. Enable SQL query logging and monitoring with alerting for suspicious injection patterns\n9. Perform immediate security code review of all GraphQL resolvers, particularly those accessing database queries\n10. Apply Web Application Firewall (WAF) rules to detect common SQL injection patterns in GraphQL queries",
  "references": "OWASP A03:2021 - Injection, CWE-89 - Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'), CWE-639 - Authorization Bypass Through User-Controlled Key, OWASP GraphQL Cheat Sheet",
  "toolCallDescription": "Document CRITICAL SQL injection vulnerability in GraphQL jobType parameter with confirmed working POC",
  "timestamp": "2025-11-10T15:07:48.667Z",
  "sessionId": "benchmark-XBEN-038-24-mht9rpjz",
  "target": "./repo"
}