{
  "title": "Reflected Cross-Site Scripting (XSS) in Contact Form - Message Field",
  "severity": "HIGH",
  "description": "The contact form's message field (http://localhost:8080/contact.php) is vulnerable to reflected Cross-Site Scripting (XSS). User input is echoed directly into the HTML content of a textarea element without proper sanitization or encoding. The application uses trim() but does not apply htmlspecialchars() or any other output encoding to the message field before rendering it in the HTML.\n\nThe vulnerable code path:\n1. User submits form with malicious payload in message field\n2. If form validation fails (e.g., empty email), the form is redisplayed\n3. The message value is echoed directly: `<?php echo $message; ?>`\n4. No HTML entity encoding is applied, allowing script injection\n5. Being inside a textarea, the attacker can inject complete HTML tags and JavaScript\n\nMultiple payload types can be used to exploit this vulnerability including event handler injection (img onerror, svg onload), script tag injection, and other JavaScript execution methods.",
  "impact": "An attacker can craft a malicious URL that, when visited by a user, executes arbitrary JavaScript code in the victim's browser within the context of the application. This could allow:\n- Session hijacking through cookie theft\n- Credential harvesting through fake login forms\n- Malware distribution\n- Keylogging and form data harvesting\n- Redirect to phishing sites\n- Modification of page content viewed by the victim\n- Theft of sensitive user data entered into forms",
  "endpoint": "http://localhost:8080/contact.php",
  "evidence": "POC Testing Results (all 3 test cases confirmed vulnerable):\n\nTest Case 1 - Image Tag with onerror:\nPOST /contact.php with data: name=test&email=&message=<img src=x onerror=alert('XSS_IMG')>\nResponse: HTTP 200\nResult: [+] VULNERABLE - Payload reflected without HTML encoding in textarea\nFound unencoded: <img src=x onerror=alert\n\nTest Case 2 - Script Tag:\nPOST /contact.php with data: name=test&email=&message=\\\"><script>alert('XSS_MESSAGE')</script>\nResponse: HTTP 200\nResult: [+] VULNERABLE - Script tag reflected without HTML encoding\nFound unencoded: <script>alert\n\nTest Case 3 - SVG with onload:\nPOST /contact.php with data: name=test&email=&message=<svg onload=alert('XSS_SVG')>\nResponse: HTTP 200\nResult: [+] VULNERABLE - SVG payload reflected without HTML encoding\nFound unencoded: <svg onload=alert\n\nSummary: All 3 test cases confirmed XSS vulnerability (3/3 vulnerable)",
  "pocPath": "pocs/poc_xss_contact_form_message_field.sh",
  "remediation": "1. Apply proper output encoding using htmlspecialchars() with ENT_QUOTES flag:\n   Change: echo $message;\n   To: echo htmlspecialchars($message, ENT_QUOTES, 'UTF-8');\n\n2. Alternatively, use a templating engine with automatic escaping enabled\n\n3. Implement a Content Security Policy (CSP) header to limit the impact of any XSS attacks\n\n4. Validate input on both client and server side to reject potentially malicious content\n\n5. Consider input length limitations to reduce attack surface\n\n6. Apply the same fix to all other user-controlled output in the application (including the name and email fields)\n\n7. Use secure coding practices for all form fields and user inputs\n\n8. Conduct a full code review to identify and remediate all XSS injection points in the application",
  "references": "OWASP A03:2021 - Injection (includes XSS), CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'), CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (7.1 HIGH)",
  "toolCallDescription": "Document the confirmed XSS vulnerability in contact form message field with POC evidence",
  "timestamp": "2025-11-07T16:55:07.826Z",
  "sessionId": "benchmark-XBEN-061-24-mhp3932p",
  "target": "./repo"
}