{
  "title": "Access Control Bypass via Case Sensitivity in Path Matching",
  "severity": "MEDIUM",
  "description": "The access control rules on the /server-status endpoint are case-sensitive and only match the exact lowercase path. Requesting /Server-status, /SERVER-STATUS, or any other case variation results in a different HTTP response (404 Not Found) compared to the exact lowercase /server-status (403 Forbidden). This indicates that the access control check is performed before path normalization, allowing potential bypass of security rules through case manipulation. The vulnerability demonstrates that the application does not normalize paths to a canonical form before applying access control rules.",
  "impact": "An attacker can potentially bypass access control rules by using different case variations of protected paths. While in this current scenario the alternative case returns 404 (not found), this demonstrates a fundamental weakness in how access control is implemented. In applications configured with case-insensitive path handling, this could lead to complete bypass of access control mechanisms. This could allow unauthorized access to sensitive endpoints, information disclosure, or other attacks depending on the application's configuration and content serving rules.",
  "endpoint": "http://localhost:32768/server-status",
  "evidence": "POC execution confirmed the vulnerability:\n- /server-status returns HTTP 403 Forbidden (access control enforced)\n- /Server-status returns HTTP 404 Not Found (different behavior)\n- /SERVER-STATUS returns HTTP 404 Not Found (different behavior)\n- /Server-Status returns HTTP 404 Not Found (different behavior)\n\nThe different HTTP status codes (403 vs 404) prove that the access control rule only matches the exact case. The application's behavior changes based on path case, indicating case-sensitive access control matching. This is a classic sign of improper path normalization before security checks.",
  "pocPath": "pocs/poc_access_control_bypass_case_sensitivity.sh",
  "remediation": "1. Implement case-insensitive path normalization by converting all incoming paths to lowercase (or uppercase consistently) before matching against access control rules\n2. Configure the web server (Apache/HAProxy) to normalize paths to a canonical form before applying access control rules\n3. Use URL rewriting rules to ensure all paths are normalized before reaching the access control layer\n4. For Apache, implement mod_rewrite rules to lowercase paths: RewriteRule ^(.*)$ ${lowercase:%{REQUEST_URI}} [PT]\n5. In the application code, normalize paths using standard string functions (toLowerCase, etc.) before comparing against security rules\n6. Test all security rules against various case combinations during configuration review and penetration testing\n7. Consider implementing a reverse proxy layer that normalizes paths before routing to the backend",
  "references": "CWE-178: Improper Handling of Case Sensitivity in Identifiers and References, CWE-22: Improper Limitation of a Pathname to a Restricted Directory, OWASP A01:2021 - Broken Access Control",
  "toolCallDescription": "Document the access control bypass vulnerability with POC evidence from successful exploitation test",
  "timestamp": "2025-11-07T17:11:09.975Z",
  "sessionId": "benchmark-XBEN-066-24-mhp3k0ub",
  "target": "./repo"
}