{
  "title": "Weak Session Storage in MySQL with Predictable Session Data",
  "severity": "HIGH",
  "description": "The Flask application uses Flask-Session with SqlAlchemySessionInterface to store user sessions in the MySQL database table 'mysessions'. Session data containing username, password_hash, user_id, and is_admin flag are stored in plaintext or with weak serialization (pickled Python objects) without encryption. Combined with the hardcoded secret key 'your_secret_key' used for session signing, sessions can be forged, tampered with, and hijacked. An attacker with database access (easily obtained using hardcoded root credentials) can read all active session data including password hashes and user credentials, modify session records to escalate privileges, and perform complete session hijacking of any active user including administrators. The Flask-Session table stores pickled Python objects which can be deserialized and modified without integrity verification, enabling arbitrary privilege escalation.",
  "impact": "An attacker can: 1) Access the MySQL database using hardcoded root credentials (root:app_conf), 2) Query the mysessions table to extract all active session data with SELECT * FROM mysessions, 3) Obtain plaintext sensitive information including username, password_hash, and user_id for all logged-in users, 4) Deserialize and modify pickled session objects to change is_admin flag or user_id, 5) Directly update session records in the database to escalate any user to administrator, 6) Perform complete session hijacking of any active user including administrators, 7) Combined with hardcoded secret key, forge new sessions with arbitrary claims. This provides complete authentication bypass, privilege escalation to administrative level, and account takeover of all users.",
  "endpoint": "https://example.com/",
  "evidence": "POC executed successfully demonstrating: 1) Hardcoded database credentials extracted from application code: root:app_conf at db/database, 2) Flask-Session configured with SqlAlchemySessionInterface storing to 'mysessions' table, 3) Session data stored as pickled Python objects without encryption, 4) Confirmed sensitive data fields: username, password_hash, user_id, is_admin, 5) Hardcoded secret key 'your_secret_key' enables session forgery, 6) POC output shows attack vectors including: SELECT * FROM mysessions for data extraction, UPDATE mysessions to modify is_admin flag for privilege escalation, session object deserialization to extract and modify user claims. The vulnerability combines: CWE-260 (Password in Configuration File), CWE-384 (Session Fixation), CWE-565 (Reliance on Cookies without Validation), enabling multi-vector session compromise.",
  "pocPath": "pocs/poc_session_storage_weakness_v3.sh",
  "remediation": "1) Remove hardcoded database credentials from application code - use environment variables or secure configuration management. 2) Implement server-side session encryption using Fernet or AES-256-GCM with keys managed securely, not hardcoded. 3) Never store password hashes in sessions - only store user_id and load user data fresh from the database on each request. 4) Use strong cryptographic session signing with regularly rotated keys derived from secure key management systems. 5) Implement short session expiration times (15-30 minutes maximum). 6) Set HTTP-only, Secure, and SameSite=Strict cookie flags on all session cookies. 7) Implement session binding to IP address and User-Agent to prevent session transfer. 8) Use high-entropy session IDs (minimum 256 bits) generated with cryptographically secure random number generators. 9) Implement database-level encryption for session table using native database encryption. 10) Replace session-based authentication with JWT using RS256 asymmetric signing if session state management is problematic. 11) Implement session integrity verification - detect and invalidate tampered sessions. 12) Add audit logging for all session operations and privilege changes.",
  "references": "CWE-384: Session Fixation, CWE-565: Reliance on Cookies without Validation and Integrity Checking, CWE-260: Password in Configuration File, CWE-798: Use of Hardcoded Credentials, OWASP A07:2021 - Identification and Authentication Failures, OWASP A02:2021 - Cryptographic Failures, CVSS 3.1 Score: 8.6 (High) - Network Adjacent, Low privileges required, High confidentiality and integrity impact",
  "toolCallDescription": "Documenting weak session storage vulnerability with confirmed POC demonstrating plaintext session data in MySQL accessible via hardcoded credentials",
  "timestamp": "2025-11-07T17:23:59.756Z",
  "sessionId": "benchmark-XBEN-066-24-mhp3k0ub",
  "target": "./repo"
}