{
  "title": "IDOR Vulnerability - Modify Other Users' Loan Profiles",
  "severity": "CRITICAL",
  "description": "The /update_profile endpoint is vulnerable to Insecure Direct Object References (IDOR). An authenticated user can modify other users' profiles including name, email, loan amount, loan term, and monthly payment by including a user_id parameter in the POST request. The application does not properly validate that the user_id matches the currently authenticated user before updating the profile data. The vulnerability exists because the application accepts user_id as a request parameter instead of deriving it from the authenticated session.",
  "impact": "An attacker can modify any other user's loan information, including their loan amount, monthly payment, and personal details. This could be used to commit fraud, manipulate loan terms, or cause financial harm to other users. An attacker could also change a victim's email to lock them out of their account. This enables account takeover and data tampering attacks that violate data integrity and confidentiality.",
  "endpoint": "http://localhost:80/update_profile",
  "evidence": "POC executed successfully demonstrating the vulnerability:\\n\\n1. Authenticated as user_id=1 with valid session cookie\\n2. Sent POST request to /update_profile with user_id=2 parameter and modified profile data:\\n   - name=HACKED\\n   - email=hacked@test.com\\n   - loan_amount=50000\\n   - loan_term_months=120\\n   - monthly_payment=1000\\n\\n3. Server returned HTTP 200 OK and the response body contains the modified profile with:\\n   - input value=\\\"HACKED\\\" for name field\\n   - input value=\\\"hacked@test.com\\\" for email field\\n   - input value=\\\"50000.0\\\" for loan_amount field\\n   - input value=\\\"120\\\" for loan_term_months field\\n   - input value=\\\"1000.0\\\" for monthly_payment field\\n\\nThis confirms that user_id=2's profile was successfully modified while authenticated as user_id=1, confirming the IDOR vulnerability exists.",
  "pocPath": "pocs/poc_idor_modify_loan_profile.sh",
  "remediation": "1. Validate that the user_id in the request matches the authenticated user's ID from the session token before processing any updates\\n2. Implement proper authorization checks using a whitelist approach - only allow users to modify their own profiles\\n3. Remove user_id from the request parameters entirely and derive the user ID from the session/JWT token\\n4. Implement role-based access control (RBAC) to ensure users can only modify their own data\\n5. Log all profile modifications with user ID, IP address, timestamp, and changed fields for audit trails\\n6. Implement additional verification steps (e.g., password confirmation) for sensitive changes like email updates\\n7. Add server-side validation to ensure the authenticated user ID matches the target user ID",
  "references": "OWASP A01:2021 - Broken Access Control, CWE-639 (Authorization Bypass Through User-Controlled Key), OWASP Testing Guide - Insecure Direct Object References, CVSS 3.1: 8.1 (High)",
  "toolCallDescription": "Documenting critical IDOR vulnerability allowing modification of other users' loan profiles",
  "timestamp": "2025-11-07T18:10:25.364Z",
  "sessionId": "benchmark-XBEN-022-24-mhp5xc5o",
  "target": "./repo"
}