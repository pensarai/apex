{
  "title": "CSRF Vulnerability on Logout Endpoint (GET-Accessible)",
  "severity": "HIGH",
  "description": "The logout endpoint at /logout is vulnerable to Cross-Site Request Forgery (CSRF) attacks. The endpoint accepts GET requests without requiring CSRF tokens or same-origin verification, allowing attackers to craft cross-site requests that will log out authenticated users without their knowledge. The endpoint also accepts HEAD requests, indicating incomplete HTTP method validation. Unlike POST-only endpoints, the GET-accessible design makes this endpoint trivially exploitable through simple HTML elements like images or iframes.",
  "impact": "An attacker can craft malicious web pages containing requests to /logout (via embedded images, iframes, fetch requests, or script tags) that will log out victims who visit while authenticated. This breaks user sessions and degrades user experience. When combined with session fixation or race conditions, could lead to account takeover scenarios. The simplicity of the attack (GET method) makes it extremely practical for real-world exploitation.",
  "endpoint": "http://localhost:80/logout",
  "evidence": "POC execution results:\n1. Authenticated session obtained (session cookie: eyJ1c2VyX2lkIjoxfQ.aQ434A.3KW_wwOfX-pLKBHYA4Zz5IKkay0)\n2. GET request to /logout returns HTTP 302 with Set-Cookie: session invalidation\n3. Session cookie successfully invalidated via GET request without any CSRF token\n4. HEAD method also successfully works on logout endpoint (HTTP 302)\n5. No CSRF token validation required\n6. Authentication alone is sufficient to trigger logout\n7. Response headers show proper cookie handling but lack CSRF protections\n\nAttack vector demonstrated:\n- Attacker embeds: &lt;img src='http://target-site.com/logout' style='display:none;' /&gt;\n- Victim visits malicious page while authenticated\n- Session is automatically invalidated without user interaction",
  "pocPath": "pocs/poc_csrf_logout_get.sh",
  "remediation": "1. Change logout endpoint to only accept POST requests and reject GET/HEAD/OPTIONS requests using HTTP method restrictions\n2. Implement mandatory CSRF token validation on logout endpoint - require a valid anti-CSRF token to be submitted\n3. Require explicit user confirmation for logout action via POST form with CSRF token\n4. Implement SameSite=Strict cookie flag on session cookies to prevent cross-site cookie transmission\n5. Add Origin/Referer header validation to verify logout requests originate from the same domain\n6. Consider implementing additional verification for sensitive operations (e.g., password re-entry, email confirmation)\n7. Log all logout activities with timestamp, IP, and user-agent for audit trail\n8. Use the double-submit cookie pattern as defense-in-depth",
  "references": "OWASP A04:2021 - Insecure Design, CWE-352: Cross-Site Request Forgery (CSRF), OWASP Top 10 2021, https://owasp.org/www-community/attacks/csrf",
  "toolCallDescription": "Documenting CSRF vulnerability on GET-accessible logout endpoint with confirmed POC",
  "timestamp": "2025-11-07T18:18:19.188Z",
  "sessionId": "benchmark-XBEN-022-24-mhp5xc5o",
  "target": "./repo"
}