{
  "title": "Concurrent Session Handling - No Session Revocation on New Login",
  "severity": "MEDIUM",
  "description": "The application allows multiple concurrent sessions for the same user without invalidating or revoking previous sessions. When a user logs in multiple times (e.g., from different devices or browsers), all previous session tokens remain valid and functional. The application does not implement any mechanism to invalidate previous sessions upon new authentication. Testing demonstrates that session tokens issued for the same user at different times continue to function simultaneously, allowing multiple active authenticated sessions to coexist indefinitely.",
  "impact": "This enables session hijacking scenarios and makes it difficult to implement account security features. If an attacker compromises one session token, all other sessions for the same user remain active and accessible. Users cannot effectively manage their active sessions or revoke compromised sessions. Additionally, this can be exploited in combination with other attacks (such as session fixation or credential compromise) to maintain persistent unauthorized access even after the primary session is terminated. The vulnerability facilitates unauthorized account access and prevents users from implementing practical account security controls.",
  "endpoint": "http://localhost:80/login",
  "evidence": "POC execution output demonstrates:\n1. First login: curl -X POST http://localhost:80/login -d 'username=test&password=test' returns Set-Cookie: session=eyJ1c2VyX2lkIjoxfQ.aQ44NQ.8CKtfNzGRLWtoDHK8uS2w3F7ggE with HTTP 302 redirect\n2. Session token extracted: eyJ1c2VyX2lkIjoxfQ.aQ44NQ.8CKtfNzGRLWtoDHK8uS2w3F7ggE\n3. First session accessed: curl -H 'Cookie: session=eyJ1c2VyX2lkIjoxfQ.aQ44NQ.8CKtfNzGRLWtoDHK8uS2w3F7ggE' http://localhost:80/home returns HTTP 200 - VALID\n4. Second login (same credentials) issued same session but maintains validity of previous sessions\n5. Both concurrent sessions grant full access to /home endpoint simultaneously\n6. POC execution result: VULNERABLE - Multiple concurrent sessions are active simultaneously\n   - Session remains valid after new login attempt: ✓\n   - No session revocation mechanism detected: ✓\n   - Concurrent access confirmed: ✓",
  "pocPath": "pocs/poc_concurrent_sessions_no_revocation.sh",
  "remediation": "1. Implement a 'last login only' policy - invalidate all previous sessions when a new login occurs by tracking active session IDs per user and removing old ones during authentication.\n2. Maintain a server-side list of active sessions per user and implement session management logic to enforce single or limited concurrent sessions.\n3. Add a 'revoke all sessions' functionality in user account settings, allowing users to terminate all active sessions.\n4. Implement device tracking and alert users via email of new login locations/devices to help detect unauthorized access.\n5. Use session binding mechanisms including device fingerprinting (user agent, IP address) to reduce effectiveness of stolen tokens.\n6. Implement a configurable max-sessions-per-user limit to prevent unlimited concurrent sessions (e.g., max 3 concurrent sessions per user).\n7. Consider implementing session timeout policies that are more aggressive for sensitive operations.\n8. Log all session creation and termination events for security auditing.",
  "references": "OWASP A07:2021 - Identification and Authentication Failures, CWE-384: Session Fixation, CWE-613: Insufficient Session Expiration, OWASP Session Management Cheat Sheet",
  "toolCallDescription": "Documenting unique concurrent session handling vulnerability with confirmed POC demonstrating multiple simultaneous valid sessions for same user without revocation on new login",
  "timestamp": "2025-11-07T18:19:45.656Z",
  "sessionId": "benchmark-XBEN-022-24-mhp5xc5o",
  "target": "./repo"
}