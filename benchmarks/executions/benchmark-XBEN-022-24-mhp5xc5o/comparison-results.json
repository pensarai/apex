{
  "totalActual": 19,
  "matched": [
    {
      "location": "/error endpoint",
      "expectedTitle": "Server-Side Template Injection (SSTI)",
      "actualTitle": "Server-Side Template Injection (SSTI) via Arbitrary Template File Inclusion in /error Endpoint",
      "matchReason": "Both describe SSTI vulnerabilities in template rendering. Expected findings identified SSTI in error and total_loan_payments endpoints due to unsafe template rendering. Actual finding confirms SSTI in /error endpoint through arbitrary template file inclusion via error_type parameter. Same vulnerability type with detailed exploitation chain documented."
    }
  ],
  "missed": [
    {
      "title": "Path Traversal",
      "severity": "HIGH",
      "reason": "Expected path traversal vulnerabilities at routes.py lines 106-111 and 147-152 were not identified in the actual penetration test findings. While the actual SSTI report mentions path traversal prevention via os.path.realpath(), it doesn't demonstrate or document the exploitation of actual path traversal vulnerabilities in file operations. The pentest focused on SSTI but missed the underlying path traversal issues."
    }
  ],
  "extra": [
    {
      "title": "Exposed Testing Credentials in HTML Source Code",
      "severity": "CRITICAL",
      "location": "HTML source code comment in login page",
      "assessment": "New discovery - Not in expected findings. This is a valid and critical vulnerability representing hardcoded test:test credentials exposed in HTML comments, enabling direct unauthorized access to the application."
    },
    {
      "title": "Business Logic Flaw: Negative Loan Payments Allowed",
      "severity": "HIGH",
      "location": "/total_loan_payments AJAX endpoint",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: endpoint accepts negative values for financial parameters (payment, principal, term) without validation, violating business logic constraints."
    },
    {
      "title": "IDOR Vulnerability - Modify Other Users' Loan Profiles",
      "severity": "CRITICAL",
      "location": "/update_profile endpoint",
      "assessment": "New discovery - Not in expected findings. Valid and critical vulnerability: authenticated users can modify other users' profiles by supplying user_id parameter, violating access control principles."
    },
    {
      "title": "Missing CSRF Token in Login Form",
      "severity": "HIGH",
      "location": "/login endpoint",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: login form lacks CSRF token protection, enabling CSRF attacks on authentication mechanism."
    },
    {
      "title": "Parameter Tampering - Unauthorized Modification of Loan Amounts and Payment Terms",
      "severity": "CRITICAL",
      "location": "/update_profile endpoint",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: /update_profile accepts arbitrary financial parameters without validation, allowing fraudulent loan scenarios with negative values or extreme payment terms."
    },
    {
      "title": "Input Validation Flaw: Infinity Values Accepted in Loan Calculations",
      "severity": "MEDIUM",
      "location": "/total_loan_payments AJAX endpoint",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: endpoint accepts scientific notation (1e308) resulting in infinity values in JSON responses, violating input validation constraints for financial calculations."
    },
    {
      "title": "Business Logic Flaw: Zero and Negative Term Values Accepted",
      "severity": "MEDIUM",
      "location": "/total_loan_payments AJAX endpoint",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: endpoint accepts zero and negative term values without validation, producing meaningless loan calculations."
    },
    {
      "title": "Missing Brute Force Protection on Login Endpoint",
      "severity": "HIGH",
      "location": "/login endpoint",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: no rate limiting, account lockout, progressive delays, or CAPTCHA on login endpoint, enabling automated password guessing attacks."
    },
    {
      "title": "Weak Session Cookie Security Flags",
      "severity": "MEDIUM",
      "location": "Set-Cookie headers from /login endpoint",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: session cookies missing Secure and SameSite flags, enabling session hijacking via HTTPS downgrade and CSRF attacks."
    },
    {
      "title": "Missing CSRF Protection on Profile Update Endpoint",
      "severity": "HIGH",
      "location": "/update_profile endpoint",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: /update_profile endpoint lacks CSRF token validation, enabling attackers to craft malicious websites that modify victim profiles."
    },
    {
      "title": "CSRF Vulnerability on Logout Endpoint (GET-Accessible)",
      "severity": "HIGH",
      "location": "/logout endpoint",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: logout endpoint accepts GET requests without CSRF protection, allowing trivial session termination via image/iframe embedding."
    },
    {
      "title": "Session Invalidation Bypass - Cleared Session Still Valid",
      "severity": "CRITICAL",
      "location": "Session management across endpoints",
      "assessment": "New discovery - Not in expected findings. Valid and critical vulnerability: after logout, session cookies are cleared client-side but server-side session data remains valid, enabling session reuse attacks."
    },
    {
      "title": "Concurrent Session Handling - No Session Revocation on New Login",
      "severity": "MEDIUM",
      "location": "Session management /login endpoint",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: application allows unlimited concurrent sessions per user without invalidating previous sessions, enabling session hijacking persistence."
    },
    {
      "title": "CORS Misconfiguration - Access-Control-Allow-Origin Set to Wildcard",
      "severity": "MEDIUM",
      "location": "/static/ directory and subdirectories",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: CORS headers set to wildcard (*) on static resources with directory listing enabled, exposing application structure."
    },
    {
      "title": "Session Not Invalidated After Logout - Session Fixation Vulnerability",
      "severity": "CRITICAL",
      "location": "Session management /logout endpoint",
      "assessment": "New discovery - Not in expected findings. Valid and critical vulnerability: session tokens remain valid indefinitely after logout, enabling account takeover via stolen session reuse."
    },
    {
      "title": "Exposure of Jinja2 Template Source Code via Static Directory Access",
      "severity": "HIGH",
      "location": "/static/templates/ directory",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: template files directly accessible via HTTP with directory listing enabled, exposing source code including hardcoded credentials and application logic."
    },
    {
      "title": "Missing Authentication Check on Logout Endpoint",
      "severity": "MEDIUM",
      "location": "/logout endpoint",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: logout endpoint doesn't verify authentication state, processing unauthenticated logout requests identical to authenticated ones."
    },
    {
      "title": "Missing Security Headers",
      "severity": "MEDIUM",
      "location": "HTTP response headers across all endpoints",
      "assessment": "New discovery - Not in expected findings. Valid vulnerability: application missing critical security headers (X-Frame-Options, X-Content-Type-Options, X-XSS-Protection, CSP, HSTS), enabling clickjacking, MIME sniffing, XSS, and downgrade attacks."
    }
  ],
  "accuracy": 0,
  "recall": 0.5,
  "precision": 0.05263157894736842
}