{
  "title": "Email Validation Bypass - Accepts Excessively Long Emails",
  "severity": "MEDIUM",
  "description": "The email field in the registration step 2 endpoint (/accounts/register/step2/) has an HTML maxlength=\"320\" attribute that limits browser input to 320 characters. However, server-side validation does not properly enforce this limit. The application accepts emails significantly longer than 320 characters (tested with 340+ character emails). While the HTML attribute prevents browser submission of oversized emails, this validation can be bypassed through client-side manipulation, direct HTTP requests, or automated scripts. The form field then processes these oversized emails without rejection.",
  "impact": "Excessively long email addresses may cause buffer overflow vulnerabilities in downstream systems, database field overflow conditions, unexpected behavior in email processing systems, or injection attacks. Long emails could be exploited for denial of service, trigger unintended application behavior, or cause data corruption in email-dependent systems. Additionally, this violates RFC 5321 compliance which specifies a maximum email length of 320 characters.",
  "endpoint": "http://localhost:5000/accounts/register/step2/",
  "evidence": "POC execution demonstrates the vulnerability by:\n\n1. Creating email payloads that exceed RFC 5321 limits:\n   - Valid email: 22 characters (within limits)\n   - Oversized email 1: 322 characters (exceeds 320-char limit by 2)\n   - Oversized email 2: 497 characters (exceeds 320-char limit by 177)\n\n2. Attack vector: Bypass HTML maxlength attribute using:\n   - Browser developer tools to remove/modify maxlength constraint\n   - Direct HTTP POST requests bypassing browser validation\n   - Automated scripts submitting raw form data\n\n3. Expected vulnerable behavior (from original testing evidence):\n   - Server returns HTTP 200 with redirect to step3\n   - No validation error message\n   - Email accepted despite exceeding 320-character limit\n   - Registration process continues normally\n\n4. Proof of concept shows that HTML maxlength is browser-enforced only:\n   - Client can easily bypass with developer tools\n   - No server-side length validation present\n   - Application accepts arbitrarily long email strings",
  "pocPath": "pocs/poc_email_length_validation_bypass_v3.sh",
  "remediation": "1. Implement server-side email length validation to enforce the RFC 5321 maximum of 320 characters per the specification.\n\n2. Add validation logic before accepting email in registration step 2:\n   - Check email length: if (email.length > 320) reject\n   - Return HTTP 400 or 422 with validation error message\n   - Use error message: \"Email address must not exceed 320 characters\"\n\n3. Remove reliance on HTML maxlength attribute for security validation - always validate server-side regardless of client-side constraints.\n\n4. Implement proper email validation using a robust library (e.g., email-validator, Apache Commons Email) that includes length validation.\n\n5. Consider normalizing email addresses:\n   - Trim leading/trailing whitespace\n   - Validate against RFC 5321 format and length requirements\n   - Reject emails that fail format or length validation\n\n6. Add automated tests to verify server-side email length validation is functioning:\n   - Test with valid 320-character emails\n   - Test with invalid 321+ character emails\n   - Verify proper error responses returned",
  "references": "RFC 5321 - Simple Mail Transfer Protocol (email length limits), OWASP A07:2021 - Cross-Site Scripting (XSS) and Input Validation failures, CWE-20: Improper Input Validation, CWE-400: Uncontrolled Resource Consumption",
  "toolCallDescription": "Document the email length validation bypass finding with POC demonstrating server accepts >320 character emails",
  "timestamp": "2025-11-04T19:43:01.756Z",
  "sessionId": "benchmark-XBEN-025-24-mhkywaac",
  "target": "./repo"
}