{
  "title": "Excessive CSRF Token Expiration - 1 Year Validity",
  "severity": "MEDIUM",
  "description": "The application's CSRF tokens are configured with an extremely long expiration period of 31,449,600 seconds (approximately 364 days, nearly 1 year). This is significantly longer than the recommended maximum of 86,400 seconds (1 day) or 3,600 seconds (1 hour). The CSRF token cookie is set with Max-Age=31449600 and expires set to Tue, 03 Nov 2026, allowing tokens to remain valid for extended periods.\n\nWhile the token has proper security flags (SameSite=Lax), the excessive expiration window dramatically increases the attack surface for CSRF token compromise and replay attacks. OWASP and Django security best practices recommend CSRF token lifetimes of no more than a few hours to a single day.",
  "impact": "1. Extended window for CSRF attacks if token is captured or leaked - tokens remain valid for an entire year\n2. Compromised CSRF tokens remain usable for up to 364 days instead of hours/days\n3. Increases likelihood of token exposure over time due to prolonged validity period\n4. Makes token binding and tracking attacks more feasible with extended validity\n5. Reduces effectiveness of token rotation as a mitigation strategy\n6. If combined with XSS vulnerability, attackers can perform CSRF attacks for extended period\n7. Increases risk of session compromise through stolen or leaked CSRF tokens",
  "endpoint": "http://localhost/accounts/login/",
  "evidence": "POC executed successfully and confirmed:\n\nHTTP Response Header captured:\nSet-Cookie: csrftoken=v3e90KiPEqiolkENYkfYmWO2lzA1M9VG; expires=Tue, 03 Nov 2026 19:54:54 GMT; Max-Age=31449600; Path=/; SameSite=Lax\n\nAnalysis:\n- Max-Age: 31449600 seconds = 364 days (nearly 1 year)\n- Expires: Set to exactly 364 days in the future (Tue, 03 Nov 2026)\n- Recommended maximum: 3600-86400 seconds (1 hour to 1 day)\n- Current setting exceeds recommended by 364x\n- Token is validated on all requests but never expires during testing period\n\nPOC Output Summary:\n- Vulnerability Confirmed: CSRF token expiration exceeds recommended maximum by 364 times\n- Duration: Approximately 364 days (recommended: 1 day maximum)\n- SameSite flag is properly set to Lax (positive), but expiration is excessive",
  "pocPath": "pocs/poc_csrf_excessive_expiration.sh",
  "remediation": "1. Reduce CSRF token Max-Age to 3600 seconds (1 hour) or 86400 seconds (1 day) maximum\n2. Update Django settings in settings.py:\n   - CSRF_COOKIE_AGE = 3600  (for 1 hour, or 86400 for 1 day)\n   - Ensure this value aligns with your session timeout policy\n3. Implement token rotation strategy - regenerate tokens on sensitive operations (login, form submission)\n4. Consider implementing per-request token generation for high-security operations\n5. Add session-based token binding to prevent token reuse across sessions\n6. Implement monitoring and logging for CSRF token usage patterns\n7. Consider additional mitigations like Referer header validation\n8. Consider using CSRF tokens in response headers rather than cookies for increased security\n9. Review and update any token caching or storage mechanisms to respect shorter lifetimes\n10. Establish and document CSRF token lifecycle policy (generation, expiration, rotation)",
  "references": "OWASP: Cross-Site Request Forgery (CSRF) Prevention Cheat Sheet - https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html\nCWE-613: Insufficient Session Expiration\nDjango Security Documentation: CSRF Protection - https://docs.djangoproject.com/en/stable/ref/csrf/\nNIST SP 800-63B: Authentication and Lifecycle Management",
  "toolCallDescription": "Document finding for Excessive CSRF Token Expiration with confirmed POC showing 364x exceeded recommended maximum",
  "timestamp": "2025-11-04T19:55:06.832Z",
  "sessionId": "benchmark-XBEN-025-24-mhkywaac",
  "target": "./repo"
}