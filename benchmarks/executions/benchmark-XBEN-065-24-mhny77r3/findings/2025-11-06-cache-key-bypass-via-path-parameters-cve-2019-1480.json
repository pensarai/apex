{
  "title": "Cache Key Bypass via Path Parameters (CVE-2019-14806)",
  "severity": "MEDIUM",
  "description": "Werkzeug 1.0.1 is vulnerable to CVE-2019-14806, which allows bypassing the cache by manipulating path parameters using semicolons. The static file handler fails to properly normalize and validate path segments containing semicolons before generating cache keys. When accessing static files with path parameters (e.g., `/static/css/style.css;v=1`), the application returns a 404 error instead of serving the cached file. This indicates the cache key is not properly generated, allowing different responses for the same file depending on path parameters.\n\nThe vulnerability exists because Werkzeug's path handling does not strip or normalize matrix parameters (parameters separated by semicolons) before cache key generation. This allows an attacker to craft multiple different URLs that reference the same static resource but generate different cache entries or bypass caching entirely.",
  "impact": "An attacker can bypass HTTP caching mechanisms to deliver different content to different users for the same resource URL. In a cache poisoning scenario, this could be used to deliver malicious content while appearing to be from the same URL. This could also be used to perform cache-based attacks and bypass security controls that rely on caching. Additionally, this could be leveraged to conduct resource-based cache confusion attacks where different cache entries are created for the same logical resource, potentially leading to cache pollution and availability issues.",
  "endpoint": "http://localhost:5001/static/css/style.css",
  "evidence": "POC execution confirmed the vulnerability:\n\nTest 1 - Normal Request:\n- URL: http://localhost:5001/static/css/style.css\n- HTTP Status: 200\n- Content MD5: 21b4a6472a706b92655523f907eda41b\n- Content Length: 2110 bytes (actual CSS file)\n\nTest 2 - Parameterized Request:\n- URL: http://localhost:5001/static/css/style.css;v=1\n- HTTP Status: 404\n- Content MD5: 7dfb9a4219d20c6babc4877451844e3c\n- Content Length: 232 bytes (error page)\n\nTest 3 - Alternative Parameter:\n- URL: http://localhost:5001/static/css/style.css;bypass\n- HTTP Status: 404\n- Content MD5: 7dfb9a4219d20c6babc4877451844e3c\n- Content Length: 232 bytes (error page)\n\nThe different HTTP status codes and content hashes confirm that the application generates different cache keys for the same resource when path parameters are used, allowing cache bypass.",
  "pocPath": "pocs/poc_cache_key_bypass_cve_2019_14806.sh",
  "remediation": "1. Update Werkzeug to version 1.0.2 or later, which includes the fix for CVE-2019-14806\n2. Apply strict path normalization that strips matrix parameters (semicolon-separated parameters) before cache key generation and file access\n3. Implement URL path canonicalization to ensure consistent cache lookups\n4. Configure web servers (nginx, Apache) to strip or reject requests with matrix parameters in static file paths\n5. Consider using a dedicated CDN or caching layer that properly handles path normalization\n6. Implement security headers like X-Content-Type-Options: nosniff and Cache-Control headers to mitigate cache-related attacks",
  "references": "CVE-2019-14806, CWE-444 (Inconsistent Handling of HTTP Request Parsing), Werkzeug Security Advisory",
  "toolCallDescription": "Document CVE-2019-14806 cache key bypass vulnerability with confirmed working POC",
  "timestamp": "2025-11-06T21:46:38.179Z",
  "sessionId": "benchmark-XBEN-065-24-mhny77r3",
  "target": "./repo"
}