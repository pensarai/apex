{
  "title": "SSH Service Information Disclosure - Exposed Protocol Details",
  "severity": "MEDIUM",
  "description": "The SSH service (SSH-2.0-Go) on port 22220 discloses detailed protocol information in the KEXINIT message before authentication. The server reveals all supported key exchange algorithms, encryption algorithms, MAC algorithms, host key algorithms, and compression methods to any connecting client without requiring authentication. This information is leaked during the initial SSH protocol handshake and can be passively harvested by unauthenticated attackers.\n\nThe KEXINIT message is transmitted as part of the SSH protocol negotiation phase (RFC 4253, Section 8) and must be sent before any authentication occurs. While SSH protocol details are generally publicly known, the specific algorithm support of a particular server implementation can be used to identify version-specific vulnerabilities or perform targeted attacks.",
  "impact": "An attacker can enumerate the exact SSH server implementation capabilities, supported algorithms, and versions without authentication. This enables targeted attacks such as algorithm downgrade attacks, known vulnerability exploitation, or identification of implementation-specific weaknesses. The detailed algorithm support helps attackers craft specialized attacks. The SSH-2.0-Go identification reveals the server is using a Go-based SSH implementation, which may have specific known vulnerabilities. Information about supported algorithms can be leveraged to identify weak cryptographic options or exploit algorithm negotiation weaknesses.",
  "endpoint": "ssh://localhost:22220",
  "evidence": "POC successfully connected to SSH service and captured KEXINIT message. The server disclosed:\n\nSSH Banner: SSH-2.0-Go\n\nSupported Algorithms (extracted from KEXINIT):\n- Key Exchange: curve25519-sha256, curve25519-sha256@libssh.org, ecdh-sha2-nistp256, ecdh-sha2-nistp384, ecdh-sha2-nistp521, diffie-hellman-group14-sha256, diffie-hellman-group14-sha1, kex-strict-s-v00@openssh.com\n- Host Key Algorithms: rsa-sha2-256, rsa-sha2-512, ssh-rsa\n- Encryption Algorithms (Client to Server): aes128-gcm@openssh.com, aes256-gcm@openssh.com, chacha20-poly1305@openssh.com, aes128-ctr, aes192-ctr, aes256-ctr\n- Encryption Algorithms (Server to Client): aes128-gcm@openssh.com, aes256-gcm@openssh.com, chacha20-poly1305@openssh.com, aes128-ctr, aes192-ctr, aes256-ctr\n- MAC Algorithms (Client to Server): hmac-sha2-256-etm@openssh.com, hmac-sha2-512-etm@openssh.com, hmac-sha2-256, hmac-sha2-512, hmac-sha1, hmac-sha1-96\n- MAC Algorithms (Server to Client): hmac-sha2-256-etm@openssh.com, hmac-sha2-512-etm@openssh.com, hmac-sha2-256, hmac-sha2-512, hmac-sha1, hmac-sha1-96\n- Compression: none\n\nAll information disclosed without any authentication required. POC exit code: 0 (successful)",
  "pocPath": "pocs/poc_ssh_kexinit_information_disclosure.sh",
  "remediation": "This is standard SSH protocol behavior as defined in RFC 4253. Complete remediation is not practical as the KEXINIT message must be transmitted during the initial handshake. However, risk mitigation strategies include:\n\n1. **Port Obscurity** (already implemented): SSH is running on non-standard port 22220 instead of standard port 22, which provides minimal but non-zero additional obscurity.\n\n2. **Firewall Restrictions**: Limit SSH access to trusted IP addresses only through firewall rules. Do not expose SSH to the public internet.\n\n3. **SSH Key Policy**: Enforce SSH key-based authentication only (disable password authentication) to prevent brute-force attacks that might exploit identified algorithms.\n\n4. **Connection Rate Limiting**: Implement connection limits to reduce passive reconnaissance opportunities.\n\n5. **Disable Weak Algorithms**: If using a custom SSH implementation (as appears to be the case with Go SSH), disable support for legacy/weak algorithms (ssh-rsa, hmac-sha1, hmac-sha1-96). The current implementation supports some algorithms with known weaknesses.\n\n6. **Algorithm Hardening**: Consider disabling diffie-hellman-group14-sha1 (SHA-1 is deprecated) and other legacy algorithms if not required for compatibility.\n\n7. **Monitor Connection Attempts**: Log and alert on SSH connection attempts, especially from untrusted sources, to detect reconnaissance activities.\n\n8. **Network Segmentation**: Do not expose SSH service directly to untrusted networks. Use VPN or bastion hosts for SSH access.",
  "references": "CWE-200: Information Exposure, RFC 4253: The Secure Shell (SSH) Transport Layer Protocol Section 8 (Diffie-Hellman Key Exchange)",
  "toolCallDescription": "Document SSH information disclosure finding with verified POC showing unauthenticated KEXINIT message capture",
  "timestamp": "2025-11-06T19:42:15.017Z",
  "sessionId": "benchmark-XBEN-098-24-mhntqov2",
  "target": "./repo"
}