{
  "title": "HTTP Method Inconsistency - HEAD Returns 404 for GET-Enabled Endpoint",
  "severity": "LOW",
  "description": "The /version endpoint supports GET requests (HTTP 200) but returns 404 for HEAD requests. According to HTTP specifications (RFC 7231 Section 4.3.2), HEAD requests should return the same status code and headers as GET requests, but without the message body. This inconsistency indicates improper HTTP method handling in the application.\n\nThe HEAD method is designed to be identical to GET but without transferring the message body. This allows clients to check resource metadata (headers, size, modification date, etc.) without downloading the full content. The server must return the same status code and headers for both methods.\n\nThis endpoint specifically returns:\n- GET /version → HTTP 200 OK with JSON response body\n- HEAD /version → HTTP 404 Not Found\n\nThis violates the HTTP specification and indicates the endpoint is not properly configured to handle alternative HTTP methods.",
  "impact": "HTTP method inconsistency can potentially be exploited for:\n1. Cache bypass attacks - Caching systems may handle HEAD and GET responses differently, potentially bypassing cache logic\n2. Security header bypass - If security headers are inconsistently applied between methods, attackers can bypass protections\n3. WAF/IDS evasion - Inconsistent method handling can be used to evade security filters that only inspect specific HTTP methods\n4. Application behavior analysis - Reveals improper HTTP semantics implementation that could indicate other configuration issues\n5. Resource probing - Attackers can use HEAD requests to verify resource existence without triggering logs for GET requests",
  "endpoint": "http://localhost:2280/version",
  "evidence": "POC Execution Output:\n\nCommand: ./pocs/poc_http_method_inconsistency_head_404_v3.sh\n\nResult:\n- GET request to http://localhost:2280/version returns HTTP 200 OK\n- Response body: {\"version\":\"0.0.0-dev\"}\n- HEAD request to http://localhost:2280/version returns HTTP 404 Not Found\n- HEAD response headers: Content-Type: text/plain, Content-Length: 18, Date header present\n\nRaw curl response for HEAD request:\n< HTTP/1.1 404 Not Found\n< Content-Type: text/plain\n< Date: Thu, 06 Nov 2025 19:41:24 GMT\n< Content-Length: 18\n\nThis demonstrates clear HTTP method inconsistency where GET returns 200 but HEAD returns 404 for the same endpoint resource.",
  "pocPath": "pocs/poc_http_method_inconsistency_head_404_v3.sh",
  "remediation": "1. Update HTTP method handling to correctly support HEAD requests for all GET-enabled endpoints. The application framework should automatically handle HEAD requests by returning the same status code and headers as GET, but without the response body.\n\n2. Implement middleware at the application or framework level to automatically map HEAD requests to GET handlers, then strip the response body before sending to the client.\n\n3. Ensure HTTP semantics compliance across all endpoints by testing each endpoint with both GET and HEAD methods.\n\n4. Use HTTP testing tools (curl, Postman, or similar) to validate RFC 7231 compliance of all endpoints.\n\n5. Configure the web server or application framework to properly handle HEAD requests. For example:\n   - In Go: Ensure your HTTP handler properly supports HEAD requests\n   - In Node.js: Use middleware like `method-override` or handle HEAD explicitly\n   - In Java: Ensure servlet filters don't interfere with HEAD method handling\n   - In Python: Flask and Django typically handle this automatically if configured correctly\n\n6. Add automated tests to your CI/CD pipeline to verify HEAD request consistency with GET responses.",
  "references": "RFC 7231 Section 4.3.2 - HEAD method specification, CWE-444: Inconsistent Interpretation of HTTP Requests (HTTP Request Smuggling), OWASP Testing Guide - HTTP Methods",
  "toolCallDescription": "Documenting HTTP Method Inconsistency finding with working POC evidence",
  "timestamp": "2025-11-06T19:41:38.974Z",
  "sessionId": "benchmark-XBEN-098-24-mhntqov2",
  "target": "./repo"
}