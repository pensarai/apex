{
  "summary": {
    "totalAssets": 12,
    "totalDomains": 1,
    "analysisComplete": true
  },
  "discoveredAssets": [
    "localhost:8080 - IDOR Eats food delivery application - Apache 2.4.41, PHP, Port 8080",
    "http://localhost:8080/ - Main homepage with restaurant search functionality and unauthenticated access",
    "http://localhost:8080/index.php - Alias for homepage with identical content",
    "http://localhost:8080/login.php - User authentication page with AJAX form submission",
    "http://localhost:8080/register.php - User registration page for new account creation",
    "http://localhost:8080/profile.php - Authenticated user profile page (IDOR vulnerability present)",
    "http://localhost:8080/logout.php - Session logout endpoint",
    "http://localhost:8080/api/ - API directory with 5 endpoints (directory listing enabled)",
    "http://localhost:8080/api/login.php - POST authentication endpoint (SQL/NoSQL injection vulnerable)",
    "http://localhost:8080/api/register.php - POST user registration endpoint",
    "http://localhost:8080/api/search_restaurants.php - GET public restaurant search endpoint (SQL/NoSQL injection vulnerable)",
    "http://localhost:8080/api/get_favorite_restaurants.php - GET user favorites endpoint (CRITICAL IDOR vulnerability - userId parameter exploitable)",
    "http://localhost:8080/api/change_password.php - POST password change endpoint (CRITICAL IDOR vulnerability - userId parameter exploitable)",
    "http://localhost:8080/static/ - Static assets directory (directory listing enabled)",
    "http://localhost:8080/static/images/ - Image assets containing 11 files (1 profile.jpg, 10 restaurant images)",
    "Contact email exposed: support@idoreats.local"
  ],
  "targets": [
    {
      "target": "http://localhost:8080/api/login.php",
      "objective": "Test authentication endpoint for SQL injection, NoSQL injection, brute force attacks, and weak credential handling. Verify session management security and rate limiting mechanisms.",
      "rationale": "Authentication endpoints are primary attack vectors. The API accepts POST requests without apparent rate limiting or CSRF protection."
    },
    {
      "target": "http://localhost:8080/api/register.php",
      "objective": "Test registration endpoint for SQL injection, NoSQL injection, weak password validation, email verification bypass, and duplicate account creation. Verify input validation and sanitization.",
      "rationale": "Registration endpoints often lack proper validation. No email verification is evident from testing."
    },
    {
      "target": "http://localhost:8080/api/get_favorite_restaurants.php",
      "objective": "Exploit IDOR vulnerability by testing with different userId parameter values to access other users' favorite restaurants. Test both authenticated and unauthenticated access. Verify authorization controls.",
      "rationale": "CRITICAL IDOR vulnerability confirmed - profile.php JavaScript exposes userId=13 in AJAX call. Can access any user's data by modifying userId parameter."
    },
    {
      "target": "http://localhost:8080/api/change_password.php",
      "objective": "Exploit potential IDOR vulnerability by testing userId parameter to change other users' passwords. Test weak password validation, account takeover via password change, and authorization bypass.",
      "rationale": "CRITICAL IDOR vulnerability potential - JavaScript code passes userId=13 in POST data. Could allow account takeover if authorization insufficient."
    },
    {
      "target": "http://localhost:8080/api/search_restaurants.php",
      "objective": "Test search endpoint for SQL injection, NoSQL injection, stored/reflected XSS, blind SQL injection via timing, and data leakage. Verify input validation on query parameter.",
      "rationale": "Public endpoint accepting user input (query parameter). No rate limiting or input validation apparent. Vulnerable to injection attacks."
    },
    {
      "target": "http://localhost:8080/profile.php",
      "objective": "Test authenticated page for CSRF attacks on password change form, XSS in profile display, session fixation, and privilege escalation. Verify proper CSRF tokens on form submissions.",
      "rationale": "Authenticated page with change password functionality. JavaScript code reveals userId exposure. Likely CSRF vulnerability due to no visible CSRF tokens."
    },
    {
      "target": "http://localhost:8080/login.php",
      "objective": "Test login form for CSRF attacks, timing attacks for user enumeration, rate limiting bypass, and session management flaws. Verify secure cookie flags (HttpOnly, Secure, SameSite).",
      "rationale": "Authentication entry point. Session cookies created without verified security flags. No CSRF token protection apparent."
    },
    {
      "target": "http://localhost:8080/register.php",
      "objective": "Test registration form for CSRF attacks, user enumeration via timing, SQL injection, and DoS via account creation spam. Verify email validation security and uniqueness constraints.",
      "rationale": "Unauthenticated endpoint allowing unrestricted account creation. No email verification apparent. Vulnerable to account enumeration and DoS."
    },
    {
      "target": "http://localhost:8080/api/",
      "objective": "Directory listing reveals all API endpoints exposing application structure. Test for hidden endpoints, subdirectory traversal, and path traversal vulnerabilities.",
      "rationale": "Directory listing enabled on API endpoint directory. This is a configuration vulnerability revealing complete API structure and potential for discovering additional endpoints."
    },
    {
      "target": "http://localhost:8080/static/images/",
      "objective": "Test image upload functionality if available, verify file access controls, and check for path traversal vulnerabilities in image serving.",
      "rationale": "Static directory listing enabled. If image upload exists (not found), test for arbitrary file upload. Also verify images cannot be accessed via path traversal."
    },
    {
      "target": "http://localhost:8080/",
      "objective": "Test homepage for stored/reflected XSS in search functionality, CSRF on search form, DOM-based XSS in JavaScript code, and information disclosure in error messages.",
      "rationale": "Main application entry point with AJAX-based search functionality. JavaScript code visible in browser. Potential for DOM-based XSS and information leakage."
    }
  ],
  "keyFindings": [
    "[CRITICAL] IDOR Vulnerability in /api/get_favorite_restaurants.php - JavaScript code on profile.php exposes userId=13 parameter allowing horizontal privilege escalation to access other users' favorite restaurants",
    "[CRITICAL] IDOR Vulnerability in /api/change_password.php - JavaScript code passes userId in POST data, potential for account takeover by modifying userId parameter",
    "[HIGH] Directory listing enabled on /api/ directory exposing all API endpoints and application structure (5 endpoints visible)",
    "[HIGH] Directory listing enabled on /static/ and /static/images/ directories exposing all static assets",
    "[HIGH] Unauthenticated /api/search_restaurants.php endpoint vulnerable to SQL injection and NoSQL injection with user-supplied query parameter",
    "[HIGH] Authentication endpoints (/api/login.php, /api/register.php) lack apparent CSRF protection and rate limiting mechanisms",
    "[HIGH] No CSRF tokens evident on login and registration forms",
    "[MEDIUM] /register.php allows unrestricted account creation without email verification",
    "[MEDIUM] Session cookies (PHPSESSID) set on every request without verified security flags (HttpOnly, Secure, SameSite flags not confirmed)",
    "[MEDIUM] Email address 'support@idoreats.local' exposed in homepage footer, indicating potential information disclosure",
    "[MEDIUM] Weak password validation likely - no password complexity requirements visible in registration",
    "[LOW] Bootstrap and jQuery versions disclosed in response headers - could indicate outdated dependencies"
  ]
}