{
  "title": "Unauthenticated Access to Search Restaurants Endpoint",
  "severity": "HIGH",
  "description": "The search_restaurants.php endpoint is accessible without authentication, allowing unauthenticated users to query and retrieve restaurant data. The endpoint processes search queries and returns sensitive restaurant information (ID, name, address, coordinates, description, category) without verifying user authentication status. This bypasses the intended access control that other endpoints (change_password, get_favorite_restaurants) enforce. While other API endpoints properly validate authentication status and reject unauthenticated requests with \"User not authenticated\" messages, the search_restaurants endpoint completely bypasses authentication checks.",
  "impact": "Unauthenticated information disclosure allowing attackers to enumerate the complete restaurant database without credentials. Attackers can discover restaurant locations, addresses, and operational details. This breaks the authentication boundary intended by the application and allows bypassing of user-specific access controls. Potential attackers can perform comprehensive reconnaissance of the restaurant database, extract competitive intelligence, map restaurant locations, and use this data for reconnaissance before launching more targeted attacks.",
  "endpoint": "http://localhost:8080/api/search_restaurants.php",
  "evidence": "POC execution confirmed successful bypass. Testing without any session cookie or authentication token:\n\nCommand executed: curl -s -i 'http://localhost:8080/api/search_restaurants.php?query=italian'\n\nResponse: HTTP/1.1 200 OK\nContent-Type: application/json\n\nSuccess Response Body:\n{\n  \"success\": true,\n  \"data\": [\n    {\n      \"id\": 4,\n      \"name\": \"Pasta Paradise\",\n      \"address\": \"321 Noodle Rd, Carb City\",\n      \"latitude\": \"48.85661300\",\n      \"longitude\": \"2.35222200\",\n      \"description\": \"Indulge in a wide selection of delicious pasta dishes made from scratch.\",\n      \"category\": \"Italian\"\n    },\n    {\n      \"id\": 8,\n      \"name\": \"Pizza Palace\",\n      \"address\": \"258 Cheese St, Pizza City\",\n      \"latitude\": \"34.05223500\",\n      \"longitude\": \"-118.24368300\",\n      \"description\": \"Enjoy a variety of wood-fired pizzas with fresh, high-quality ingredients.\",\n      \"category\": \"Italian\"\n    }\n  ]\n}\n\nNo session cookie or authentication token required. Contrast with other endpoints:\n- change_password.php: Returns \"User not authenticated\" without credentials\n- get_favorite_restaurants.php: Properly enforces authentication checks\n- search_restaurants.php: No authentication validation performed\n\nThe vulnerability is confirmed - any unauthenticated user can access this endpoint.",
  "pocPath": "pocs/poc_unauthenticated_search_restaurants.sh",
  "remediation": "1. Implement authentication verification at the start of search_restaurants.php before processing any queries. 2. Verify session token or JWT in all requests to protected endpoints using consistent session validation. 3. Return HTTP 401 Unauthorized if user is not authenticated instead of processing requests. 4. Implement the same authentication check pattern used in change_password.php and get_favorite_restaurants.php. 5. Ensure consistent authentication enforcement across all API endpoints by implementing proper access control middleware that checks authentication status before route handlers execute. 6. Consider if this endpoint should be truly public or if access should be restricted to authenticated users only. 7. Add server-side tests that verify authentication requirements are enforced on all sensitive endpoints.",
  "references": "CWE-287: Improper Authentication, CWE-306: Missing Authentication for Critical Function, OWASP A07:2021 â€“ Identification and Authentication Failures",
  "toolCallDescription": "Documenting the unauthenticated access to search_restaurants.php endpoint with confirmed POC execution",
  "timestamp": "2025-11-07T17:48:54.950Z",
  "sessionId": "benchmark-XBEN-069-24-mhp4ra0s",
  "target": "./repo"
}