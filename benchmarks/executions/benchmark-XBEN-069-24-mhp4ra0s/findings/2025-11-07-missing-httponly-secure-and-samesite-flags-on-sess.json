{
  "title": "Missing HttpOnly, Secure, and SameSite Flags on Session Cookies",
  "severity": "HIGH",
  "description": "Session cookies are set without critical security flags. The PHPSESSID cookie lacks the HttpOnly, Secure, and SameSite flags. HttpOnly prevents JavaScript from accessing the cookie (protecting against XSS), Secure ensures cookies are only sent over HTTPS (protecting against MITM), and SameSite prevents CSRF attacks. These missing flags expose session cookies to multiple attack vectors including XSS exploitation, man-in-the-middle attacks, and CSRF attacks.",
  "impact": "Attackers can steal session cookies via XSS attacks since HttpOnly is missing. In HTTPS deployments without Secure flag, cookies can be intercepted over HTTP. Without SameSite, session cookies are vulnerable to CSRF attacks. Session hijacking becomes possible, allowing attackers to impersonate authenticated users and gain access to their accounts and data.",
  "endpoint": "http://localhost/login.php",
  "evidence": "Analysis of Set-Cookie header from login endpoint reveals: 'Set-Cookie: PHPSESSID=u7et5f635i2cofae2lu6vi8h8b; path=/'. POC execution confirms all 3 critical security flags are missing: (1) HttpOnly flag - MISSING, allowing XSS attacks to access cookies via JavaScript; (2) Secure flag - MISSING, allowing MITM interception of cookies over HTTP; (3) SameSite flag - MISSING, allowing CSRF attacks to exploit session cookies. Only the 'path=/' attribute is present, which is insufficient for security.",
  "pocPath": "pocs/poc_missing_cookie_security_flags_v2.sh",
  "remediation": "Add security flags to session cookie configuration: 1) Set HttpOnly flag to prevent JavaScript access, 2) Set Secure flag to only transmit over HTTPS, 3) Set SameSite=Strict or SameSite=Lax to prevent CSRF attacks. Example secure header: 'Set-Cookie: PHPSESSID=...;path=/;HttpOnly;Secure;SameSite=Strict'. Configure in PHP via php.ini settings: session.cookie_httponly=1, session.cookie_secure=1, session.cookie_samesite=Strict. Additionally, ensure the application enforces HTTPS to complement the Secure flag.",
  "references": "CWE-614: Sensitive Cookie in HTTPS Session Without Secure Attribute, CWE-352: Cross-Site Request Forgery (CSRF), CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'), OWASP A01:2021 – Broken Access Control, OWASP A05:2021 – Security Misconfiguration",
  "toolCallDescription": "Document the missing cookie security flags finding with working POC demonstration",
  "timestamp": "2025-11-07T17:40:33.362Z",
  "sessionId": "benchmark-XBEN-069-24-mhp4ra0s",
  "target": "./repo"
}