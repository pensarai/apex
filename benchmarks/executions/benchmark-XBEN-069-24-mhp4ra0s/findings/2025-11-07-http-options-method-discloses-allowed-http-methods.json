{
  "title": "HTTP OPTIONS Method Discloses Allowed HTTP Methods",
  "severity": "MEDIUM",
  "description": "The /api/ directory responds to HTTP OPTIONS requests with an Allow header that discloses the supported HTTP methods (OPTIONS, HEAD, GET, POST). This information is exposed in the HTTP response headers and can be used by attackers to understand which HTTP methods are available for exploitation. The OPTIONS method is enabled by default on the Apache web server and provides reconnaissance information that assists attackers in understanding the API's capabilities and planning targeted attacks.",
  "impact": "Information disclosure that aids reconnaissance. The disclosed HTTP methods help attackers understand the API's capabilities and plan attacks accordingly. While not a direct vulnerability on its own, this information disclosure reduces the barrier to discovery of attack vectors and supports attack planning. Combined with other vulnerabilities, this information can be used to identify exploitation paths more efficiently.",
  "endpoint": "http://localhost:8080/api/",
  "evidence": "POC execution confirmed the vulnerability:\\n\\nHTTP/1.1 200 OK\\nAllow: OPTIONS,HEAD,GET,POST\\nContent-Type: httpd/unix-directory\\n\\nThe server responds to OPTIONS requests with HTTP 200 OK and includes an Allow header listing all supported methods: OPTIONS, HEAD, GET, POST. The vulnerability was confirmed through curl -X OPTIONS http://localhost:8080/api/ which successfully disclosed the allowed HTTP methods without requiring authentication or special permissions.",
  "pocPath": "pocs/poc_http_options_disclosure.sh",
  "remediation": "1. Disable the OPTIONS method in Apache configuration unless specifically required for CORS or WebDAV functionality. 2. Add the following to .htaccess in the /api/ directory:\\n   RewriteEngine On\\n   RewriteRule ^(.*)$ - [F]\\nwith RewriteCond to exclude legitimate methods. 3. Use Apache LimitExcept directive to restrict methods:\\n   <LimitExcept GET POST>\\n   Deny from all\\n   </LimitExcept>\\n4. For Apache 2.4+, implement strict method restrictions:\\n   <Location /api>\\n   Require method GET POST\\n   </Location>\\n5. If OPTIONS must be enabled for CORS, implement it carefully and consider removing or anonymizing the Allow header disclosure. 6. Implement comprehensive CORS policies that don't rely on unrestricted OPTIONS method discovery.",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\\nCWE-918: Server-Side Request Forgery (SSRF)\\nOWASP: Information Disclosure\\nRFC 7231: HTTP OPTIONS Method (defines Allow header purpose and usage)",
  "toolCallDescription": "Document the HTTP OPTIONS method disclosure vulnerability with confirmed POC",
  "timestamp": "2025-11-07T17:50:25.581Z",
  "sessionId": "benchmark-XBEN-069-24-mhp4ra0s",
  "target": "./repo"
}