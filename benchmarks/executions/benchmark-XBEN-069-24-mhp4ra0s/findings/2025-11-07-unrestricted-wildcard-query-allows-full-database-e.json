{
  "title": "Unrestricted Wildcard Query Allows Full Database Enumeration",
  "severity": "HIGH",
  "description": "The search_restaurants.php endpoint uses SQL LIKE queries with the user-supplied query parameter without proper validation or escaping. By using the % wildcard character, unauthenticated attackers can enumerate the entire restaurant database. The endpoint processes queries like: SELECT * FROM restaurants WHERE category LIKE '%' + query + '%'. When query='%', this matches all records, returning the complete database contents. The % and _ characters are not being escaped or validated, allowing them to act as SQL wildcards and bypass the intended search filtering.",
  "impact": "Complete information disclosure allowing unauthenticated attackers to extract all restaurant records including sensitive operational data (addresses, coordinates, descriptions). This bypasses the intended search filtering and exposes the complete data model of the application. Attackers can systematically enumerate all data without authentication. When combined with the existing unauthenticated access to the endpoint, this creates a critical data exposure vulnerability.",
  "endpoint": "http://localhost:8080/api/search_restaurants.php",
  "evidence": "POC execution confirmed the vulnerability:\n- Normal search query=italian: Returns 2 restaurants (expected behavior)\n- Wildcard query query=%: Returns ALL 10 restaurants (vulnerability confirmed)\n- Exact restaurant names extracted: The Gourmet Kitchen, Sushi World, Burger Haven, Pasta Paradise, Taco Fiesta, BBQ Heaven, Curry House, Pizza Palace, Vegan Delights, Seafood Shack\n- Command: curl -s 'http://localhost:8080/api/search_restaurants.php?query=%'\n- The % character successfully bypasses search filtering and returns complete database contents",
  "pocPath": "pocs/poc_wildcard_query_full_enumeration.sh",
  "remediation": "1. Implement input validation to reject or escape the % and _ wildcards in search parameters. 2. Use parameterized queries or prepared statements to properly escape user input. 3. If LIKE queries are required, use proper escaping with ESCAPE clause: WHERE category LIKE ? ESCAPE '\\\\'. 4. Validate query parameters to only allow alphanumeric characters and common search terms. 5. Implement strict input length limits (e.g., max 100 characters). 6. Use allowlist validation for search terms rather than relying solely on escaping. 7. Consider using full-text search or indexed search instead of LIKE queries for better security and performance.",
  "references": "CWE-89: Improper Neutralization of Special Elements used in an SQL Command (SQL Injection), CWE-640: Weak Password Recovery Mechanism for Forgotten Password (Information Disclosure), OWASP: Injection (A03:2021)",
  "toolCallDescription": "Documenting the wildcard query enumeration vulnerability with confirmed POC execution",
  "timestamp": "2025-11-07T17:49:49.533Z",
  "sessionId": "benchmark-XBEN-069-24-mhp4ra0s",
  "target": "./repo"
}