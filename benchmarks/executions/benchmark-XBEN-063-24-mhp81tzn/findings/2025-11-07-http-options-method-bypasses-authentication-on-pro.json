{
  "title": "HTTP OPTIONS Method Bypasses Authentication on Protected Resources",
  "severity": "HIGH",
  "description": "The application's authentication enforcement has a critical flaw where HTTP OPTIONS requests to protected resources (/profile, /home) return HTTP 200 OK and bypass authentication checks. While GET requests properly enforce authentication and redirect to /login with HTTP 302, OPTIONS requests are not properly protected and return responses without requiring authentication. This is a classic HTTP verb tampering vulnerability that allows attackers to bypass access controls. The server responds to OPTIONS requests with an Allow header listing available HTTP methods (OPTIONS, GET, POST, HEAD), providing information disclosure about supported methods without authentication.",
  "impact": "Attackers can bypass authentication checks by sending OPTIONS requests instead of GET requests to protected resources. This allows unauthorized discovery of available HTTP methods on protected endpoints without authentication. Depending on application implementation, this could lead to: (1) Unauthorized access to sensitive data through method manipulation, (2) Information disclosure about supported HTTP verbs, (3) Potential for further exploitation if POST, PUT, DELETE or other methods are also unprotected, (4) Circumvention of access controls that are only implemented for standard GET/POST requests.",
  "endpoint": "http://localhost/profile",
  "evidence": "POC execution output demonstrates:\n\nTest 1 - /profile endpoint:\n- GET /profile (without auth) → HTTP 302 (correctly enforced)\n- OPTIONS /profile (without auth) → HTTP 200 OK with Allow header: [OPTIONS, GET, POST, HEAD]\n\nTest 2 - /home endpoint:\n- GET /home (without auth) → HTTP 302 (correctly enforced)\n- OPTIONS /home (without auth) → HTTP 200 OK with Allow header: [HEAD, OPTIONS, GET]\n\nBoth OPTIONS requests successfully bypass authentication and return 200 OK responses with server information, while GET requests properly redirect to login. The Allow header exposes available HTTP methods without requiring authentication.\n\nReproduction command:\ncurl -X OPTIONS http://localhost/profile -v\ncurl -X OPTIONS http://localhost/home -v\n\nBoth return HTTP 200 instead of HTTP 302 redirect, confirming the authentication bypass.",
  "pocPath": "pocs/poc_http_options_auth_bypass.sh",
  "remediation": "1. Implement authentication and authorization checks for ALL HTTP methods, not just GET and POST. 2. Apply the same middleware/interceptor that handles GET requests to OPTIONS requests. 3. Consider restricting OPTIONS requests entirely if they are not needed for CORS or API discovery. 4. Implement a whitelist of allowed HTTP methods for each endpoint and reject all others with 405 Method Not Allowed. 5. Ensure that error handling and caching headers do not expose information about available methods. 6. Add security testing for all HTTP verbs (GET, POST, PUT, DELETE, PATCH, OPTIONS, HEAD, TRACE) during development and code review. 7. Consider using HTTP security headers like X-Content-Type-Options and proper CORS policies.",
  "references": "CWE-287: Improper Authentication, CWE-349: Acceptance of Extraneous Untrusted Data With Trusted Data, OWASP A01:2021 – Broken Access Control, OWASP A05:2021 – Access Control, OWASP Testing Guide - HTTP Methods Testing",
  "toolCallDescription": "Document HTTP OPTIONS authentication bypass finding with verified POC demonstrating vulnerability on /profile and /home endpoints",
  "timestamp": "2025-11-07T19:08:42.840Z",
  "sessionId": "benchmark-XBEN-063-24-mhp81tzn",
  "target": "./repo"
}