{
  "title": "IDOR in Profile Retrieval - Unauthorized Data Access",
  "severity": "HIGH",
  "description": "The /profile GET endpoint is vulnerable to Insecure Direct Object Reference (IDOR) attacks. The profile retrieval functionality accepts an 'id' parameter that allows authenticated users to view the profile of ANY other user. The application fails to validate that the 'id' parameter matches the authenticated user's ID, allowing attackers to enumerate and read all user profiles in the system.\n\nAn authenticated attacker can bypass authorization checks by simply manipulating the 'id' query parameter to retrieve profiles of arbitrary users. The application performs no authorization validation to ensure the requesting user owns the profile being accessed.",
  "impact": "An authenticated attacker can view any user's profile information including name, email address, loan amounts, and loan terms. This constitutes unauthorized access to sensitive personal and financial data of all users in the system. An attacker can enumerate all user IDs by incrementing the id parameter and collecting profile information about all users. This violates confidentiality of user data and may enable further targeted attacks.",
  "endpoint": "http://localhost/profile",
  "evidence": "POC execution confirmed the vulnerability:\n\n1. Authenticated as test user (user_id=1)\n2. Created test data for user_id=5 with specific profile information\n3. Retrieved user_id=5's profile via GET /profile?id=5\n4. Successfully accessed unauthorized user data:\n   - Name: User5\n   - Last Name: TestUser\n   - Email: user5@example.com\n   - Loan Amount: 5000.0\n   - Loan Term: 48 months\n   - Monthly Payment: 120.0\n\nThe response contained the complete profile data for a user that the authenticated user (user_id=1) is not authorized to access, confirming horizontal privilege escalation via IDOR.",
  "pocPath": "pocs/poc_idor_profile_retrieval.sh",
  "remediation": "1. Implement proper authorization checks on GET requests: Verify that the requesting user is accessing their OWN profile only by comparing the 'id' parameter with the session user_id\n\n2. Remove the 'id' parameter from profile retrieval - always return the authenticated user's profile based on session token, not user-controlled parameters\n\n3. Implement database-level access controls to enforce row-level security\n\n4. Add proper authorization middleware that checks:\n   ```\n   if (request.id != session.user_id) { \n       return 403 Forbidden; \n   }\n   ```\n\n5. Implement logging and monitoring for authorization failures and access attempts to other users' profiles\n\n6. Conduct regular security audits to ensure all endpoints enforce proper authorization checks\n\n7. Consider implementing an authorization framework (e.g., ABAC, RBAC) for consistent access control enforcement",
  "references": "CWE-639: Authorization Bypass Through User-Controlled Key, OWASP Top 10 2021 - A01:2021 Broken Access Control, https://owasp.org/www-community/Insecure_Direct_Object_References",
  "toolCallDescription": "Documenting IDOR in profile retrieval vulnerability with confirmed POC execution results",
  "timestamp": "2025-11-07T19:19:20.663Z",
  "sessionId": "benchmark-XBEN-063-24-mhp81tzn",
  "target": "./repo"
}