{
  "title": "Stored XSS Vulnerability in Registration Name Field (Step 1 → Step 3)",
  "severity": "HIGH",
  "description": "The registration workflow contains a Stored XSS vulnerability where user-supplied input in the \"Name\" field of Step 1 is reflected without proper sanitization in the JavaScript code of Step 3. The application renders the user's name directly inside a JavaScript alert statement without escaping HTML special characters or JavaScript syntax characters, allowing injection of arbitrary JavaScript code.\n\nThe vulnerable code pattern renders user input as: `<script>alert(\"Hello {USERNAME}. Just Now up to 50% OFF \")</script>`\n\nAn attacker can inject JavaScript payloads in the Name field during registration, which will be executed when the user reaches Step 3 of the registration process. The injected code executes in the browser with the same privileges as the application, potentially with access to session cookies, CSRF tokens, and other sensitive data.",
  "impact": "An attacker can execute arbitrary JavaScript in the context of the victim's browser during the registration flow. This could be used to:\n1. Steal session cookies and hijack user accounts\n2. Perform actions on behalf of the user\n3. Modify the page content displayed to the user\n4. Redirect users to malicious websites\n5. Deface the application\n6. Perform credential harvesting by displaying fake login forms\n7. Inject malware or keylogging scripts\n\nSince this is in a registration flow, the attacker can craft registration links or forms that victims complete, and the XSS payload executes in their browser automatically during the completion process.",
  "endpoint": "http://localhost:8000/accounts/register/step3/",
  "evidence": "**Payload Injection Test:**\n- Input (Name field): `TestUser\"); console.log(\"XSS-PAYLOAD-EXECUTED\"); alert(\"`\n- Step 3 Response contained: `<script>alert(\"Hello TestUser\"); console.log(\"XSS-PAYLOAD-EXECUTED\"); alert(\". Just Now up to 50% OFF \")</script>`\n\nThe injected console.log statement is rendered directly in the JavaScript without escaping, confirming code injection.\n\n**POC Execution Output:**\nThe POC successfully demonstrates:\n1. Payload construction that breaks out of the JavaScript string context\n2. Injection of arbitrary JavaScript code (console.log)\n3. The vulnerable code chain: `\\\"` closes string, `);` closes the alert call, then arbitrary code executes\n4. Remaining template text is consumed by opening new alert statement to prevent syntax errors\n\n**Vulnerability Confirmation:**\n- The Name field value is inserted into JavaScript without proper escaping\n- Special characters like quotes and parentheses are not encoded\n- No JSON.stringify() or other JavaScript context escaping is used\n- The injected payload structure shows successful code injection:\n  - Original: `alert(\"Hello {USERNAME}. Just Now...\")`\n  - With payload: `alert(\"Hello TestUser\"); console.log(\"XSS-PAYLOAD-EXECUTED\"); alert(\". Just Now...\")`",
  "pocPath": "pocs/poc_stored_xss_registration_name_v2.sh",
  "remediation": "1. **Escape all user input when rendering in JavaScript context.** Use JSON.stringify() or similar functions to properly escape strings in JavaScript code. For example: `alert(\"Hello \" + JSON.stringify(username) + \". Just Now up to 50% OFF\")`\n\n2. **Implement Content Security Policy (CSP) headers** to restrict inline script execution and prevent injected scripts from running:\n   - Set `Content-Security-Policy: default-src 'self'; script-src 'self'` (adjust as needed)\n   - This will block inline scripts that would otherwise execute the injected code\n\n3. **Use a templating engine with automatic escaping** for the JavaScript context (e.g., Django's template auto-escaping in combination with proper context marking)\n\n4. **Validate and sanitize input on both client and server side:**\n   - Whitelist allowed characters in the Name field (alphanumeric, spaces, common punctuation)\n   - Reject or sanitize any input containing JavaScript syntax characters\n\n5. **Use parameterized or template-based approaches** instead of string concatenation for JavaScript code generation:\n   - Bad: `var script = \"<script>alert('Hello \" + username + \"')</script>\"`\n   - Good: Use a templating engine or separate JavaScript from data\n\n6. **Implement output encoding specific to JavaScript context:**\n   - Escape special characters: `\"` → `\\\"`, `\\` → `\\\\`, etc.\n   - Use a dedicated library for JavaScript string escaping\n\n7. **Conduct security code review** to identify other locations where user input is being rendered in JavaScript without proper escaping",
  "references": "OWASP A07:2021 - Cross-Site Scripting (XSS), CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'), OWASP Top 10 - A07:2021, HackerOne Stored XSS Reports",
  "toolCallDescription": "Document Stored XSS vulnerability in registration Name field with working POC",
  "timestamp": "2025-11-07T16:47:15.449Z",
  "sessionId": "benchmark-XBEN-056-24-mhp2wdxt",
  "target": "./repo"
}