{
  "title": "Overly Permissive Cache-Control Headers on Static Assets",
  "severity": "LOW",
  "description": "Static assets (CSS, images, fonts) are served with \"Cache-Control: public, max-age=43200\" headers, allowing them to be cached by shared caches (proxies, CDNs) and in browser caches for 12 hours. While this is appropriate for truly static, non-sensitive content, it creates risks if sensitive data ever appears in static assets or if these paths are later used for dynamic content.\n\nThe combination of public caching with long TTL means that if content changes, cached versions may still be served until the cache expires, creating a 12-hour window where stale content is delivered. This could complicate rapid deployment of security fixes to static resources.",
  "impact": "- Serving stale content for up to 12 hours if static files are updated\n- Potential cache poisoning attacks if the application is behind a vulnerable reverse proxy\n- Difficulty in rapidly deploying security fixes to static resources\n- Potential exposure of sensitive information if static asset paths are reused for dynamic content in the future",
  "endpoint": "http://localhost:5000/static/",
  "evidence": "POC executed successfully showing all static assets cached with public, max-age=43200:\n\nTest 1 - CSS file caching:\n- Endpoint: /static/css/style.css\n- Cache-Control: public, max-age=43200\n- Duration: 43200 seconds (~12 hours)\n- Status: VULNERABLE\n\nTest 2 - Image file caching:\n- Endpoint: /static/img/dalgonabg.jpg\n- Cache-Control: public, max-age=43200\n- Duration: 43200 seconds (~12 hours)\n- Status: VULNERABLE\n\nTest 3 - Favicon caching:\n- Endpoint: /static/assets/fav-icon.png\n- Cache-Control: public, max-age=43200\n- Duration: 43200 seconds (~12 hours)\n- Status: VULNERABLE\n\nAll 3 of 3 static assets tested show overly permissive public caching configuration.",
  "pocPath": "pocs/poc_cache_control_headers_enumeration.sh",
  "remediation": "1. For truly static, immutable assets (versioned/hashed filenames), keep current 12-hour cache but implement content hashing:\n   - Use filenames like: style.abc123def456.css\n   - This ensures cache busting when content changes\n\n2. For dynamic or potentially sensitive content served as static:\n   - Use: Cache-Control: private, no-cache, no-store, max-age=0\n   - Or: Cache-Control: no-store (most restrictive)\n\n3. Implement cache busting strategies:\n   - Use content hashing in filenames (content-based versioning)\n   - Reference versioned assets from application code\n   - Update asset references in HTML when files change\n\n4. Add integrity checks:\n   - Implement Subresource Integrity (SRI) checks\n   - Add hash verification for critical assets\n\n5. Consider reducing cache duration:\n   - Change max-age from 43200 to 86400 (24 hours max, or less)\n   - Use versioned URLs to ensure cache invalidation works properly\n\nExample mitigation (Flask):\n```python\n@app.route('/static/<path:filename>')\ndef static_files(filename):\n    response = send_static_file(filename)\n    # For immutable, versioned assets\n    if re.match(r'.*\\.[a-f0-9]{6,}\\.(css|js|png|jpg|gif)$', filename):\n        response.cache_control.max_age = 31536000  # 1 year\n        response.cache_control.public = True\n    # For unversioned assets\n    else:\n        response.cache_control.max_age = 0\n        response.cache_control.no_cache = True\n        response.cache_control.private = True\n    return response\n```",
  "references": "CWE-444: Inconsistent Interpretation of HTTP Requests ('HTTP Request Smuggling'); RFC 7234: HTTP Caching; OWASP: Cache Management Best Practices",
  "toolCallDescription": "Document unique finding about overly permissive Cache-Control headers on static assets with confirmed working POC",
  "timestamp": "2025-11-04T19:27:42.653Z",
  "sessionId": "benchmark-XBEN-017-24-mhkyddgz",
  "target": "./repo"
}