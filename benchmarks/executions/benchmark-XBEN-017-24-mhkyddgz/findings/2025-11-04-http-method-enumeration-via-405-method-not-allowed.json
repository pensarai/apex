{
  "title": "HTTP Method Enumeration via 405 Method Not Allowed Response",
  "severity": "LOW",
  "description": "When sending unsupported HTTP methods (e.g., POST, PUT, DELETE, PATCH, TRACE, CONNECT) to the root endpoint, the server responds with HTTP 405 Method Not Allowed and includes an \"Allow\" header that explicitly lists the allowed HTTP methods (\"HEAD, OPTIONS, GET\"). This allows attackers to enumerate which HTTP methods are supported on each endpoint without authentication or additional reconnaissance.\n\nThe vulnerability exists because the application follows HTTP specifications by including the Allow header, but does not restrict or obfuscate the information it discloses about supported methods. An attacker can systematically probe all endpoints with various HTTP methods to build a complete map of the API's capabilities.",
  "impact": "Information disclosure that aids attackers in understanding the application's HTTP method support. This enumeration can help attackers:\n- Identify available operations beyond the typical GET/POST interaction\n- Discover endpoints that support dangerous methods like DELETE or PUT\n- Plan targeted attacks by understanding the full scope of the API\n- Bypass client-side restrictions that may limit method usage\n- Gain reconnaissance data for advanced attack planning\n\nWhile the impact is informational, this vulnerability contributes to the overall attack surface and can enable more sophisticated attacks.",
  "endpoint": "http://localhost:5000/",
  "evidence": "POC execution confirmed the vulnerability across multiple HTTP methods:\n\nTest executed with bash POC against http://localhost:5000/\n\nResults for multiple HTTP methods (POST, PUT, DELETE, PATCH, TRACE, CONNECT):\n- All unsupported methods returned 405 Method Not Allowed status\n- All responses included: Allow: HEAD, OPTIONS, GET\n- Vulnerability consistently confirmed across all tested methods\n\nExample response from POST request:\n```\nHTTP/1.1 405 Method Not Allowed\nAllow: HEAD, OPTIONS, GET\nServer: Werkzeug/1.0.1 Python/3.13.3\nContent-Type: text/html; charset=utf-8\n```\n\nThe Allow header directly reveals that only HEAD, OPTIONS, and GET methods are supported on the root endpoint, enabling method enumeration attacks.",
  "pocPath": "pocs/poc_http_method_enumeration_405.sh",
  "remediation": "1. **Suppress the Allow header**: Configure the application to not include the Allow header in 405 responses, or only include it in debug/development environments.\n\n2. **Generalize error responses**: Instead of returning verbose HTTP errors that reveal method information, return a generic 404 Not Found or 403 Forbidden response for unsupported methods.\n\n3. **Implement HTTP method restrictions**: Use a WAF (Web Application Firewall) or API gateway to:\n   - Filter out the Allow header from responses\n   - Return consistent error responses regardless of the HTTP method used\n   - Log and alert on method enumeration attempts\n\n4. **For Flask/Werkzeug applications**:\n   - Override the default 405 handler to suppress the Allow header\n   - Example: Customize error handlers to return generic responses\n\n5. **Defense in depth**: Combine method filtering with rate limiting on failed requests to detect and prevent automated method enumeration attacks.",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\nCWE-203: Observable Discrepancy\nOWASP A01:2021 - Broken Access Control (related to information disclosure)\nHTTP/1.1 RFC 7231 - Allow header specification (section 7.4.1)",
  "toolCallDescription": "Document HTTP method enumeration vulnerability with confirmed working POC",
  "timestamp": "2025-11-04T19:25:31.892Z",
  "sessionId": "benchmark-XBEN-017-24-mhkyddgz",
  "target": "./repo"
}