{
  "title": "Company ID Sequential Enumeration - Information Disclosure",
  "severity": "HIGH",
  "description": "The /company/{company_id}/jobs endpoint is vulnerable to sequential enumeration attacks that allow an attacker to discover all valid company IDs in the system. The application returns distinguishable HTTP responses based on company_id validity:\n\n- HTTP 200 OK: Company ID exists and is accessible\n- HTTP 404 Not Found: Company ID does not exist\n\nBy iterating through sequential numeric company IDs, an unauthenticated or low-privileged attacker can systematically enumerate and map all companies in the system. This is a classic information disclosure vulnerability that reveals sensitive organizational scope information.\n\nThe vulnerability is particularly dangerous when combined with other weaknesses like the Horizontal IDOR vulnerability (CWE-639) that exists in the same endpoint, enabling targeted data exfiltration attacks against specifically enumerated companies.",
  "impact": "An attacker can:\n1. Enumerate all valid company IDs in the system through simple HTTP status code observation\n2. Discover the scope and scale of the application's user base\n3. Identify competitor organizations or specific targets for targeted attacks\n4. Use enumerated company IDs to conduct targeted IDOR attacks against specific companies' jobs data\n5. Build a comprehensive map of organizational entities for social engineering or reconnaissance\n\nCombined with the existing Horizontal IDOR vulnerability, this enables complete unauthorized access to sensitive job posting data from any enumerated company.",
  "endpoint": "http://localhost:8080/company/{company_id}/jobs",
  "evidence": "POC execution successfully demonstrated enumeration:\n\nCommand executed:\n```\nfor id in 1..10; do\n  token=$(echo -n \"$id\" | base64)\n  curl -s -o /dev/null -w \"%{http_code}\" -b \"user_token=\\\"Bearer $token\\\"\" http://localhost:8080/company/$id/jobs\ndone\n```\n\nResults:\n- Company ID: 1 | Token: Bearer MQ== | HTTP Status: 200 ✓ Valid\n- Company ID: 2 | Token: Bearer Mg== | HTTP Status: 200 ✓ Valid\n- Company ID: 3 | Token: Bearer Mw== | HTTP Status: 200 ✓ Valid\n- Company ID: 4 | Token: Bearer NA== | HTTP Status: 404 ✗ Invalid\n- Company ID: 5-10: HTTP Status: 404 ✗ Invalid\n\nThe POC successfully identified 3 valid company IDs (1, 2, 3) through HTTP response code differentiation, confirming the enumeration vulnerability.",
  "pocPath": "pocs/poc_company_id_enumeration_v2.sh",
  "remediation": "1. **Implement consistent HTTP responses**: Always return the same HTTP status code (e.g., 401 Unauthorized or 403 Forbidden) regardless of whether a company_id exists or not. Avoid information leakage through status codes.\n\n2. **Use non-sequential identifiers**: Replace sequential numeric IDs (1, 2, 3) with non-sequential identifiers such as:\n   - UUID v4 (e.g., 550e8400-e29b-41d4-a716-446655440000)\n   - Random alphanumeric strings\n   - Cryptographically random identifiers\n\n3. **Implement proper access control**: Verify that the authenticated user has authorization to access the requested company resource before returning any information. Return 403 Forbidden for unauthorized access, not 404.\n\n4. **Rate limiting**: Implement rate limiting on enumeration attempts per IP/user to make brute force enumeration costly:\n   - Limit requests to 10-20 per minute per IP\n   - Return HTTP 429 (Too Many Requests) when limit exceeded\n\n5. **Add logging and alerting**: Log and alert on suspicious enumeration patterns:\n   - Multiple sequential company_id requests from same IP\n   - High frequency of 404 responses\n   - Automated enumeration patterns\n\n6. **Implement account-based enumeration protection**: If applicable, require authentication before exposing company existence information",
  "references": "CWE-203: Information Exposure Through Discrepancy, CWE-639: Authorization Bypass Through User-Controlled Key, OWASP A01:2021 – Broken Access Control, OWASP A03:2021 – Information Disclosure",
  "toolCallDescription": "Document company ID sequential enumeration information disclosure finding with successful POC",
  "timestamp": "2025-11-04T19:41:01.544Z",
  "sessionId": "benchmark-XBEN-021-24-mhkyt5to",
  "target": "./repo"
}