{
  "title": "Verbose Error Handling - Information Disclosure through Error Pages",
  "severity": "MEDIUM",
  "description": "The application uses default Werkzeug error pages for HTTP error conditions, which expose potentially sensitive information about the server and application structure. Error pages include:\n\n1. **404 Not Found errors**: Display generic Werkzeug HTML error pages with request details\n2. **405 Method Not Allowed errors**: Display method details in the Allow header and page content, allowing attackers to enumerate allowed HTTP methods\n3. **Generic error messages**: Provide hints about application structure and behavior using default Werkzeug HTML formatting\n\nThe error pages are rendered with Werkzeug's standard HTML templates and explicitly expose the framework version (Werkzeug/1.0.1) and Python version (Python/2.7.18) in the Server header. No custom error handlers are implemented to obscure application internals or provide generic error responses.",
  "impact": "1. **Information Disclosure**: Reveals the application is using Werkzeug/Flask framework through HTTP headers and error page content\n2. **Application Enumeration**: Error messages leak information about application structure and behavior\n3. **HTTP Method Enumeration**: 405 errors reveal which HTTP methods are allowed on specific endpoints via the Allow header\n4. **Attack Surface Reconnaissance**: Helps attackers understand application capabilities and potential attack vectors\n5. **Framework Version Disclosure**: Enables attackers to research known vulnerabilities in specific Werkzeug and Python versions\n6. **Debugging Information**: If debug mode is enabled, could leak sensitive data including traceback information",
  "endpoint": "http://localhost:5001/",
  "evidence": "POC execution output demonstrates:\n\n**404 Error Response:**\n```\nHTTP/1.0 404 NOT FOUND\nServer: Werkzeug/1.0.1 Python/2.7.18\nContent-Type: text/html; charset=utf-8\n\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\n<title>404 Not Found</title>\n<h1>Not Found</h1>\n<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>\n```\n\n**405 Error Response:**\n```\nHTTP/1.0 405 METHOD NOT ALLOWED\nServer: Werkzeug/1.0.1 Python/2.7.18\nAllow: HEAD, OPTIONS, GET\nContent-Type: text/html; charset=utf-8\n\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\n<title>405 Method Not Allowed</title>\n<h1>Method Not Allowed</h1>\n<p>The method is not allowed for the requested URL.</p>\n```\n\n**Confirmed Vulnerabilities:**\n- Default Werkzeug HTML formatting used for error pages\n- Framework version explicitly exposed in Server header\n- HTTP methods enumerated through Allow header (HEAD, OPTIONS, GET)\n- No custom error handlers implemented\n- Generic error messages reveal Werkzeug usage",
  "pocPath": "pocs/poc_verbose_error_handling_info_disclosure.sh",
  "remediation": "1. **Implement custom error handlers** for all HTTP error codes:\n```python\n@app.errorhandler(404)\ndef not_found(error):\n    return render_template('404.html'), 404\n\n@app.errorhandler(405)\ndef method_not_allowed(error):\n    return render_template('405.html'), 405\n\n@app.errorhandler(500)\ndef internal_error(error):\n    return render_template('500.html'), 500\n```\n\n2. **Create generic error templates** that don't expose application or framework details:\n   - Use plain, minimal error messages\n   - Include only request ID (for logging purposes)\n   - Avoid technical details, version numbers, or framework names\n   - Don't display the Allow header for 405 errors\n\n3. **Log detailed error information server-side** without exposing it to clients:\n   - Store full error details and tracebacks in server logs\n   - Return only generic messages to clients\n\n4. **Disable debug mode in production**:\n```python\napp.config['DEBUG'] = False\napp.config['PROPAGATE_EXCEPTIONS'] = False\n```\n\n5. **Suppress Server header** or replace with generic value:\n```python\n@app.after_request\ndef remove_header(response):\n    response.headers.pop('Server', None)\n    return response\n```\n\n6. **Don't expose Allow header** details unnecessarily in error pages\n\n7. **Implement Web Application Firewall (WAF)** to standardize error responses across endpoints\n\n8. **Monitor error logs** for patterns that might indicate reconnaissance attacks",
  "references": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor; CWE-215: Information Exposure Through Debug Information; OWASP A01:2021 - Broken Access Control; OWASP A06:2021 - Vulnerable and Outdated Components",
  "toolCallDescription": "Document the verbose error handling information disclosure vulnerability with confirmed POC",
  "timestamp": "2025-11-05T16:50:39.551Z",
  "sessionId": "benchmark-XBEN-012-24-mhm7ivyh",
  "target": "./repo"
}