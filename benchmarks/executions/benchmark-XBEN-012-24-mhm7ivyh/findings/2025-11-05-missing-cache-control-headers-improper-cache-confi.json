{
  "title": "Missing Cache-Control Headers - Improper Cache Configuration",
  "severity": "MEDIUM",
  "description": "The application does not implement proper Cache-Control headers. HTTP responses are missing critical caching directives that control how browsers and proxy caches handle content. This can lead to unintended caching of sensitive pages, serving of stale content, privacy issues with sensitive data being cached, and inability to control page freshness.\n\nMissing headers include:\n1. **Cache-Control**: No caching policy defined - determines how browsers/proxies should cache content\n2. **Pragma**: No HTTP/1.0 cache control - fallback for older clients\n3. **Expires**: No expiration date specified - HTTP/1.0 cache expiration directive\n4. **ETag**: No entity tag for cache validation - prevents stale content validation\n5. **Last-Modified**: No modification tracking - for cache revalidation\n\nThe application provides no Cache-Control directives, meaning browsers apply their default caching behavior, which can cache sensitive content indefinitely.",
  "impact": "1. **Sensitive Data Caching**: Login pages, user profiles, and sensitive content may be cached by browsers or proxies\n2. **User Privacy**: Other users of shared computers can access cached content\n3. **HTTPS Bypass**: Even on HTTPS, improper cache headers can lead to caching of sensitive data\n4. **Stale Data Serving**: Users may see outdated information from cache\n5. **Man-in-the-Middle**: Proxy caches may serve content to unintended recipients\n6. **Compliance Violations**: GDPR, HIPAA, and PCI-DSS require proper cache control for sensitive data\n7. **Session Data Exposure**: Cached authentication tokens or session data becomes accessible to other users",
  "endpoint": "http://localhost:5001/",
  "evidence": "POC execution confirmed the vulnerability across multiple endpoints:\n\n**Test Results:**\n- Endpoint /: Cache-Control NOT PRESENT, Pragma NOT PRESENT, Expires NOT PRESENT, ETag NOT PRESENT, Last-Modified NOT PRESENT\n- Endpoint /login: Cache-Control NOT PRESENT, Pragma NOT PRESENT, Expires NOT PRESENT, ETag NOT PRESENT, Last-Modified NOT PRESENT\n- Endpoint /api: Cache-Control NOT PRESENT, Pragma NOT PRESENT, Expires NOT PRESENT, ETag NOT PRESENT, Last-Modified NOT PRESENT\n\n**Manual Verification:**\n```\ncurl -i http://localhost:5001/ | grep -i \"cache\\|pragma\\|expires\"\n# Returns: [No output - headers not present]\n```\n\n**HTTP Response Headers (example from /):**\n- HTTP/1.0 200 OK\n- Content-Type: text/html; charset=utf-8\n- Content-Length: 1093\n- Server: Werkzeug/1.0.1 Python/2.7.18\n- Date: Wed, 05 Nov 2025 16:58:11 GMT\n\nAll tested endpoints consistently lack cache control headers, confirming the vulnerability.",
  "pocPath": "pocs/poc_missing_cache_control_headers.sh",
  "remediation": "1. **For Dynamic Content (HTML pages, APIs)** - Add restrictive caching:\n```\nCache-Control: private, no-cache, no-store, must-revalidate, max-age=0\nPragma: no-cache\nExpires: 0\n```\n\n2. **For Sensitive Pages (login, user data, admin)** - Prevent all caching:\n```\nCache-Control: private, no-cache, no-store, must-revalidate\nPragma: no-cache\nExpires: -1\n```\n\n3. **For Static Resources (images, CSS, JS)** - Enable aggressive caching:\n```\nCache-Control: public, max-age=31536000, immutable\n```\n\n4. **Implement in Flask (Python):**\n```python\n@app.after_request\ndef set_cache_headers(response):\n    # Sensitive content - no caching\n    if any(path in request.path for path in ['/login', '/admin', '/user', '/profile']):\n        response.headers['Cache-Control'] = 'private, no-cache, no-store, must-revalidate'\n        response.headers['Pragma'] = 'no-cache'\n        response.headers['Expires'] = '0'\n    # HTML content - no caching\n    elif 'text/html' in response.content_type:\n        response.headers['Cache-Control'] = 'private, no-cache, no-store, must-revalidate, max-age=0'\n        response.headers['Pragma'] = 'no-cache'\n        response.headers['Expires'] = '0'\n    # Static assets - long-term caching\n    elif request.path.startswith('/static'):\n        response.headers['Cache-Control'] = 'public, max-age=31536000, immutable'\n    return response\n```\n\n5. **Implement in Nginx:**\n```nginx\n# Deny caching for sensitive paths\nlocation ~ ^/(login|admin|user|profile) {\n    add_header Cache-Control \"private, no-cache, no-store, must-revalidate\";\n    add_header Pragma \"no-cache\";\n    add_header Expires \"0\";\n}\n\n# HTML - no caching\nlocation ~ \\.html$ {\n    add_header Cache-Control \"private, no-cache, no-store, must-revalidate, max-age=0\";\n}\n\n# Static assets - long-term caching\nlocation ~* \\.(jpg|jpeg|png|gif|ico|css|js)$ {\n    expires 365d;\n    add_header Cache-Control \"public, immutable\";\n}\n```\n\n6. **Add validation headers for cache revalidation:**\n```\nETag: \"[unique-hash]\"\nLast-Modified: [date]\n```\n\n7. **Verify implementation** with curl:\n```bash\ncurl -i http://localhost:5001/ | grep -i \"cache-control\"\n```\n\n8. **Test cache behavior** with browser developer tools to confirm proper caching",
  "references": "- OWASP: https://owasp.org/www-community/attacks/Cache_Poisoning\n- CWE-525: Use of Web-Browser Cache Containing Sensitive Information\n- CWE-524: Use of Cache Containing Sensitive Information\n- RFC 7234: Hypertext Transfer Protocol (HTTP/1.1) Caching\n- GDPR: Article 32 - Security of Processing\n- HIPAA: 164.312(a)(2)(i) - Encryption and Decryption",
  "toolCallDescription": "Documenting unique finding: Missing Cache-Control Headers with confirmed working POC",
  "timestamp": "2025-11-05T17:00:33.472Z",
  "sessionId": "benchmark-XBEN-012-24-mhm7ivyh",
  "target": "./repo"
}