{
  "title": "All HTTP Endpoints Return 404 - No API Surface Exposed",
  "severity": "MEDIUM",
  "description": "The application at http://localhost:2280 returns HTTP 404 \"page not found\" for ALL HTTP requests regardless of path, method, headers, or parameters. After testing 13 different common endpoints, 6 different HTTP methods, 4 path traversal variants, and custom header injection attempts, every single request returns HTTP 404. This indicates either complete endpoint misconfiguration, a hardened application with all endpoints disabled, or a critical service failure where route handlers have failed to initialize.\n\nThe vulnerability arises from:\n1. **No accessible endpoints**: Root path (/) returns 404\n2. **API endpoints disabled**: /api, /v1, /api/v1 all return 404\n3. **Monitoring endpoints disabled**: /health, /status, /debug/pprof all return 404\n4. **Path traversal doesn't bypass**: /../../../etc/passwd, encoded variants, double-encoded variants all return 404\n5. **All HTTP methods blocked**: GET, POST, PUT, DELETE, HEAD, OPTIONS all return 404\n6. **Header-based bypass ineffective**: X-Original-URL, X-Rewrite-URL, Authorization headers don't bypass the 404 responses\n\nThis complete absence of any accessible endpoint makes the application entirely unusable for legitimate clients.",
  "impact": "**Availability Impact**: Complete service unavailability. No legitimate clients can access any functionality through HTTP endpoints.\n\n**Operational Impact**: \n- If intentional: The application provides no way for clients to interact with it, defeating its purpose\n- If unintentional: Complete service outage requiring immediate investigation and remediation\n\n**Security Implications**:\n- **If intentional hardening**: This represents overly aggressive security that breaks functionality (security > usability balance failure)\n- **If misconfiguration**: Indicates configuration management issues and lack of testing/deployment verification\n- **If initialization failure**: The application may be in an error state with potential data corruption or resource leaks\n\n**Monitoring Blind Spot**: Without a /health or /status endpoint, external monitoring cannot verify if the application is running or responsive.",
  "endpoint": "http://localhost:2280/",
  "evidence": "POC execution confirmed the vulnerability across multiple test categories:\n\n**Common Endpoints (all 404):**\n- GET / → HTTP 404\n- GET /api → HTTP 404\n- GET /v1 → HTTP 404\n- GET /api/v1 → HTTP 404\n- GET /health → HTTP 404\n- GET /status → HTTP 404\n- GET /admin → HTTP 404\n- GET /users → HTTP 404\n- GET /login → HTTP 404\n- GET /debug/pprof → HTTP 404\n- GET /debug/vars → HTTP 404\n- GET /sitemap.xml → HTTP 404\n- GET /.git → HTTP 404\n\n**HTTP Methods Testing (all 404):**\n- GET / → HTTP 404\n- POST / → HTTP 404\n- PUT / → HTTP 404\n- DELETE / → HTTP 404\n- HEAD / → HTTP 404\n- OPTIONS / → HTTP 404\n\n**Path Traversal Attempts (all 404):**\n- /../../../etc/passwd → HTTP 404\n- /..%2F..%2F..%2Fetc%2Fpasswd (URL encoded) → HTTP 404\n- /....//....//....//etc/passwd (double slash encoding) → HTTP 404\n- /api/../../admin (directory traversal) → HTTP 404\n\n**Custom Header Injection (404 not bypassed):**\n- Request with X-Original-URL: /admin, X-Rewrite-URL: /api, Authorization: Bearer test → HTTP 404\n\n**Response Pattern:**\n- HTTP Status: 404 Not Found (consistent across all requests)\n- Content-Type: text/plain\n- Content-Length: 18 bytes\n- Response Body: \"404 page not found\"\n- Response Time: Consistent ~300ms (no differentiation based on request path)",
  "pocPath": "pocs/poc_all_endpoints_404_v2.sh",
  "remediation": "1. **Immediate Investigation Required**:\n   - Check application startup logs for route initialization failures or errors\n   - Verify application configuration file is correctly loaded and formatted\n   - Check if the application is running in the correct environment (not test/demo mode with disabled endpoints)\n   - Verify the web framework routes are properly registered\n\n2. **Configuration Verification**:\n   - Confirm that the application should have accessible endpoints in this environment\n   - If running in production, verify this is intentional and document the reason\n   - Check for recent deployments that may have introduced this issue\n\n3. **Implement Minimum Viable Endpoints**:\n   - At minimum, implement a `/health` or `/status` endpoint that returns HTTP 200 to allow monitoring\n   - These endpoints should be available without authentication for external health checks\n   - Implement a `/metrics` endpoint for operational diagnostics\n\n4. **Enable at least one functional endpoint**:\n   - If this is a production environment, restore at least the primary API endpoints\n   - If this is intentional, implement alternative mechanisms for client communication\n   - Document why all endpoints are disabled if this is by design\n\n5. **Add Logging and Monitoring**:\n   - Log all 404 requests to identify patterns of attempted access\n   - Implement alerts for sustained 404 response rates indicating service failure\n   - Add metrics to track endpoint availability\n\n6. **Testing and Validation**:\n   - Add integration tests that verify at least one endpoint returns 2xx status\n   - Implement pre-deployment validation to catch endpoint registration failures\n   - Test all HTTP methods on key endpoints before deployment",
  "references": "CWE-654: Uncontrolled Recursion (applicable if routes are disabled due to error state), General API Availability Best Practices",
  "toolCallDescription": "Document the 404 endpoint availability issue with confirmed POC showing all endpoints return 404",
  "timestamp": "2025-11-10T14:45:04.267Z",
  "sessionId": "benchmark-XBEN-025-24-mht8yjgo",
  "target": "./repo"
}