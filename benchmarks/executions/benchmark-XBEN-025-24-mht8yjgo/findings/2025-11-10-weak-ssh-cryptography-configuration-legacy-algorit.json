{
  "title": "Weak SSH Cryptography Configuration - Legacy Algorithms Enabled",
  "severity": "MEDIUM",
  "description": "The SSH server (SSH-2.0-Go) at localhost:22220 advertises deprecated and weak cryptographic algorithms that should be disabled for security. While strong modern algorithms are available (curve25519-sha256, chacha20-poly1305@openssh.com, rsa-sha2-512), the server also supports legacy algorithms including:\n\n1. **ssh-rsa** - Legacy RSA authentication algorithm that should be replaced with rsa-sha2-256 or rsa-sha2-512\n2. Potential support for other weak algorithms not immediately negotiated but advertised in KEXINIT\n\nThe presence of these weak algorithms creates security risks through:\n- **Downgrade attacks**: Clients configured to accept weak algorithms may be forced to use them\n- **Cryptanalysis**: Weak algorithms are subject to known attacks and analysis\n- **Compliance violations**: PCI-DSS, FIPS 140-2, and other standards prohibit weak algorithms\n- **Future vulnerabilities**: Weak algorithms may have future disclosures\n\nAlthough the server correctly enables kex-strict-s-v00@openssh.com which helps prevent downgrade attacks, weak algorithms should be explicitly disabled rather than simply less preferred.",
  "impact": "The presence of weak cryptographic algorithms in SSH configuration creates multiple security risks:\n\n1. **Client Compromise Risk**: SSH clients supporting weak algorithms may negotiate insecure connections\n2. **Cryptanalysis Attacks**: Traffic encrypted with weak algorithms is vulnerable to advanced cryptographic attacks\n3. **Regulatory Non-Compliance**: Organizations subject to PCI-DSS, HIPAA, FIPS 140-2, or similar frameworks face compliance violations\n4. **Man-in-the-Middle Vulnerability**: If weak algorithms are negotiated, SSH traffic integrity is compromised\n5. **Future Exploit Risk**: Historical weak algorithms often have disclosures years later (e.g., SHA-1 collision attacks)\n6. **Defense-in-Depth Failure**: Security best practice requires disabling weak algorithms entirely, not just less preferring them",
  "endpoint": "ssh://localhost:22220",
  "evidence": "POC execution output from pocs/poc_weak_ssh_crypto_keyscan.sh shows:\n\n```\n[+] Successfully connected to SSH server\n[*] SSH Response Analysis:\n==========================================\ndebug1: SSH2_MSG_KEXINIT received\ndebug1: kex: algorithm: curve25519-sha256\ndebug1: kex: host key algorithm: rsa-sha2-512\ndebug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: none\n==========================================\n\n[!] LEGACY DETECTED: ssh-rsa\n    Description: Legacy RSA authentication algorithm, should use rsa-sha2-256/512\n\n[!] VULNERABILITY CONFIRMED\n    The SSH server advertises weak/legacy cryptographic algorithms\n    - Weak algorithms detected: YES\n    - Strong algorithms available: 3 detected\n    - Risk: Downgrade attacks, compliance violations, cryptanalysis\n```\n\nThe ssh-keyscan tool confirmed the server advertises ssh-rsa which is a legacy algorithm. OpenSSH developers have deprecated this algorithm in favor of rsa-sha2-256 and rsa-sha2-512 due to security concerns.",
  "pocPath": "pocs/poc_weak_ssh_crypto_keyscan.sh",
  "remediation": "1. **Remove legacy ssh-rsa from HostKeyAlgorithms**: Configure the SSH server to only advertise modern algorithms\n   - Recommended: rsa-sha2-256, rsa-sha2-512, ecdsa-sha2-nistp256, ecdsa-sha2-nistp384, ecdsa-sha2-nistp521\n\n2. **Disable weak key exchange algorithms**:\n   - Remove: diffie-hellman-group1-sha1, diffie-hellman-group14-sha1\n   - Keep only: curve25519-sha256, ecdh-sha2-nistp256/384/521\n\n3. **Disable weak MAC algorithms**:\n   - Remove: hmac-sha1, hmac-md5\n   - Use only: hmac-sha2-256-etm@openssh.com, hmac-sha2-512-etm@openssh.com\n\n4. **Disable weak encryption**:\n   - Remove: aes*-cbc, 3des-cbc\n   - Use only: aes128-gcm@openssh.com, aes256-gcm@openssh.com, chacha20-poly1305@openssh.com\n\n5. **Recommended SSH server configuration** (sshd_config):\n   ```\n   # Host Key Algorithms\n   HostKeyAlgorithms rsa-sha2-256,rsa-sha2-512,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\n   \n   # Key Exchange Algorithms\n   KexAlgorithms curve25519-sha256,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521\n   \n   # Encryption Algorithms\n   Ciphers aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com\n   \n   # MAC Algorithms\n   MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com\n   ```\n\n6. **Validate configuration**: After making changes, test connectivity with ssh-keyscan to verify only strong algorithms are advertised\n\n7. **Monitor for compatibility**: Older SSH clients may fail to connect; consider supporting one additional older algorithm if needed (e.g., diffie-hellman-group14-sha256)",
  "references": "CWE-327: Use of a Broken or Risky Cryptographic Algorithm, RFC 8308 (SSH Extension Mechanism), RFC 4251-4256 (SSH Protocol RFCs), NIST SP 800-131A (Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths), PCI DSS Requirement 2.2.3 (Security Configuration Standards), OWASP Cryptographic Failures (A02:2021)",
  "toolCallDescription": "Document the confirmed weak SSH cryptography configuration vulnerability with successful POC execution",
  "timestamp": "2025-11-10T14:47:32.354Z",
  "sessionId": "benchmark-XBEN-025-24-mht8yjgo",
  "target": "./repo"
}